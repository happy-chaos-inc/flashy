/*! For license information please see main.09bca386.js.LICENSE.txt */
(()=>{"use strict";var e={4(e,t,n){var i=n(853),r=n(43),s=n(950);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function h(e){if(l(e)!==e)throw Error(o(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var p=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),b=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),C=Symbol.for("react.lazy");Symbol.for("react.scope");var A=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var E=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var _=Symbol.iterator;function T(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=_&&e[_]||e["@@iterator"])?e:null}var P=Symbol.for("react.client.reference");function M(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===P?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case v:return"Fragment";case O:return"Profiler";case y:return"StrictMode";case x:return"Suspense";case D:return"SuspenseList";case A:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case b:return e.displayName||"Context";case w:return(e._context.displayName||"Context")+".Consumer";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case S:return null!==(t=e.displayName||null)?t:M(e.type)||"Memo";case C:t=e._payload,e=e._init;try{return M(e(t))}catch(n){}}return null}var F=Array.isArray,R=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,N=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I={pending:!1,data:null,method:null,action:null},B=[],Q=-1;function L(e){return{current:e}}function j(e){0>Q||(e.current=B[Q],B[Q]=null,Q--)}function $(e,t){Q++,B[Q]=e.current,e.current=t}var z,W,V=L(null),U=L(null),X=L(null),q=L(null);function Z(e,t){switch($(X,t),$(U,e),$(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?vh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=yh(t=vh(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}j(V),$(V,e)}function H(){j(V),j(U),j(X)}function Y(e){null!==e.memoizedState&&$(q,e);var t=V.current,n=yh(t,e.type);t!==n&&($(U,e),$(V,n))}function G(e){U.current===e&&(j(V),j(U)),q.current===e&&(j(q),ud._currentValue=I)}function K(e){if(void 0===z)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);z=t&&t[1]||"",W=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+z+e+W}var J=!1;function ee(e,t){if(!e||J)return"";J=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(r){var i=r}Reflect.construct(e,[],n)}else{try{n.call()}catch(s){i=s}e.call(n.prototype)}}else{try{throw Error()}catch(o){i=o}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(a){if(a&&i&&"string"===typeof a.stack)return[a.stack,i.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=i.DetermineComponentFrameRoot(),o=s[0],a=s[1];if(o&&a){var l=o.split("\n"),c=a.split("\n");for(r=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(i===l.length||r===c.length)for(i=l.length-1,r=c.length-1;1<=i&&0<=r&&l[i]!==c[r];)r--;for(;1<=i&&0<=r;i--,r--)if(l[i]!==c[r]){if(1!==i||1!==r)do{if(i--,0>--r||l[i]!==c[r]){var u="\n"+l[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=i&&0<=r);break}}}finally{J=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?K(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return K(e.type);case 16:return K("Lazy");case 13:return e.child!==t&&null!==t?K("Suspense Fallback"):K("Suspense");case 19:return K("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return K("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(i){return"\nError generating stack: "+i.message+"\n"+i.stack}}var ie=Object.prototype.hasOwnProperty,re=i.unstable_scheduleCallback,se=i.unstable_cancelCallback,oe=i.unstable_shouldYield,ae=i.unstable_requestPaint,le=i.unstable_now,ce=i.unstable_getCurrentPriorityLevel,ue=i.unstable_ImmediatePriority,he=i.unstable_UserBlockingPriority,de=i.unstable_NormalPriority,pe=i.unstable_LowPriority,fe=i.unstable_IdlePriority,me=i.log,ge=i.unstable_setDisableYieldValue,ve=null,ye=null;function Oe(e){if("function"===typeof me&&ge(e),ye&&"function"===typeof ye.setStrictMode)try{ye.setStrictMode(ve,e)}catch(t){}}var we=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(be(e)/ke|0)|0},be=Math.log,ke=Math.LN2;var xe=256,De=262144,Se=4194304;function Ce(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t,n){var i=e.pendingLanes;if(0===i)return 0;var r=0,s=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var a=134217727&i;return 0!==a?0!==(i=a&~s)?r=Ce(i):0!==(o&=a)?r=Ce(o):n||0!==(n=a&~e)&&(r=Ce(n)):0!==(a=i&~s)?r=Ce(a):0!==o?r=Ce(o):n||0!==(n=i&~e)&&(r=Ce(n)),0===r?0:0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(n=t&-t)||32===s&&0!==(4194048&n))?t:r}function Ee(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function _e(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Te(){var e=Se;return 0===(62914560&(Se<<=1))&&(Se=4194304),e}function Pe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Me(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Fe(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-we(t);e.entangledLanes|=t,e.entanglements[i]=1073741824|e.entanglements[i]|261930&n}function Re(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-we(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}function Ne(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Ie(n))&(e.suspendedLanes|t))?0:n}function Ie(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Be(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Qe(){var e=N.p;return 0!==e?e:void 0===(e=window.event)?32:Cd(e.type)}function Le(e,t){var n=N.p;try{return N.p=e,t()}finally{N.p=n}}var je=Math.random().toString(36).slice(2),$e="__reactFiber$"+je,ze="__reactProps$"+je,We="__reactContainer$"+je,Ve="__reactEvents$"+je,Ue="__reactListeners$"+je,Xe="__reactHandles$"+je,qe="__reactResources$"+je,Ze="__reactMarker$"+je;function He(e){delete e[$e],delete e[ze],delete e[Ve],delete e[Ue],delete e[Xe]}function Ye(e){var t=e[$e];if(t)return t;for(var n=e.parentNode;n;){if(t=n[We]||n[$e]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Ih(e);null!==e;){if(n=e[$e])return n;e=Ih(e)}return t}n=(e=n).parentNode}return null}function Ge(e){if(e=e[$e]||e[We]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Ke(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function Je(e){var t=e[qe];return t||(t=e[qe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Ze]=!0}var tt=new Set,nt={};function it(e,t){rt(e,t),rt(e+"Capture",t)}function rt(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ot={},at={};function lt(e,t,n){if(r=t,ie.call(at,r)||!ie.call(ot,r)&&(st.test(r)?at[r]=!0:(ot[r]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var i=t.toLowerCase().slice(0,5);if("data-"!==i&&"aria-"!==i)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var r}function ct(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,i){if(null===i)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+i)}}function ht(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function dt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function pt(e){if(!e._valueTracker){var t=dt(e)?"checked":"value";e._valueTracker=function(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,s=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=dt(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function mt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function vt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,n,i,r,s,o,a){e.name="",null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ht(t)):e.value!==""+ht(t)&&(e.value=""+ht(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?wt(e,o,ht(t)):null!=n?wt(e,o,ht(n)):null!=i&&e.removeAttribute("value"),null==r&&null!=s&&(e.defaultChecked=!!s),null!=r&&(e.checked=r&&"function"!==typeof r&&"symbol"!==typeof r),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ht(a):e.removeAttribute("name")}function Ot(e,t,n,i,r,s,o,a){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=n){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return void pt(e);n=null!=n?""+ht(n):"",t=null!=t?""+ht(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}i="function"!==typeof(i=null!=i?i:r)&&"symbol"!==typeof i&&!!i,e.checked=a?e.checked:!!i,e.defaultChecked=!!i,null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.name=o),pt(e)}function wt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+ht(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function kt(e,t,n){null==t||((t=""+ht(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ht(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function xt(e,t,n,i){if(null==t){if(null!=i){if(null!=n)throw Error(o(92));if(F(i)){if(1<i.length)throw Error(o(93));i=i[0]}n=i}null==n&&(n=""),t=n}n=ht(t),e.defaultValue=n,(i=e.textContent)===n&&""!==i&&null!==i&&(e.value=i),pt(e)}function Dt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ct(e,t,n){var i=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?i?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":i?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function At(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(o(62));if(e=e.style,null!=n){for(var i in n)!n.hasOwnProperty(i)||null!=t&&t.hasOwnProperty(i)||(0===i.indexOf("--")?e.setProperty(i,""):"float"===i?e.cssFloat="":e[i]="");for(var r in t)i=t[r],t.hasOwnProperty(r)&&n[r]!==i&&Ct(e,r,i)}else for(var s in t)t.hasOwnProperty(s)&&Ct(e,s,t[s])}function Et(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _t=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Tt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pt(e){return Tt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Mt(){}var Ft=null;function Rt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Nt=null,It=null;function Bt(e){var t=Ge(e);if(t&&(e=t.stateNode)){var n=e[ze]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+vt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=i[ze]||null;if(!r)throw Error(o(90));yt(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)(i=n[t]).form===e.form&&ft(i)}break e;case"textarea":kt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var Qt=!1;function Lt(e,t,n){if(Qt)return e(t,n);Qt=!0;try{return e(t)}finally{if(Qt=!1,(null!==Nt||null!==It)&&(Jc(),Nt&&(t=Nt,e=It,It=Nt=null,Bt(t),e)))for(t=0;t<e.length;t++)Bt(e[t])}}function jt(e,t){var n=e.stateNode;if(null===n)return null;var i=n[ze]||null;if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var $t=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),zt=!1;if($t)try{var Wt={};Object.defineProperty(Wt,"passive",{get:function(){zt=!0}}),window.addEventListener("test",Wt,Wt),window.removeEventListener("test",Wt,Wt)}catch(Gd){zt=!1}var Vt=null,Ut=null,Xt=null;function qt(){if(Xt)return Xt;var e,t,n=Ut,i=n.length,r="value"in Vt?Vt.value:Vt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[s-t];t++);return Xt=r.slice(e,1<t?1-t:void 0)}function Zt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Ht(){return!0}function Yt(){return!1}function Gt(e){function t(t,n,i,r,s){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Ht:Yt,this.isPropagationStopped=Yt,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Ht)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Ht)},persist:function(){},isPersistent:Ht}),t}var Kt,Jt,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Gt(tn),rn=p({},tn,{view:0,detail:0}),sn=Gt(rn),on=p({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Kt=e.screenX-en.screenX,Jt=e.screenY-en.screenY):Jt=Kt=0,en=e),Kt)},movementY:function(e){return"movementY"in e?e.movementY:Jt}}),an=Gt(on),ln=Gt(p({},on,{dataTransfer:0})),cn=Gt(p({},rn,{relatedTarget:0})),un=Gt(p({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),hn=Gt(p({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),dn=Gt(p({},tn,{data:0})),pn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mn[e])&&!!t[e]}function vn(){return gn}var yn=Gt(p({},rn,{key:function(e){if(e.key){var t=pn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Zt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vn,charCode:function(e){return"keypress"===e.type?Zt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Zt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),On=Gt(p({},on,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),wn=Gt(p({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vn})),bn=Gt(p({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),kn=Gt(p({},on,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),xn=Gt(p({},tn,{newState:0,oldState:0})),Dn=[9,13,27,32],Sn=$t&&"CompositionEvent"in window,Cn=null;$t&&"documentMode"in document&&(Cn=document.documentMode);var An=$t&&"TextEvent"in window&&!Cn,En=$t&&(!Sn||Cn&&8<Cn&&11>=Cn),_n=String.fromCharCode(32),Tn=!1;function Pn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Fn=!1;var Rn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Rn[e.type]:"textarea"===t}function In(e,t,n,i){Nt?It?It.push(i):It=[i]:Nt=i,0<(t=ih(t,"onChange")).length&&(n=new nn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Bn=null,Qn=null;function Ln(e){Hu(e,0)}function jn(e){if(ft(Ke(e)))return e}function $n(e,t){if("change"===e)return t}var zn=!1;if($t){var Wn;if($t){var Vn="oninput"in document;if(!Vn){var Un=document.createElement("div");Un.setAttribute("oninput","return;"),Vn="function"===typeof Un.oninput}Wn=Vn}else Wn=!1;zn=Wn&&(!document.documentMode||9<document.documentMode)}function Xn(){Bn&&(Bn.detachEvent("onpropertychange",qn),Qn=Bn=null)}function qn(e){if("value"===e.propertyName&&jn(Qn)){var t=[];In(t,Qn,e,Rt(e)),Lt(Ln,t)}}function Zn(e,t,n){"focusin"===e?(Xn(),Qn=n,(Bn=t).attachEvent("onpropertychange",qn)):"focusout"===e&&Xn()}function Hn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return jn(Qn)}function Yn(e,t){if("click"===e)return jn(t)}function Gn(e,t){if("input"===e||"change"===e)return jn(t)}var Kn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Jn(e,t){if(Kn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!ie.call(t,r)||!Kn(e[r],t[r]))return!1}return!0}function ei(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ti(e,t){var n,i=ei(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ei(i)}}function ni(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ni(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ii(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=mt((e=t.contentWindow).document)}return t}function ri(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var si=$t&&"documentMode"in document&&11>=document.documentMode,oi=null,ai=null,li=null,ci=!1;function ui(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ci||null==oi||oi!==mt(i)||("selectionStart"in(i=oi)&&ri(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},li&&Jn(li,i)||(li=i,0<(i=ih(ai,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=oi)))}function hi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var di={animationend:hi("Animation","AnimationEnd"),animationiteration:hi("Animation","AnimationIteration"),animationstart:hi("Animation","AnimationStart"),transitionrun:hi("Transition","TransitionRun"),transitionstart:hi("Transition","TransitionStart"),transitioncancel:hi("Transition","TransitionCancel"),transitionend:hi("Transition","TransitionEnd")},pi={},fi={};function mi(e){if(pi[e])return pi[e];if(!di[e])return e;var t,n=di[e];for(t in n)if(n.hasOwnProperty(t)&&t in fi)return pi[e]=n[t];return e}$t&&(fi=document.createElement("div").style,"AnimationEvent"in window||(delete di.animationend.animation,delete di.animationiteration.animation,delete di.animationstart.animation),"TransitionEvent"in window||delete di.transitionend.transition);var gi=mi("animationend"),vi=mi("animationiteration"),yi=mi("animationstart"),Oi=mi("transitionrun"),wi=mi("transitionstart"),bi=mi("transitioncancel"),ki=mi("transitionend"),xi=new Map,Di="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Si(e,t){xi.set(e,t),it(t,[e])}Di.push("scrollEnd");var Ci="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Ai=[],Ei=0,_i=0;function Ti(){for(var e=Ei,t=_i=Ei=0;t<e;){var n=Ai[t];Ai[t++]=null;var i=Ai[t];Ai[t++]=null;var r=Ai[t];Ai[t++]=null;var s=Ai[t];if(Ai[t++]=null,null!==i&&null!==r){var o=i.pending;null===o?r.next=r:(r.next=o.next,o.next=r),i.pending=r}0!==s&&Ri(n,r,s)}}function Pi(e,t,n,i){Ai[Ei++]=e,Ai[Ei++]=t,Ai[Ei++]=n,Ai[Ei++]=i,_i|=i,e.lanes|=i,null!==(e=e.alternate)&&(e.lanes|=i)}function Mi(e,t,n,i){return Pi(e,t,n,i),Ni(e)}function Fi(e,t){return Pi(e,null,null,t),Ni(e)}function Ri(e,t,n){e.lanes|=n;var i=e.alternate;null!==i&&(i.lanes|=n);for(var r=!1,s=e.return;null!==s;)s.childLanes|=n,null!==(i=s.alternate)&&(i.childLanes|=n),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(r=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,r&&null!==t&&(r=31-we(n),null===(i=(e=s.hiddenUpdates)[r])?e[r]=[t]:i.push(t),t.lane=536870912|n),s):null}function Ni(e){if(50<Vc)throw Vc=0,Uc=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Ii={};function Bi(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qi(e,t,n,i){return new Bi(e,t,n,i)}function Li(e){return!(!(e=e.prototype)||!e.isReactComponent)}function ji(e,t){var n=e.alternate;return null===n?((n=Qi(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function $i(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function zi(e,t,n,i,r,s){var a=0;if(i=e,"function"===typeof e)Li(e)&&(a=1);else if("string"===typeof e)a=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case A:return(e=Qi(31,n,t,r)).elementType=A,e.lanes=s,e;case v:return Wi(n.children,r,s,t);case y:a=8,r|=24;break;case O:return(e=Qi(12,n,t,2|r)).elementType=O,e.lanes=s,e;case x:return(e=Qi(13,n,t,r)).elementType=x,e.lanes=s,e;case D:return(e=Qi(19,n,t,r)).elementType=D,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:a=10;break e;case w:a=9;break e;case k:a=11;break e;case S:a=14;break e;case C:a=16,i=null;break e}a=29,n=Error(o(130,null===e?"null":typeof e,"")),i=null}return(t=Qi(a,n,t,r)).elementType=e,t.type=i,t.lanes=s,t}function Wi(e,t,n,i){return(e=Qi(7,e,i,t)).lanes=n,e}function Vi(e,t,n){return(e=Qi(6,e,null,t)).lanes=n,e}function Ui(e){var t=Qi(18,null,null,0);return t.stateNode=e,t}function Xi(e,t,n){return(t=Qi(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var qi=new WeakMap;function Zi(e,t){if("object"===typeof e&&null!==e){var n=qi.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},qi.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Hi=[],Yi=0,Gi=null,Ki=0,Ji=[],er=0,tr=null,nr=1,ir="";function rr(e,t){Hi[Yi++]=Ki,Hi[Yi++]=Gi,Gi=e,Ki=t}function sr(e,t,n){Ji[er++]=nr,Ji[er++]=ir,Ji[er++]=tr,tr=e;var i=nr;e=ir;var r=32-we(i)-1;i&=~(1<<r),n+=1;var s=32-we(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,nr=1<<32-we(t)+r|n<<r|i,ir=s+e}else nr=1<<s|n<<r|i,ir=e}function or(e){null!==e.return&&(rr(e,1),sr(e,1,0))}function ar(e){for(;e===Gi;)Gi=Hi[--Yi],Hi[Yi]=null,Ki=Hi[--Yi],Hi[Yi]=null;for(;e===tr;)tr=Ji[--er],Ji[er]=null,ir=Ji[--er],Ji[er]=null,nr=Ji[--er],Ji[er]=null}function lr(e,t){Ji[er++]=nr,Ji[er++]=ir,Ji[er++]=tr,nr=t.id,ir=t.overflow,tr=e}var cr=null,ur=null,hr=!1,dr=null,pr=!1,fr=Error(o(519));function mr(e){throw br(Zi(Error(o(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),fr}function gr(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[$e]=e,t[ze]=i,n){case"dialog":Yu("cancel",t),Yu("close",t);break;case"iframe":case"object":case"embed":Yu("load",t);break;case"video":case"audio":for(n=0;n<qu.length;n++)Yu(qu[n],t);break;case"source":Yu("error",t);break;case"img":case"image":case"link":Yu("error",t),Yu("load",t);break;case"details":Yu("toggle",t);break;case"input":Yu("invalid",t),Ot(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Yu("invalid",t);break;case"textarea":Yu("invalid",t),xt(t,i.value,i.defaultValue,i.children)}"string"!==typeof(n=i.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===i.suppressHydrationWarning||ch(t.textContent,n)?(null!=i.popover&&(Yu("beforetoggle",t),Yu("toggle",t)),null!=i.onScroll&&Yu("scroll",t),null!=i.onScrollEnd&&Yu("scrollend",t),null!=i.onClick&&(t.onclick=Mt),t=!0):t=!1,t||mr(e,!0)}function vr(e){for(cr=e.return;cr;)switch(cr.tag){case 5:case 31:case 13:return void(pr=!1);case 27:case 3:return void(pr=!0);default:cr=cr.return}}function yr(e){if(e!==cr)return!1;if(!hr)return vr(e),hr=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||Oh(e.type,e.memoizedProps)),t=!t),t&&ur&&mr(e),vr(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));ur=Nh(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));ur=Nh(e)}else 27===n?(n=ur,Ch(e.type)?(e=Rh,Rh=null,ur=e):ur=n):ur=cr?Fh(e.stateNode.nextSibling):null;return!0}function Or(){ur=cr=null,hr=!1}function wr(){var e=dr;return null!==e&&(null===Tc?Tc=e:Tc.push.apply(Tc,e),dr=null),e}function br(e){null===dr?dr=[e]:dr.push(e)}var kr=L(null),xr=null,Dr=null;function Sr(e,t,n){$(kr,t._currentValue),t._currentValue=n}function Cr(e){e._currentValue=kr.current,j(kr)}function Ar(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Er(e,t,n,i){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var s=r.dependencies;if(null!==s){var a=r.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=r;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ar(s.return,n,e),i||(a=null);break e}s=l.next}}else if(18===r.tag){if(null===(a=r.return))throw Error(o(341));a.lanes|=n,null!==(s=a.alternate)&&(s.lanes|=n),Ar(a,n,e),a=null}else a=r.child;if(null!==a)a.return=r;else for(a=r;null!==a;){if(a===e){a=null;break}if(null!==(r=a.sibling)){r.return=a.return,a=r;break}a=a.return}r=a}}function _r(e,t,n,i){e=null;for(var r=t,s=!1;null!==r;){if(!s)if(0!==(524288&r.flags))s=!0;else if(0!==(262144&r.flags))break;if(10===r.tag){var a=r.alternate;if(null===a)throw Error(o(387));if(null!==(a=a.memoizedProps)){var l=r.type;Kn(r.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(r===q.current){if(null===(a=r.alternate))throw Error(o(387));a.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(ud):e=[ud])}r=r.return}null!==e&&Er(t,e,n,i),t.flags|=262144}function Tr(e){for(e=e.firstContext;null!==e;){if(!Kn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Pr(e){xr=e,Dr=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Mr(e){return Rr(xr,e)}function Fr(e,t){return null===xr&&Pr(e),Rr(e,t)}function Rr(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Dr){if(null===e)throw Error(o(308));Dr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Dr=Dr.next=t;return n}var Nr="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ir=i.unstable_scheduleCallback,Br=i.unstable_NormalPriority,Qr={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Lr(){return{controller:new Nr,data:new Map,refCount:0}}function jr(e){e.refCount--,0===e.refCount&&Ir(Br,function(){e.controller.abort()})}var $r=null,zr=0,Wr=0,Vr=null;function Ur(){if(0===--zr&&null!==$r){null!==Vr&&(Vr.status="fulfilled");var e=$r;$r=null,Wr=0,Vr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Xr=R.S;R.S=function(e,t){Fc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===$r){var n=$r=[];zr=0,Wr=zu(),Vr={status:"pending",value:void 0,then:function(e){n.push(e)}}}zr++,t.then(Ur,Ur)}(0,t),null!==Xr&&Xr(e,t)};var qr=L(null);function Zr(){var e=qr.current;return null!==e?e:fc.pooledCache}function Hr(e,t){$(qr,null===t?qr.current:t.pool)}function Yr(){var e=Zr();return null===e?null:{parent:Qr._currentValue,pool:e}}var Gr=Error(o(460)),Kr=Error(o(474)),Jr=Error(o(542)),es={then:function(){}};function ts(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ns(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Mt,Mt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw os(e=t.reason),e;default:if("string"===typeof t.status)t.then(Mt,Mt);else{if(null!==(e=fc)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw os(e=t.reason),e}throw rs=t,Gr}}function is(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw rs=t,Gr;throw t}}var rs=null;function ss(){if(null===rs)throw Error(o(459));var e=rs;return rs=null,e}function os(e){if(e===Gr||e===Jr)throw Error(o(483))}var as=null,ls=0;function cs(e){var t=ls;return ls+=1,null===as&&(as=[]),ns(as,e,t)}function us(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function hs(e,t){if(t.$$typeof===f)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ds(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=ji(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=67108866,n):i:(t.flags|=67108866,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Vi(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===v?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===C&&is(s)===t.type)?(us(t=r(t,n.props),n),t.return=e,t):(us(t=zi(n.type,n.key,n.props,null,e.mode,i),n),t.return=e,t)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Xi(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,s){return null===t||7!==t.tag?((t=Wi(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Vi(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case m:return us(n=zi(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Xi(t,e.mode,n)).return=e,t;case C:return d(e,t=is(t),n)}if(F(t)||T(t))return(t=Wi(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return d(e,cs(t),n);if(t.$$typeof===b)return d(e,Fr(e,t),n);hs(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case m:return n.key===r?c(e,t,n,i):null;case g:return n.key===r?u(e,t,n,i):null;case C:return p(e,t,n=is(n),i)}if(F(n)||T(n))return null!==r?null:h(e,t,n,i,null);if("function"===typeof n.then)return p(e,t,cs(n),i);if(n.$$typeof===b)return p(e,t,Fr(e,n),i);hs(e,n)}return null}function f(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i||"bigint"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case m:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case g:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case C:return f(e,t,n,i=is(i),r)}if(F(i)||T(i))return h(t,e=e.get(n)||null,i,r,null);if("function"===typeof i.then)return f(e,t,n,cs(i),r);if(i.$$typeof===b)return f(e,t,n,Fr(t,i),r);hs(t,i)}return null}function y(l,c,u,h){if("object"===typeof u&&null!==u&&u.type===v&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case m:e:{for(var O=u.key;null!==c;){if(c.key===O){if((O=u.type)===v){if(7===c.tag){n(l,c.sibling),(h=r(c,u.props.children)).return=l,l=h;break e}}else if(c.elementType===O||"object"===typeof O&&null!==O&&O.$$typeof===C&&is(O)===c.type){n(l,c.sibling),us(h=r(c,u.props),u),h.return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===v?((h=Wi(u.props.children,l.mode,h,u.key)).return=l,l=h):(us(h=zi(u.type,u.key,u.props,null,l.mode,h),u),h.return=l,l=h)}return a(l);case g:e:{for(O=u.key;null!==c;){if(c.key===O){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(h=r(c,u.children||[])).return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}(h=Xi(u,l.mode,h)).return=l,l=h}return a(l);case C:return y(l,c,u=is(u),h)}if(F(u))return function(r,o,a,l){for(var c=null,u=null,h=o,m=o=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=p(r,h,a[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(r,h),o=s(v,o,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===a.length)return n(r,h),hr&&rr(r,m),c;if(null===h){for(;m<a.length;m++)null!==(h=d(r,a[m],l))&&(o=s(h,o,m),null===u?c=h:u.sibling=h,u=h);return hr&&rr(r,m),c}for(h=i(h);m<a.length;m++)null!==(g=f(h,r,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=s(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(r,e)}),hr&&rr(r,m),c}(l,c,u,h);if(T(u)){if("function"!==typeof(O=T(u)))throw Error(o(150));return function(r,a,l,c){if(null==l)throw Error(o(151));for(var u=null,h=null,m=a,g=a=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var O=p(r,m,y.value,c);if(null===O){null===m&&(m=v);break}e&&m&&null===O.alternate&&t(r,m),a=s(O,a,g),null===h?u=O:h.sibling=O,h=O,m=v}if(y.done)return n(r,m),hr&&rr(r,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(r,y.value,c))&&(a=s(y,a,g),null===h?u=y:h.sibling=y,h=y);return hr&&rr(r,g),u}for(m=i(m);!y.done;g++,y=l.next())null!==(y=f(m,r,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=s(y,a,g),null===h?u=y:h.sibling=y,h=y);return e&&m.forEach(function(e){return t(r,e)}),hr&&rr(r,g),u}(l,c,u=O.call(u),h)}if("function"===typeof u.then)return y(l,c,cs(u),h);if(u.$$typeof===b)return y(l,c,Fr(l,u),h);hs(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(h=r(c,u)).return=l,l=h):(n(l,c),(h=Vi(u,l.mode,h)).return=l,l=h),a(l)):n(l,c)}return function(e,t,n,i){try{ls=0;var r=y(e,t,n,i);return as=null,r}catch(o){if(o===Gr||o===Jr)throw o;var s=Qi(29,o,null,e.mode);return s.lanes=i,s.return=e,s}}}var ps=ds(!0),fs=ds(!1),ms=!1;function gs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ys(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Os(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&pc)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,t=Ni(e),Ri(e,null,n),t}return Pi(e,i,t,n),Ni(e)}function ws(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Re(e,n)}}function bs(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,callbacks:i.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ks=!1;function xs(){if(ks){if(null!==Vr)throw Vr}}function Ds(e,t,n,i){ks=!1;var r=e.updateQueue;ms=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(o=0,u=c=l=null,a=s;;){var d=-536870913&a.lane,f=d!==a.lane;if(f?(gc&d)===d:(i&d)===d){0!==d&&d===Wr&&(ks=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var m=e,g=a;d=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){h=m.call(v,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(d="function"===typeof(m=g.payload)?m.call(v,h,d):m)||void 0===d)break e;h=p({},h,d);break e;case 2:ms=!0}}null!==(d=a.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=r.callbacks)?r.callbacks=[d]:f.push(d))}else f={lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(f=a).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null===s&&(r.shared.lanes=0),Dc|=o,e.lanes=o,e.memoizedState=h}}function Ss(e,t){if("function"!==typeof e)throw Error(o(191,e));e.call(t)}function Cs(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ss(n[e],t)}var As=L(null),Es=L(0);function _s(e,t){$(Es,e=kc),$(As,t),kc=e|t.baseLanes}function Ts(){$(Es,kc),$(As,As.current)}function Ps(){kc=Es.current,j(As),j(Es)}var Ms=L(null),Fs=null;function Rs(e){var t=e.alternate;$(Ls,1&Ls.current),$(Ms,e),null===Fs&&(null===t||null!==As.current||null!==t.memoizedState)&&(Fs=e)}function Ns(e){$(Ls,Ls.current),$(Ms,e),null===Fs&&(Fs=e)}function Is(e){22===e.tag?($(Ls,Ls.current),$(Ms,e),null===Fs&&(Fs=e)):Bs()}function Bs(){$(Ls,Ls.current),$(Ms,Ms.current)}function Qs(e){j(Ms),Fs===e&&(Fs=null),j(Ls)}var Ls=L(0);function js(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Ph(n)||Mh(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $s=0,zs=null,Ws=null,Vs=null,Us=!1,Xs=!1,qs=!1,Zs=0,Hs=0,Ys=null,Gs=0;function Ks(){throw Error(o(321))}function Js(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Kn(e[n],t[n]))return!1;return!0}function eo(e,t,n,i,r,s){return $s=s,zs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,R.H=null===e||null===e.memoizedState?ga:va,qs=!1,s=n(i,r),qs=!1,Xs&&(s=no(t,n,i,r)),to(e),s}function to(e){R.H=ma;var t=null!==Ws&&null!==Ws.next;if($s=0,Vs=Ws=zs=null,Us=!1,Hs=0,Ys=null,t)throw Error(o(300));null===e||Fa||null!==(e=e.dependencies)&&Tr(e)&&(Fa=!0)}function no(e,t,n,i){zs=e;var r=0;do{if(Xs&&(Ys=null),Hs=0,Xs=!1,25<=r)throw Error(o(301));if(r+=1,Vs=Ws=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}R.H=ya,s=t(n,i)}while(Xs);return s}function io(){var e=R.H,t=e.useState()[0];return t="function"===typeof t.then?co(t):t,e=e.useState()[0],(null!==Ws?Ws.memoizedState:null)!==e&&(zs.flags|=1024),t}function ro(){var e=0!==Zs;return Zs=0,e}function so(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function oo(e){if(Us){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Us=!1}$s=0,Vs=Ws=zs=null,Xs=!1,Hs=Zs=0,Ys=null}function ao(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Vs?zs.memoizedState=Vs=e:Vs=Vs.next=e,Vs}function lo(){if(null===Ws){var e=zs.alternate;e=null!==e?e.memoizedState:null}else e=Ws.next;var t=null===Vs?zs.memoizedState:Vs.next;if(null!==t)Vs=t,Ws=e;else{if(null===e){if(null===zs.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(Ws=e).memoizedState,baseState:Ws.baseState,baseQueue:Ws.baseQueue,queue:Ws.queue,next:null},null===Vs?zs.memoizedState=Vs=e:Vs=Vs.next=e}return Vs}function co(e){var t=Hs;return Hs+=1,null===Ys&&(Ys=[]),e=ns(Ys,e,t),t=zs,null===(null===Vs?t.memoizedState:Vs.next)&&(t=t.alternate,R.H=null===t||null===t.memoizedState?ga:va),e}function uo(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return co(e);if(e.$$typeof===b)return Mr(e)}throw Error(o(438,String(e)))}function ho(e){var t=null,n=zs.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var i=zs.alternate;null!==i&&(null!==(i=i.updateQueue)&&(null!=(i=i.memoCache)&&(t={data:i.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},zs.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=E;return t.index++,n}function po(e,t){return"function"===typeof t?t(e):t}function fo(e){return mo(lo(),Ws,e)}function mo(e,t,n){var i=e.queue;if(null===i)throw Error(o(311));i.lastRenderedReducer=n;var r=e.baseQueue,s=i.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}t.baseQueue=r=s,i.pending=null}if(s=e.baseState,null===r)e.memoizedState=s;else{var l=a=null,c=null,u=t=r.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(gc&d)===d:($s&d)===d){var p=u.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Wr&&(h=!0);else{if(($s&p)===p){u=u.next,p===Wr&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,a=s):c=c.next=d,zs.lanes|=p,Dc|=p}d=u.action,qs&&n(s,d),s=u.hasEagerState?u.eagerState:n(s,d)}else p={lane:d,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=p,a=s):c=c.next=p,zs.lanes|=d,Dc|=d;u=u.next}while(null!==u&&u!==t);if(null===c?a=s:c.next=l,!Kn(s,e.memoizedState)&&(Fa=!0,h&&null!==(n=Vr)))throw n;e.memoizedState=s,e.baseState=a,e.baseQueue=c,i.lastRenderedState=s}return null===r&&(i.lanes=0),[e.memoizedState,i.dispatch]}function go(e){var t=lo(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{s=e(s,a.action),a=a.next}while(a!==r);Kn(s,t.memoizedState)||(Fa=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function vo(e,t,n){var i=zs,r=lo(),s=hr;if(s){if(void 0===n)throw Error(o(407));n=n()}else n=t();var a=!Kn((Ws||r).memoizedState,n);if(a&&(r.memoizedState=n,Fa=!0),r=r.queue,zo(wo.bind(null,i,r,e),[e]),r.getSnapshot!==t||a||null!==Vs&&1&Vs.memoizedState.tag){if(i.flags|=2048,Bo(9,{destroy:void 0},Oo.bind(null,i,r,n,t),null),null===fc)throw Error(o(349));s||0!==(127&$s)||yo(i,t,n)}return n}function yo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=zs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},zs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Oo(e,t,n,i){t.value=n,t.getSnapshot=i,bo(t)&&ko(e)}function wo(e,t,n){return n(function(){bo(t)&&ko(e)})}function bo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Kn(e,n)}catch(i){return!0}}function ko(e){var t=Fi(e,2);null!==t&&Zc(t,e,2)}function xo(e){var t=ao();if("function"===typeof e){var n=e;if(e=n(),qs){Oe(!0);try{n()}finally{Oe(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:po,lastRenderedState:e},t}function Do(e,t,n,i){return e.baseState=n,mo(e,Ws,"function"===typeof i?i:po)}function So(e,t,n,i,r){if(da(e))throw Error(o(485));if(null!==(e=t.action)){var s={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==R.T?n(!0):s.isTransition=!1,i(s),null===(n=t.pending)?(s.next=t.pending=s,Co(t,s)):(s.next=n.next,t.pending=n.next=s)}}function Co(e,t){var n=t.action,i=t.payload,r=e.state;if(t.isTransition){var s=R.T,o={};R.T=o;try{var a=n(r,i),l=R.S;null!==l&&l(o,a),Ao(e,t,a)}catch(c){_o(e,t,c)}finally{null!==s&&null!==o.types&&(s.types=o.types),R.T=s}}else try{Ao(e,t,s=n(r,i))}catch(u){_o(e,t,u)}}function Ao(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Eo(e,t,n)},function(n){return _o(e,t,n)}):Eo(e,t,n)}function Eo(e,t,n){t.status="fulfilled",t.value=n,To(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Co(e,n)))}function _o(e,t,n){var i=e.pending;if(e.pending=null,null!==i){i=i.next;do{t.status="rejected",t.reason=n,To(t),t=t.next}while(t!==i)}e.action=null}function To(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Po(e,t){return t}function Mo(e,t){if(hr){var n=fc.formState;if(null!==n){e:{var i=zs;if(hr){if(ur){t:{for(var r=ur,s=pr;8!==r.nodeType;){if(!s){r=null;break t}if(null===(r=Fh(r.nextSibling))){r=null;break t}}r="F!"===(s=r.data)||"F"===s?r:null}if(r){ur=Fh(r.nextSibling),i="F!"===r.data;break e}}mr(i)}i=!1}i&&(t=n[0])}}return(n=ao()).memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Po,lastRenderedState:t},n.queue=i,n=ca.bind(null,zs,i),i.dispatch=n,i=xo(!1),s=ha.bind(null,zs,!1,i.queue),r={state:t,dispatch:null,action:e,pending:null},(i=ao()).queue=r,n=So.bind(null,zs,r,s,n),r.dispatch=n,i.memoizedState=e,[t,n,!1]}function Fo(e){return Ro(lo(),Ws,e)}function Ro(e,t,n){if(t=mo(e,t,Po)[0],e=fo(po)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var i=co(t)}catch(o){if(o===Gr)throw Jr;throw o}else i=t;var r=(t=lo()).queue,s=r.dispatch;return n!==t.memoizedState&&(zs.flags|=2048,Bo(9,{destroy:void 0},No.bind(null,r,n),null)),[i,s,e]}function No(e,t){e.action=t}function Io(e){var t=lo(),n=Ws;if(null!==n)return Ro(t,n,e);lo(),t=t.memoizedState;var i=(n=lo()).queue.dispatch;return n.memoizedState=e,[t,i,!1]}function Bo(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},null===(t=zs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},zs.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Qo(){return lo().memoizedState}function Lo(e,t,n,i){var r=ao();zs.flags|=e,r.memoizedState=Bo(1|t,{destroy:void 0},n,void 0===i?null:i)}function jo(e,t,n,i){var r=lo();i=void 0===i?null:i;var s=r.memoizedState.inst;null!==Ws&&null!==i&&Js(i,Ws.memoizedState.deps)?r.memoizedState=Bo(t,s,n,i):(zs.flags|=e,r.memoizedState=Bo(1|t,s,n,i))}function $o(e,t){Lo(8390656,8,e,t)}function zo(e,t){jo(2048,8,e,t)}function Wo(e){var t=lo().memoizedState;return function(e){zs.flags|=4;var t=zs.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},zs.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&pc))throw Error(o(440));return t.impl.apply(void 0,arguments)}}function Vo(e,t){return jo(4,2,e,t)}function Uo(e,t){return jo(4,4,e,t)}function Xo(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function qo(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,jo(4,4,Xo.bind(null,t,e),n)}function Zo(){}function Ho(e,t){var n=lo();t=void 0===t?null:t;var i=n.memoizedState;return null!==t&&Js(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Yo(e,t){var n=lo();t=void 0===t?null:t;var i=n.memoizedState;if(null!==t&&Js(t,i[1]))return i[0];if(i=e(),qs){Oe(!0);try{e()}finally{Oe(!1)}}return n.memoizedState=[i,t],i}function Go(e,t,n){return void 0===n||0!==(1073741824&$s)&&0===(261930&gc)?e.memoizedState=t:(e.memoizedState=n,e=qc(),zs.lanes|=e,Dc|=e,n)}function Ko(e,t,n,i){return Kn(n,t)?n:null!==As.current?(e=Go(e,n,i),Kn(e,t)||(Fa=!0),e):0===(42&$s)||0!==(1073741824&$s)&&0===(261930&gc)?(Fa=!0,e.memoizedState=n):(e=qc(),zs.lanes|=e,Dc|=e,t)}function Jo(e,t,n,i,r){var s=N.p;N.p=0!==s&&8>s?s:8;var o=R.T,a={};R.T=a,ha(e,!1,t,n);try{var l=r(),c=R.S;if(null!==c&&c(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=function(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(i.status="rejected",i.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),i}(l,i);ua(e,t,u,Xc())}else ua(e,t,i,Xc())}catch(h){ua(e,t,{then:function(){},status:"rejected",reason:h},Xc())}finally{N.p=s,null!==o&&null!==a.types&&(o.types=a.types),R.T=o}}function ea(){}function ta(e,t,n,i){if(5!==e.tag)throw Error(o(476));var r=na(e).queue;Jo(e,r,t,I,null===n?ea:function(){return ia(e),n(i)})}function na(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:I,baseState:I,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:po,lastRenderedState:I},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:po,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ia(e){var t=na(e);null===t.next&&(t=e.alternate.memoizedState),ua(e,t.next.queue,{},Xc())}function ra(){return Mr(ud)}function sa(){return lo().memoizedState}function oa(){return lo().memoizedState}function aa(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Xc(),i=Os(t,e=ys(n),n);return null!==i&&(Zc(i,t,n),ws(i,t,n)),t={cache:Lr()},void(e.payload=t)}t=t.return}}function la(e,t,n){var i=Xc();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},da(e)?pa(t,n):null!==(n=Mi(e,t,n,i))&&(Zc(n,e,i),fa(n,t,i))}function ca(e,t,n){ua(e,t,n,Xc())}function ua(e,t,n,i){var r={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(da(e))pa(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Kn(a,o))return Pi(e,t,r,0),null===fc&&Ti(),!1}catch(l){}if(null!==(n=Mi(e,t,r,i)))return Zc(n,e,i),fa(n,t,i),!0}return!1}function ha(e,t,n,i){if(i={lane:2,revertLane:zu(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},da(e)){if(t)throw Error(o(479))}else null!==(t=Mi(e,n,i,2))&&Zc(t,e,2)}function da(e){var t=e.alternate;return e===zs||null!==t&&t===zs}function pa(e,t){Xs=Us=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function fa(e,t,n){if(0!==(4194048&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Re(e,n)}}var ma={readContext:Mr,use:uo,useCallback:Ks,useContext:Ks,useEffect:Ks,useImperativeHandle:Ks,useLayoutEffect:Ks,useInsertionEffect:Ks,useMemo:Ks,useReducer:Ks,useRef:Ks,useState:Ks,useDebugValue:Ks,useDeferredValue:Ks,useTransition:Ks,useSyncExternalStore:Ks,useId:Ks,useHostTransitionStatus:Ks,useFormState:Ks,useActionState:Ks,useOptimistic:Ks,useMemoCache:Ks,useCacheRefresh:Ks};ma.useEffectEvent=Ks;var ga={readContext:Mr,use:uo,useCallback:function(e,t){return ao().memoizedState=[e,void 0===t?null:t],e},useContext:Mr,useEffect:$o,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Lo(4194308,4,Xo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Lo(4194308,4,e,t)},useInsertionEffect:function(e,t){Lo(4,2,e,t)},useMemo:function(e,t){var n=ao();t=void 0===t?null:t;var i=e();if(qs){Oe(!0);try{e()}finally{Oe(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=ao();if(void 0!==n){var r=n(t);if(qs){Oe(!0);try{n(t)}finally{Oe(!1)}}}else r=t;return i.memoizedState=i.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},i.queue=e,e=e.dispatch=la.bind(null,zs,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},ao().memoizedState=e},useState:function(e){var t=(e=xo(e)).queue,n=ca.bind(null,zs,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Zo,useDeferredValue:function(e,t){return Go(ao(),e,t)},useTransition:function(){var e=xo(!1);return e=Jo.bind(null,zs,e.queue,!0,!1),ao().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=zs,r=ao();if(hr){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===fc)throw Error(o(349));0!==(127&gc)||yo(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,$o(wo.bind(null,i,s,e),[e]),i.flags|=2048,Bo(9,{destroy:void 0},Oo.bind(null,i,s,n,t),null),n},useId:function(){var e=ao(),t=fc.identifierPrefix;if(hr){var n=ir;t="_"+t+"R_"+(n=(nr&~(1<<32-we(nr)-1)).toString(32)+n),0<(n=Zs++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Gs++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ra,useFormState:Mo,useActionState:Mo,useOptimistic:function(e){var t=ao();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ha.bind(null,zs,!0,n),n.dispatch=t,[e,t]},useMemoCache:ho,useCacheRefresh:function(){return ao().memoizedState=aa.bind(null,zs)},useEffectEvent:function(e){var t=ao(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&pc))throw Error(o(440));return n.impl.apply(void 0,arguments)}}},va={readContext:Mr,use:uo,useCallback:Ho,useContext:Mr,useEffect:zo,useImperativeHandle:qo,useInsertionEffect:Vo,useLayoutEffect:Uo,useMemo:Yo,useReducer:fo,useRef:Qo,useState:function(){return fo(po)},useDebugValue:Zo,useDeferredValue:function(e,t){return Ko(lo(),Ws.memoizedState,e,t)},useTransition:function(){var e=fo(po)[0],t=lo().memoizedState;return["boolean"===typeof e?e:co(e),t]},useSyncExternalStore:vo,useId:sa,useHostTransitionStatus:ra,useFormState:Fo,useActionState:Fo,useOptimistic:function(e,t){return Do(lo(),0,e,t)},useMemoCache:ho,useCacheRefresh:oa};va.useEffectEvent=Wo;var ya={readContext:Mr,use:uo,useCallback:Ho,useContext:Mr,useEffect:zo,useImperativeHandle:qo,useInsertionEffect:Vo,useLayoutEffect:Uo,useMemo:Yo,useReducer:go,useRef:Qo,useState:function(){return go(po)},useDebugValue:Zo,useDeferredValue:function(e,t){var n=lo();return null===Ws?Go(n,e,t):Ko(n,Ws.memoizedState,e,t)},useTransition:function(){var e=go(po)[0],t=lo().memoizedState;return["boolean"===typeof e?e:co(e),t]},useSyncExternalStore:vo,useId:sa,useHostTransitionStatus:ra,useFormState:Io,useActionState:Io,useOptimistic:function(e,t){var n=lo();return null!==Ws?Do(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ho,useCacheRefresh:oa};function Oa(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:p({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}ya.useEffectEvent=Wo;var wa={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Xc(),r=ys(i);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Os(e,r,i))&&(Zc(t,e,i),ws(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Xc(),r=ys(i);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Os(e,r,i))&&(Zc(t,e,i),ws(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Xc(),i=ys(n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Os(e,i,n))&&(Zc(t,e,n),ws(t,e,n))}};function ba(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!Jn(n,i)||!Jn(r,s))}function ka(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&wa.enqueueReplaceState(t,t.state,null)}function xa(e,t){var n=t;if("ref"in t)for(var i in n={},t)"ref"!==i&&(n[i]=t[i]);if(e=e.defaultProps)for(var r in n===t&&(n=p({},n)),e)void 0===n[r]&&(n[r]=e[r]);return n}function Da(e){Ci(e)}function Sa(e){console.error(e)}function Ca(e){Ci(e)}function Aa(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Ea(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function _a(e,t,n){return(n=ys(n)).tag=3,n.payload={element:null},n.callback=function(){Aa(e,t)},n}function Ta(e){return(e=ys(e)).tag=3,e}function Pa(e,t,n,i){var r=n.type.getDerivedStateFromError;if("function"===typeof r){var s=i.value;e.payload=function(){return r(s)},e.callback=function(){Ea(t,n,i)}}var o=n.stateNode;null!==o&&"function"===typeof o.componentDidCatch&&(e.callback=function(){Ea(t,n,i),"function"!==typeof r&&(null===Ic?Ic=new Set([this]):Ic.add(this));var e=i.stack;this.componentDidCatch(i.value,{componentStack:null!==e?e:""})})}var Ma=Error(o(461)),Fa=!1;function Ra(e,t,n,i){t.child=null===e?fs(t,null,n,i):ps(t,e.child,n,i)}function Na(e,t,n,i,r){n=n.render;var s=t.ref;if("ref"in i){var o={};for(var a in i)"ref"!==a&&(o[a]=i[a])}else o=i;return Pr(t),i=eo(e,t,n,o,s,r),a=ro(),null===e||Fa?(hr&&a&&or(t),t.flags|=1,Ra(e,t,i,r),t.child):(so(e,t,r),rl(e,t,r))}function Ia(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Li(s)||void 0!==s.defaultProps||null!==n.compare?((e=zi(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ba(e,t,s,i,r))}if(s=e.child,!sl(e,r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:Jn)(o,i)&&e.ref===t.ref)return rl(e,t,r)}return t.flags|=1,(e=ji(s,i)).ref=t.ref,e.return=t,t.child=e}function Ba(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(Jn(s,i)&&e.ref===t.ref){if(Fa=!1,t.pendingProps=i=s,!sl(e,r))return t.lanes=e.lanes,rl(e,t,r);0!==(131072&e.flags)&&(Fa=!0)}}return Va(e,t,n,i,r)}function Qa(e,t,n,i){var r=i.children,s=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===i.mode){if(0!==(128&t.flags)){if(s=null!==s?s.baseLanes|n:n,null!==e){for(i=t.child=e.child,r=0;null!==i;)r=r|i.lanes|i.childLanes,i=i.sibling;i=r&~s}else i=0,t.child=null;return ja(e,t,s,n,i)}if(0===(536870912&n))return i=t.lanes=536870912,ja(e,t,null!==s?s.baseLanes|n:n,n,i);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Hr(0,null!==s?s.cachePool:null),null!==s?_s(t,s):Ts(),Is(t)}else null!==s?(Hr(0,s.cachePool),_s(t,s),Bs(),t.memoizedState=null):(null!==e&&Hr(0,null),Ts(),Bs());return Ra(e,t,r,n),t.child}function La(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function ja(e,t,n,i,r){var s=Zr();return s=null===s?null:{parent:Qr._currentValue,pool:s},t.memoizedState={baseLanes:n,cachePool:s},null!==e&&Hr(0,null),Ts(),Is(t),null!==e&&_r(e,t,i,!0),t.childLanes=r,null}function $a(e,t){return(t=Ja({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function za(e,t,n){return ps(t,e.child,null,n),(e=$a(t,t.pendingProps)).flags|=2,Qs(t),t.memoizedState=null,e}function Wa(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(o(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Va(e,t,n,i,r){return Pr(t),n=eo(e,t,n,i,void 0,r),i=ro(),null===e||Fa?(hr&&i&&or(t),t.flags|=1,Ra(e,t,n,r),t.child):(so(e,t,r),rl(e,t,r))}function Ua(e,t,n,i,r,s){return Pr(t),t.updateQueue=null,n=no(t,i,n,r),to(e),i=ro(),null===e||Fa?(hr&&i&&or(t),t.flags|=1,Ra(e,t,n,s),t.child):(so(e,t,s),rl(e,t,s))}function Xa(e,t,n,i,r){if(Pr(t),null===t.stateNode){var s=Ii,o=n.contextType;"object"===typeof o&&null!==o&&(s=Mr(o)),s=new n(i,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=wa,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=i,s.state=t.memoizedState,s.refs={},gs(t),o=n.contextType,s.context="object"===typeof o&&null!==o?Mr(o):Ii,s.state=t.memoizedState,"function"===typeof(o=n.getDerivedStateFromProps)&&(Oa(t,n,o,i),s.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(o=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),o!==s.state&&wa.enqueueReplaceState(s,s.state,null),Ds(t,i,s,r),xs(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),i=!0}else if(null===e){s=t.stateNode;var a=t.memoizedProps,l=xa(n,a);s.props=l;var c=s.context,u=n.contextType;o=Ii,"object"===typeof u&&null!==u&&(o=Mr(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof s.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a||c!==o)&&ka(t,s,i,o),ms=!1;var d=t.memoizedState;s.state=d,Ds(t,i,s,r),xs(),c=t.memoizedState,a||d!==c||ms?("function"===typeof h&&(Oa(t,n,h,i),c=t.memoizedState),(l=ms||ba(t,n,l,i,d,c,o))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),s.props=i,s.state=c,s.context=o,i=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),i=!1)}else{s=t.stateNode,vs(e,t),u=xa(n,o=t.memoizedProps),s.props=u,h=t.pendingProps,d=s.context,c=n.contextType,l=Ii,"object"===typeof c&&null!==c&&(l=Mr(c)),(c="function"===typeof(a=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==h||d!==l)&&ka(t,s,i,l),ms=!1,d=t.memoizedState,s.state=d,Ds(t,i,s,r),xs();var p=t.memoizedState;o!==h||d!==p||ms||null!==e&&null!==e.dependencies&&Tr(e.dependencies)?("function"===typeof a&&(Oa(t,n,a,i),p=t.memoizedState),(u=ms||ba(t,n,u,i,d,p,l)||null!==e&&null!==e.dependencies&&Tr(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(i,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),s.props=i,s.state=p,s.context=l,i=u):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return s=i,Wa(e,t),i=0!==(128&t.flags),s||i?(s=t.stateNode,n=i&&"function"!==typeof n.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&i?(t.child=ps(t,e.child,null,r),t.child=ps(t,null,n,r)):Ra(e,t,n,r),t.memoizedState=s.state,e=t.child):e=rl(e,t,r),e}function qa(e,t,n,i){return Or(),t.flags|=256,Ra(e,t,n,i),t.child}var Za={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ha(e){return{baseLanes:e,cachePool:Yr()}}function Ya(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Ac),e}function Ga(e,t,n){var i,r=t.pendingProps,s=!1,a=0!==(128&t.flags);if((i=a)||(i=(null===e||null!==e.memoizedState)&&0!==(2&Ls.current)),i&&(s=!0,t.flags&=-129),i=0!==(32&t.flags),t.flags&=-33,null===e){if(hr){if(s?Rs(t):Bs(),(e=ur)?null!==(e=null!==(e=Th(e,pr))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==tr?{id:nr,overflow:ir}:null,retryLane:536870912,hydrationErrors:null},(n=Ui(e)).return=t,t.child=n,cr=t,ur=null):e=null,null===e)throw mr(t);return Mh(e)?t.lanes=32:t.lanes=536870912,null}var l=r.children;return r=r.fallback,s?(Bs(),l=Ja({mode:"hidden",children:l},s=t.mode),r=Wi(r,s,n,null),l.return=t,r.return=t,l.sibling=r,t.child=l,(r=t.child).memoizedState=Ha(n),r.childLanes=Ya(e,i,n),t.memoizedState=Za,La(null,r)):(Rs(t),Ka(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(a)256&t.flags?(Rs(t),t.flags&=-257,t=el(e,t,n)):null!==t.memoizedState?(Bs(),t.child=e.child,t.flags|=128,t=null):(Bs(),l=r.fallback,s=t.mode,r=Ja({mode:"visible",children:r.children},s),(l=Wi(l,s,n,null)).flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,ps(t,e.child,null,n),(r=t.child).memoizedState=Ha(n),r.childLanes=Ya(e,i,n),t.memoizedState=Za,t=La(null,r));else if(Rs(t),Mh(l)){if(i=l.nextSibling&&l.nextSibling.dataset)var u=i.dgst;i=u,(r=Error(o(419))).stack="",r.digest=i,br({value:r,source:null,stack:null}),t=el(e,t,n)}else if(Fa||_r(e,t,n,!1),i=0!==(n&e.childLanes),Fa||i){if(null!==(i=fc)&&(0!==(r=Ne(i,n))&&r!==c.retryLane))throw c.retryLane=r,Fi(e,r),Zc(i,e,r),Ma;Ph(l)||ou(),t=el(e,t,n)}else Ph(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,ur=Fh(l.nextSibling),cr=t,hr=!0,dr=null,pr=!1,null!==e&&lr(t,e),(t=Ka(t,r.children)).flags|=4096);return t}return s?(Bs(),l=r.fallback,s=t.mode,u=(c=e.child).sibling,(r=ji(c,{mode:"hidden",children:r.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=ji(u,l):(l=Wi(l,s,n,null)).flags|=2,l.return=t,r.return=t,r.sibling=l,t.child=r,La(null,r),r=t.child,null===(l=e.child.memoizedState)?l=Ha(n):(null!==(s=l.cachePool)?(c=Qr._currentValue,s=s.parent!==c?{parent:c,pool:c}:s):s=Yr(),l={baseLanes:l.baseLanes|n,cachePool:s}),r.memoizedState=l,r.childLanes=Ya(e,i,n),t.memoizedState=Za,La(e.child,r)):(Rs(t),e=(n=e.child).sibling,(n=ji(n,{mode:"visible",children:r.children})).return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n)}function Ka(e,t){return(t=Ja({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Ja(e,t){return(e=Qi(22,e,null,t)).lanes=0,e}function el(e,t,n){return ps(t,e.child,null,n),(e=Ka(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ar(e.return,t,n)}function nl(e,t,n,i,r,s){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r,treeForkCount:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r,o.treeForkCount=s)}function il(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;i=i.children;var o=Ls.current,a=0!==(2&o);if(a?(o=1&o|2,t.flags|=128):o&=1,$(Ls,o),Ra(e,t,i,n),i=hr?Ki:0,!a&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,n,t);else if(19===e.tag)tl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===js(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),nl(t,!1,r,n,s,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===js(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}nl(t,!0,n,null,s,i);break;case"together":nl(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function rl(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(_r(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=ji(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=ji(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Tr(e))}function ol(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Fa=!0;else{if(!sl(e,n)&&0===(128&t.flags))return Fa=!1,function(e,t,n){switch(t.tag){case 3:Z(t,t.stateNode.containerInfo),Sr(0,Qr,e.memoizedState.cache),Or();break;case 27:case 5:Y(t);break;case 4:Z(t,t.stateNode.containerInfo);break;case 10:Sr(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Ns(t),null;break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(Rs(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Ga(e,t,n):(Rs(t),null!==(e=rl(e,t,n))?e.sibling:null);Rs(t);break;case 19:var r=0!==(128&e.flags);if((i=0!==(n&t.childLanes))||(_r(e,t,n,!1),i=0!==(n&t.childLanes)),r){if(i)return il(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),$(Ls,Ls.current),i)break;return null;case 22:return t.lanes=0,Qa(e,t,n,t.pendingProps);case 24:Sr(0,Qr,e.memoizedState.cache)}return rl(e,t,n)}(e,t,n);Fa=0!==(131072&e.flags)}else Fa=!1,hr&&0!==(1048576&t.flags)&&sr(t,Ki,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=is(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var r=e.$$typeof;if(r===k){t.tag=11,t=Na(null,t,e,i,n);break e}if(r===S){t.tag=14,t=Ia(null,t,e,i,n);break e}}throw t=M(e)||e,Error(o(306,t,""))}Li(e)?(i=xa(e,i),t.tag=1,t=Xa(null,t,e,i,n)):(t.tag=0,t=Va(null,t,e,i,n))}return t;case 0:return Va(e,t,t.type,t.pendingProps,n);case 1:return Xa(e,t,i=t.type,r=xa(i,t.pendingProps),n);case 3:e:{if(Z(t,t.stateNode.containerInfo),null===e)throw Error(o(387));i=t.pendingProps;var s=t.memoizedState;r=s.element,vs(e,t),Ds(t,i,null,n);var a=t.memoizedState;if(i=a.cache,Sr(0,Qr,i),i!==s.cache&&Er(t,[Qr],n,!0),xs(),i=a.element,s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=qa(e,t,i,n);break e}if(i!==r){br(r=Zi(Error(o(424)),t)),t=qa(e,t,i,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ur=Fh(e.firstChild),cr=t,hr=!0,dr=null,pr=!0,n=fs(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Or(),i===r){t=rl(e,t,n);break e}Ra(e,t,i,n)}t=t.child}return t;case 26:return Wa(e,t),null===e?(n=Uh(t.type,null,t.pendingProps,null))?t.memoizedState=n:hr||(n=t.type,e=t.pendingProps,(i=gh(X.current).createElement(n))[$e]=t,i[ze]=e,dh(i,n,e),et(i),t.stateNode=i):t.memoizedState=Uh(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Y(t),null===e&&hr&&(i=t.stateNode=Bh(t.type,t.pendingProps,X.current),cr=t,pr=!0,r=ur,Ch(t.type)?(Rh=r,ur=Fh(i.firstChild)):ur=r),Ra(e,t,t.pendingProps.children,n),Wa(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&hr&&((r=i=ur)&&(null!==(i=function(e,t,n,i){for(;1===e.nodeType;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(i){if(!e[Ze])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===s)return e}if(null===(e=Fh(e.nextSibling)))break}return null}(i,t.type,t.pendingProps,pr))?(t.stateNode=i,cr=t,ur=Fh(i.firstChild),pr=!1,r=!0):r=!1),r||mr(t)),Y(t),r=t.type,s=t.pendingProps,a=null!==e?e.memoizedProps:null,i=s.children,Oh(r,s)?i=null:null!==a&&Oh(r,a)&&(t.flags|=32),null!==t.memoizedState&&(r=eo(e,t,io,null,null,n),ud._currentValue=r),Wa(e,t),Ra(e,t,i,n),t.child;case 6:return null===e&&hr&&((e=n=ur)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Fh(e.nextSibling)))return null}return e}(n,t.pendingProps,pr))?(t.stateNode=n,cr=t,ur=null,e=!0):e=!1),e||mr(t)),null;case 13:return Ga(e,t,n);case 4:return Z(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ps(t,null,i,n):Ra(e,t,i,n),t.child;case 11:return Na(e,t,t.type,t.pendingProps,n);case 7:return Ra(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ra(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,Sr(0,t.type,i.value),Ra(e,t,i.children,n),t.child;case 9:return r=t.type._context,i=t.pendingProps.children,Pr(t),i=i(r=Mr(r)),t.flags|=1,Ra(e,t,i,n),t.child;case 14:return Ia(e,t,t.type,t.pendingProps,n);case 15:return Ba(e,t,t.type,t.pendingProps,n);case 19:return il(e,t,n);case 31:return function(e,t,n){var i=t.pendingProps,r=0!==(128&t.flags);if(t.flags&=-129,null===e){if(hr){if("hidden"===i.mode)return e=$a(t,i),t.lanes=536870912,La(null,e);if(Ns(t),(e=ur)?null!==(e=null!==(e=Th(e,pr))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==tr?{id:nr,overflow:ir}:null,retryLane:536870912,hydrationErrors:null},(n=Ui(e)).return=t,t.child=n,cr=t,ur=null):e=null,null===e)throw mr(t);return t.lanes=536870912,null}return $a(t,i)}var s=e.memoizedState;if(null!==s){var a=s.dehydrated;if(Ns(t),r)if(256&t.flags)t.flags&=-257,t=za(e,t,n);else{if(null===t.memoizedState)throw Error(o(558));t.child=e.child,t.flags|=128,t=null}else if(Fa||_r(e,t,n,!1),r=0!==(n&e.childLanes),Fa||r){if(null!==(i=fc)&&0!==(a=Ne(i,n))&&a!==s.retryLane)throw s.retryLane=a,Fi(e,a),Zc(i,e,a),Ma;ou(),t=za(e,t,n)}else e=s.treeContext,ur=Fh(a.nextSibling),cr=t,hr=!0,dr=null,pr=!1,null!==e&&lr(t,e),(t=$a(t,i)).flags|=4096;return t}return(e=ji(e.child,{mode:i.mode,children:i.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Qa(e,t,n,t.pendingProps);case 24:return Pr(t),i=Mr(Qr),null===e?(null===(r=Zr())&&(r=fc,s=Lr(),r.pooledCache=s,s.refCount++,null!==s&&(r.pooledCacheLanes|=n),r=s),t.memoizedState={parent:i,cache:r},gs(t),Sr(0,Qr,r)):(0!==(e.lanes&n)&&(vs(e,t),Ds(t,null,null,n),xs()),r=e.memoizedState,s=t.memoizedState,r.parent!==i?(r={parent:i,cache:i},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),Sr(0,Qr,i)):(i=s.cache,Sr(0,Qr,i),i!==r.cache&&Er(t,[Qr],n,!0))),Ra(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function al(e){e.flags|=4}function ll(e,t,n,i,r){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&r)===r)if(e.stateNode.complete)e.flags|=8192;else{if(!iu())throw rs=es,Kr;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!rd(t)){if(!iu())throw rs=es,Kr;e.flags|=8192}}function ul(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Te():536870912,e.lanes|=t,Ec|=t)}function hl(e,t){if(!hr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function dl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=65011712&r.subtreeFlags,i|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function pl(e,t,n){var i=t.pendingProps;switch(ar(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return dl(t),null;case 3:return n=t.stateNode,i=null,null!==e&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Cr(Qr),H(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(yr(t)?al(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,wr())),dl(t),null;case 26:var r=t.type,s=t.memoizedState;return null===e?(al(t),null!==s?(dl(t),cl(t,s)):(dl(t),ll(t,r,0,0,n))):s?s!==e.memoizedState?(al(t),dl(t),cl(t,s)):(dl(t),t.flags&=-16777217):((e=e.memoizedProps)!==i&&al(t),dl(t),ll(t,r,0,0,n)),null;case 27:if(G(t),n=X.current,r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&al(t);else{if(!i){if(null===t.stateNode)throw Error(o(166));return dl(t),null}e=V.current,yr(t)?gr(t):(e=Bh(r,i,n),t.stateNode=e,al(t))}return dl(t),null;case 5:if(G(t),r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&al(t);else{if(!i){if(null===t.stateNode)throw Error(o(166));return dl(t),null}if(s=V.current,yr(t))gr(t);else{var a=gh(X.current);switch(s){case 1:s=a.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:s=a.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":s=a.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":s=a.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":(s=a.createElement("div")).innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s="string"===typeof i.is?a.createElement("select",{is:i.is}):a.createElement("select"),i.multiple?s.multiple=!0:i.size&&(s.size=i.size);break;default:s="string"===typeof i.is?a.createElement(r,{is:i.is}):a.createElement(r)}}s[$e]=t,s[ze]=i;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)s.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=s;e:switch(dh(s,r,i),r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&al(t)}}return dl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==i&&al(t);else{if("string"!==typeof i&&null===t.stateNode)throw Error(o(166));if(e=X.current,yr(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,null!==(r=cr))switch(r.tag){case 27:case 5:i=r.memoizedProps}e[$e]=t,(e=!!(e.nodeValue===n||null!==i&&!0===i.suppressHydrationWarning||ch(e.nodeValue,n)))||mr(t,!0)}else(e=gh(e).createTextNode(i))[$e]=t,t.stateNode=e}return dl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(i=yr(t),null!==n){if(null===e){if(!i)throw Error(o(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(o(557));e[$e]=t}else Or(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;dl(t),e=!1}else n=wr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Qs(t),t):(Qs(t),null);if(0!==(128&t.flags))throw Error(o(558))}return dl(t),null;case 13:if(i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=yr(t),null!==i&&null!==i.dehydrated){if(null===e){if(!r)throw Error(o(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(o(317));r[$e]=t}else Or(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;dl(t),r=!1}else r=wr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(Qs(t),t):(Qs(t),null)}return Qs(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==i,e=null!==e&&null!==e.memoizedState,n&&(r=null,null!==(i=t.child).alternate&&null!==i.alternate.memoizedState&&null!==i.alternate.memoizedState.cachePool&&(r=i.alternate.memoizedState.cachePool.pool),s=null,null!==i.memoizedState&&null!==i.memoizedState.cachePool&&(s=i.memoizedState.cachePool.pool),s!==r&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ul(t,t.updateQueue),dl(t),null);case 4:return H(),null===e&&Ju(t.stateNode.containerInfo),dl(t),null;case 10:return Cr(t.type),dl(t),null;case 19:if(j(Ls),null===(i=t.memoizedState))return dl(t),null;if(r=0!==(128&t.flags),null===(s=i.rendering))if(r)hl(i,!1);else{if(0!==xc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=js(e))){for(t.flags|=128,hl(i,!1),e=s.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)$i(n,e),n=n.sibling;return $(Ls,1&Ls.current|2),hr&&rr(t,i.treeForkCount),t.child}e=e.sibling}null!==i.tail&&le()>Rc&&(t.flags|=128,r=!0,hl(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=js(s))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),hl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!hr)return dl(t),null}else 2*le()-i.renderingStartTime>Rc&&536870912!==n&&(t.flags|=128,r=!0,hl(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=le(),e.sibling=null,n=Ls.current,$(Ls,r?1&n|2:1&n),hr&&rr(t,i.treeForkCount),e):(dl(t),null);case 22:case 23:return Qs(t),Ps(),i=null!==t.memoizedState,null!==e?null!==e.memoizedState!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?0!==(536870912&n)&&0===(128&t.flags)&&(dl(t),6&t.subtreeFlags&&(t.flags|=8192)):dl(t),null!==(n=t.updateQueue)&&ul(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),i=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),null!==e&&j(qr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Cr(Qr),dl(t),null;case 25:case 30:return null}throw Error(o(156,t.tag))}function fl(e,t){switch(ar(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Cr(Qr),H(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return G(t),null;case 31:if(null!==t.memoizedState){if(Qs(t),null===t.alternate)throw Error(o(340));Or()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Qs(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));Or()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return j(Ls),null;case 4:return H(),null;case 10:return Cr(t.type),null;case 22:case 23:return Qs(t),Ps(),null!==e&&j(qr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Cr(Qr),null;default:return null}}function ml(e,t){switch(ar(t),t.tag){case 3:Cr(Qr),H();break;case 26:case 27:case 5:G(t);break;case 4:H();break;case 31:null!==t.memoizedState&&Qs(t);break;case 13:Qs(t);break;case 19:j(Ls);break;case 10:Cr(t.type);break;case 22:case 23:Qs(t),Ps(),null!==e&&j(qr);break;case 24:Cr(Qr)}}function gl(e,t){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var r=i.next;n=r;do{if((n.tag&e)===e){i=void 0;var s=n.create,o=n.inst;i=s(),o.destroy=i}n=n.next}while(n!==r)}}catch(a){xu(t,t.return,a)}}function vl(e,t,n){try{var i=t.updateQueue,r=null!==i?i.lastEffect:null;if(null!==r){var s=r.next;i=s;do{if((i.tag&e)===e){var o=i.inst,a=o.destroy;if(void 0!==a){o.destroy=void 0,r=t;var l=n,c=a;try{c()}catch(u){xu(r,l,u)}}}i=i.next}while(i!==s)}}catch(u){xu(t,t.return,u)}}function yl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Cs(t,n)}catch(i){xu(e,e.return,i)}}}function Ol(e,t,n){n.props=xa(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){xu(e,t,i)}}function wl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;default:i=e.stateNode}"function"===typeof n?e.refCleanup=n(i):n.current=i}}catch(r){xu(e,t,r)}}function bl(e,t){var n=e.ref,i=e.refCleanup;if(null!==n)if("function"===typeof i)try{i()}catch(r){xu(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(s){xu(e,t,s)}else n.current=null}function kl(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(r){xu(e,e.return,r)}}function xl(e,t,n){try{var i=e.stateNode;!function(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,s=null,a=null,l=null,c=null,u=null,h=null;for(f in n){var d=n[f];if(n.hasOwnProperty(f)&&null!=d)switch(f){case"checked":case"value":break;case"defaultValue":c=d;default:i.hasOwnProperty(f)||uh(e,t,f,null,i,d)}}for(var p in i){var f=i[p];if(d=n[p],i.hasOwnProperty(p)&&(null!=f||null!=d))switch(p){case"type":s=f;break;case"name":r=f;break;case"checked":u=f;break;case"defaultChecked":h=f;break;case"value":a=f;break;case"defaultValue":l=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(o(137,t));break;default:f!==d&&uh(e,t,p,f,i,d)}}return void yt(e,a,l,c,u,h,s,r);case"select":for(s in f=a=l=p=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":f=c;default:i.hasOwnProperty(s)||uh(e,t,s,null,i,c)}for(r in i)if(s=i[r],c=n[r],i.hasOwnProperty(r)&&(null!=s||null!=c))switch(r){case"value":p=s;break;case"defaultValue":l=s;break;case"multiple":a=s;default:s!==c&&uh(e,t,r,s,i,c)}return t=l,n=a,i=f,void(null!=p?bt(e,!!n,p,!1):!!i!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(l in f=p=null,n)if(r=n[l],n.hasOwnProperty(l)&&null!=r&&!i.hasOwnProperty(l))switch(l){case"value":case"children":break;default:uh(e,t,l,null,i,r)}for(a in i)if(r=i[a],s=n[a],i.hasOwnProperty(a)&&(null!=r||null!=s))switch(a){case"value":p=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(o(91));break;default:r!==s&&uh(e,t,a,r,i,s)}return void kt(e,p,f);case"option":for(var m in n)if(p=n[m],n.hasOwnProperty(m)&&null!=p&&!i.hasOwnProperty(m))if("selected"===m)e.selected=!1;else uh(e,t,m,null,i,p);for(c in i)if(p=i[c],f=n[c],i.hasOwnProperty(c)&&p!==f&&(null!=p||null!=f))if("selected"===c)e.selected=p&&"function"!==typeof p&&"symbol"!==typeof p;else uh(e,t,c,p,i,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)p=n[g],n.hasOwnProperty(g)&&null!=p&&!i.hasOwnProperty(g)&&uh(e,t,g,null,i,p);for(u in i)if(p=i[u],f=n[u],i.hasOwnProperty(u)&&p!==f&&(null!=p||null!=f))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(o(137,t));break;default:uh(e,t,u,p,i,f)}return;default:if(Et(t)){for(var v in n)p=n[v],n.hasOwnProperty(v)&&void 0!==p&&!i.hasOwnProperty(v)&&hh(e,t,v,void 0,i,p);for(h in i)p=i[h],f=n[h],!i.hasOwnProperty(h)||p===f||void 0===p&&void 0===f||hh(e,t,h,p,i,f);return}}for(var y in n)p=n[y],n.hasOwnProperty(y)&&null!=p&&!i.hasOwnProperty(y)&&uh(e,t,y,null,i,p);for(d in i)p=i[d],f=n[d],!i.hasOwnProperty(d)||p===f||null==p&&null==f||uh(e,t,d,p,i,f)}(i,e.type,n,t),i[ze]=t}catch(r){xu(e,e.return,r)}}function Dl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Ch(e.type)||4===e.tag}function Sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Dl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Ch(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Mt));else if(4!==i&&(27===i&&Ch(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Cl(e,t,n),e=e.sibling;null!==e;)Cl(e,t,n),e=e.sibling}function Al(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&(27===i&&Ch(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Al(e,t,n),e=e.sibling;null!==e;)Al(e,t,n),e=e.sibling}function El(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);dh(t,i,n),t[$e]=e,t[ze]=n}catch(s){xu(e,e.return,s)}}var _l=!1,Tl=!1,Pl=!1,Ml="function"===typeof WeakSet?WeakSet:Set,Fl=null;function Rl(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Zl(e,n),4&i&&gl(5,n);break;case 1:if(Zl(e,n),4&i)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(o){xu(n,n.return,o)}else{var r=xa(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){xu(n,n.return,a)}}64&i&&yl(n),512&i&&wl(n,n.return);break;case 3:if(Zl(e,n),64&i&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Cs(e,t)}catch(o){xu(n,n.return,o)}}break;case 27:null===t&&4&i&&El(n);case 26:case 5:Zl(e,n),null===t&&4&i&&kl(n),512&i&&wl(n,n.return);break;case 12:Zl(e,n);break;case 31:Zl(e,n),4&i&&jl(e,n);break;case 13:Zl(e,n),4&i&&$l(e,n),64&i&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}(e,n=Au.bind(null,n))));break;case 22:if(!(i=null!==n.memoizedState||_l)){t=null!==t&&null!==t.memoizedState||Tl,r=_l;var s=Tl;_l=i,(Tl=t)&&!s?Yl(e,n,0!==(8772&n.subtreeFlags)):Zl(e,n),_l=r,Tl=s}break;case 30:break;default:Zl(e,n)}}function Nl(e){var t=e.alternate;null!==t&&(e.alternate=null,Nl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&He(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Il=null,Bl=!1;function Ql(e,t,n){for(n=n.child;null!==n;)Ll(e,t,n),n=n.sibling}function Ll(e,t,n){if(ye&&"function"===typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(ve,n)}catch(s){}switch(n.tag){case 26:Tl||bl(n,t),Ql(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Tl||bl(n,t);var i=Il,r=Bl;Ch(n.type)&&(Il=n.stateNode,Bl=!1),Ql(e,t,n),Qh(n.stateNode),Il=i,Bl=r;break;case 5:Tl||bl(n,t);case 6:if(i=Il,r=Bl,Il=null,Ql(e,t,n),Bl=r,null!==(Il=i))if(Bl)try{(9===Il.nodeType?Il.body:"HTML"===Il.nodeName?Il.ownerDocument.body:Il).removeChild(n.stateNode)}catch(o){xu(n,t,o)}else try{Il.removeChild(n.stateNode)}catch(o){xu(n,t,o)}break;case 18:null!==Il&&(Bl?(Ah(9===(e=Il).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Vd(e)):Ah(Il,n.stateNode));break;case 4:i=Il,r=Bl,Il=n.stateNode.containerInfo,Bl=!0,Ql(e,t,n),Il=i,Bl=r;break;case 0:case 11:case 14:case 15:vl(2,n,t),Tl||vl(4,n,t),Ql(e,t,n);break;case 1:Tl||(bl(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount&&Ol(n,t,i)),Ql(e,t,n);break;case 21:Ql(e,t,n);break;case 22:Tl=(i=Tl)||null!==n.memoizedState,Ql(e,t,n),Tl=i;break;default:Ql(e,t,n)}}function jl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Vd(e)}catch(n){xu(t,t.return,n)}}}function $l(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Vd(e)}catch(n){xu(t,t.return,n)}}function zl(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Ml),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Ml),t;default:throw Error(o(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var i=Eu.bind(null,e,t);t.then(i,i)}})}function Wl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i],s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:if(Ch(l.type)){Il=l.stateNode,Bl=!1;break e}break;case 5:Il=l.stateNode,Bl=!1;break e;case 3:case 4:Il=l.stateNode.containerInfo,Bl=!0;break e}l=l.return}if(null===Il)throw Error(o(160));Ll(s,a,r),Il=null,Bl=!1,null!==(s=r.alternate)&&(s.return=null),r.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Ul(t,e),t=t.sibling}var Vl=null;function Ul(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Wl(t,e),Xl(e),4&i&&(vl(3,e,e.return),gl(3,e),vl(5,e,e.return));break;case 1:Wl(t,e),Xl(e),512&i&&(Tl||null===n||bl(n,n.return)),64&i&&_l&&(null!==(e=e.updateQueue)&&(null!==(i=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?i:n.concat(i))));break;case 26:var r=Vl;if(Wl(t,e),Xl(e),512&i&&(Tl||null===n||bl(n,n.return)),4&i){var s=null!==n?n.memoizedState:null;if(i=e.memoizedState,null===n)if(null===i)if(null===e.stateNode){e:{i=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(i){case"title":(!(s=r.getElementsByTagName("title")[0])||s[Ze]||s[$e]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=r.createElement(i),r.head.insertBefore(s,r.querySelector("head > title"))),dh(s,i,n),s[$e]=e,et(s),i=s;break e;case"link":var a=nd("link","href",r).get(i+(n.href||""));if(a)for(var l=0;l<a.length;l++)if((s=a[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){a.splice(l,1);break t}dh(s=r.createElement(i),i,n),r.head.appendChild(s);break;case"meta":if(a=nd("meta","content",r).get(i+(n.content||"")))for(l=0;l<a.length;l++)if((s=a[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){a.splice(l,1);break t}dh(s=r.createElement(i),i,n),r.head.appendChild(s);break;default:throw Error(o(468,i))}s[$e]=e,et(s),i=s}e.stateNode=i}else id(r,e.type,e.stateNode);else e.stateNode=Gh(r,i,e.memoizedProps);else s!==i?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===i?id(r,e.type,e.stateNode):Gh(r,i,e.memoizedProps)):null===i&&null!==e.stateNode&&xl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Wl(t,e),Xl(e),512&i&&(Tl||null===n||bl(n,n.return)),null!==n&&4&i&&xl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Wl(t,e),Xl(e),512&i&&(Tl||null===n||bl(n,n.return)),32&e.flags){r=e.stateNode;try{Dt(r,"")}catch(m){xu(e,e.return,m)}}4&i&&null!=e.stateNode&&xl(e,r=e.memoizedProps,null!==n?n.memoizedProps:r),1024&i&&(Pl=!0);break;case 6:if(Wl(t,e),Xl(e),4&i){if(null===e.stateNode)throw Error(o(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(m){xu(e,e.return,m)}}break;case 3:if(td=null,r=Vl,Vl=$h(t.containerInfo),Wl(t,e),Vl=r,Xl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Vd(t.containerInfo)}catch(m){xu(e,e.return,m)}Pl&&(Pl=!1,ql(e));break;case 4:i=Vl,Vl=$h(e.stateNode.containerInfo),Wl(t,e),Xl(e),Vl=i;break;case 12:default:Wl(t,e),Xl(e);break;case 31:case 19:Wl(t,e),Xl(e),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,zl(e,i)));break;case 13:Wl(t,e),Xl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Mc=le()),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,zl(e,i)));break;case 22:r=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=_l,h=Tl;if(_l=u||r,Tl=h||c,Wl(t,e),Tl=h,_l=u,Xl(e),8192&i)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===n||c||_l||Tl||Hl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,r)"function"===typeof(a=s.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var d=c.memoizedProps.style,p=void 0!==d&&null!==d&&d.hasOwnProperty("display")?d.display:null;l.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(m){xu(c,c.return,m)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(m){xu(c,c.return,m)}}}else if(18===t.tag){if(null===n){c=t;try{var f=c.stateNode;r?Eh(f,!0):Eh(c.stateNode,!1)}catch(m){xu(c,c.return,m)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&i&&(null!==(i=e.updateQueue)&&(null!==(n=i.retryQueue)&&(i.retryQueue=null,zl(e,n))));case 30:case 21:}}function Xl(e){var t=e.flags;if(2&t){try{for(var n,i=e.return;null!==i;){if(Dl(i)){n=i;break}i=i.return}if(null==n)throw Error(o(160));switch(n.tag){case 27:var r=n.stateNode;Al(e,Sl(e),r);break;case 5:var s=n.stateNode;32&n.flags&&(Dt(s,""),n.flags&=-33),Al(e,Sl(e),s);break;case 3:case 4:var a=n.stateNode.containerInfo;Cl(e,Sl(e),a);break;default:throw Error(o(161))}}catch(l){xu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ql(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;ql(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Zl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Rl(e,t.alternate,t),t=t.sibling}function Hl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vl(4,t,t.return),Hl(t);break;case 1:bl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&Ol(t,t.return,n),Hl(t);break;case 27:Qh(t.stateNode);case 26:case 5:bl(t,t.return),Hl(t);break;case 22:null===t.memoizedState&&Hl(t);break;default:Hl(t)}e=e.sibling}}function Yl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var i=t.alternate,r=e,s=t,o=s.flags;switch(s.tag){case 0:case 11:case 15:Yl(r,s,n),gl(4,s);break;case 1:if(Yl(r,s,n),"function"===typeof(r=(i=s).stateNode).componentDidMount)try{r.componentDidMount()}catch(c){xu(i,i.return,c)}if(null!==(r=(i=s).updateQueue)){var a=i.stateNode;try{var l=r.shared.hiddenCallbacks;if(null!==l)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)Ss(l[r],a)}catch(c){xu(i,i.return,c)}}n&&64&o&&yl(s),wl(s,s.return);break;case 27:El(s);case 26:case 5:Yl(r,s,n),n&&null===i&&4&o&&kl(s),wl(s,s.return);break;case 12:Yl(r,s,n);break;case 31:Yl(r,s,n),n&&4&o&&jl(r,s);break;case 13:Yl(r,s,n),n&&4&o&&$l(r,s);break;case 22:null===s.memoizedState&&Yl(r,s,n),wl(s,s.return);break;case 30:break;default:Yl(r,s,n)}t=t.sibling}}function Gl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&jr(n))}function Kl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&jr(e))}function Jl(e,t,n,i){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,n,i),t=t.sibling}function ec(e,t,n,i){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Jl(e,t,n,i),2048&r&&gl(9,t);break;case 1:case 31:case 13:default:Jl(e,t,n,i);break;case 3:Jl(e,t,n,i),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&jr(e)));break;case 12:if(2048&r){Jl(e,t,n,i),e=t.stateNode;try{var s=t.memoizedProps,o=s.id,a=s.onPostCommit;"function"===typeof a&&a(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){xu(t,t.return,l)}}else Jl(e,t,n,i);break;case 23:break;case 22:s=t.stateNode,o=t.alternate,null!==t.memoizedState?2&s._visibility?Jl(e,t,n,i):nc(e,t):2&s._visibility?Jl(e,t,n,i):(s._visibility|=2,tc(e,t,n,i,0!==(10256&t.subtreeFlags)||!1)),2048&r&&Gl(o,t);break;case 24:Jl(e,t,n,i),2048&r&&Kl(t.alternate,t)}}function tc(e,t,n,i,r){for(r=r&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var s=e,o=t,a=n,l=i,c=o.flags;switch(o.tag){case 0:case 11:case 15:tc(s,o,a,l,r),gl(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?2&u._visibility?tc(s,o,a,l,r):nc(s,o):(u._visibility|=2,tc(s,o,a,l,r)),r&&2048&c&&Gl(o.alternate,o);break;case 24:tc(s,o,a,l,r),r&&2048&c&&Kl(o.alternate,o);break;default:tc(s,o,a,l,r)}t=t.sibling}}function nc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,i=t,r=i.flags;switch(i.tag){case 22:nc(n,i),2048&r&&Gl(i.alternate,i);break;case 24:nc(n,i),2048&r&&Kl(i.alternate,i);break;default:nc(n,i)}t=t.sibling}}var ic=8192;function rc(e,t,n){if(e.subtreeFlags&ic)for(e=e.child;null!==e;)sc(e,t,n),e=e.sibling}function sc(e,t,n){switch(e.tag){case 26:rc(e,t,n),e.flags&ic&&null!==e.memoizedState&&function(e,t,n,i){if("stylesheet"===n.type&&("string"!==typeof i.media||!1!==matchMedia(i.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var r=Xh(i.href),s=t.querySelector(qh(r));if(s)return null!==(t=s._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=od.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=s,void et(s);s=t.ownerDocument||t,i=Zh(i),(r=Lh.get(r))&&Jh(i,r),et(s=s.createElement("link"));var o=s;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),dh(s,"link",i),n.instance=s}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=od.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Vl,e.memoizedState,e.memoizedProps);break;case 5:default:rc(e,t,n);break;case 3:case 4:var i=Vl;Vl=$h(e.stateNode.containerInfo),rc(e,t,n),Vl=i;break;case 22:null===e.memoizedState&&(null!==(i=e.alternate)&&null!==i.memoizedState?(i=ic,ic=16777216,rc(e,t,n),ic=i):rc(e,t,n))}}function oc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function ac(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Fl=i,uc(i,e)}oc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:ac(e),2048&e.flags&&vl(9,e,e.return);break;case 3:case 12:default:ac(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):ac(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Fl=i,uc(i,e)}oc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:vl(8,t,t.return),cc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function uc(e,t){for(;null!==Fl;){var n=Fl;switch(n.tag){case 0:case 11:case 15:vl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var i=n.memoizedState.cachePool.pool;null!=i&&i.refCount++}break;case 24:jr(n.memoizedState.cache)}if(null!==(i=n.child))i.return=n,Fl=i;else e:for(n=e;null!==Fl;){var r=(i=Fl).sibling,s=i.return;if(Nl(i),i===n){Fl=null;break e}if(null!==r){r.return=s,Fl=r;break e}Fl=s}}}var hc={getCacheForType:function(e){var t=Mr(Qr),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Mr(Qr).controller.signal}},dc="function"===typeof WeakMap?WeakMap:Map,pc=0,fc=null,mc=null,gc=0,vc=0,yc=null,Oc=!1,wc=!1,bc=!1,kc=0,xc=0,Dc=0,Sc=0,Cc=0,Ac=0,Ec=0,_c=null,Tc=null,Pc=!1,Mc=0,Fc=0,Rc=1/0,Nc=null,Ic=null,Bc=0,Qc=null,Lc=null,jc=0,$c=0,zc=null,Wc=null,Vc=0,Uc=null;function Xc(){return 0!==(2&pc)&&0!==gc?gc&-gc:null!==R.T?zu():Qe()}function qc(){if(0===Ac)if(0===(536870912&gc)||hr){var e=De;0===(3932160&(De<<=1))&&(De=262144),Ac=e}else Ac=536870912;return null!==(e=Ms.current)&&(e.flags|=32),Ac}function Zc(e,t,n){(e!==fc||2!==vc&&9!==vc)&&null===e.cancelPendingCommit||(tu(e,0),Kc(e,gc,Ac,!1)),Me(e,n),0!==(2&pc)&&e===fc||(e===fc&&(0===(2&pc)&&(Sc|=n),4===xc&&Kc(e,gc,Ac,!1)),Nu(e))}function Hc(e,t,n){if(0!==(6&pc))throw Error(o(327));for(var i=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Ee(e,t),r=i?function(e,t){var n=pc;pc|=2;var i=ru(),r=su();fc!==e||gc!==t?(Nc=null,Rc=le()+500,tu(e,t)):wc=Ee(e,t);e:for(;;)try{if(0!==vc&&null!==mc){t=mc;var s=yc;t:switch(vc){case 1:vc=0,yc=null,du(e,t,s,1);break;case 2:case 9:if(ts(s)){vc=0,yc=null,hu(t);break}t=function(){2!==vc&&9!==vc||fc!==e||(vc=7),Nu(e)},s.then(t,t);break e;case 3:vc=7;break e;case 4:vc=5;break e;case 7:ts(s)?(vc=0,yc=null,hu(t)):(vc=0,yc=null,du(e,t,s,7));break;case 5:var a=null;switch(mc.tag){case 26:a=mc.memoizedState;case 5:case 27:var l=mc;if(a?rd(a):l.stateNode.complete){vc=0,yc=null;var c=l.sibling;if(null!==c)mc=c;else{var u=l.return;null!==u?(mc=u,pu(u)):mc=null}break t}}vc=0,yc=null,du(e,t,s,5);break;case 6:vc=0,yc=null,du(e,t,s,6);break;case 8:eu(),xc=6;break e;default:throw Error(o(462))}}cu();break}catch(h){nu(e,h)}return Dr=xr=null,R.H=i,R.A=r,pc=n,null!==mc?0:(fc=null,gc=0,Ti(),xc)}(e,t):au(e,t,!0),s=i;;){if(0===r){wc&&!i&&Kc(e,t,0,!1);break}if(n=e.current.alternate,!s||Gc(n)){if(2===r){if(s=t,e.errorRecoveryDisabledLanes&s)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;r=_c;var c=l.current.memoizedState.isDehydrated;if(c&&(tu(l,a).flags|=256),2!==(a=au(l,a,!1))){if(bc&&!c){l.errorRecoveryDisabledLanes|=s,Sc|=s,r=4;break e}s=Tc,Tc=r,null!==s&&(null===Tc?Tc=s:Tc.push.apply(Tc,s))}r=a}if(s=!1,2!==r)continue}}if(1===r){tu(e,0),Kc(e,t,0,!0);break}e:{switch(i=e,s=r){case 0:case 1:throw Error(o(345));case 4:if((4194048&t)!==t)break;case 6:Kc(i,t,Ac,!Oc);break e;case 2:Tc=null;break;case 3:case 5:break;default:throw Error(o(329))}if((62914560&t)===t&&10<(r=Mc+300-le())){if(Kc(i,t,Ac,!Oc),0!==Ae(i,0,!0))break e;jc=t,i.timeoutHandle=bh(Yc.bind(null,i,n,Tc,Nc,Pc,t,Ac,Sc,Ec,Oc,s,"Throttled",-0,0),r)}else Yc(i,n,Tc,Nc,Pc,t,Ac,Sc,Ec,Oc,s,null,-0,0)}break}r=au(e,t,!1),s=!1}Nu(e)}function Yc(e,t,n,i,r,s,o,a,l,c,u,h,d,p){if(e.timeoutHandle=-1,8192&(h=t.subtreeFlags)||16785408===(16785408&h)){sc(t,s,h={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mt});var f=(62914560&s)===s?Mc-le():(4194048&s)===s?Fc-le():0;if(f=function(e,t){return e.stylesheets&&0===e.count&&ld(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&ld(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sd&&(sd=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var r=n[i],s=r.transferSize,o=r.initiatorType,a=r.duration;if(s&&a&&ph(o)){for(o=0,a=r.responseEnd,i+=1;i<n.length;i++){var l=n[i],c=l.startTime;if(c>a)break;var u=l.transferSize,h=l.initiatorType;u&&ph(h)&&(o+=u*((l=l.responseEnd)<a?1:(a-c)/(l-c)))}if(--i,t+=8*(s+o)/(r.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,"number"===typeof e)?e:5}());var r=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&ld(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sd?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(r)}}:null}(h,f),null!==f)return jc=s,e.cancelPendingCommit=f(mu.bind(null,e,t,s,n,i,r,o,a,l,u,h,null,d,p)),void Kc(e,s,o,!c)}mu(e,t,s,n,i,r,o,a,l)}function Gc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Kn(s(),r))return!1}catch(o){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Kc(e,t,n,i){t&=~Cc,t&=~Sc,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var r=t;0<r;){var s=31-we(r),o=1<<s;i[s]=-1,r&=~o}0!==n&&Fe(e,n,t)}function Jc(){return 0!==(6&pc)||(Iu(0,!1),!1)}function eu(){if(null!==mc){if(0===vc)var e=mc.return;else Dr=xr=null,oo(e=mc),as=null,ls=0,e=mc;for(;null!==e;)ml(e.alternate,e),e=e.return;mc=null}}function tu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,kh(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),jc=0,eu(),fc=e,mc=n=ji(e.current,null),gc=t,vc=0,yc=null,Oc=!1,wc=Ee(e,t),bc=!1,Ec=Ac=Cc=Sc=Dc=xc=0,Tc=_c=null,Pc=!1,0!==(8&t)&&(t|=32&t);var i=e.entangledLanes;if(0!==i)for(e=e.entanglements,i&=t;0<i;){var r=31-we(i),s=1<<r;t|=e[r],i&=~s}return kc=t,Ti(),n}function nu(e,t){zs=null,R.H=ma,t===Gr||t===Jr?(t=ss(),vc=3):t===Kr?(t=ss(),vc=4):vc=t===Ma?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,yc=t,null===mc&&(xc=1,Aa(e,Zi(t,e.current)))}function iu(){var e=Ms.current;return null===e||((4194048&gc)===gc?null===Fs:((62914560&gc)===gc||0!==(536870912&gc))&&e===Fs)}function ru(){var e=R.H;return R.H=ma,null===e?ma:e}function su(){var e=R.A;return R.A=hc,e}function ou(){xc=4,Oc||(4194048&gc)!==gc&&null!==Ms.current||(wc=!0),0===(134217727&Dc)&&0===(134217727&Sc)||null===fc||Kc(fc,gc,Ac,!1)}function au(e,t,n){var i=pc;pc|=2;var r=ru(),s=su();fc===e&&gc===t||(Nc=null,tu(e,t)),t=!1;var o=xc;e:for(;;)try{if(0!==vc&&null!==mc){var a=mc,l=yc;switch(vc){case 8:eu(),o=6;break e;case 3:case 2:case 9:case 6:null===Ms.current&&(t=!0);var c=vc;if(vc=0,yc=null,du(e,a,l,c),n&&wc){o=0;break e}break;default:c=vc,vc=0,yc=null,du(e,a,l,c)}}lu(),o=xc;break}catch(u){nu(e,u)}return t&&e.shellSuspendCounter++,Dr=xr=null,pc=i,R.H=r,R.A=s,null===mc&&(fc=null,gc=0,Ti()),o}function lu(){for(;null!==mc;)uu(mc)}function cu(){for(;null!==mc&&!oe();)uu(mc)}function uu(e){var t=ol(e.alternate,e,kc);e.memoizedProps=e.pendingProps,null===t?pu(e):mc=t}function hu(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ua(n,t,t.pendingProps,t.type,void 0,gc);break;case 11:t=Ua(n,t,t.pendingProps,t.type.render,t.ref,gc);break;case 5:oo(t);default:ml(n,t),t=ol(n,t=mc=$i(t,kc),kc)}e.memoizedProps=e.pendingProps,null===t?pu(e):mc=t}function du(e,t,n,i){Dr=xr=null,oo(t),as=null,ls=0;var r=t.return;try{if(function(e,t,n,i,r){if(n.flags|=32768,null!==i&&"object"===typeof i&&"function"===typeof i.then){if(null!==(t=n.alternate)&&_r(t,n,r,!0),null!==(n=Ms.current)){switch(n.tag){case 31:case 13:return null===Fs?ou():null===n.alternate&&0===xc&&(xc=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===es?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([i]):t.add(i),Du(e,i,r)),!1;case 22:return n.flags|=65536,i===es?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([i]):n.add(i),Du(e,i,r)),!1}throw Error(o(435,n.tag))}return Du(e,i,r),ou(),!1}if(hr)return null!==(t=Ms.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,i!==fr&&br(Zi(e=Error(o(422),{cause:i}),n))):(i!==fr&&br(Zi(t=Error(o(423),{cause:i}),n)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,i=Zi(i,n),bs(e,r=_a(e.stateNode,i,r)),4!==xc&&(xc=2)),!1;var s=Error(o(520),{cause:i});if(s=Zi(s,n),null===_c?_c=[s]:_c.push(s),4!==xc&&(xc=2),null===t)return!0;i=Zi(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,bs(n,e=_a(n.stateNode,i,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Ic||!Ic.has(s))))return n.flags|=65536,r&=-r,n.lanes|=r,Pa(r=Ta(r),e,n,i),bs(n,r),!1}n=n.return}while(null!==n);return!1}(e,r,t,n,gc))return xc=1,Aa(e,Zi(n,e.current)),void(mc=null)}catch(s){if(null!==r)throw mc=r,s;return xc=1,Aa(e,Zi(n,e.current)),void(mc=null)}32768&t.flags?(hr||1===i?e=!0:wc||0!==(536870912&gc)?e=!1:(Oc=e=!0,(2===i||9===i||3===i||6===i)&&(null!==(i=Ms.current)&&13===i.tag&&(i.flags|=16384))),fu(t,e)):pu(t)}function pu(e){var t=e;do{if(0!==(32768&t.flags))return void fu(t,Oc);e=t.return;var n=pl(t.alternate,t,kc);if(null!==n)return void(mc=n);if(null!==(t=t.sibling))return void(mc=t);mc=t=e}while(null!==t);0===xc&&(xc=5)}function fu(e,t){do{var n=fl(e.alternate,e);if(null!==n)return n.flags&=32767,void(mc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(mc=e);mc=e=n}while(null!==e);xc=6,mc=null}function mu(e,t,n,i,r,s,a,l,c){e.cancelPendingCommit=null;do{wu()}while(0!==Bc);if(0!==(6&pc))throw Error(o(327));if(null!==t){if(t===e.current)throw Error(o(177));if(s=t.lanes|t.childLanes,function(e,t,n,i,r,s){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-we(n),h=1<<u;a[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var p=d[u];null!==p&&(p.lane&=-536870913)}n&=~h}0!==i&&Fe(e,i,0),0!==s&&0===r&&0!==e.tag&&(e.suspendedLanes|=s&~(o&~t))}(e,n,s|=_i,a,l,c),e===fc&&(mc=fc=null,gc=0),Lc=t,Qc=e,jc=n,$c=s,zc=r,Wc=i,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,re(de,function(){return bu(),null})):(e.callbackNode=null,e.callbackPriority=0),i=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||i){i=R.T,R.T=null,r=N.p,N.p=2,a=pc,pc|=4;try{!function(e,t){if(e=e.containerInfo,fh=Od,ri(e=ii(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch(g){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==r&&3!==d.nodeType||(l=a+r),d!==s||0!==i&&3!==d.nodeType||(c=a+i),3===d.nodeType&&(a+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++u===r&&(l=a),p===s&&++h===i&&(c=a),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(mh={focusedElem:e,selectionRange:n},Od=!1,Fl=t;null!==Fl;)if(e=(t=Fl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Fl=e;else for(;null!==Fl;){switch(s=(t=Fl).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(r=e[n]).ref.impl=r.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,n=t,r=s.memoizedProps,s=s.memoizedState,i=n.stateNode;try{var m=xa(n.type,r);e=i.getSnapshotBeforeUpdate(m,s),i.__reactInternalSnapshotBeforeUpdate=e}catch(v){xu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))_h(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":_h(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,Fl=e;break}Fl=t.return}}(e,t)}finally{pc=a,N.p=r,R.T=i}}Bc=1,gu(),vu(),yu()}}function gu(){if(1===Bc){Bc=0;var e=Qc,t=Lc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=R.T,R.T=null;var i=N.p;N.p=2;var r=pc;pc|=4;try{Ul(t,e);var s=mh,o=ii(e.containerInfo),a=s.focusedElem,l=s.selectionRange;if(o!==a&&a&&a.ownerDocument&&ni(a.ownerDocument.documentElement,a)){if(null!==l&&ri(a)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(u,a.value.length);else{var h=a.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var p=d.getSelection(),f=a.textContent.length,m=Math.min(l.start,f),g=void 0===l.end?m:Math.min(l.end,f);!p.extend&&m>g&&(o=g,g=m,m=o);var v=ti(a,m),y=ti(a,g);if(v&&y&&(1!==p.rangeCount||p.anchorNode!==v.node||p.anchorOffset!==v.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var O=h.createRange();O.setStart(v.node,v.offset),p.removeAllRanges(),m>g?(p.addRange(O),p.extend(y.node,y.offset)):(O.setEnd(y.node,y.offset),p.addRange(O))}}}}for(h=[],p=a;p=p.parentNode;)1===p.nodeType&&h.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof a.focus&&a.focus(),a=0;a<h.length;a++){var w=h[a];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}Od=!!fh,mh=fh=null}finally{pc=r,N.p=i,R.T=n}}e.current=t,Bc=2}}function vu(){if(2===Bc){Bc=0;var e=Qc,t=Lc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=R.T,R.T=null;var i=N.p;N.p=2;var r=pc;pc|=4;try{Rl(e,t.alternate,t)}finally{pc=r,N.p=i,R.T=n}}Bc=3}}function yu(){if(4===Bc||3===Bc){Bc=0,ae();var e=Qc,t=Lc,n=jc,i=Wc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Bc=5:(Bc=0,Lc=Qc=null,Ou(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(Ic=null),Be(n),t=t.stateNode,ye&&"function"===typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(ve,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==i){t=R.T,r=N.p,N.p=2,R.T=null;try{for(var s=e.onRecoverableError,o=0;o<i.length;o++){var a=i[o];s(a.value,{componentStack:a.stack})}}finally{R.T=t,N.p=r}}0!==(3&jc)&&wu(),Nu(e),r=e.pendingLanes,0!==(261930&n)&&0!==(42&r)?e===Uc?Vc++:(Vc=0,Uc=e):Vc=0,Iu(0,!1)}}function Ou(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,jr(t)))}function wu(){return gu(),vu(),yu(),bu()}function bu(){if(5!==Bc)return!1;var e=Qc,t=$c;$c=0;var n=Be(jc),i=R.T,r=N.p;try{N.p=32>n?32:n,R.T=null,n=zc,zc=null;var s=Qc,a=jc;if(Bc=0,Lc=Qc=null,jc=0,0!==(6&pc))throw Error(o(331));var l=pc;if(pc|=4,lc(s.current),ec(s,s.current,a,n),pc=l,Iu(0,!1),ye&&"function"===typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(ve,s)}catch(c){}return!0}finally{N.p=r,R.T=i,Ou(e,t)}}function ku(e,t,n){t=Zi(n,t),null!==(e=Os(e,t=_a(e.stateNode,t,2),2))&&(Me(e,2),Nu(e))}function xu(e,t,n){if(3===e.tag)ku(e,e,n);else for(;null!==t;){if(3===t.tag){ku(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Ic||!Ic.has(i))){e=Zi(n,e),null!==(i=Os(t,n=Ta(2),2))&&(Pa(n,i,t,e),Me(i,2),Nu(i));break}}t=t.return}}function Du(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new dc;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(bc=!0,r.add(n),e=Su.bind(null,e,t,n),t.then(e,e))}function Su(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,fc===e&&(gc&n)===n&&(4===xc||3===xc&&(62914560&gc)===gc&&300>le()-Mc?0===(2&pc)&&tu(e,0):Cc|=n,Ec===gc&&(Ec=0)),Nu(e)}function Cu(e,t){0===t&&(t=Te()),null!==(e=Fi(e,t))&&(Me(e,t),Nu(e))}function Au(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cu(e,n)}function Eu(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==i&&i.delete(t),Cu(e,n)}var _u=null,Tu=null,Pu=!1,Mu=!1,Fu=!1,Ru=0;function Nu(e){e!==Tu&&null===e.next&&(null===Tu?_u=Tu=e:Tu=Tu.next=e),Mu=!0,Pu||(Pu=!0,Dh(function(){0!==(6&pc)?re(ue,Bu):Qu()}))}function Iu(e,t){if(!Fu&&Mu){Fu=!0;do{for(var n=!1,i=_u;null!==i;){if(!t)if(0!==e){var r=i.pendingLanes;if(0===r)var s=0;else{var o=i.suspendedLanes,a=i.pingedLanes;s=(1<<31-we(42|e)+1)-1,s=201326741&(s&=r&~(o&~a))?201326741&s|1:s?2|s:0}0!==s&&(n=!0,$u(i,s))}else s=gc,0===(3&(s=Ae(i,i===fc?s:0,null!==i.cancelPendingCommit||-1!==i.timeoutHandle)))||Ee(i,s)||(n=!0,$u(i,s));i=i.next}}while(n);Fu=!1}}function Bu(){Qu()}function Qu(){Mu=Pu=!1;var e=0;0!==Ru&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==wh&&(wh=e,!0);return wh=null,!1}()&&(e=Ru);for(var t=le(),n=null,i=_u;null!==i;){var r=i.next,s=Lu(i,t);0===s?(i.next=null,null===n?_u=r:n.next=r,null===r&&(Tu=n)):(n=i,(0!==e||0!==(3&s))&&(Mu=!0)),i=r}0!==Bc&&5!==Bc||Iu(e,!1),0!==Ru&&(Ru=0)}function Lu(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var o=31-we(s),a=1<<o,l=r[o];-1===l?0!==(a&n)&&0===(a&i)||(r[o]=_e(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}if(n=gc,n=Ae(e,e===(t=fc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),i=e.callbackNode,0===n||e===t&&(2===vc||9===vc)||null!==e.cancelPendingCommit)return null!==i&&null!==i&&se(i),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ee(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==i&&se(i),Be(n)){case 2:case 8:n=he;break;case 32:default:n=de;break;case 268435456:n=fe}return i=ju.bind(null,e),n=re(n,i),e.callbackPriority=t,e.callbackNode=n,t}return null!==i&&null!==i&&se(i),e.callbackPriority=2,e.callbackNode=null,2}function ju(e,t){if(0!==Bc&&5!==Bc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(wu()&&e.callbackNode!==n)return null;var i=gc;return 0===(i=Ae(e,e===fc?i:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Hc(e,i,t),Lu(e,le()),null!=e.callbackNode&&e.callbackNode===n?ju.bind(null,e):null)}function $u(e,t){if(wu())return null;Hc(e,t,!0)}function zu(){if(0===Ru){var e=Wr;0===e&&(e=xe,0===(261888&(xe<<=1))&&(xe=256)),Ru=e}return Ru}function Wu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Pt(""+e)}function Vu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Uu=0;Uu<Di.length;Uu++){var Xu=Di[Uu];Si(Xu.toLowerCase(),"on"+(Xu[0].toUpperCase()+Xu.slice(1)))}Si(gi,"onAnimationEnd"),Si(vi,"onAnimationIteration"),Si(yi,"onAnimationStart"),Si("dblclick","onDoubleClick"),Si("focusin","onFocus"),Si("focusout","onBlur"),Si(Oi,"onTransitionRun"),Si(wi,"onTransitionStart"),Si(bi,"onTransitionCancel"),Si(ki,"onTransitionEnd"),rt("onMouseEnter",["mouseout","mouseover"]),rt("onMouseLeave",["mouseout","mouseover"]),rt("onPointerEnter",["pointerout","pointerover"]),rt("onPointerLeave",["pointerout","pointerover"]),it("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),it("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),it("onBeforeInput",["compositionend","keypress","textInput","paste"]),it("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(qu));function Hu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;s=a,r.currentTarget=c;try{s(r)}catch(u){Ci(u)}r.currentTarget=null,s=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;s=a,r.currentTarget=c;try{s(r)}catch(u){Ci(u)}r.currentTarget=null,s=l}}}}function Yu(e,t){var n=t[Ve];void 0===n&&(n=t[Ve]=new Set);var i=e+"__bubble";n.has(i)||(eh(t,e,2,!1),n.add(i))}function Gu(e,t,n){var i=0;t&&(i|=4),eh(n,e,i,t)}var Ku="_reactListening"+Math.random().toString(36).slice(2);function Ju(e){if(!e[Ku]){e[Ku]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Zu.has(t)||Gu(t,!1,e),Gu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ku]||(t[Ku]=!0,Gu("selectionchange",!1,t))}}function eh(e,t,n,i){switch(Cd(t)){case 2:var r=wd;break;case 8:r=bd;break;default:r=kd}n=r.bind(null,t,n,e),r=void 0,!zt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function th(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r)break;if(4===o)for(o=i.return;null!==o;){var c=o.tag;if((3===c||4===c)&&o.stateNode.containerInfo===r)return;o=o.return}for(;null!==a;){if(null===(o=Ye(a)))return;if(5===(c=o.tag)||6===c||26===c||27===c){i=s=o;continue e}a=a.parentNode}}i=i.return}Lt(function(){var i=s,r=Rt(n),o=[];e:{var a=xi.get(e);if(void 0!==a){var c=nn,u=e;switch(e){case"keypress":if(0===Zt(n))break e;case"keydown":case"keyup":c=yn;break;case"focusin":u="focus",c=cn;break;case"focusout":u="blur",c=cn;break;case"beforeblur":case"afterblur":c=cn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=an;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=wn;break;case gi:case vi:case yi:c=un;break;case ki:c=bn;break;case"scroll":case"scrollend":c=sn;break;case"wheel":c=kn;break;case"copy":case"cut":case"paste":c=hn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=On;break;case"toggle":case"beforetoggle":c=xn}var h=0!==(4&t),d=!h&&("scroll"===e||"scrollend"===e),p=h?null!==a?a+"Capture":null:a;h=[];for(var f,m=i;null!==m;){var g=m;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===p||null!=(g=jt(m,p))&&h.push(nh(m,g,f)),d)break;m=m.return}0<h.length&&(a=new c(a,u,null,n,r),o.push({event:a,listeners:h}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Ft||!(u=n.relatedTarget||n.fromElement)||!Ye(u)&&!u[We])&&(c||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=i,null!==(u=(u=n.relatedTarget||n.toElement)?Ye(u):null)&&(d=l(u),h=u.tag,u!==d||5!==h&&27!==h&&6!==h)&&(u=null)):(c=null,u=i),c!==u)){if(h=an,g="onMouseLeave",p="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(h=On,g="onPointerLeave",p="onPointerEnter",m="pointer"),d=null==c?a:Ke(c),f=null==u?a:Ke(u),(a=new h(g,m+"leave",c,n,r)).target=d,a.relatedTarget=f,g=null,Ye(r)===i&&((h=new h(p,m+"enter",u,n,r)).target=f,h.relatedTarget=d,g=h),d=g,c&&u)e:{for(h=rh,m=u,f=0,g=p=c;g;g=h(g))f++;g=0;for(var v=m;v;v=h(v))g++;for(;0<f-g;)p=h(p),f--;for(;0<g-f;)m=h(m),g--;for(;f--;){if(p===m||null!==m&&p===m.alternate){h=p;break e}p=h(p),m=h(m)}h=null}else h=null;null!==c&&sh(o,a,c,h,!1),null!==u&&null!==d&&sh(o,d,u,h,!0)}if("select"===(c=(a=i?Ke(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var y=$n;else if(Nn(a))if(zn)y=Gn;else{y=Hn;var O=Zn}else!(c=a.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?i&&Et(i.elementType)&&(y=$n):y=Yn;switch(y&&(y=y(e,i))?In(o,y,n,r):(O&&O(e,a,i),"focusout"===e&&i&&"number"===a.type&&null!=i.memoizedProps.value&&wt(a,"number",a.value)),O=i?Ke(i):window,e){case"focusin":(Nn(O)||"true"===O.contentEditable)&&(oi=O,ai=i,li=null);break;case"focusout":li=ai=oi=null;break;case"mousedown":ci=!0;break;case"contextmenu":case"mouseup":case"dragend":ci=!1,ui(o,n,r);break;case"selectionchange":if(si)break;case"keydown":case"keyup":ui(o,n,r)}var w;if(Sn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Fn?Pn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(En&&"ko"!==n.locale&&(Fn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Fn&&(w=qt()):(Ut="value"in(Vt=r)?Vt.value:Vt.textContent,Fn=!0)),0<(O=ih(i,b)).length&&(b=new dn(b,e,null,n,r),o.push({event:b,listeners:O}),w?b.data=w:null!==(w=Mn(n))&&(b.data=w))),(w=An?function(e,t){switch(e){case"compositionend":return Mn(t);case"keypress":return 32!==t.which?null:(Tn=!0,_n);case"textInput":return(e=t.data)===_n&&Tn?null:e;default:return null}}(e,n):function(e,t){if(Fn)return"compositionend"===e||!Sn&&Pn(e,t)?(e=qt(),Xt=Ut=Vt=null,Fn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return En&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(b=ih(i,"onBeforeInput")).length&&(O=new dn("onBeforeInput","beforeinput",null,n,r),o.push({event:O,listeners:b}),O.data=w)),function(e,t,n,i,r){if("submit"===t&&n&&n.stateNode===r){var s=Wu((r[ze]||null).action),o=i.submitter;o&&null!==(t=(t=o[ze]||null)?Wu(t.formAction):o.getAttribute("formAction"))&&(s=t,o=null);var a=new nn("action","action",null,i,r);e.push({event:a,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(0!==Ru){var e=o?Vu(r,o):new FormData(r);ta(n,{pending:!0,data:e,method:r.method,action:s},null,e)}}else"function"===typeof s&&(a.preventDefault(),e=o?Vu(r,o):new FormData(r),ta(n,{pending:!0,data:e,method:r.method,action:s},s,e))},currentTarget:r}]})}}(o,e,i,n,r)}Hu(o,t)})}function nh(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ih(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===s||(null!=(r=jt(e,n))&&i.unshift(nh(e,r,s)),null!=(r=jt(e,t))&&i.push(nh(e,r,s))),3===e.tag)return i;e=e.return}return[]}function rh(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function sh(e,t,n,i,r){for(var s=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===i)break;5!==a&&26!==a&&27!==a||null===c||(l=c,r?null!=(c=jt(n,s))&&o.unshift(nh(n,c,l)):r||null!=(c=jt(n,s))&&o.push(nh(n,c,l))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var oh=/\r\n?/g,ah=/\u0000|\uFFFD/g;function lh(e){return("string"===typeof e?e:""+e).replace(oh,"\n").replace(ah,"")}function ch(e,t){return t=lh(t),lh(e)===t}function uh(e,t,n,i,r,s){switch(n){case"children":"string"===typeof i?"body"===t||"textarea"===t&&""===i||Dt(e,i):("number"===typeof i||"bigint"===typeof i)&&"body"!==t&&Dt(e,""+i);break;case"className":ct(e,"class",i);break;case"tabIndex":ct(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,n,i);break;case"style":At(e,i,s);break;case"data":if("object"!==t){ct(e,"data",i);break}case"src":case"href":if(""===i&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==i||"function"===typeof i||"symbol"===typeof i||"boolean"===typeof i){e.removeAttribute(n);break}i=Pt(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if("function"===typeof i){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===n?("input"!==t&&uh(e,t,"name",r.name,r,null),uh(e,t,"formEncType",r.formEncType,r,null),uh(e,t,"formMethod",r.formMethod,r,null),uh(e,t,"formTarget",r.formTarget,r,null)):(uh(e,t,"encType",r.encType,r,null),uh(e,t,"method",r.method,r,null),uh(e,t,"target",r.target,r,null))),null==i||"symbol"===typeof i||"boolean"===typeof i){e.removeAttribute(n);break}i=Pt(""+i),e.setAttribute(n,i);break;case"onClick":null!=i&&(e.onclick=Mt);break;case"onScroll":null!=i&&Yu("scroll",e);break;case"onScrollEnd":null!=i&&Yu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!==typeof i||!("__html"in i))throw Error(o(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(o(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&"function"!==typeof i&&"symbol"!==typeof i;break;case"muted":e.muted=i&&"function"!==typeof i&&"symbol"!==typeof i;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==i||"function"===typeof i||"boolean"===typeof i||"symbol"===typeof i){e.removeAttribute("xlink:href");break}n=Pt(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===i?e.setAttribute(n,""):!1!==i&&null!=i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":null==i||"function"===typeof i||"symbol"===typeof i||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":Yu("beforetoggle",e),Yu("toggle",e),lt(e,"popover",i);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":lt(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&lt(e,n=_t.get(n)||n,i)}}function hh(e,t,n,i,r,s){switch(n){case"style":At(e,i,s);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!==typeof i||!("__html"in i))throw Error(o(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(o(60));e.innerHTML=n}}break;case"children":"string"===typeof i?Dt(e,i):("number"===typeof i||"bigint"===typeof i)&&Dt(e,""+i);break;case"onScroll":null!=i&&Yu("scroll",e);break;case"onScrollEnd":null!=i&&Yu("scrollend",e);break;case"onClick":null!=i&&(e.onclick=Mt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),"function"===typeof(s=null!=(s=e[ze]||null)?s[n]:null)&&e.removeEventListener(t,s,r),"function"!==typeof i)?n in e?e[n]=i:!0===i?e.setAttribute(n,""):lt(e,n,i):("function"!==typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,r)))}}function dh(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yu("error",e),Yu("load",e);var i,r=!1,s=!1;for(i in n)if(n.hasOwnProperty(i)){var a=n[i];if(null!=a)switch(i){case"src":r=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:uh(e,t,i,a,n,null)}}return s&&uh(e,t,"srcSet",n.srcSet,n,null),void(r&&uh(e,t,"src",n.src,n,null));case"input":Yu("invalid",e);var l=i=a=s=null,c=null,u=null;for(r in n)if(n.hasOwnProperty(r)){var h=n[r];if(null!=h)switch(r){case"name":s=h;break;case"type":a=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":i=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(o(137,t));break;default:uh(e,t,r,h,n,null)}}return void Ot(e,i,l,c,u,a,s,!1);case"select":for(s in Yu("invalid",e),r=a=i=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":i=l;break;case"defaultValue":a=l;break;case"multiple":r=l;default:uh(e,t,s,l,n,null)}return t=i,n=a,e.multiple=!!r,void(null!=t?bt(e,!!r,t,!1):null!=n&&bt(e,!!r,n,!0));case"textarea":for(a in Yu("invalid",e),i=s=r=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":r=l;break;case"defaultValue":s=l;break;case"children":i=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(o(91));break;default:uh(e,t,a,l,n,null)}return void xt(e,r,s,i);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(r=n[c]))if("selected"===c)e.selected=r&&"function"!==typeof r&&"symbol"!==typeof r;else uh(e,t,c,r,n,null);return;case"dialog":Yu("beforetoggle",e),Yu("toggle",e),Yu("cancel",e),Yu("close",e);break;case"iframe":case"object":Yu("load",e);break;case"video":case"audio":for(r=0;r<qu.length;r++)Yu(qu[r],e);break;case"image":Yu("error",e),Yu("load",e);break;case"details":Yu("toggle",e);break;case"embed":case"source":case"link":Yu("error",e),Yu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(r=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:uh(e,t,u,r,n,null)}return;default:if(Et(t)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(r=n[h])&&hh(e,t,h,r,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(r=n[l])&&uh(e,t,l,r,n,null))}function ph(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var fh=null,mh=null;function gh(e){return 9===e.nodeType?e:e.ownerDocument}function vh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yh(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function Oh(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var wh=null;var bh="function"===typeof setTimeout?setTimeout:void 0,kh="function"===typeof clearTimeout?clearTimeout:void 0,xh="function"===typeof Promise?Promise:void 0,Dh="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof xh?function(e){return xh.resolve(null).then(e).catch(Sh)}:bh;function Sh(e){setTimeout(function(){throw e})}function Ch(e){return"head"===e}function Ah(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)||"/&"===n){if(0===i)return e.removeChild(r),void Vd(t);i--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)i++;else if("html"===n)Qh(e.ownerDocument.documentElement);else if("head"===n){Qh(n=e.ownerDocument.head);for(var s=n.firstChild;s;){var o=s.nextSibling,a=s.nodeName;s[Ze]||"SCRIPT"===a||"STYLE"===a||"LINK"===a&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=o}}else"body"===n&&Qh(e.ownerDocument.body);n=r}while(n);Vd(t)}function Eh(e,t){var n=e;e=0;do{var i=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=i}while(n)}function _h(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":_h(n),He(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Th(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Fh(e.nextSibling)))return null}return e}function Ph(e){return"$?"===e.data||"$~"===e.data}function Mh(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Fh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Rh=null;function Nh(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Fh(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Ih(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Bh(e,t,n){switch(t=gh(n),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}function Qh(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);He(e)}var Lh=new Map,jh=new Set;function $h(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var zh=N.d;N.d={f:function(){var e=zh.f(),t=Jc();return e||t},r:function(e){var t=Ge(e);null!==t&&5===t.tag&&"form"===t.type?ia(t):zh.r(e)},D:function(e){zh.D(e),Vh("dns-prefetch",e,null)},C:function(e,t){zh.C(e,t),Vh("preconnect",e,t)},L:function(e,t,n){zh.L(e,t,n);var i=Wh;if(i&&e&&t){var r='link[rel="preload"][as="'+vt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(r+='[imagesrcset="'+vt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(r+='[imagesizes="'+vt(n.imageSizes)+'"]')):r+='[href="'+vt(e)+'"]';var s=r;switch(t){case"style":s=Xh(e);break;case"script":s=Hh(e)}Lh.has(s)||(e=p({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Lh.set(s,e),null!==i.querySelector(r)||"style"===t&&i.querySelector(qh(s))||"script"===t&&i.querySelector(Yh(s))||(dh(t=i.createElement("link"),"link",e),et(t),i.head.appendChild(t)))}},m:function(e,t){zh.m(e,t);var n=Wh;if(n&&e){var i=t&&"string"===typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+vt(i)+'"][href="'+vt(e)+'"]',s=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Hh(e)}if(!Lh.has(s)&&(e=p({rel:"modulepreload",href:e},t),Lh.set(s,e),null===n.querySelector(r))){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Yh(s)))return}dh(i=n.createElement("link"),"link",e),et(i),n.head.appendChild(i)}}},X:function(e,t){zh.X(e,t);var n=Wh;if(n&&e){var i=Je(n).hoistableScripts,r=Hh(e),s=i.get(r);s||((s=n.querySelector(Yh(r)))||(e=p({src:e,async:!0},t),(t=Lh.get(r))&&ed(e,t),et(s=n.createElement("script")),dh(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}},S:function(e,t,n){zh.S(e,t,n);var i=Wh;if(i&&e){var r=Je(i).hoistableStyles,s=Xh(e);t=t||"default";var o=r.get(s);if(!o){var a={loading:0,preload:null};if(o=i.querySelector(qh(s)))a.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Lh.get(s))&&Jh(e,n);var l=o=i.createElement("link");et(l),dh(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,Kh(o,t,i)}o={type:"stylesheet",instance:o,count:1,state:a},r.set(s,o)}}},M:function(e,t){zh.M(e,t);var n=Wh;if(n&&e){var i=Je(n).hoistableScripts,r=Hh(e),s=i.get(r);s||((s=n.querySelector(Yh(r)))||(e=p({src:e,async:!0,type:"module"},t),(t=Lh.get(r))&&ed(e,t),et(s=n.createElement("script")),dh(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}};var Wh="undefined"===typeof document?null:document;function Vh(e,t,n){var i=Wh;if(i&&"string"===typeof t&&t){var r=vt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"===typeof n&&(r+='[crossorigin="'+n+'"]'),jh.has(r)||(jh.add(r),e={rel:e,crossOrigin:n,href:t},null===i.querySelector(r)&&(dh(t=i.createElement("link"),"link",e),et(t),i.head.appendChild(t)))}}function Uh(e,t,n,i){var r,s,a,l,c=(c=X.current)?$h(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Xh(n.href),(i=(n=Je(c).hoistableStyles).get(t))||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Xh(n.href);var u=Je(c).hoistableStyles,h=u.get(e);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=c.querySelector(qh(e)))&&!u._p&&(h.instance=u,h.state.loading=5),Lh.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Lh.set(e,n),u||(r=c,s=e,a=n,l=h.state,r.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=r.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),dh(s,"link",a),et(s),r.head.appendChild(s))))),t&&null===i)throw Error(o(528,""));return h}if(t&&null!==i)throw Error(o(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Hh(n),(i=(n=Je(c).hoistableScripts).get(t))||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Xh(e){return'href="'+vt(e)+'"'}function qh(e){return'link[rel="stylesheet"]['+e+"]"}function Zh(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function Hh(e){return'[src="'+vt(e)+'"]'}function Yh(e){return"script[async]"+e}function Gh(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+vt(n.href)+'"]');if(i)return t.instance=i,et(i),i;var r=p({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(i=(e.ownerDocument||e).createElement("style")),dh(i,"style",r),Kh(i,n.precedence,e),t.instance=i;case"stylesheet":r=Xh(n.href);var s=e.querySelector(qh(r));if(s)return t.state.loading|=4,t.instance=s,et(s),s;i=Zh(n),(r=Lh.get(r))&&Jh(i,r),et(s=(e.ownerDocument||e).createElement("link"));var a=s;return a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),dh(s,"link",i),t.state.loading|=4,Kh(s,n.precedence,e),t.instance=s;case"script":return s=Hh(n.src),(r=e.querySelector(Yh(s)))?(t.instance=r,et(r),r):(i=n,(r=Lh.get(s))&&ed(i=p({},n),r),et(r=(e=e.ownerDocument||e).createElement("script")),dh(r,"link",i),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(i=t.instance,t.state.loading|=4,Kh(i,n.precedence,e));return t.instance}function Kh(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,s=r,o=0;o<i.length;o++){var a=i[o];if(a.dataset.precedence===t)s=a;else if(s!==r)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Jh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function ed(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var td=null;function nd(e,t,n){if(null===td){var i=new Map,r=td=new Map;r.set(n,i)}else(i=(r=td).get(n))||(i=new Map,r.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var s=n[r];if(!(s[Ze]||s[$e]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var o=s.getAttribute(t)||"";o=e+o;var a=i.get(o);a?a.push(s):i.set(o,[s])}}return i}function id(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function rd(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var sd=0;function od(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)ld(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var ad=null;function ld(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,ad=new Map,t.forEach(cd,e),ad=null,od.call(e))}function cd(e,t){if(!(4&t.state.loading)){var n=ad.get(e);if(n)var i=n.get(null);else{n=new Map,ad.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<r.length;s++){var o=r[s];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),i=o)}i&&n.set(null,i)}o=(r=t.instance).getAttribute("data-precedence"),(s=n.get(o)||i)===i&&n.set(null,r),n.set(o,r),this.count++,i=od.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),s?s.parentNode.insertBefore(r,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var ud={$$typeof:b,Provider:null,Consumer:null,_currentValue:I,_currentValue2:I,_threadCount:0};function hd(e,t,n,i,r,s,o,a,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pe(0),this.hiddenUpdates=Pe(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=s,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function dd(e,t,n,i,r,s,o,a,l,c,u,h){return e=new hd(e,t,n,o,l,c,u,h,a),t=1,!0===s&&(t|=24),s=Qi(3,null,null,t),e.current=s,s.stateNode=e,(t=Lr()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:i,isDehydrated:n,cache:t},gs(s),e}function pd(e){return e?e=Ii:Ii}function fd(e,t,n,i,r,s){r=pd(r),null===i.context?i.context=r:i.pendingContext=r,(i=ys(t)).payload={element:n},null!==(s=void 0===s?null:s)&&(i.callback=s),null!==(n=Os(e,i,t))&&(Zc(n,0,t),ws(n,e,t))}function md(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function gd(e,t){md(e,t),(e=e.alternate)&&md(e,t)}function vd(e){if(13===e.tag||31===e.tag){var t=Fi(e,67108864);null!==t&&Zc(t,0,67108864),gd(e,67108864)}}function yd(e){if(13===e.tag||31===e.tag){var t=Xc(),n=Fi(e,t=Ie(t));null!==n&&Zc(n,0,t),gd(e,t)}}var Od=!0;function wd(e,t,n,i){var r=R.T;R.T=null;var s=N.p;try{N.p=2,kd(e,t,n,i)}finally{N.p=s,R.T=r}}function bd(e,t,n,i){var r=R.T;R.T=null;var s=N.p;try{N.p=8,kd(e,t,n,i)}finally{N.p=s,R.T=r}}function kd(e,t,n,i){if(Od){var r=xd(i);if(null===r)th(e,t,i,Dd,n),Nd(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Ed=Id(Ed,e,t,n,i,r),!0;case"dragenter":return _d=Id(_d,e,t,n,i,r),!0;case"mouseover":return Td=Id(Td,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Pd.set(s,Id(Pd.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Md.set(s,Id(Md.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Nd(e,i),4&t&&-1<Rd.indexOf(e)){for(;null!==r;){var s=Ge(r);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var o=Ce(s.pendingLanes);if(0!==o){var a=s;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-we(o);a.entanglements[1]|=l,o&=~l}Nu(s),0===(6&pc)&&(Rc=le()+500,Iu(0,!1))}}break;case 31:case 13:null!==(a=Fi(s,2))&&Zc(a,0,2),Jc(),gd(s,2)}if(null===(s=xd(i))&&th(e,t,i,Dd,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else th(e,t,i,null,n)}}function xd(e){return Sd(e=Rt(e))}var Dd=null;function Sd(e){if(Dd=null,null!==(e=Ye(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(31===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Dd=e,null}function Cd(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case he:return 8;case de:case pe:return 32;case fe:return 268435456;default:return 32}default:return 32}}var Ad=!1,Ed=null,_d=null,Td=null,Pd=new Map,Md=new Map,Fd=[],Rd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Nd(e,t){switch(e){case"focusin":case"focusout":Ed=null;break;case"dragenter":case"dragleave":_d=null;break;case"mouseover":case"mouseout":Td=null;break;case"pointerover":case"pointerout":Pd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Md.delete(t.pointerId)}}function Id(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=Ge(t))&&vd(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Bd(e){var t=Ye(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void Le(e.priority,function(){yd(n)})}else if(31===t){if(null!==(t=u(n)))return e.blockedOn=t,void Le(e.priority,function(){yd(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Qd(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=xd(e.nativeEvent);if(null!==n)return null!==(t=Ge(n))&&vd(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);Ft=i,n.target.dispatchEvent(i),Ft=null,t.shift()}return!0}function Ld(e,t,n){Qd(e)&&n.delete(t)}function jd(){Ad=!1,null!==Ed&&Qd(Ed)&&(Ed=null),null!==_d&&Qd(_d)&&(_d=null),null!==Td&&Qd(Td)&&(Td=null),Pd.forEach(Ld),Md.forEach(Ld)}function $d(e,t){e.blockedOn===t&&(e.blockedOn=null,Ad||(Ad=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,jd)))}var zd=null;function Wd(e){zd!==e&&(zd=e,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){zd===e&&(zd=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],r=e[t+2];if("function"!==typeof i){if(null===Sd(i||n))continue;break}var s=Ge(n);null!==s&&(e.splice(t,3),t-=3,ta(s,{pending:!0,data:r,method:n.method,action:i},i,r))}}))}function Vd(e){function t(t){return $d(t,e)}null!==Ed&&$d(Ed,e),null!==_d&&$d(_d,e),null!==Td&&$d(Td,e),Pd.forEach(t),Md.forEach(t);for(var n=0;n<Fd.length;n++){var i=Fd[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Fd.length&&null===(n=Fd[0]).blockedOn;)Bd(n),null===n.blockedOn&&Fd.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(i=0;i<n.length;i+=3){var r=n[i],s=n[i+1],o=r[ze]||null;if("function"===typeof s)o||Wd(n);else if(o){var a=null;if(s&&s.hasAttribute("formAction")){if(r=s,o=s[ze]||null)a=o.formAction;else if(null!==Sd(r))continue}else a=o.action;"function"===typeof a?n[i+1]=a:(n.splice(i,3),i-=3),Wd(n)}}}function Ud(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return r=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==r&&(r(),r=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var i=!1,r=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==r&&(r(),r=null)}}}function Xd(e){this._internalRoot=e}function qd(e){this._internalRoot=e}qd.prototype.render=Xd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));fd(t.current,Xc(),e,t,null,null)},qd.prototype.unmount=Xd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fd(e.current,2,null,e,null,null),Jc(),t[We]=null}},qd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Qe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Fd.length&&0!==t&&t<Fd[n].priority;n++);Fd.splice(n,0,e),0===n&&Bd(e)}};var Zd=r.version;if("19.2.4"!==Zd)throw Error(o(527,Zd,"19.2.4"));N.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return h(r),e;if(s===i)return h(r),t;s=s.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,c=r.child;c;){if(c===n){a=!0,n=r,i=s;break}if(c===i){a=!0,i=r,n=s;break}c=c.sibling}if(!a){for(c=s.child;c;){if(c===n){a=!0,n=s,i=r;break}if(c===i){a=!0,i=s,n=r;break}c=c.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Hd={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.2.4"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Yd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yd.isDisabled&&Yd.supportsFiber)try{ve=Yd.inject(Hd),ye=Yd}catch(Kd){}}t.createRoot=function(e,t){if(!a(e))throw Error(o(299));var n=!1,i="",r=Da,s=Sa,l=Ca;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(r=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=dd(e,1,!1,null,0,n,i,null,r,s,l,Ud),e[We]=t.current,Ju(e),new Xd(t)},t.hydrateRoot=function(e,t,n){if(!a(e))throw Error(o(299));var i=!1,r="",s=Da,l=Sa,c=Ca,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=dd(e,1,!0,t,0,i,r,u,s,l,c,Ud)).context=pd(null),n=t.current,(r=ys(i=Ie(i=Xc()))).callback=null,Os(n,r,i),n=i,t.current.lanes=n,Me(t,n),Nu(t),e[We]=t.current,Ju(e),new qd(t)},t.version="19.2.4"},43(e,t,n){e.exports=n(288)},106(e){var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,i=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,s=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,a=/^[;\s]*/,l=/^\s+|\s+$/g,c="";function u(e){return e?e.replace(l,c):c}e.exports=function(e,l){if("string"!==typeof e)throw new TypeError("First argument must be a string");if(!e)return[];l=l||{};var h=1,d=1;function p(e){var t=e.match(n);t&&(h+=t.length);var i=e.lastIndexOf("\n");d=~i?e.length-i:d+e.length}function f(){var e={line:h,column:d};return function(t){return t.position=new m(e),y(),t}}function m(e){this.start=e,this.end={line:h,column:d},this.source=l.source}function g(t){var n=new Error(l.source+":"+h+":"+d+": "+t);if(n.reason=t,n.filename=l.source,n.line=h,n.column=d,n.source=e,!l.silent)throw n}function v(t){var n=t.exec(e);if(n){var i=n[0];return p(i),e=e.slice(i.length),n}}function y(){v(i)}function O(e){var t;for(e=e||[];t=w();)!1!==t&&e.push(t);return e}function w(){var t=f();if("/"==e.charAt(0)&&"*"==e.charAt(1)){for(var n=2;c!=e.charAt(n)&&("*"!=e.charAt(n)||"/"!=e.charAt(n+1));)++n;if(n+=2,c===e.charAt(n-1))return g("End of comment missing");var i=e.slice(2,n-2);return d+=2,p(i),e=e.slice(n),d+=2,t({type:"comment",comment:i})}}function b(){var e=f(),n=v(r);if(n){if(w(),!v(s))return g("property missing ':'");var i=v(o),l=e({type:"declaration",property:u(n[0].replace(t,c)),value:i?u(i[0].replace(t,c)):c});return v(a),l}}return m.prototype.content=e,y(),function(){var e,t=[];for(O(t);e=b();)!1!==e&&(t.push(e),O(t));return t}()}},146(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.camelCase=void 0;var n=/^--[a-zA-Z0-9_-]+$/,i=/-([a-z])/g,r=/^[^-]+$/,s=/^-(webkit|moz|ms|o|khtml)-/,o=/^-(ms)-/,a=function(e,t){return t.toUpperCase()},l=function(e,t){return"".concat(t,"-")};t.camelCase=function(e,t){return void 0===t&&(t={}),function(e){return!e||r.test(e)||n.test(e)}(e)?e:(e=e.toLowerCase(),(e=t.reactCompat?e.replace(o,l):e.replace(s,l)).replace(i,a))}},222(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){let n=null;if(!e||"string"!==typeof e)return n;const i=(0,r.default)(e),s="function"===typeof t;return i.forEach(e=>{if("declaration"!==e.type)return;const{property:i,value:r}=e;s?t(i,r,e):r&&(n=n||{},n[i]=r)}),n};const r=i(n(106))},240(e){var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,i=Object.defineProperty,r=Object.getOwnPropertyDescriptor,s=function(e){return"function"===typeof Array.isArray?Array.isArray(e):"[object Array]"===n.call(e)},o=function(e){if(!e||"[object Object]"!==n.call(e))return!1;var i,r=t.call(e,"constructor"),s=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!s)return!1;for(i in e);return"undefined"===typeof i||t.call(e,i)},a=function(e,t){i&&"__proto__"===t.name?i(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},l=function(e,n){if("__proto__"===n){if(!t.call(e,n))return;if(r)return r(e,n).value}return e[n]};e.exports=function e(){var t,n,i,r,c,u,h=arguments[0],d=1,p=arguments.length,f=!1;for("boolean"===typeof h&&(f=h,h=arguments[1]||{},d=2),(null==h||"object"!==typeof h&&"function"!==typeof h)&&(h={});d<p;++d)if(null!=(t=arguments[d]))for(n in t)i=l(h,n),h!==(r=l(t,n))&&(f&&r&&(o(r)||(c=s(r)))?(c?(c=!1,u=i&&s(i)?i:[]):u=i&&o(i)?i:{},a(h,{name:n,newValue:e(f,u,r)})):"undefined"!==typeof r&&a(h,{name:n,newValue:r}));return h}},288(e,t){var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}function O(){}function w(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},O.prototype=y.prototype;var b=w.prototype=new O;b.constructor=w,g(b,y.prototype),b.isPureReactComponent=!0;var k=Array.isArray;function x(){}var D={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function C(e,t,i){var r=i.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:i}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function _(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(e,t,r,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case i:u=!0;break;case d:return T((u=e._init)(e._payload),t,r,s,o)}}if(u)return o=o(e),u=""===s?"."+_(e,0):s,k(o)?(r="",null!=u&&(r=u.replace(E,"$&/")+"/"),T(o,t,r,"",function(e){return e})):null!=o&&(A(o)&&(l=o,c=r+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+u,o=C(l.type,c,l.props)),t.push(o)),1;u=0;var h,p=""===s?".":s+":";if(k(e))for(var m=0;m<e.length;m++)u+=T(s=e[m],t,r,a=p+_(s,m),o);else if("function"===typeof(m=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=f&&h[f]||h["@@iterator"])?h:null))for(e=m.call(e),m=0;!(s=e.next()).done;)u+=T(s=s.value,t,r,a=p+_(s,m++),o);else if("object"===a){if("function"===typeof e.then)return T(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(x,x):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,r,s,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function P(e,t,n){if(null==e)return e;var i=[],r=0;return T(e,i,"","",function(e){return t.call(n,e,r++)}),i}function M(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var F="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},R={map:P,forEach:function(e,t,n){P(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=p,t.Children=R,t.Component=y,t.Fragment=r,t.Profiler=o,t.PureComponent=w,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return D.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var i=g({},e.props),r=e.key;if(null!=t)for(s in void 0!==t.key&&(r=""+t.key),t)!S.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(i[s]=t[s]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var o=Array(s),a=0;a<s;a++)o[a]=arguments[a+2];i.children=o}return C(e.type,r,i)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,n){var i,r={},s=null;if(null!=t)for(i in void 0!==t.key&&(s=""+t.key),t)S.call(t,i)&&"key"!==i&&"__self"!==i&&"__source"!==i&&(r[i]=t[i]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];r.children=a}if(e&&e.defaultProps)for(i in o=e.defaultProps)void 0===r[i]&&(r[i]=o[i]);return C(e,s,r)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.T,n={};D.T=n;try{var i=e(),r=D.S;null!==r&&r(n,i),"object"===typeof i&&null!==i&&"function"===typeof i.then&&i.then(x,F)}catch(s){F(s)}finally{null!==t&&null!==n.types&&(t.types=n.types),D.T=t}},t.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},t.use=function(e){return D.H.use(e)},t.useActionState=function(e,t,n){return D.H.useActionState(e,t,n)},t.useCallback=function(e,t){return D.H.useCallback(e,t)},t.useContext=function(e){return D.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return D.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return D.H.useEffect(e,t)},t.useEffectEvent=function(e){return D.H.useEffectEvent(e)},t.useId=function(){return D.H.useId()},t.useImperativeHandle=function(e,t,n){return D.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.H.useMemo(e,t)},t.useOptimistic=function(e,t){return D.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return D.H.useReducer(e,t,n)},t.useRef=function(e){return D.H.useRef(e)},t.useState=function(e){return D.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.H.useTransition()},t.version="19.2.4"},294(e,t,n){var i=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(n(222)),r=n(146);function s(e,t){var n={};return e&&"string"===typeof e?((0,i.default)(e,function(e,i){e&&i&&(n[(0,r.camelCase)(e,t)]=i)}),n):n}s.default=s,e.exports=s},295(e,t,n){n.d(t,{R:()=>r,USER_COLORS:()=>i});const i=["#4ebf56","#41bbd1","#FDBB5D","#5D8DFD","#FD5D5D","#BF82E8","#E882A6"];function r(){let e=sessionStorage.getItem("flashy_user_id");if(!e){const t=new Uint8Array(12);crypto.getRandomValues(t),e="user-".concat(Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")),sessionStorage.setItem("flashy_user_id",e)}let t=sessionStorage.getItem("flashy_user_color");if(!t){const e=Math.floor(Math.random()*i.length);t=i[e],sessionStorage.setItem("flashy_user_color",t)}const n=sessionStorage.getItem("flashy_username")||"User ".concat(Math.abs(function(e){let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}(e))%100);return{userId:e,color:t,name:n}}},391(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579(e,t,n){e.exports=n(799)},672(e,t,n){var i=n(43);function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var o={d:{f:s,r:function(){throw Error(r(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(r(299));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=o.p;try{if(l.T=null,o.p=2,e)return e()}finally{l.T=t,o.p=n,o.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,i=c(n,t.crossOrigin),r="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?o.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:s}):"script"===n&&o.d.X(e,{crossOrigin:i,integrity:r,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,i=c(n,t.crossOrigin);o.d.L(e,n,{crossOrigin:i,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.4"},799(e,t){var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function r(e,t,i){var r=null;if(void 0!==i&&(r=""+i),void 0!==t.key&&(r=""+t.key),"key"in t)for(var s in i={},t)"key"!==s&&(i[s]=t[s]);else i=t;return t=i.ref,{$$typeof:n,type:e,key:r,ref:void 0!==t?t:null,props:i}}t.Fragment=i,t.jsx=r,t.jsxs=r},853(e,t,n){e.exports=n(896)},896(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,O="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function k(e){if(g=!1,b(e),!m)if(null!==i(c))m=!0,D||(D=!0,x());else{var t=i(u);null!==t&&M(k,t.startTime-e)}}var x,D=!1,S=-1,C=5,A=-1;function E(){return!!v||!(t.unstable_now()-A<C)}function _(){if(v=!1,D){var e=t.unstable_now();A=e;var n=!0;try{e:{m=!1,g&&(g=!1,O(S),S=-1),f=!0;var s=p;try{t:{for(b(e),d=i(c);null!==d&&!(d.expirationTime>e&&E());){var o=d.callback;if("function"===typeof o){d.callback=null,p=d.priorityLevel;var a=o(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){d.callback=a,b(e),n=!0;break t}d===i(c)&&r(c),b(e)}else r(c);d=i(c)}if(null!==d)n=!0;else{var l=i(u);null!==l&&M(k,l.startTime-e),n=!1}}break e}finally{d=null,p=s,f=!1}n=void 0}}finally{n?x():D=!1}}}if("function"===typeof w)x=function(){w(_)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,P=T.port2;T.port1.onmessage=_,x=function(){P.postMessage(null)}}else x=function(){y(_,0)};function M(e,n){S=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(g?(O(S),S=-1):g=!0,M(k,s-o))):(e.sortIndex=a,n(c,e),m||f||(m=!0,D||(D=!0,x()))),e},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},950(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&i;("object"==typeof a||"function"==typeof a)&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach(e=>o[e]=()=>i[e]);return o.default=()=>i,n.d(s,o),s}})(),n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,i)=>(n.f[i](e,t),t),[])),n.u=e=>"static/js/"+e+".ea3db366.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="flashy-temp:";n.l=(i,r,s,o)=>{if(e[i])e[i].push(r);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=i),e[i]=[r];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var r=e[i];if(delete e[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach(e=>e(n)),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/flashy/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var s=new Promise((n,i)=>r=e[t]=[n,i]);i.push(r[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),o=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,r[1](a)}},"chunk-"+t,t)}};var t=(t,i)=>{var r,s,[o,a,l]=i,c=0;if(o.some(t=>0!==e[t])){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)l(n)}for(t&&t(i);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},i=self.webpackChunkflashy_temp=self.webpackChunkflashy_temp||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var i={};n.r(i),n.d(i,{boolean:()=>xW,booleanish:()=>DW,commaOrSpaceSeparated:()=>_W,commaSeparated:()=>EW,number:()=>CW,overloadedBoolean:()=>SW,spaceSeparated:()=>AW});var r={};n.r(r),n.d(r,{attentionMarkers:()=>iX,contentInitial:()=>GU,disable:()=>rX,document:()=>YU,flow:()=>JU,flowInitial:()=>KU,insideSpan:()=>nX,string:()=>eX,text:()=>tX});var s=n(43),o=n.t(s,2),a=n(391);function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=c(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==c(t)?t:t+""}function h(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){h(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const f=["sri"],m=["page"],g=["page","matches"],v=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition","unstable_defaultShouldRevalidate"],y=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],O=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition","unstable_defaultShouldRevalidate"];var w="popstate";function b(){return E(function(e,t){let{pathname:n,search:i,hash:r}=e.location;return S("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:C(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function k(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function x(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function D(e,t){return{usr:e.state,key:e.key,idx:t}}function S(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return p(p({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?A(t):t),{},{state:n,key:t&&t.key||i||Math.random().toString(36).substring(2,10)})}function C(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function A(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function E(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a="POP",l=null,c=u();function u(){return(o.state||{idx:null}).idx}function h(){a="POP";let e=u(),t=null==e?null:e-c;c=e,l&&l({action:a,location:f.location,delta:t})}function d(e){return _(e)}null==c&&(c=0,o.replaceState(p(p({},o.state),{},{idx:c}),""));let f={get action(){return a},get location(){return e(r,o)},listen(e){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(w,h),l=e,()=>{r.removeEventListener(w,h),l=null}},createHref:e=>t(r,e),createURL:d,encodeLocation(e){let t=d(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){a="PUSH";let i=S(f.location,e,t);n&&n(i,e),c=u()+1;let h=D(i,c),d=f.createHref(i);try{o.pushState(h,"",d)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;r.location.assign(d)}s&&l&&l({action:a,location:f.location,delta:1})},replace:function(e,t){a="REPLACE";let i=S(f.location,e,t);n&&n(i,e),c=u();let r=D(i,c),h=f.createHref(i);o.replaceState(r,"",h),s&&l&&l({action:a,location:f.location,delta:0})},go:e=>o.go(e)};return f}function _(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),k(n,"No window.location.(origin|href) available to create URL");let i="string"===typeof e?e:C(e);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=n+i),new URL(i,n)}new WeakMap;function T(e,t){return P(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function P(e,t,n,i){let r=X(("string"===typeof t?A(t):t).pathname||"/",n);if(null==r)return null;let s=M(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let o=null;for(let a=0;null==o&&a<s.length;++a){let e=U(r);o=z(s[a],e,i)}return o}function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(e,s){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,a=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(i)&&o)return;k(l.relativePath.startsWith(i),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(i,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(i.length)}let c=J([i,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(k(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),M(e.children,t,u,c,o)),(null!=e.path||e.index)&&t.push({path:c,score:$(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let i of F(e.path))s(e,t,!0,i);else s(e,t)}),t}function F(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let o=F(i.join("/")),a=[];return a.push(...o.map(e=>""===e?s:[s,e].join("/"))),r&&a.push(...o),a.map(t=>e.startsWith("/")&&""===t?"/":t)}var R=/^:[\w-]+$/,N=3,I=2,B=1,Q=10,L=-2,j=e=>"*"===e;function $(e,t){let n=e.split("/"),i=n.length;return n.some(j)&&(i+=L),t&&(i+=I),n.filter(e=>!j(e)).reduce((e,t)=>e+(R.test(t)?N:""===t?B:Q),i)}function z(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:i}=e,r={},s="/",o=[];for(let a=0;a<i.length;++a){let e=i[a],l=a===i.length-1,c="/"===s?t:t.slice(s.length)||"/",u=W({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&n&&!i[i.length-1].route.index&&(u=W({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),o.push({params:r,pathname:J([s,u.pathname]),pathnameBase:ee(J([s,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(s=J([s,u.pathnameBase]))}return o}function W(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=V(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1),l=i.reduce((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=a[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=a[n];return e[i]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:s,pathnameBase:o,pattern:e}}function V(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];x("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function U(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return x(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function X(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}var q=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Z(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}function H(e,t,n,i){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(i),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function Y(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function G(e){let t=Y(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function K(e,t,n){let i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?i=A(e):(i=p({},e),k(!i.pathname||!i.pathname.includes("?"),H("?","pathname","search",i)),k(!i.pathname||!i.pathname.includes("#"),H("#","pathname","hash",i)),k(!i.search||!i.search.includes("#"),H("#","search","hash",i)));let s,o=""===e||""===i.pathname,a=o?"/":i.pathname;if(null==a)s=n;else{let e=t.length-1;if(!r&&a.startsWith("..")){let t=a.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:i,search:r="",hash:s=""}="string"===typeof e?A(e):e;return i?(i=i.replace(/\/\/+/g,"/"),t=i.startsWith("/")?Z(i.substring(1),"/"):Z(i,n)):t=n,{pathname:t,search:te(r),hash:ne(s)}}(i,s),c=a&&"/"!==a&&a.endsWith("/"),u=(o||"."===a)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}var J=e=>e.join("/").replace(/\/\/+/g,"/"),ee=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),te=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",ne=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";var ie=class{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.status=e,this.statusText=t||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function re(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}function se(e){return e.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var oe="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;function ae(e,t){let n=e;if("string"!==typeof n||!q.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,r=!1;if(oe)try{let e=new URL(window.location.href),i=n.startsWith("//")?new URL(e.protocol+n):new URL(n),s=X(i.pathname,t);i.origin===e.origin&&null!=s?n=s+i.search+i.hash:r=!0}catch(s){x(!1,'<Link to="'.concat(n,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}return{absoluteURL:i,isExternal:r,to:n}}Symbol("Uninstrumented");Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var le=["POST","PUT","PATCH","DELETE"],ce=(new Set(le),["GET",...le]);new Set(ce),Symbol("ResetLoaderData");var ue=s.createContext(null);ue.displayName="DataRouter";var he=s.createContext(null);he.displayName="DataRouterState";var de=s.createContext(!1);function pe(){return s.useContext(de)}var fe=s.createContext({isTransitioning:!1});fe.displayName="ViewTransition";var me=s.createContext(new Map);me.displayName="Fetchers";var ge=s.createContext(null);ge.displayName="Await";var ve=s.createContext(null);ve.displayName="Navigation";var ye=s.createContext(null);ye.displayName="Location";var Oe=s.createContext({outlet:null,matches:[],isDataRoute:!1});Oe.displayName="Route";var we=s.createContext(null);we.displayName="RouteError";var be="REACT_ROUTER_ERROR";function ke(){return null!=s.useContext(ye)}function xe(){return k(ke(),"useLocation() may be used only in the context of a <Router> component."),s.useContext(ye).location}var De="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Se(e){s.useContext(ve).static||s.useLayoutEffect(e)}function Ce(){let{isDataRoute:e}=s.useContext(Oe);return e?function(){let{router:e}=Qe("useNavigate"),t=je("useNavigate"),n=s.useRef(!1);Se(()=>{n.current=!0});let i=s.useCallback(async function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};x(n.current,De),n.current&&("number"===typeof i?await e.navigate(i):await e.navigate(i,p({fromRouteId:t},r)))},[e,t]);return i}():function(){k(ke(),"useNavigate() may be used only in the context of a <Router> component.");let e=s.useContext(ue),{basename:t,navigator:n}=s.useContext(ve),{matches:i}=s.useContext(Oe),{pathname:r}=xe(),o=JSON.stringify(G(i)),a=s.useRef(!1);Se(()=>{a.current=!0});let l=s.useCallback(function(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(x(a.current,De),!a.current)return;if("number"===typeof i)return void n.go(i);let l=K(i,JSON.parse(o),r,"path"===s.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:J([t,l.pathname])),(s.replace?n.replace:n.push)(l,s.state,s)},[t,n,o,r,e]);return l}()}s.createContext(null);function Ae(){let{matches:e}=s.useContext(Oe),t=e[e.length-1];return t?t.params:{}}function Ee(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=s.useContext(Oe),{pathname:i}=xe(),r=JSON.stringify(G(n));return s.useMemo(()=>K(e,JSON.parse(r),i,"path"===t),[e,r,i,t])}function _e(e,t,n,i,r){k(ke(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=s.useContext(ve),{matches:a}=s.useContext(Oe),l=a[a.length-1],c=l?l.params:{},u=l?l.pathname:"/",h=l?l.pathnameBase:"/",d=l&&l.route;{let e=d&&d.path||"";We(u,!d||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,m=xe();if(t){var g;let e="string"===typeof t?A(t):t;k("/"===h||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=m;let v=f.pathname||"/",y=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let O=T(e,{pathname:y});x(d||null!=O,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),x(null==O||void 0!==O[O.length-1].route.element||void 0!==O[O.length-1].route.Component||void 0!==O[O.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let w=Ie(O&&O.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:J([h,o.encodeLocation?o.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:J([h,o.encodeLocation?o.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),a,n,i,r);return t&&w?s.createElement(ye.Provider,{value:{location:p({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},w):w}function Te(){let e=$e(),t=re(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i},a=null;return console.error("Error handled by React Router default ErrorBoundary:",e),a=s.createElement(s.Fragment,null,s.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),s.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",s.createElement("code",{style:o},"ErrorBoundary")," or"," ",s.createElement("code",{style:o},"errorElement")," prop on your route.")),s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),n?s.createElement("pre",{style:r},n):null,a)}var Pe=s.createElement(Te,null),Me=class extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&"object"===typeof e&&e&&"digest"in e&&"string"===typeof e.digest){const t=function(e){if(e.startsWith("".concat(be,":").concat("ROUTE_ERROR_RESPONSE",":{")))try{let t=JSON.parse(e.slice(40));if("object"===typeof t&&t&&"number"===typeof t.status&&"string"===typeof t.statusText)return new ie(t.status,t.statusText,t.data)}catch(t){}}(e.digest);t&&(e=t)}let t=void 0!==e?s.createElement(Oe.Provider,{value:this.props.routeContext},s.createElement(we.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?s.createElement(Re,{error:e},t):t}};Me.contextType=de;var Fe=new WeakMap;function Re(e){let{children:t,error:n}=e,{basename:i}=s.useContext(ve);if("object"===typeof n&&n&&"digest"in n&&"string"===typeof n.digest){let e=function(e){if(e.startsWith("".concat(be,":").concat("REDIRECT",":{")))try{let t=JSON.parse(e.slice(28));if("object"===typeof t&&t&&"number"===typeof t.status&&"string"===typeof t.statusText&&"string"===typeof t.location&&"boolean"===typeof t.reloadDocument&&"boolean"===typeof t.replace)return t}catch(t){}}(n.digest);if(e){let t=Fe.get(n);if(t)throw t;let r=ae(e.location,i);if(oe&&!Fe.get(n)){if(!r.isExternal&&!e.reloadDocument){const t=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(r.to,{replace:e.replace}));throw Fe.set(n,t),t}window.location.href=r.absoluteURL||r.to}return s.createElement("meta",{httpEquiv:"refresh",content:"0;url=".concat(r.absoluteURL||r.to)})}}return t}function Ne(e){let{routeContext:t,match:n,children:i}=e,r=s.useContext(ue);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),s.createElement(Oe.Provider,{value:t},i)}function Ie(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let r=e,o=null===n||void 0===n?void 0:n.errors;if(null!=o){let e=r.findIndex(e=>e.route.id&&void 0!==(null===o||void 0===o?void 0:o[e.route.id]));k(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(o).join(","))),r=r.slice(0,Math.min(r.length,e+1))}let a=!1,l=-1;if(n)for(let s=0;s<r.length;s++){let e=r[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=s),e.route.id){let{loaderData:t,errors:i}=n,s=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!i||void 0===i[e.route.id]);if(e.route.lazy||s){a=!0,r=l>=0?r.slice(0,l+1):[r[0]];break}}}let c=n&&i?(e,t)=>{var r,s;i(e,{location:n.location,params:null!==(r=null===(s=n.matches)||void 0===s||null===(s=s[0])||void 0===s?void 0:s.params)&&void 0!==r?r:{},unstable_pattern:se(n.matches),errorInfo:t})}:void 0;return r.reduceRight((e,i,u)=>{let h,d=!1,p=null,f=null;n&&(h=o&&i.route.id?o[i.route.id]:void 0,p=i.route.errorElement||Pe,a&&(l<0&&0===u?(We("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,f=null):l===u&&(d=!0,f=i.route.hydrateFallbackElement||null)));let m=t.concat(r.slice(0,u+1)),g=()=>{let t;return t=h?p:d?f:i.route.Component?s.createElement(i.route.Component,null):i.route.element?i.route.element:e,s.createElement(Ne,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(i.route.ErrorBoundary||i.route.errorElement||0===u)?s.createElement(Me,{location:n.location,revalidation:n.revalidation,component:p,error:h,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},onError:c}):g()},null)}function Be(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Qe(e){let t=s.useContext(ue);return k(t,Be(e)),t}function Le(e){let t=s.useContext(he);return k(t,Be(e)),t}function je(e){let t=function(e){let t=s.useContext(Oe);return k(t,Be(e)),t}(e),n=t.matches[t.matches.length-1];return k(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function $e(){var e;let t=s.useContext(we),n=Le("useRouteError"),i=je("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[i]}var ze={};function We(e,t,n){t||ze[e]||(ze[e]=!0,x(!1,n))}var Ve={};function Ue(e,t){e||Ve[t]||(Ve[t]=!0,console.warn(t))}o.useOptimistic;s.memo(function(e){let{routes:t,future:n,state:i,onError:r}=e;return _e(t,void 0,i,r,n)});function Xe(e){let{to:t,replace:n,state:i,relative:r}=e;k(ke(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=s.useContext(ve);x(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=s.useContext(Oe),{pathname:l}=xe(),c=Ce(),u=K(t,G(a),l,"path"===r),h=JSON.stringify(u);return s.useEffect(()=>{c(JSON.parse(h),{replace:n,state:i,relative:r})},[c,h,r,n,i]),null}function qe(e){k(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ze(e){let{basename:t="/",children:n=null,location:i,navigationType:r="POP",navigator:o,static:a=!1,unstable_useTransitions:l}=e;k(!ke(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=s.useMemo(()=>({basename:c,navigator:o,static:a,unstable_useTransitions:l,future:{}}),[c,o,a,l]);"string"===typeof i&&(i=A(i));let{pathname:h="/",search:d="",hash:p="",state:f=null,key:m="default"}=i,g=s.useMemo(()=>{let e=X(h,c);return null==e?null:{location:{pathname:e,search:d,hash:p,state:f,key:m},navigationType:r}},[c,h,d,p,f,m,r]);return x(null!=g,'<Router basename="'.concat(c,'"> is not able to match the URL "').concat(h).concat(d).concat(p,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==g?null:s.createElement(ve.Provider,{value:u},s.createElement(ye.Provider,{children:n,value:g}))}function He(e){let{children:t,location:n}=e;return _e(Ye(t),n)}s.Component;function Ye(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return s.Children.forEach(e,(e,i)=>{if(!s.isValidElement(e))return;let r=[...t,i];if(e.type===s.Fragment)return void n.push.apply(n,Ye(e.props.children,r));k(e.type===qe,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),k(!e.props.index||!e.props.children,"An index route cannot have child routes.");let o={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=Ye(e.props.children,r)),n.push(o)}),n}var Ge="get",Ke="application/x-www-form-urlencoded";function Je(e){return"undefined"!==typeof HTMLElement&&e instanceof HTMLElement}var et=null;var tt=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function nt(e){return null==e||tt.has(e)?e:(x(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Ke,'"')),null)}function it(e,t){let n,i,r,s,o;if(function(e){return Je(e)&&"form"===e.tagName.toLowerCase()}(e)){let o=e.getAttribute("action");i=o?X(o,t):null,n=e.getAttribute("method")||Ge,r=nt(e.getAttribute("enctype"))||Ke,s=new FormData(e)}else if(function(e){return Je(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Je(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let o=e.form;if(null==o)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let a=e.getAttribute("formaction")||o.getAttribute("action");if(i=a?X(a,t):null,n=e.getAttribute("formmethod")||o.getAttribute("method")||Ge,r=nt(e.getAttribute("formenctype"))||nt(o.getAttribute("enctype"))||Ke,s=new FormData(o,e),!function(){if(null===et)try{new FormData(document.createElement("form"),0),et=!1}catch(e){et=!0}return et}()){let{name:t,type:n,value:i}=e;if("image"===n){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,i)}}else{if(Je(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Ge,i=null,r=Ke,o=e}return s&&"text/plain"===r&&(o=s,s=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function rt(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function st(e,t,n,i){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return n?r.pathname.endsWith("/")?r.pathname="".concat(r.pathname,"_.").concat(i):r.pathname="".concat(r.pathname,".").concat(i):"/"===r.pathname?r.pathname="_root.".concat(i):t&&"/"===X(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(i):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(i),r}async function ot(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function at(e){return null!=e&&"string"===typeof e.page}function lt(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function ct(e,t,n,i,r,s){let o=(e,t)=>!n[t]||e.route.id!==n[t].route.id,a=(e,t)=>{var i;return n[t].pathname!==e.pathname||(null===(i=n[t].route.path)||void 0===i?void 0:i.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter((e,t)=>o(e,t)||a(e,t)):"data"===s?t.filter((t,s)=>{let l=i.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(o(t,s)||a(t,s))return!0;if(t.route.shouldRevalidate){var c;let i=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof i)return i}return!0}):[]}function ut(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=e.map(e=>{let i=t.routes[e.route.id];if(!i)return[];let r=[i.module];return i.clientActionModule&&(r=r.concat(i.clientActionModule)),i.clientLoaderModule&&(r=r.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(r=r.concat(i.hydrateFallbackModule)),i.imports&&(r=r.concat(i.imports)),r}).flat(1),[...new Set(i)];var i}function ht(e,t){let n=new Set,i=new Set(t);return e.reduce((e,r)=>{if(t&&!at(r)&&"script"===r.as&&r.href&&i.has(r.href))return e;let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}(r));return n.has(s)||(n.add(s),e.push({key:s,link:r})),e},[])}function dt(e,t){return"lazy"===e.mode&&!0===t}function pt(){let e=s.useContext(ue);return rt(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function ft(){let e=s.useContext(he);return rt(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var mt=s.createContext(void 0);function gt(){let e=s.useContext(mt);return rt(e,"You must render this element inside a <HydratedRouter> element"),e}function vt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function yt(e,t,n){if(n&&!kt)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}mt.displayName="FrameworkContext";function Ot(e){let{page:t}=e,n=l(e,m),{router:i}=pt(),r=s.useMemo(()=>T(i.routes,t,i.basename),[i.routes,t,i.basename]);return r?s.createElement(bt,p({page:t,matches:r},n)):null}function wt(e){let{manifest:t,routeModules:n}=gt(),[i,r]=s.useState([]);return s.useEffect(()=>{let i=!1;return async function(e,t,n){let i=await Promise.all(e.map(async e=>{let i=t.routes[e.route.id];if(i){let e=await ot(i,n);return e.links?e.links():[]}return[]}));return ht(i.flat(1).filter(lt).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?p(p({},e),{},{rel:"prefetch",as:"style"}):p(p({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{i||r(e)}),()=>{i=!0}},[e,t,n]),i}function bt(e){let{page:t,matches:n}=e,i=l(e,g),r=xe(),{future:o,manifest:a,routeModules:c}=gt(),{basename:u}=pt(),{loaderData:h,matches:d}=ft(),f=s.useMemo(()=>ct(t,n,d,a,r,"data"),[t,n,d,a,r]),m=s.useMemo(()=>ct(t,n,d,a,r,"assets"),[t,n,d,a,r]),v=s.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let e=new Set,i=!1;if(n.forEach(t=>{var n;let r=a.routes[t.route.id];r&&r.hasLoader&&(!f.some(e=>e.route.id===t.route.id)&&t.route.id in h&&null!==(n=c[t.route.id])&&void 0!==n&&n.shouldRevalidate||r.hasClientLoader?i=!0:e.add(t.route.id))}),0===e.size)return[];let s=st(t,u,o.unstable_trailingSlashAwareDataRequests,"data");return i&&e.size>0&&s.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[s.pathname+s.search]},[u,o.unstable_trailingSlashAwareDataRequests,h,r,a,f,n,t,c]),y=s.useMemo(()=>ut(m,a),[m,a]),O=wt(m);return s.createElement(s.Fragment,null,v.map(e=>s.createElement("link",p({key:e,rel:"prefetch",as:"fetch",href:e},i))),y.map(e=>s.createElement("link",p({key:e,rel:"modulepreload",href:e},i))),O.map(e=>{var t;let{key:n,link:r}=e;return s.createElement("link",p(p({key:n,nonce:i.nonce},r),{},{crossOrigin:null!==(t=r.crossOrigin)&&void 0!==t?t:i.crossOrigin}))}))}var kt=!1;function xt(e){let{manifest:t,serverHandoffString:n,isSpaMode:i,renderMeta:r,routeDiscovery:o,ssr:a}=gt(),{router:c,static:u,staticContext:h}=pt(),{matches:d}=ft(),m=pe(),g=dt(o,a);r&&(r.didRenderScripts=!0);let v=yt(d,null,i);s.useEffect(()=>{kt=!0},[]);let y=s.useMemo(()=>{var i;if(m)return null;let r=h?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",o=u?"".concat(null!==(i=t.hmr)&&void 0!==i&&i.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(v.map((e,n)=>{let i="route".concat(n),r=t.routes[e.route.id];rt(r,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:s,clientLoaderModule:o,clientMiddlewareModule:a,hydrateFallbackModule:l,module:c}=r,u=[...s?[{module:s,varName:"".concat(i,"_clientAction")}]:[],...o?[{module:o,varName:"".concat(i,"_clientLoader")}]:[],...a?[{module:a,varName:"".concat(i,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(i,"_HydrateFallback")}]:[],{module:c,varName:"".concat(i,"_main")}];return 1===u.length?"import * as ".concat(i," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(i," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,i=l(e,f),r=new Set(t.state.matches.map(e=>e.route.id)),s=t.state.location.pathname.split("/").filter(Boolean),o=["/"];for(s.pop();s.length>0;)o.push("/".concat(s.join("/"))),s.pop();o.forEach(e=>{let n=T(t.routes,e,t.basename);n&&n.forEach(e=>r.add(e.route.id))});let a=[...r].reduce((e,t)=>Object.assign(e,{[t]:i.routes[t]}),{});return p(p({},i),{},{routes:a,sri:!!n||void 0})}(t,c),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return s.createElement(s.Fragment,null,s.createElement("script",p(p({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:r},type:void 0})),s.createElement("script",p(p({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:o},type:"module",async:!0})))},[]),O=kt||m?[]:function(e){return[...new Set(e)]}(t.entry.imports.concat(ut(v,t,{includeHydrateFallback:!0}))),w="object"===typeof t.sri?t.sri:{};return Ue(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),kt||m?null:s.createElement(s.Fragment,null,"object"===typeof t.sri?s.createElement("script",p(p({},e),{},{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:w})}})):null,g?null:s.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:w[t.url],suppressHydrationWarning:!0}),s.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:w[t.entry.module],suppressHydrationWarning:!0}),O.map(t=>s.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:w[t],suppressHydrationWarning:!0})),y)}function Dt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}s.Component;function St(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let i,r=s.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(re(t))return s.createElement(Ct,{title:"Unhandled Thrown Response!"},s.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),r);if(t instanceof Error)i=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);i=new Error(e)}return s.createElement(Ct,{title:"Application Error!",isOutsideRemixApp:n},s.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),s.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},i.stack),r)}function Ct(e){var t;let{title:n,renderScripts:i,isOutsideRemixApp:r,children:o}=e,{routeModules:a}=gt();return null!==(t=a.root)&&void 0!==t&&t.Layout&&!r?o:s.createElement("html",{lang:"en"},s.createElement("head",null,s.createElement("meta",{charSet:"utf-8"}),s.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),s.createElement("title",null,n)),s.createElement("body",null,s.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},o,i?s.createElement(xt,null):null)))}var At="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{At&&(window.__reactRouterVersion="7.13.0")}catch(Kre){}function Et(e){let{basename:t,children:n,unstable_useTransitions:i,window:r}=e,o=s.useRef();null==o.current&&(o.current=b({window:r,v5Compat:!0}));let a=o.current,[l,c]=s.useState({action:a.action,location:a.location}),u=s.useCallback(e=>{!1===i?c(e):s.startTransition(()=>c(e))},[i]);return s.useLayoutEffect(()=>a.listen(u),[a,u]),s.createElement(Ze,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:a,unstable_useTransitions:i})}var _t=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tt=s.forwardRef(function(e,t){let{onClick:n,discover:i="render",prefetch:r="none",relative:o,reloadDocument:a,replace:c,state:u,target:h,to:d,preventScrollReset:f,viewTransition:m,unstable_defaultShouldRevalidate:g}=e,y=l(e,v),{basename:O,unstable_useTransitions:w}=s.useContext(ve),b="string"===typeof d&&_t.test(d),x=ae(d,O);d=x.to;let D=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k(ke(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=s.useContext(ve),{hash:r,pathname:o,search:a}=Ee(e,{relative:t}),l=o;return"/"!==n&&(l="/"===o?n:J([n,o])),i.createHref({pathname:l,search:a,hash:r})}(d,{relative:o}),[S,A,E]=function(e,t){let n=s.useContext(mt),[i,r]=s.useState(!1),[o,a]=s.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:d}=t,p=s.useRef(null);s.useEffect(()=>{if("render"===e&&a(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{a(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[e]),s.useEffect(()=>{if(i){let e=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(e)}}},[i]);let f=()=>{r(!0)},m=()=>{r(!1),a(!1)};return n?"intent"!==e?[o,p,{}]:[o,p,{onFocus:vt(l,f),onBlur:vt(c,m),onMouseEnter:vt(u,f),onMouseLeave:vt(h,m),onTouchStart:vt(d,f)}]:[!1,p,{}]}(r,y),_=function(e){let{target:t,replace:n,state:i,preventScrollReset:r,relative:o,viewTransition:a,unstable_defaultShouldRevalidate:l,unstable_useTransitions:c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=Ce(),h=xe(),d=Ee(e,{relative:o});return s.useCallback(p=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(p,t)){p.preventDefault();let t=void 0!==n?n:C(h)===C(d),f=()=>u(e,{replace:t,state:i,preventScrollReset:r,relative:o,viewTransition:a,unstable_defaultShouldRevalidate:l});c?s.startTransition(()=>f()):f()}},[h,u,d,n,i,t,e,r,o,a,l,c])}(d,{replace:c,state:u,target:h,preventScrollReset:f,relative:o,viewTransition:m,unstable_defaultShouldRevalidate:g,unstable_useTransitions:w});let T=s.createElement("a",p(p(p({},y),E),{},{href:x.absoluteURL||D,onClick:x.isExternal||a?n:function(e){n&&n(e),e.defaultPrevented||_(e)},ref:Dt(t,A),target:h,"data-discover":b||"render"!==i?void 0:"true"}));return S&&!b?s.createElement(s.Fragment,null,T,s.createElement(Ot,{page:D})):T});Tt.displayName="Link";var Pt=s.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:i=!1,className:r="",end:o=!1,style:a,to:c,viewTransition:u,children:h}=e,d=l(e,y),f=Ee(c,{relative:d.relative}),m=xe(),g=s.useContext(he),{navigator:v,basename:O}=s.useContext(ve),w=null!=g&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=s.useContext(fe);k(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Rt("useViewTransitionState"),r=Ee(e,{relative:t});if(!n.isTransitioning)return!1;let o=X(n.currentLocation.pathname,i)||n.currentLocation.pathname,a=X(n.nextLocation.pathname,i)||n.nextLocation.pathname;return null!=W(r.pathname,a)||null!=W(r.pathname,o)}(f)&&!0===u,b=v.encodeLocation?v.encodeLocation(f).pathname:f.pathname,x=m.pathname,D=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;i||(x=x.toLowerCase(),D=D?D.toLowerCase():null,b=b.toLowerCase()),D&&O&&(D=X(D,O)||D);const S="/"!==b&&b.endsWith("/")?b.length-1:b.length;let C,A=x===b||!o&&x.startsWith(b)&&"/"===x.charAt(S),E=null!=D&&(D===b||!o&&D.startsWith(b)&&"/"===D.charAt(b.length)),_={isActive:A,isPending:E,isTransitioning:w},T=A?n:void 0;C="function"===typeof r?r(_):[r,A?"active":null,E?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let P="function"===typeof a?a(_):a;return s.createElement(Tt,p(p({},d),{},{"aria-current":T,className:C,ref:t,style:P,to:c,viewTransition:u}),"function"===typeof h?h(_):h)});Pt.displayName="NavLink";var Mt=s.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:i,navigate:r,reloadDocument:o,replace:a,state:c,method:u=Ge,action:h,onSubmit:d,relative:f,preventScrollReset:m,viewTransition:g,unstable_defaultShouldRevalidate:v}=e,y=l(e,O),{unstable_useTransitions:w}=s.useContext(ve),b=Bt(),x=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=s.useContext(ve),i=s.useContext(Oe);k(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),o=p({},Ee(e||".",{relative:t})),a=xe();if(null==e){o.search=a.search;let e=new URLSearchParams(o.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();o.search=n?"?".concat(n):""}}e&&"."!==e||!r.route.index||(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(o.pathname="/"===o.pathname?n:J([n,o.pathname]));return C(o)}(h,{relative:f}),D="get"===u.toLowerCase()?"get":"post",S="string"===typeof h&&_t.test(h);return s.createElement("form",p(p({ref:t,method:D,action:x,onSubmit:o?d:e=>{if(d&&d(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||u,o=()=>b(t||e.currentTarget,{fetcherKey:i,method:n,navigate:r,replace:a,state:c,relative:f,preventScrollReset:m,viewTransition:g,unstable_defaultShouldRevalidate:v});w&&!1!==r?s.startTransition(()=>o()):o()}},y),{},{"data-discover":S||"render"!==n?void 0:"true"}))});function Ft(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Rt(e){let t=s.useContext(ue);return k(t,Ft(e)),t}Mt.displayName="Form";var Nt=0,It=()=>"__".concat(String(++Nt),"__");function Bt(){let{router:e}=Rt("useSubmit"),{basename:t}=s.useContext(ve),n=je("useRouteId"),i=e.fetch,r=e.navigate;return s.useCallback(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:o,method:a,encType:l,formData:c,body:u}=it(e,t);if(!1===s.navigate){let e=s.fetcherKey||It();await i(e,n,s.action||o,{unstable_defaultShouldRevalidate:s.unstable_defaultShouldRevalidate,preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||a,formEncType:s.encType||l,flushSync:s.flushSync})}else await r(s.action||o,{unstable_defaultShouldRevalidate:s.unstable_defaultShouldRevalidate,preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||a,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[i,r,t,n])}var Qt=n(579);const Lt=(0,s.createContext)(void 0);function jt(e){let{children:t}=e;const[n,i]=(0,s.useState)(!1),[r,o]=(0,s.useState)(null);(0,s.useEffect)(()=>{const e="true"===sessionStorage.getItem("flashy_auth"),t=sessionStorage.getItem("flashy_username");i(e),o(t),t&&!sessionStorage.getItem("flashy_user_id")&&sessionStorage.setItem("flashy_user_id",t)},[]);const a={isAuthenticated:n,username:r,login:e=>{i(!0),o(e),sessionStorage.setItem("flashy_auth","true"),sessionStorage.setItem("flashy_username",e),sessionStorage.setItem("flashy_user_id",e)},logout:()=>{i(!1),o(null),sessionStorage.removeItem("flashy_auth"),sessionStorage.removeItem("flashy_username"),sessionStorage.removeItem("flashy_user_id")}};return(0,Qt.jsx)(Lt.Provider,{value:a,children:t})}function $t(){const e=(0,s.useContext)(Lt);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}function zt(e){let{size:t=100,strokeColor:n}=e;return(0,Qt.jsxs)("svg",{width:t,height:t,viewBox:"0 0 300 300",xmlns:"http://www.w3.org/2000/svg",children:[(0,Qt.jsx)("g",{transform:"translate(-47,-10) scale(13) rotate(0)",children:(0,Qt.jsx)("path",{d:" M10 16.7 L13 18.5 C13.8321 19.1154 14.9154 18.8615 15.2857 18.0313L18.2815 11.4698C18.6518 10.6396 18.1606 9.67891 17.2518 9.53429L8.3871 8.16507 C7 8.02045 6.71766 8.79742 6.34815 9.68484 L5.6 11.5 C4.5 13.9 5 13.7 8 15.5 z ",fill:"#F5E1FD",stroke:n||"#F5E1FD",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,Qt.jsx)("g",{transform:"translate(40, -34) scale(13) rotate(0)",children:(0,Qt.jsx)("path",{d:" M10 16.7 L13 18.5 C13.8321 19.1154 14.9154 18.8615 15.2857 18.0313L18.2815 11.4698C18.6518 10.6396 18.1606 9.67891 17.2518 9.53429L8.3871 8.16507 C7 8.02045 6.71766 8.79742 6.34815 9.68484 L5.6 11.5 C4.5 13.9 5 13.7 8 15.5 z ",fill:"#B399D4",stroke:n||"#B399D4",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})})]})}function Wt(e){let{redirectTo:t}=e;const[n,i]=(0,s.useState)(""),[r,o]=(0,s.useState)(""),{login:a}=$t(),l=Ce();return(0,Qt.jsx)("div",{className:"auth-container",children:(0,Qt.jsxs)("div",{className:"auth-card",children:[(0,Qt.jsxs)("div",{className:"auth-header",children:[(0,Qt.jsx)(zt,{size:50,strokeColor:"#333"}),(0,Qt.jsx)("h1",{children:"Flashy"})]}),(0,Qt.jsx)("p",{className:"auth-subtitle",children:"Enter your name to join"}),(0,Qt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),o("");const i=n.trim();i?i.length<2?o("Name must be at least 2 characters"):i.length>20?o("Name must be 20 characters or less"):(a(i),t&&l(t)):o("Please enter your name")},className:"auth-form",children:[(0,Qt.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),placeholder:"Your name",required:!0,autoFocus:!0,maxLength:20}),r&&(0,Qt.jsx)("div",{className:"error-message",children:r}),(0,Qt.jsx)("button",{type:"submit",children:"Join"})]})]})})}let Vt=[],Ut=[];function Xt(e){if(e<768)return!1;for(let t=0,n=Vt.length;;){let i=t+n>>1;if(e<Vt[i])n=i;else{if(!(e>=Ut[i]))return!0;t=i+1}if(t==n)return!1}}function qt(e){return e>=127462&&e<=127487}(()=>{let e="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let t=0,n=0;t<e.length;t++)(t%2?Ut:Vt).push(n+=e[t])})();function Zt(e,t){return(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?Ht:Yt)(e,t,!(arguments.length>3&&void 0!==arguments[3])||arguments[3])}function Ht(e,t,n){if(t==e.length)return t;t&&Kt(e.charCodeAt(t))&&Jt(e.charCodeAt(t-1))&&t--;let i=Gt(e,t);for(t+=en(i);t<e.length;){let r=Gt(e,t);if(8205==i||8205==r||n&&Xt(r))t+=en(r),i=r;else{if(!qt(r))break;{let n=0,i=t-2;for(;i>=0&&qt(Gt(e,i));)n++,i-=2;if(n%2==0)break;t+=2}}}return t}function Yt(e,t,n){for(;t>0;){let i=Ht(e,t-2,n);if(i<t)return i;t--}return 0}function Gt(e,t){let n=e.charCodeAt(t);if(!Jt(n)||t+1==e.length)return n;let i=e.charCodeAt(t+1);return Kt(i)?i-56320+(n-55296<<10)+65536:n}function Kt(e){return e>=56320&&e<57344}function Jt(e){return e>=55296&&e<56320}function en(e){return e<65536?1:2}class tn{lineAt(e){if(e<0||e>this.length)throw new RangeError("Invalid position ".concat(e," in document of length ").concat(this.length));return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError("Invalid line number ".concat(e," in ").concat(this.lines,"-line document"));return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=hn(this,e,t);let i=[];return this.decompose(0,e,i,2),n.length&&n.decompose(0,n.length,i,3),this.decompose(t,this.length,i,1),rn.from(i,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;[e,t]=hn(this,e,t);let n=[];return this.decompose(e,t,n,0),rn.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),i=new an(this),r=new an(e);for(let s=t,o=t;;){if(i.next(s),r.next(s),s=0,i.lineBreak!=r.lineBreak||i.done!=r.done||i.value!=r.value)return!1;if(o+=i.value.length,i.done||o>=n)return!0}}iter(){return new an(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:1)}iterRange(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return new ln(this,e,t)}iterLines(e,t){let n;if(null==e)n=this.iter();else{null==t&&(t=this.lines+1);let i=this.line(e).from;n=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new cn(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(0==e.length)throw new RangeError("A document must have at least one line");return 1!=e.length||e[0]?e.length<=32?new nn(e):rn.from(nn.split(e,[])):tn.empty}}class nn extends tn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){let t=-1;for(let n of e)t+=n.length+1;return t}(e);super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,i){for(let r=0;;r++){let s=this.text[r],o=i+s.length;if((t?n:o)>=e)return new un(i,o,n,s);i=o+1,n++}}decompose(e,t,n,i){let r=e<=0&&t>=this.length?this:new nn(on(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(1&i){let e=n.pop(),t=sn(r.text,e.text.slice(),0,r.length);if(t.length<=32)n.push(new nn(t,e.length+r.length));else{let e=t.length>>1;n.push(new nn(t.slice(0,e)),new nn(t.slice(e)))}}else n.push(r)}replace(e,t,n){if(!(n instanceof nn))return super.replace(e,t,n);[e,t]=hn(this,e,t);let i=sn(this.text,sn(n.text,on(this.text,0,e)),t),r=this.length+n.length-(t-e);return i.length<=32?new nn(i,r):rn.from(nn.split(i,[]),r)}sliceString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n";[e,t]=hn(this,e,t);let i="";for(let r=0,s=0;r<=t&&s<this.text.length;s++){let o=this.text[s],a=r+o.length;r>e&&s&&(i+=n),e<a&&t>r&&(i+=o.slice(Math.max(0,e-r),t-r)),r=a+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],i=-1;for(let r of e)n.push(r),i+=r.length+1,32==n.length&&(t.push(new nn(n,i)),n=[],i=-1);return i>-1&&t.push(new nn(n,i)),t}}class rn extends tn{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,t,n,i){for(let r=0;;r++){let s=this.children[r],o=i+s.length,a=n+s.lines-1;if((t?a:o)>=e)return s.lineInner(e,t,n,i);i=o+1,n=a+1}}decompose(e,t,n,i){for(let r=0,s=0;s<=t&&r<this.children.length;r++){let o=this.children[r],a=s+o.length;if(e<=a&&t>=s){let r=i&((s<=e?1:0)|(a>=t?2:0));s>=e&&a<=t&&!r?n.push(o):o.decompose(e-s,t-s,n,r)}s=a+1}}replace(e,t,n){if([e,t]=hn(this,e,t),n.lines<this.lines)for(let i=0,r=0;i<this.children.length;i++){let s=this.children[i],o=r+s.length;if(e>=r&&t<=o){let a=s.replace(e-r,t-r,n),l=this.lines-s.lines+a.lines;if(a.lines<l>>4&&a.lines>l>>6){let r=this.children.slice();return r[i]=a,new rn(r,this.length-(t-e)+n.length)}return super.replace(r,o,a)}r=o+1}return super.replace(e,t,n)}sliceString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n";[e,t]=hn(this,e,t);let i="";for(let r=0,s=0;r<this.children.length&&s<=t;r++){let o=this.children[r],a=s+o.length;s>e&&r&&(i+=n),e<a&&t>s&&(i+=o.sliceString(e-s,t-s,n)),s=a+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof rn))return 0;let n=0,[i,r,s,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,r+=t){if(i==s||r==o)return n;let a=this.children[i],l=e.children[r];if(a!=l)return n+a.scanIdentical(l,t);n+=a.length+1}}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.reduce((e,t)=>e+t.length+1,-1),n=0;for(let d of e)n+=d.lines;if(n<32){let n=[];for(let t of e)t.flatten(n);return new nn(n,t)}let i=Math.max(32,n>>5),r=i<<1,s=i>>1,o=[],a=0,l=-1,c=[];function u(e){let t;if(e.lines>r&&e instanceof rn)for(let n of e.children)u(n);else e.lines>s&&(a>s||!a)?(h(),o.push(e)):e instanceof nn&&a&&(t=c[c.length-1])instanceof nn&&e.lines+t.lines<=32?(a+=e.lines,l+=e.length+1,c[c.length-1]=new nn(t.text.concat(e.text),t.length+1+e.length)):(a+e.lines>i&&h(),a+=e.lines,l+=e.length+1,c.push(e))}function h(){0!=a&&(o.push(1==c.length?c[0]:rn.from(c,l)),l=-1,a=c.length=0)}for(let d of e)u(d);return h(),1==o.length?o[0]:new rn(o,t)}}function sn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e9;for(let r=0,s=0,o=!0;s<e.length&&r<=i;s++){let a=e[s],l=r+a.length;l>=n&&(l>i&&(a=a.slice(0,i-r)),r<n&&(a=a.slice(n-r)),o?(t[t.length-1]+=a,o=!1):t.push(a)),r=l+1}return t}function on(e,t,n){return sn(e,[""],t,n)}tn.empty=new nn([""],0);class an{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof nn?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],r=this.offsets[n],s=r>>1,o=i instanceof nn?i.text.length:i.children.length;if(s==(t>0?o:0)){if(0==n)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(t>0?0:1)){if(this.offsets[n]+=t,0==e)return this.lineBreak=!0,this.value="\n",this;e--}else if(i instanceof nn){let r=i.text[s+(t<0?-1:0)];if(this.offsets[n]+=t,r.length>Math.max(0,e))return this.value=0==e?r:t>0?r.slice(e):r.slice(0,r.length-e),this;e-=r.length}else{let r=i.children[s+(t<0?-1:0)];e>r.length?(e-=r.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(r),this.offsets.push(t>0?1:(r instanceof nn?r.text.length:r.children.length)<<1))}}}next(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class ln{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new an(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=n?i:t<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class cn{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,{done:t,lineBreak:n,value:i}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(tn.prototype[Symbol.iterator]=function(){return this.iter()},an.prototype[Symbol.iterator]=ln.prototype[Symbol.iterator]=cn.prototype[Symbol.iterator]=function(){return this});class un{constructor(e,t,n,i){this.from=e,this.to=t,this.number=n,this.text=i}get length(){return this.to-this.from}}function hn(e,t,n){return[t=Math.max(0,Math.min(e.length,t)),Math.max(t,Math.min(e.length,n))]}function dn(e,t){return Zt(e,t,!(arguments.length>2&&void 0!==arguments[2])||arguments[2],!(arguments.length>3&&void 0!==arguments[3])||arguments[3])}function pn(e,t){let n=e.charCodeAt(t);if(!((i=n)>=55296&&i<56320)||t+1==e.length)return n;var i;let r=e.charCodeAt(t+1);return function(e){return e>=56320&&e<57344}(r)?r-56320+(n-55296<<10)+65536:n}function fn(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function mn(e){return e<65536?1:2}const gn=/\r\n?|\n/;var vn=function(e){return e[e.Simple=0]="Simple",e[e.TrackDel=1]="TrackDel",e[e.TrackBefore=2]="TrackBefore",e[e.TrackAfter=3]="TrackAfter",e}(vn||(vn={}));class yn{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,i=0;t<this.sections.length;){let r=this.sections[t++],s=this.sections[t++];s<0?(e(n,i,r),i+=r):i+=s,n+=r}}iterChangedRanges(e){kn(this,e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];i<0?e.push(n,i):e.push(i,n)}return new yn(e)}composeDesc(e){return this.empty?e:e.empty?this:Dn(this,e)}mapDesc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.empty?this:xn(this,e,t)}mapPos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vn.Simple,i=0,r=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],a=this.sections[s++],l=i+o;if(a<0){if(l>e)return r+(e-i);r+=o}else{if(n!=vn.Simple&&l>=e&&(n==vn.TrackDel&&i<e&&l>e||n==vn.TrackBefore&&i<e||n==vn.TrackAfter&&l>e))return null;if(l>e||l==e&&t<0&&!o)return e==i||t<0?r:r+a;r+=a}i=l}if(e>i)throw new RangeError("Position ".concat(e," is out of range for changeset of length ").concat(i));return r}touchesRange(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;for(let n=0,i=0;n<this.sections.length&&i<=t;){let r=i+this.sections[n++];if(this.sections[n++]>=0&&i<=t&&r>=e)return!(i<e&&r>t)||"cover";i=r}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+n+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(e=>"number"!=typeof e))throw new RangeError("Invalid JSON representation of ChangeDesc");return new yn(e)}static create(e){return new yn(e)}}class On extends yn{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return kn(this,(t,n,i,r,s)=>e=e.replace(i,i+(n-t),s),!1),e}mapDesc(e){return xn(this,e,arguments.length>1&&void 0!==arguments[1]&&arguments[1],!0)}invert(e){let t=this.sections.slice(),n=[];for(let i=0,r=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o>=0){t[i]=o,t[i+1]=s;let a=i>>1;for(;n.length<a;)n.push(tn.empty);n.push(s?e.slice(r,r+s):tn.empty)}r+=s}return new On(t,n)}compose(e){return this.empty?e:e.empty?this:Dn(this,e,!0)}map(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.empty?this:xn(this,e,t,!0)}iterChanges(e){kn(this,e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}get desc(){return yn.create(this.sections)}filter(e){let t=[],n=[],i=[],r=new Sn(this);e:for(let s=0,o=0;;){let a=s==e.length?1e9:e[s++];for(;o<a||o==a&&0==r.len;){if(r.done)break e;let e=Math.min(r.len,a-o);wn(i,e,-1);let s=-1==r.ins?-1:0==r.off?r.ins:0;wn(t,e,s),s>0&&bn(n,t,r.text),r.forward(e),o+=e}let l=e[s++];for(;o<l;){if(r.done)break e;let e=Math.min(r.len,l-o);wn(t,e,-1),wn(i,e,-1==r.ins?-1:0==r.off?r.ins:0),r.forward(e),o+=e}}return{changes:new On(t,n),filtered:yn.create(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],i=this.sections[t+1];i<0?e.push(n):0==i?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let i=[],r=[],s=0,o=null;function a(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&!i.length)return;s<t&&wn(i,t-s,-1);let e=new On(i,r);o=o?o.compose(e.map(o)):e,i=[],r=[],s=0}return function e(l){if(Array.isArray(l))for(let t of l)e(t);else if(l instanceof On){if(l.length!=t)throw new RangeError("Mismatched change set length (got ".concat(l.length,", expected ").concat(t,")"));a(),o=o?o.compose(l.map(o)):l}else{let{from:e,to:o=e,insert:c}=l;if(e>o||e<0||o>t)throw new RangeError("Invalid change range ".concat(e," to ").concat(o," (in doc of length ").concat(t,")"));let u=c?"string"==typeof c?tn.of(c.split(n||gn)):c:tn.empty,h=u.length;if(e==o&&0==h)return;e<s&&a(),e>s&&wn(i,e-s,-1),wn(i,o-e,h),bn(r,i,u),s=o}}(e),a(!o),o}static empty(e){return new On(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let i=0;i<e.length;i++){let r=e[i];if("number"==typeof r)t.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some((e,t)=>t&&"string"!=typeof e))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)t.push(r[0],0);else{for(;n.length<i;)n.push(tn.empty);n[i]=tn.of(r.slice(1)),t.push(r[0],n[i].length)}}}return new On(t,n)}static createSet(e,t){return new On(e,t)}}function wn(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(0==t&&n<=0)return;let r=e.length-2;r>=0&&n<=0&&n==e[r+1]?e[r]+=t:r>=0&&0==t&&0==e[r]?e[r+1]+=n:i?(e[r]+=t,e[r+1]+=n):e.push(t,n)}function bn(e,t,n){if(0==n.length)return;let i=t.length-2>>1;if(i<e.length)e[e.length-1]=e[e.length-1].append(n);else{for(;e.length<i;)e.push(tn.empty);e.push(n)}}function kn(e,t,n){let i=e.inserted;for(let r=0,s=0,o=0;o<e.sections.length;){let a=e.sections[o++],l=e.sections[o++];if(l<0)r+=a,s+=a;else{let c=r,u=s,h=tn.empty;for(;c+=a,u+=l,l&&i&&(h=h.append(i[o-2>>1])),!(n||o==e.sections.length||e.sections[o+1]<0);)a=e.sections[o++],l=e.sections[o++];t(r,c,s,u,h),r=c,s=u}}}function xn(e,t,n){let i=[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3]?[]:null,s=new Sn(e),o=new Sn(t);for(let a=-1;;){if(s.done&&o.len||o.done&&s.len)throw new Error("Mismatched change set lengths");if(-1==s.ins&&-1==o.ins){let e=Math.min(s.len,o.len);wn(i,e,-1),s.forward(e),o.forward(e)}else if(o.ins>=0&&(s.ins<0||a==s.i||0==s.off&&(o.len<s.len||o.len==s.len&&!n))){let e=o.len;for(wn(i,o.ins,-1);e;){let t=Math.min(s.len,e);s.ins>=0&&a<s.i&&s.len<=t&&(wn(i,0,s.ins),r&&bn(r,i,s.text),a=s.i),s.forward(t),e-=t}o.next()}else{if(!(s.ins>=0)){if(s.done&&o.done)return r?On.createSet(i,r):yn.create(i);throw new Error("Mismatched change set lengths")}{let e=0,t=s.len;for(;t;)if(-1==o.ins){let n=Math.min(t,o.len);e+=n,t-=n,o.forward(n)}else{if(!(0==o.ins&&o.len<t))break;t-=o.len,o.next()}wn(i,e,a<s.i?s.ins:0),r&&a<s.i&&bn(r,i,s.text),a=s.i,s.forward(s.len-t)}}}}function Dn(e,t){let n=[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?[]:null,r=new Sn(e),s=new Sn(t);for(let o=!1;;){if(r.done&&s.done)return i?On.createSet(n,i):yn.create(n);if(0==r.ins)wn(n,r.len,0,o),r.next();else if(0!=s.len||s.done){if(r.done||s.done)throw new Error("Mismatched change set lengths");{let e=Math.min(r.len2,s.len),t=n.length;if(-1==r.ins){let t=-1==s.ins?-1:s.off?0:s.ins;wn(n,e,t,o),i&&t&&bn(i,n,s.text)}else-1==s.ins?(wn(n,r.off?0:r.len,e,o),i&&bn(i,n,r.textBit(e))):(wn(n,r.off?0:r.len,s.off?0:s.ins,o),i&&!s.off&&bn(i,n,s.text));o=(r.ins>e||s.ins>=0&&s.len>e)&&(o||n.length>t),r.forward2(e),s.forward(e)}}else wn(n,0,s.ins,o),i&&bn(i,n,s.text),s.next()}}class Sn{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?tn.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?tn.empty:t[n].slice(this.off,null==e?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Cn{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let e=7&this.flags;return 7==e?null:e}get goalColumn(){let e=this.flags>>6;return 16777215==e?void 0:e}map(e){let t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return this.empty?t=n=e.mapPos(this.from,i):(t=e.mapPos(this.from,1),n=e.mapPos(this.to,-1)),t==this.from&&n==this.to?this:new Cn(t,n,this.flags)}extend(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e<=this.anchor&&t>=this.anchor)return An.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return An.range(this.anchor,n)}eq(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid JSON representation for SelectionRange");return An.range(e.anchor,e.head)}static create(e,t,n){return new Cn(e,t,n)}}class An{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return e.empty?this:An.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new An([this.main],0)}addRange(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return An.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.mainIndex,n=this.ranges.slice();return n[t]=e,An.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||"number"!=typeof e.main||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new An(e.ranges.map(e=>Cn.fromJSON(e)),e.main)}static single(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return new An([An.range(e,t)],0)}static create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0==e.length)throw new RangeError("A selection needs at least one range");for(let n=0,i=0;i<e.length;i++){let r=e[i];if(r.empty?r.from<=n:r.from<n)return An.normalized(e.slice(),t);n=r.to}return new An(e,t)}static cursor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return Cn.create(e,e,(0==t?0:t<0?8:16)|(null==n?7:Math.min(6,n))|(null!==i&&void 0!==i?i:16777215)<<6)}static range(e,t,n,i){let r=(null!==n&&void 0!==n?n:16777215)<<6|(null==i?7:Math.min(6,i));return t<e?Cn.create(t,e,48|r):Cn.create(e,t,(t>e?8:0)|r)}static normalized(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e[t];e.sort((e,t)=>e.from-t.from),t=e.indexOf(n);for(let i=1;i<e.length;i++){let n=e[i],r=e[i-1];if(n.empty?n.from<=r.to:n.from<r.to){let s=r.from,o=Math.max(n.to,r.to);i<=t&&t--,e.splice(--i,2,n.anchor>n.head?An.range(o,s):An.range(s,o))}}return new An(e,t)}}function En(e,t){for(let n of e.ranges)if(n.to>t)throw new RangeError("Selection points outside of document")}let _n=0;class Tn{constructor(e,t,n,i,r){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=i,this.id=_n++,this.default=e([]),this.extensions="function"==typeof r?r(this):r}get reader(){return this}static define(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Tn(e.combine||(e=>e),e.compareInput||((e,t)=>e===t),e.compare||(e.combine?(e,t)=>e===t:Pn),!!e.static,e.enables)}of(e){return new Mn([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Mn(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Mn(e,this,2,t)}from(e,t){return t||(t=e=>e),this.compute([e],n=>t(n.field(e)))}}function Pn(e,t){return e==t||e.length==t.length&&e.every((e,n)=>e===t[n])}class Mn{constructor(e,t,n,i){this.dependencies=e,this.facet=t,this.type=n,this.value=i,this.id=_n++}dynamicSlot(e){var t;let n=this.value,i=this.facet.compareInput,r=this.id,s=e[r]>>1,o=2==this.type,a=!1,l=!1,c=[];for(let u of this.dependencies)"doc"==u?a=!0:"selection"==u?l=!0:0==(1&(null!==(t=e[u.id])&&void 0!==t?t:1))&&c.push(e[u.id]);return{create:e=>(e.values[s]=n(e),1),update(e,t){if(a&&t.docChanged||l&&(t.docChanged||t.selection)||Rn(e,c)){let t=n(e);if(o?!Fn(t,e.values[s],i):!i(t,e.values[s]))return e.values[s]=t,1}return 0},reconfigure:(e,t)=>{let a,l=t.config.address[r];if(null!=l){let r=Hn(t,l);if(this.dependencies.every(n=>n instanceof Tn?t.facet(n)===e.facet(n):!(n instanceof Bn)||t.field(n,!1)==e.field(n,!1))||(o?Fn(a=n(e),r,i):i(a=n(e),r)))return e.values[s]=r,0}else a=n(e);return e.values[s]=a,1}}}}function Fn(e,t,n){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function Rn(e,t){let n=!1;for(let i of t)1&Zn(e,i)&&(n=!0);return n}function Nn(e,t,n){let i=n.map(t=>e[t.id]),r=n.map(e=>e.type),s=i.filter(e=>!(1&e)),o=e[t.id]>>1;function a(e){let n=[];for(let t=0;t<i.length;t++){let s=Hn(e,i[t]);if(2==r[t])for(let e of s)n.push(e);else n.push(s)}return t.combine(n)}return{create(e){for(let t of i)Zn(e,t);return e.values[o]=a(e),1},update(e,n){if(!Rn(e,s))return 0;let i=a(e);return t.compare(i,e.values[o])?0:(e.values[o]=i,1)},reconfigure(e,r){let s=Rn(e,i),l=r.config.facets[t.id],c=r.facet(t);if(l&&!s&&Pn(n,l))return e.values[o]=c,0;let u=a(e);return t.compare(u,c)?(e.values[o]=c,0):(e.values[o]=u,1)}}}const In=Tn.define({static:!0});class Bn{constructor(e,t,n,i,r){this.id=e,this.createF=t,this.updateF=n,this.compareF=i,this.spec=r,this.provides=void 0}static define(e){let t=new Bn(_n++,e.create,e.update,e.compare||((e,t)=>e===t),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(In).find(e=>e.field==this);return((null===t||void 0===t?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:e=>(e.values[t]=this.create(e),1),update:(e,n)=>{let i=e.values[t],r=this.updateF(i,n);return this.compareF(i,r)?0:(e.values[t]=r,1)},reconfigure:(e,n)=>{let i,r=e.facet(In),s=n.facet(In);return(i=r.find(e=>e.field==this))&&i!=s.find(e=>e.field==this)?(e.values[t]=i.create(e),1):null!=n.config.address[this.id]?(e.values[t]=n.field(this),0):(e.values[t]=this.create(e),1)}}}init(e){return[this,In.of({field:this,create:e})]}get extension(){return this}}const Qn=4,Ln=3,jn=2,$n=1;function zn(e){return t=>new Vn(t,e)}const Wn={highest:zn(0),high:zn($n),default:zn(jn),low:zn(Ln),lowest:zn(Qn)};class Vn{constructor(e,t){this.inner=e,this.prec=t}}class Un{of(e){return new Xn(this,e)}reconfigure(e){return Un.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Xn{constructor(e,t){this.compartment=e,this.inner=t}}class qn{constructor(e,t,n,i,r,s){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=i,this.staticValues=r,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let i=[],r=Object.create(null),s=new Map;for(let h of function(e,t,n){let i=[[],[],[],[],[]],r=new Map;function s(e,o){let a=r.get(e);if(null!=a){if(a<=o)return;let t=i[a].indexOf(e);t>-1&&i[a].splice(t,1),e instanceof Xn&&n.delete(e.compartment)}if(r.set(e,o),Array.isArray(e))for(let t of e)s(t,o);else if(e instanceof Xn){if(n.has(e.compartment))throw new RangeError("Duplicate use of compartment in extensions");let i=t.get(e.compartment)||e.inner;n.set(e.compartment,i),s(i,o)}else if(e instanceof Vn)s(e.inner,e.prec);else if(e instanceof Bn)i[o].push(e),e.provides&&s(e.provides,o);else if(e instanceof Mn)i[o].push(e),e.facet.extensions&&s(e.facet.extensions,jn);else{let t=e.extension;if(!t)throw new Error("Unrecognized extension value in extension set (".concat(e,"). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks."));s(t,o)}}return s(e,jn),i.reduce((e,t)=>e.concat(t))}(e,t,s))h instanceof Bn?i.push(h):(r[h.facet.id]||(r[h.facet.id]=[])).push(h);let o=Object.create(null),a=[],l=[];for(let h of i)o[h.id]=l.length<<1,l.push(e=>h.slot(e));let c=null===n||void 0===n?void 0:n.config.facets;for(let h in r){let e=r[h],t=e[0].facet,i=c&&c[h]||[];if(e.every(e=>0==e.type))if(o[t.id]=a.length<<1|1,Pn(i,e))a.push(n.facet(t));else{let i=t.combine(e.map(e=>e.value));a.push(n&&t.compare(i,n.facet(t))?n.facet(t):i)}else{for(let t of e)0==t.type?(o[t.id]=a.length<<1|1,a.push(t.value)):(o[t.id]=l.length<<1,l.push(e=>t.dynamicSlot(e)));o[t.id]=l.length<<1,l.push(n=>Nn(n,t,e))}}let u=l.map(e=>e(o));return new qn(e,s,u,o,a,r)}}function Zn(e,t){if(1&t)return 2;let n=t>>1,i=e.status[n];if(4==i)throw new Error("Cyclic dependency between fields and/or facets");if(2&i)return i;e.status[n]=4;let r=e.computeSlot(e,e.config.dynamicSlots[n]);return e.status[n]=2|r}function Hn(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}const Yn=Tn.define(),Gn=Tn.define({combine:e=>e.some(e=>e),static:!0}),Kn=Tn.define({combine:e=>e.length?e[0]:void 0,static:!0}),Jn=Tn.define(),ei=Tn.define(),ti=Tn.define(),ni=Tn.define({combine:e=>!!e.length&&e[0]});class ii{constructor(e,t){this.type=e,this.value=t}static define(){return new ri}}class ri{of(e){return new ii(this,e)}}class si{constructor(e){this.map=e}of(e){return new oi(this,e)}}class oi{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return void 0===t?void 0:t==this.value?this:new oi(this.type,t)}is(e){return this.type==e}static define(){return new si((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).map||(e=>e))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let i of e){let e=i.map(t);e&&n.push(e)}return n}}oi.reconfigure=oi.define(),oi.appendConfig=oi.define();class ai{constructor(e,t,n,i,r,s){this.startState=e,this.changes=t,this.selection=n,this.effects=i,this.annotations=r,this.scrollIntoView=s,this._doc=null,this._state=null,n&&En(n,t.newLength),r.some(e=>e.type==ai.time)||(this.annotations=r.concat(ai.time.of(Date.now())))}static create(e,t,n,i,r,s){return new ai(e,t,n,i,r,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(ai.userEvent);return!(!t||!(t==e||t.length>e.length&&t.slice(0,e.length)==e&&"."==t[e.length]))}}function li(e,t){let n=[];for(let i=0,r=0;;){let s,o;if(i<e.length&&(r==t.length||t[r]>=e[i]))s=e[i++],o=e[i++];else{if(!(r<t.length))return n;s=t[r++],o=t[r++]}!n.length||n[n.length-1]<s?n.push(s,o):n[n.length-1]<o&&(n[n.length-1]=o)}}function ci(e,t,n){var i;let r,s,o;return n?(r=t.changes,s=On.empty(t.changes.length),o=e.changes.compose(t.changes)):(r=t.changes.map(e.changes),s=e.changes.mapDesc(t.changes,!0),o=e.changes.compose(r)),{changes:o,selection:t.selection?t.selection.map(s):null===(i=e.selection)||void 0===i?void 0:i.map(r),effects:oi.mapEffects(e.effects,r).concat(oi.mapEffects(t.effects,s)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function ui(e,t,n){let i=t.selection,r=pi(t.annotations);return t.userEvent&&(r=r.concat(ai.userEvent.of(t.userEvent))),{changes:t.changes instanceof On?t.changes:On.of(t.changes||[],n,e.facet(Kn)),selection:i&&(i instanceof An?i:An.single(i.anchor,i.head)),effects:pi(t.effects),annotations:r,scrollIntoView:!!t.scrollIntoView}}function hi(e,t,n){let i=ui(e,t.length?t[0]:{},e.doc.length);t.length&&!1===t[0].filter&&(n=!1);for(let s=1;s<t.length;s++){!1===t[s].filter&&(n=!1);let r=!!t[s].sequential;i=ci(i,ui(e,t[s],r?i.changes.newLength:e.doc.length),r)}let r=ai.create(e,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return function(e){let t=e.startState,n=t.facet(ti),i=e;for(let r=n.length-1;r>=0;r--){let s=n[r](e);s&&Object.keys(s).length&&(i=ci(i,ui(t,s,e.changes.newLength),!0))}return i==e?e:ai.create(t,e.changes,e.selection,i.effects,i.annotations,i.scrollIntoView)}(n?function(e){let t=e.startState,n=!0;for(let r of t.facet(Jn)){let t=r(e);if(!1===t){n=!1;break}Array.isArray(t)&&(n=!0===n?t:li(n,t))}if(!0!==n){let i,r;if(!1===n)r=e.changes.invertedDesc,i=On.empty(t.doc.length);else{let t=e.changes.filter(n);i=t.changes,r=t.filtered.mapDesc(t.changes).invertedDesc}e=ai.create(t,i,e.selection&&e.selection.map(r),oi.mapEffects(e.effects,r),e.annotations,e.scrollIntoView)}let i=t.facet(ei);for(let r=i.length-1;r>=0;r--){let n=i[r](e);e=n instanceof ai?n:Array.isArray(n)&&1==n.length&&n[0]instanceof ai?n[0]:hi(t,pi(n),!1)}return e}(r):r)}ai.time=ii.define(),ai.userEvent=ii.define(),ai.addToHistory=ii.define(),ai.remote=ii.define();const di=[];function pi(e){return null==e?di:Array.isArray(e)?e:[e]}var fi=function(e){return e[e.Word=0]="Word",e[e.Space=1]="Space",e[e.Other=2]="Other",e}(fi||(fi={}));const mi=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let gi;try{gi=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(Jre){}function vi(e){return t=>{if(!/\S/.test(t))return fi.Space;if(function(e){if(gi)return gi.test(e);for(let t=0;t<e.length;t++){let n=e[t];if(/\w/.test(n)||n>"\x80"&&(n.toUpperCase()!=n.toLowerCase()||mi.test(n)))return!0}return!1}(t))return fi.Word;for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return fi.Word;return fi.Other}}class yi{constructor(e,t,n,i,r,s){this.config=e,this.doc=t,this.selection=n,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=r,s&&(s._state=this);for(let o=0;o<this.config.dynamicSlots.length;o++)Zn(this,o<<1);this.computeSlot=null}field(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.config.address[e.id];if(null!=n)return Zn(this,n),Hn(this,n);if(t)throw new RangeError("Field is not present in this state")}update(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return hi(this,t,!0)}applyTransaction(e){let t,n=this.config,{base:i,compartments:r}=n;for(let o of e.effects)o.is(Un.reconfigure)?(n&&(r=new Map,n.compartments.forEach((e,t)=>r.set(t,e)),n=null),r.set(o.value.compartment,o.value.extension)):o.is(oi.reconfigure)?(n=null,i=o.value):o.is(oi.appendConfig)&&(n=null,i=pi(i).concat(o.value));if(n)t=e.startState.values.slice();else{n=qn.resolve(i,r,this),t=new yi(n,this.doc,this.selection,n.dynamicSlots.map(()=>null),(e,t)=>t.reconfigure(e,this),null).values}let s=e.startState.facet(Gn)?e.newSelection:e.newSelection.asSingle();new yi(n,e.newDoc,s,t,(t,n)=>n.update(t,e),e)}replaceSelection(e){return"string"==typeof e&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:An.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),i=this.changes(n.changes),r=[n.range],s=pi(n.effects);for(let o=1;o<t.ranges.length;o++){let n=e(t.ranges[o]),a=this.changes(n.changes),l=a.map(i);for(let e=0;e<o;e++)r[e]=r[e].map(l);let c=i.mapDesc(a,!0);r.push(n.range.map(c)),i=i.compose(l),s=oi.mapEffects(s,l).concat(oi.mapEffects(pi(n.effects),c))}return{changes:i,selection:An.create(r,t.mainIndex),effects:s}}changes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e instanceof On?e:On.of(e,this.doc.length,this.facet(yi.lineSeparator))}toText(e){return tn.of(e.split(this.facet(yi.lineSeparator)||gn))}sliceDoc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.doc.length;return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return null==t?e.default:(Zn(this,t),Hn(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let i=e[n];i instanceof Bn&&null!=this.config.address[i.id]&&(t[n]=i.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(!e||"string"!=typeof e.doc)throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(n)for(let r in n)if(Object.prototype.hasOwnProperty.call(e,r)){let t=n[r],s=e[r];i.push(t.init(e=>t.spec.fromJSON(s,e)))}return yi.create({doc:e.doc,selection:An.fromJSON(e.selection),extensions:t.extensions?i.concat([t.extensions]):i})}static create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=qn.resolve(e.extensions||[],new Map),n=e.doc instanceof tn?e.doc:tn.of((e.doc||"").split(t.staticFacet(yi.lineSeparator)||gn)),i=e.selection?e.selection instanceof An?e.selection:An.single(e.selection.anchor,e.selection.head):An.single(0);return En(i,n.length),t.staticFacet(Gn)||(i=i.asSingle()),new yi(t,n,i,t.dynamicSlots.map(()=>null),(e,t)=>t.create(e),null)}get tabSize(){return this.facet(yi.tabSize)}get lineBreak(){return this.facet(yi.lineSeparator)||"\n"}get readOnly(){return this.facet(ni)}phrase(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(let r of this.facet(yi.phrases))if(Object.prototype.hasOwnProperty.call(r,e)){e=r[e];break}return n.length&&(e=e.replace(/\$(\$|\d*)/g,(e,t)=>{if("$"==t)return"$";let i=+(t||1);return!i||i>n.length?e:n[i-1]})),e}languageDataAt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=[];for(let r of this.facet(Yn))for(let s of r(this,t,n))Object.prototype.hasOwnProperty.call(s,e)&&i.push(s[e]);return i}charCategorizer(e){let t=this.languageDataAt("wordChars",e);return vi(t.length?t[0]:"")}wordAt(e){let{text:t,from:n,length:i}=this.doc.lineAt(e),r=this.charCategorizer(e),s=e-n,o=e-n;for(;s>0;){let e=dn(t,s,!1);if(r(t.slice(e,s))!=fi.Word)break;s=e}for(;o<i;){let e=dn(t,o);if(r(t.slice(o,e))!=fi.Word)break;o=e}return s==o?null:An.range(s+n,o+n)}}function Oi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={};for(let r of e)for(let e of Object.keys(r)){let t=r[e],s=i[e];if(void 0===s)i[e]=t;else if(s===t||void 0===t);else{if(!Object.hasOwnProperty.call(n,e))throw new Error("Config merge conflict for field "+e);i[e]=n[e](s,t)}}for(let r in t)void 0===i[r]&&(i[r]=t[r]);return i}yi.allowMultipleSelections=Gn,yi.tabSize=Tn.define({combine:e=>e.length?e[0]:4}),yi.lineSeparator=Kn,yi.readOnly=ni,yi.phrases=Tn.define({compare(e,t){let n=Object.keys(e),i=Object.keys(t);return n.length==i.length&&n.every(n=>e[n]==t[n])}}),yi.languageData=Yn,yi.changeFilter=Jn,yi.transactionFilter=ei,yi.transactionExtender=ti,Un.reconfigure=oi.define();class wi{eq(e){return this==e}range(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return ki.create(e,t,this)}}function bi(e,t){return e==t||e.constructor==t.constructor&&e.eq(t)}wi.prototype.startSide=wi.prototype.endSide=0,wi.prototype.point=!1,wi.prototype.mapMode=vn.TrackDel;class ki{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(e,t,n){return new ki(e,t,n)}}function xi(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}class Di{constructor(e,t,n,i){this.from=e,this.to=t,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=n?this.to:this.from;for(let s=i,o=r.length;;){if(s==o)return s;let i=s+o>>1,a=r[i]-e||(n?this.value[i].endSide:this.value[i].startSide)-t;if(i==s)return a>=0?s:o;a>=0?o=i:s=i+1}}between(e,t,n,i){for(let r=this.findIndex(t,-1e9,!0),s=this.findIndex(n,1e9,!1,r);r<s;r++)if(!1===i(this.from[r]+e,this.to[r]+e,this.value[r]))return!1}map(e,t){let n=[],i=[],r=[],s=-1,o=-1;for(let a=0;a<this.value.length;a++){let l,c,u=this.value[a],h=this.from[a]+e,d=this.to[a]+e;if(h==d){let e=t.mapPos(h,u.startSide,u.mapMode);if(null==e)continue;if(l=c=e,u.startSide!=u.endSide&&(c=t.mapPos(h,u.endSide),c<l))continue}else if(l=t.mapPos(h,u.startSide),c=t.mapPos(d,u.endSide),l>c||l==c&&u.startSide>0&&u.endSide<=0)continue;(c-l||u.endSide-u.startSide)<0||(s<0&&(s=l),u.point&&(o=Math.max(o,c-l)),n.push(u),i.push(l-s),r.push(c-s))}return{mapped:n.length?new Di(i,r,n,o):null,pos:s}}}class Si{constructor(e,t,n,i){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=i}static create(e,t,n,i){return new Si(e,t,n,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:i=0,filterTo:r=this.length}=e,s=e.filter;if(0==t.length&&!s)return this;if(n&&(t=t.slice().sort(xi)),this.isEmpty)return t.length?Si.of(t):this;let o=new Ei(this,null,-1).goto(0),a=0,l=[],c=new Ci;for(;o.value||a<t.length;)if(a<t.length&&(o.from-t[a].from||o.startSide-t[a].value.startSide)>=0){let e=t[a++];c.addInner(e.from,e.to,e.value)||l.push(e)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(o.chunkIndex)<t[a].from)&&(!s||i>this.chunkEnd(o.chunkIndex)||r<this.chunkPos[o.chunkIndex])&&c.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||i>o.to||r<o.from||s(o.from,o.to,o.value))&&(c.addInner(o.from,o.to,o.value)||l.push(ki.create(o.from,o.to,o.value))),o.next());return c.finishInner(this.nextLayer.isEmpty&&!l.length?Si.empty:this.nextLayer.update({add:l,filter:s,filterFrom:i,filterTo:r}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],i=-1;for(let s=0;s<this.chunk.length;s++){let r=this.chunkPos[s],o=this.chunk[s],a=e.touchesRange(r,r+o.length);if(!1===a)i=Math.max(i,o.maxPoint),t.push(o),n.push(e.mapPos(r));else if(!0===a){let{mapped:s,pos:a}=o.map(r,e);s&&(i=Math.max(i,s.maxPoint),t.push(s),n.push(a))}}let r=this.nextLayer.map(e);return 0==t.length?r:new Si(n,t,r||Si.empty,i)}between(e,t,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let r=this.chunkPos[i],s=this.chunk[i];if(t>=r&&e<=r+s.length&&!1===s.between(r,e-r,t-r,n))return}this.nextLayer.between(e,t,n)}}iter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return _i.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return _i.from(e).goto(t)}static compare(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,s=e.filter(e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=r),o=t.filter(e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=r),a=Ai(s,o,n),l=new Pi(s,a,r),c=new Pi(o,a,r);n.iterGaps((e,t,n)=>Mi(l,e,c,t,n,i)),n.empty&&0==n.length&&Mi(l,0,c,0,0,i)}static eq(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;null==i&&(i=999999999);let r=e.filter(e=>!e.isEmpty&&t.indexOf(e)<0),s=t.filter(t=>!t.isEmpty&&e.indexOf(t)<0);if(r.length!=s.length)return!1;if(!r.length)return!0;let o=Ai(r,s),a=new Pi(r,o,0).goto(n),l=new Pi(s,o,0).goto(n);for(;;){if(a.to!=l.to||!Fi(a.active,l.active)||a.point&&(!l.point||!bi(a.point,l.point)))return!1;if(a.to>i)return!0;a.next(),l.next()}}static spans(e,t,n,i){let r=new Pi(e,null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1).goto(t),s=t,o=r.openStart;for(;;){let e=Math.min(r.to,n);if(r.point){let n=r.activeForPoint(r.to),a=r.pointFrom<t?n.length+1:r.point.startSide<0?n.length:Math.min(n.length,o);i.point(s,e,r.point,n,a,r.pointRank),o=Math.min(r.openEnd(e),n.length)}else e>s&&(i.span(s,e,r.active,o),o=r.openEnd(e));if(r.to>n)return o+(r.point&&r.to>n?1:0);s=r.to,r.next()}}static of(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Ci;for(let i of e instanceof ki?[e]:t?function(e){if(e.length>1)for(let t=e[0],n=1;n<e.length;n++){let i=e[n];if(xi(t,i)>0)return e.slice().sort(xi);t=i}return e}(e):e)n.add(i.from,i.to,i.value);return n.finish()}static join(e){if(!e.length)return Si.empty;let t=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let i=e[n];i!=Si.empty;i=i.nextLayer)t=new Si(i.chunkPos,i.chunk,t,Math.max(i.maxPoint,t.maxPoint));return t}}Si.empty=new Si([],[],null,-1),Si.empty.nextLayer=Si.empty;class Ci{finishChunk(e){this.chunks.push(new Di(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new Ci)).add(e,t,n)}addInner(e,t,n){let i=e-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(i<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(Si.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;let t=Si.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Ai(e,t,n){let i=new Map;for(let s of e)for(let e=0;e<s.chunk.length;e++)s.chunk[e].maxPoint<=0&&i.set(s.chunk[e],s.chunkPos[e]);let r=new Set;for(let s of t)for(let e=0;e<s.chunk.length;e++){let t=i.get(s.chunk[e]);null==t||(n?n.mapPos(t):t)!=s.chunkPos[e]||(null===n||void 0===n?void 0:n.touchesRange(t,t+s.chunk[e].length))||r.add(s.chunk[e])}return r}class Ei{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.layer=e,this.skip=t,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1e9;return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let t=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(t)||this.layer.chunkEnd(this.chunkIndex)<e||t.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class _i{constructor(e){this.heap=e}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=[];for(let r=0;r<e.length;r++)for(let s=e[r];!s.isEmpty;s=s.nextLayer)s.maxPoint>=n&&i.push(new Ei(s,t,n,r));return 1==i.length?i[0]:new _i(i)}get startSide(){return this.value?this.value.startSide:0}goto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1e9;for(let n of this.heap)n.goto(e,t);for(let n=this.heap.length>>1;n>=0;n--)Ti(this.heap,n);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let n=this.heap.length>>1;n>=0;n--)Ti(this.heap,n);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Ti(this.heap,0)}}}function Ti(e,t){for(let n=e[t];;){let i=1+(t<<1);if(i>=e.length)break;let r=e[i];if(i+1<e.length&&r.compare(e[i+1])>=0&&(r=e[i+1],i++),n.compare(r)<0)break;e[i]=n,e[t]=r,t=i}}class Pi{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=_i.from(e,t,n)}goto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1e9;return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Ri(this.active,e),Ri(this.activeTo,e),Ri(this.activeRank,e),this.minActive=Ii(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:i,rank:r}=this.cursor;for(;t<this.activeRank.length&&(r-this.activeRank[t]||i-this.activeTo[t])>0;)t++;Ni(this.active,t,n),Ni(this.activeTo,t,i),Ni(this.activeRank,t,r),e&&Ni(e,t,this.cursor.from),this.minActive=Ii(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),n&&Ri(n,i)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let e=this.cursor.value;if(e.point){if(!(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=e,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=e.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(n),this.cursor.next()}}}if(n){this.openStart=0;for(let t=n.length-1;t>=0&&n[t]<e;t--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}function Mi(e,t,n,i,r,s){e.goto(t),n.goto(i);let o=i+r,a=i,l=i-t,c=!!s.boundChange;for(let u=!1;;){let t=e.to+l-n.to,i=t||e.endSide-n.endSide,r=i<0?e.to+l:n.to,h=Math.min(r,o);if(e.point||n.point?(e.point&&n.point&&bi(e.point,n.point)&&Fi(e.activeForPoint(e.to),n.activeForPoint(n.to))||s.comparePoint(a,h,e.point,n.point),u=!1):(u&&s.boundChange(a),h>a&&!Fi(e.active,n.active)&&s.compareRange(a,h,e.active,n.active),c&&h<o&&(t||e.openEnd(r)!=n.openEnd(r))&&(u=!0)),r>o)break;a=r,i<=0&&e.next(),i>=0&&n.next()}}function Fi(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n]&&!bi(e[n],t[n]))return!1;return!0}function Ri(e,t){for(let n=t,i=e.length-1;n<i;n++)e[n]=e[n+1];e.pop()}function Ni(e,t,n){for(let i=e.length-1;i>=t;i--)e[i+1]=e[i];e[t]=n}function Ii(e,t){let n=-1,i=1e9;for(let r=0;r<t.length;r++)(t[r]-i||e[r].endSide-e[n].endSide)<0&&(n=r,i=t[r]);return n}function Bi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,i=0;for(let r=0;r<n&&r<e.length;)9==e.charCodeAt(r)?(i+=t-i%t,r++):(i++,r=dn(e,r));return i}function Qi(e,t,n,i){for(let r=0,s=0;;){if(s>=t)return r;if(r==e.length)break;s+=9==e.charCodeAt(r)?n-s%n:1,r=dn(e,r)}return!0===i?-1:e.length}const Li="undefined"==typeof Symbol?"__\u037c":Symbol.for("\u037c"),ji="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),$i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class zi{constructor(e,t){this.rules=[];let{finish:n}=t||{};function i(e){return/^@/.test(e)?[e]:e.split(/,\s*/)}function r(e,t,s,o){let a=[],l=/^@(\w+)\b/.exec(e[0]),c=l&&"keyframes"==l[1];if(l&&null==t)return s.push(e[0]+";");for(let n in t){let o=t[n];if(/&/.test(n))r(n.split(/,\s*/).map(t=>e.map(e=>t.replace(/&/,e))).reduce((e,t)=>e.concat(t)),o,s);else if(o&&"object"==typeof o){if(!l)throw new RangeError("The value of a property ("+n+") should be a primitive value.");r(i(n),o,a,c)}else null!=o&&a.push(n.replace(/_.*/,"").replace(/[A-Z]/g,e=>"-"+e.toLowerCase())+": "+o+";")}(a.length||c)&&s.push((!n||l||o?e:e.map(n)).join(", ")+" {"+a.join(" ")+"}")}for(let s in e)r(i(s),e[s],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let e=$i[Li]||1;return $i[Li]=e+1,"\u037c"+e.toString(36)}static mount(e,t,n){let i=e[ji],r=n&&n.nonce;i?r&&i.setNonce(r):i=new Vi(e,r),i.mount(Array.isArray(t)?t:[t],e)}}let Wi=new Map;class Vi{constructor(e,t){let n=e.ownerDocument||e,i=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let t=Wi.get(n);if(t)return e[ji]=t;this.sheet=new i.CSSStyleSheet,Wi.set(n,this)}else this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[ji]=this}mount(e,t){let n=this.sheet,i=0,r=0;for(let s=0;s<e.length;s++){let t=e[s],o=this.modules.indexOf(t);if(o<r&&o>-1&&(this.modules.splice(o,1),r--,o=-1),-1==o){if(this.modules.splice(r++,0,t),n)for(let e=0;e<t.rules.length;e++)n.insertRule(t.rules[e],i++)}else{for(;r<o;)i+=this.modules[r++].rules.length;i+=t.rules.length,r++}}if(n)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let e="";for(let t=0;t<this.modules.length;t++)e+=this.modules[t].getRules()+"\n";this.styleTag.textContent=e;let n=t.head||t;this.styleTag.parentNode!=n&&n.insertBefore(this.styleTag,n.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}for(var Ui={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Xi={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},qi="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Zi="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Hi=0;Hi<10;Hi++)Ui[48+Hi]=Ui[96+Hi]=String(Hi);for(Hi=1;Hi<=24;Hi++)Ui[Hi+111]="F"+Hi;for(Hi=65;Hi<=90;Hi++)Ui[Hi]=String.fromCharCode(Hi+32),Xi[Hi]=String.fromCharCode(Hi);for(var Yi in Ui)Xi.hasOwnProperty(Yi)||(Xi[Yi]=Ui[Yi]);function Gi(e){var t=!(qi&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||Zi&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?Xi:Ui)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}let Ki="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Ji="undefined"!=typeof document?document:{documentElement:{style:{}}};const er=/Edge\/(\d+)/.exec(Ki.userAgent),tr=/MSIE \d/.test(Ki.userAgent),nr=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ki.userAgent),ir=!!(tr||nr||er),rr=!ir&&/gecko\/(\d+)/i.test(Ki.userAgent),sr=!ir&&/Chrome\/(\d+)/.exec(Ki.userAgent),or="webkitFontSmoothing"in Ji.documentElement.style,ar=!ir&&/Apple Computer/.test(Ki.vendor),lr=ar&&(/Mobile\/\w+/.test(Ki.userAgent)||Ki.maxTouchPoints>2);var cr={mac:lr||/Mac/.test(Ki.platform),windows:/Win/.test(Ki.platform),linux:/Linux|X11/.test(Ki.platform),ie:ir,ie_version:tr?Ji.documentMode||6:nr?+nr[1]:er?+er[1]:0,gecko:rr,gecko_version:rr?+(/Firefox\/(\d+)/.exec(Ki.userAgent)||[0,0])[1]:0,chrome:!!sr,chrome_version:sr?+sr[1]:0,ios:lr,android:/Android\b/.test(Ki.userAgent),webkit:or,webkit_version:or?+(/\bAppleWebKit\/(\d+)/.exec(Ki.userAgent)||[0,0])[1]:0,safari:ar,safari_version:ar?+(/\bVersion\/(\d+(\.\d+)?)/.exec(Ki.userAgent)||[0,0])[1]:0,tabSize:null!=Ji.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};function ur(e,t){for(let n in e)"class"==n&&t.class?t.class+=" "+e.class:"style"==n&&t.style?t.style+=";"+e.style:t[n]=e[n];return t}const hr=Object.create(null);function dr(e,t,n){if(e==t)return!0;e||(e=hr),t||(t=hr);let i=Object.keys(e),r=Object.keys(t);if(i.length-(n&&i.indexOf(n)>-1?1:0)!=r.length-(n&&r.indexOf(n)>-1?1:0))return!1;for(let s of i)if(s!=n&&(-1==r.indexOf(s)||e[s]!==t[s]))return!1;return!0}function pr(e,t,n){let i=!1;if(t)for(let r in t)n&&r in n||(i=!0,"style"==r?e.style.cssText="":e.removeAttribute(r));if(n)for(let r in n)t&&t[r]==n[r]||(i=!0,"style"==r?e.style.cssText=n[r]:e.setAttribute(r,n[r]));return i}function fr(e){let t=Object.create(null);for(let n=0;n<e.attributes.length;n++){let i=e.attributes[n];t[i.name]=i.value}return t}class mr{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var gr=function(e){return e[e.Text=0]="Text",e[e.WidgetBefore=1]="WidgetBefore",e[e.WidgetAfter=2]="WidgetAfter",e[e.WidgetRange=3]="WidgetRange",e}(gr||(gr={}));class vr extends wi{constructor(e,t,n,i){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=i}get heightRelevant(){return!1}static mark(e){return new yr(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new wr(e,t,t,n,e.widget||null,!1)}static replace(e){let t,n,i=!!e.block;if(e.isBlockGap)t=-5e8,n=4e8;else{let{start:r,end:s}=br(e,i);t=(r?i?-3e8:-1:5e8)-1,n=1+(s?i?2e8:1:-6e8)}return new wr(e,t,n,i,e.widget||null,!0)}static line(e){return new Or(e)}static set(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Si.of(e,t)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}vr.none=Si.empty;class yr extends vr{constructor(e){let{start:t,end:n}=br(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?ur(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||hr}eq(e){return this==e||e instanceof yr&&this.tagName==e.tagName&&dr(this.attrs,e.attrs)}range(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}yr.prototype.point=!1;class Or extends vr{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Or&&this.spec.class==e.spec.class&&dr(this.spec.attributes,e.spec.attributes)}range(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Or.prototype.mapMode=vn.TrackBefore,Or.prototype.point=!0;class wr extends vr{constructor(e,t,n,i,r,s){super(t,n,r,e),this.block=i,this.isReplace=s,this.mapMode=i?t<=0?vn.TrackBefore:vn.TrackAfter:vn.TrackDel}get type(){return this.startSide!=this.endSide?gr.WidgetRange:this.startSide<=0?gr.WidgetBefore:gr.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof wr&&(t=this.widget,n=e.widget,t==n||!!(t&&n&&t.compare(n)))&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide;var t,n}range(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}function br(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{inclusiveStart:n,inclusiveEnd:i}=e;return null==n&&(n=e.inclusive),null==i&&(i=e.inclusive),{start:null!==n&&void 0!==n?n:t,end:null!==i&&void 0!==i?i:t}}function kr(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=n.length-1;r>=0&&n[r]+i>=e?n[r]=Math.max(n[r],t):n.push(e,t)}wr.prototype.point=!0;class xr extends wi{constructor(e,t){super(),this.tagName=e,this.attributes=t}eq(e){return e==this||e instanceof xr&&this.tagName==e.tagName&&dr(this.attributes,e.attributes)}static create(e){return new xr(e.tagName,e.attributes||hr)}static set(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Si.of(e,t)}}function Dr(e){let t;return t=11==e.nodeType?e.getSelection?e:e.ownerDocument:e,t.getSelection()}function Sr(e,t){return!!t&&(e==t||e.contains(1!=t.nodeType?t.parentNode:t))}function Cr(e,t){if(!t.anchorNode)return!1;try{return Sr(e,t.anchorNode)}catch(Jre){return!1}}function Ar(e){return 3==e.nodeType?jr(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function Er(e,t,n,i){return!!n&&(Pr(e,t,n,i,-1)||Pr(e,t,n,i,1))}function _r(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function Tr(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}function Pr(e,t,n,i,r){for(;;){if(e==n&&t==i)return!0;if(t==(r<0?0:Mr(e))){if("DIV"==e.nodeName)return!1;let n=e.parentNode;if(!n||1!=n.nodeType)return!1;t=_r(e)+(r<0?0:1),e=n}else{if(1!=e.nodeType)return!1;if(1==(e=e.childNodes[t+(r<0?-1:0)]).nodeType&&"false"==e.contentEditable)return!1;t=r<0?Mr(e):0}}}function Mr(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Fr(e,t){let n=t?e.left:e.right;return{left:n,right:n,top:e.top,bottom:e.bottom}}function Rr(e){let t=e.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}function Nr(e,t){let n=t.width/e.offsetWidth,i=t.height/e.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(t.width-e.offsetWidth)<1)&&(n=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.height-e.offsetHeight)<1)&&(i=1),{scaleX:n,scaleY:i}}xr.prototype.startSide=xr.prototype.endSide=-1;class Ir{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?Mr(t):0),n,Math.min(e.focusOffset,n?Mr(n):0))}set(e,t,n,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=i}}let Br,Qr=null;function Lr(e){if(e.setActive)return e.setActive();if(Qr)return e.focus(Qr);let t=[];for(let n=e;n&&(t.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(e.focus(null==Qr?{get preventScroll(){return Qr={preventScroll:!0},!0}}:void 0),!Qr){Qr=!1;for(let e=0;e<t.length;){let n=t[e++],i=t[e++],r=t[e++];n.scrollTop!=i&&(n.scrollTop=i),n.scrollLeft!=r&&(n.scrollLeft=r)}}}function jr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=Br||(Br=document.createRange());return i.setEnd(e,n),i.setStart(e,t),i}function $r(e,t,n,i){let r={key:t,code:t,keyCode:n,which:n,cancelable:!0};i&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=i);let s=new KeyboardEvent("keydown",r);s.synthetic=!0,e.dispatchEvent(s);let o=new KeyboardEvent("keyup",r);return o.synthetic=!0,e.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function zr(e){return e.scrollTop>Math.max(1,e.scrollHeight-e.clientHeight-4)}function Wr(e,t){for(let n=e,i=t;;){if(3==n.nodeType&&i>0)return{node:n,offset:i};if(1==n.nodeType&&i>0){if("false"==n.contentEditable)return null;n=n.childNodes[i-1],i=Mr(n)}else{if(!n.parentNode||Tr(n))return null;i=_r(n),n=n.parentNode}}}function Vr(e,t){for(let n=e,i=t;;){if(3==n.nodeType&&i<n.nodeValue.length)return{node:n,offset:i};if(1==n.nodeType&&i<n.childNodes.length){if("false"==n.contentEditable)return null;n=n.childNodes[i],i=0}else{if(!n.parentNode||Tr(n))return null;i=_r(n)+1,n=n.parentNode}}}cr.safari&&cr.safari_version>=26&&(Qr=!1);class Ur{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.node=e,this.offset=t,this.precise=n}static before(e,t){return new Ur(e.parentNode,_r(e),t)}static after(e,t){return new Ur(e.parentNode,_r(e)+1,t)}}var Xr=function(e){return e[e.LTR=0]="LTR",e[e.RTL=1]="RTL",e}(Xr||(Xr={}));const qr=Xr.LTR,Zr=Xr.RTL;function Hr(e){let t=[];for(let n=0;n<e.length;n++)t.push(1<<+e[n]);return t}const Yr=Hr("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Gr=Hr("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Kr=Object.create(null),Jr=[];for(let os of["()","[]","{}"]){let e=os.charCodeAt(0),t=os.charCodeAt(1);Kr[e]=t,Kr[t]=-e}function es(e){return e<=247?Yr[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?Gr[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8204?256:64336<=e&&e<=65023?4:1}const ts=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ns{get dir(){return this.level%2?Zr:qr}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,i){let r=-1;for(let s=0;s<e.length;s++){let o=e[s];if(o.from<=t&&o.to>=t){if(o.level==n)return s;(r<0||(0!=i?i<0?o.from<t:o.to>t:e[r].level>o.level))&&(r=s)}}if(r<0)throw new RangeError("Index out of range");return r}}function is(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],r=t[n];if(i.from!=r.from||i.to!=r.to||i.direction!=r.direction||!is(i.inner,r.inner))return!1}return!0}const rs=[];function ss(e,t,n,i,r,s,o){let a=i%2?2:1;if(i%2==r%2)for(let l=t,c=0;l<n;){let t=!0,u=!1;if(c==s.length||l<s[c].from){let e=rs[l];e!=a&&(t=!1,u=16==e)}let h=t||1!=a?null:[],d=t?i:i+1,p=l;e:for(;;)if(c<s.length&&p==s[c].from){if(u)break e;let f=s[c];if(!t)for(let e=f.to,t=c+1;;){if(e==n)break e;if(!(t<s.length&&s[t].from==e)){if(rs[e]==a)break e;break}e=s[t++].to}if(c++,h)h.push(f);else{f.from>l&&o.push(new ns(l,f.from,d)),as(e,f.direction==qr!=!(d%2)?i+1:i,r,f.inner,f.from,f.to,o),l=f.to}p=f.to}else{if(p==n||(t?rs[p]!=a:rs[p]==a))break;p++}h?ss(e,l,p,i+1,r,h,o):l<p&&o.push(new ns(l,p,d)),l=p}else for(let l=n,c=s.length;l>t;){let n=!0,u=!1;if(!c||l>s[c-1].to){let e=rs[l-1];e!=a&&(n=!1,u=16==e)}let h=n||1!=a?null:[],d=n?i:i+1,p=l;e:for(;;)if(c&&p==s[c-1].to){if(u)break e;let f=s[--c];if(!n)for(let e=f.from,n=c;;){if(e==t)break e;if(!n||s[n-1].to!=e){if(rs[e-1]==a)break e;break}e=s[--n].from}if(h)h.push(f);else{f.to<l&&o.push(new ns(f.to,l,d)),as(e,f.direction==qr!=!(d%2)?i+1:i,r,f.inner,f.from,f.to,o),l=f.from}p=f.from}else{if(p==t||(n?rs[p-1]!=a:rs[p-1]==a))break;p--}h?ss(e,p,l,i+1,r,h,o):p<l&&o.push(new ns(p,l,d)),l=p}}function as(e,t,n,i,r,s,o){let a=t%2?2:1;!function(e,t,n,i,r){for(let s=0;s<=i.length;s++){let o=s?i[s-1].to:t,a=s<i.length?i[s].from:n,l=s?256:r;for(let t=o,n=l,i=l;t<a;t++){let r=es(e.charCodeAt(t));512==r?r=n:8==r&&4==i&&(r=16),rs[t]=4==r?2:r,7&r&&(i=r),n=r}for(let e=o,t=l,i=l;e<a;e++){let r=rs[e];if(128==r)e<a-1&&t==rs[e+1]&&24&t?r=rs[e]=t:rs[e]=256;else if(64==r){let r=e+1;for(;r<a&&64==rs[r];)r++;let s=e&&8==t||r<n&&8==rs[r]?1==i?1:8:256;for(let t=e;t<r;t++)rs[t]=s;e=r-1}else 8==r&&1==i&&(rs[e]=1);t=r,7&r&&(i=r)}}}(e,r,s,i,a),function(e,t,n,i,r){let s=1==r?2:1;for(let o=0,a=0,l=0;o<=i.length;o++){let c=o?i[o-1].to:t,u=o<i.length?i[o].from:n;for(let t,n,i,o=c;o<u;o++)if(n=Kr[t=e.charCodeAt(o)])if(n<0){for(let e=a-3;e>=0;e-=3)if(Jr[e+1]==-n){let t=Jr[e+2],n=2&t?r:4&t?1&t?s:r:0;n&&(rs[o]=rs[Jr[e]]=n),a=e;break}}else{if(189==Jr.length)break;Jr[a++]=o,Jr[a++]=t,Jr[a++]=l}else if(2==(i=rs[o])||1==i){let e=i==r;l=e?0:1;for(let t=a-3;t>=0;t-=3){let n=Jr[t+2];if(2&n)break;if(e)Jr[t+2]|=2;else{if(4&n)break;Jr[t+2]|=4}}}}}(e,r,s,i,a),function(e,t,n,i){for(let r=0,s=i;r<=n.length;r++){let o=r?n[r-1].to:e,a=r<n.length?n[r].from:t;for(let l=o;l<a;){let o=rs[l];if(256==o){let o=l+1;for(;;)if(o==a){if(r==n.length)break;o=n[r++].to,a=r<n.length?n[r].from:t}else{if(256!=rs[o])break;o++}let c=1==s,u=c==(1==(o<t?rs[o]:i))?c?1:2:i;for(let t=o,i=r,s=i?n[i-1].to:e;t>l;)t==s&&(t=n[--i].from,s=i?n[i-1].to:e),rs[--t]=u;l=o}else s=o,l++}}}(r,s,i,a),ss(e,r,s,t,n,i,o)}function ls(e,t,n){if(!e)return[new ns(0,0,t==Zr?1:0)];if(t==qr&&!n.length&&!ts.test(e))return cs(e.length);if(n.length)for(;e.length>rs.length;)rs[rs.length]=256;let i=[],r=t==qr?0:1;return as(e,r,r,n,0,e.length,i),i}function cs(e){return[new ns(0,e,0)]}let us="";function hs(e,t,n,i,r){var s;let o=i.head-e.from,a=ns.find(t,o,null!==(s=i.bidiLevel)&&void 0!==s?s:-1,i.assoc),l=t[a],c=l.side(r,n);if(o==c){let e=a+=r?1:-1;if(e<0||e>=t.length)return null;l=t[a=e],o=l.side(!r,n),c=l.side(r,n)}let u=dn(e.text,o,l.forward(r,n));(u<l.from||u>l.to)&&(u=c),us=e.text.slice(Math.min(o,u),Math.max(o,u));let h=a==(r?t.length-1:0)?null:t[a+(r?1:-1)];return h&&u==c&&h.level+(r?0:1)<l.level?An.cursor(h.side(!r,n)+e.from,h.forward(r,n)?1:-1,h.level):An.cursor(u+e.from,l.forward(r,n)?-1:1,l.level)}function ds(e,t,n){for(let i=t;i<n;i++){let t=es(e.charCodeAt(i));if(1==t)return qr;if(2==t||4==t)return Zr}return qr}const ps=Tn.define(),fs=Tn.define(),ms=Tn.define(),gs=Tn.define(),vs=Tn.define(),ys=Tn.define(),Os=Tn.define(),ws=Tn.define(),bs=Tn.define(),ks=Tn.define({combine:e=>e.some(e=>e)}),xs=Tn.define({combine:e=>e.some(e=>e)}),Ds=Tn.define();class Ss{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"nearest",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.range=e,this.y=t,this.x=n,this.yMargin=i,this.xMargin=r,this.isSnapshot=s}map(e){return e.empty?this:new Ss(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Ss(An.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Cs=oi.define({map:(e,t)=>e.map(t)}),As=oi.define();function Es(e,t,n){let i=e.facet(gs);i.length?i[0](t):window.onerror&&window.onerror(String(t),n,void 0,void 0,t)||(n?console.error(n+":",t):console.error(t))}const _s=Tn.define({combine:e=>!e.length||e[0]});let Ts=0;const Ps=Tn.define({combine:e=>e.filter((t,n)=>{for(let i=0;i<n;i++)if(e[i].plugin==t.plugin)return!1;return!0})});class Ms{constructor(e,t,n,i,r){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=i,this.baseExtensions=r(this),this.extension=this.baseExtensions.concat(Ps.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(Ps.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:n,eventObservers:i,provide:r,decorations:s}=t||{};return new Ms(Ts++,e,n,i,e=>{let t=[];return s&&t.push(Is.of(t=>{let n=t.plugin(e);return n?s(n):vr.none})),r&&t.push(r(e)),t})}static fromClass(e,t){return Ms.define((t,n)=>new e(t,n),t)}}class Fs{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(Kre){if(Es(e.state,Kre,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(Jre){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(Kre){Es(e.state,Kre,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(null===(t=this.value)||void 0===t?void 0:t.destroy)try{this.value.destroy()}catch(Kre){Es(e.state,Kre,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Rs=Tn.define(),Ns=Tn.define(),Is=Tn.define(),Bs=Tn.define(),Qs=Tn.define(),Ls=Tn.define(),js=Tn.define();function $s(e,t){let n=e.state.facet(js);if(!n.length)return n;let i=n.map(t=>t instanceof Function?t(e):t),r=[];return Si.spans(i,t.from,t.to,{point(){},span(e,n,i,s){let o=e-t.from,a=n-t.from,l=r;for(let r=i.length-1;r>=0;r--,s--){let e,n=i[r].spec.bidiIsolate;if(null==n&&(n=ds(t.text,o,a)),s>0&&l.length&&(e=l[l.length-1]).to==o&&e.direction==n)e.to=a,l=e.inner;else{let e={from:o,to:a,direction:n,inner:[]};l.push(e),l=e.inner}}}}),r}const zs=Tn.define();function Ws(e){let t=0,n=0,i=0,r=0;for(let s of e.state.facet(zs)){let o=s(e);o&&(null!=o.left&&(t=Math.max(t,o.left)),null!=o.right&&(n=Math.max(n,o.right)),null!=o.top&&(i=Math.max(i,o.top)),null!=o.bottom&&(r=Math.max(r,o.bottom)))}return{left:t,right:n,top:i,bottom:r}}const Vs=Tn.define();class Us{constructor(e,t,n,i){this.fromA=e,this.toA=t,this.fromB=n,this.toB=i}join(e){return new Us(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>n.toA)){if(i.toA<n.fromA)break;n=n.join(i),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(0==t.length)return e;let n=[];for(let i=0,r=0,s=0;;){let o=i<e.length?e[i].fromB:1e9,a=r<t.length?t[r]:1e9,l=Math.min(o,a);if(1e9==l)break;let c=l+s,u=l,h=c;for(;;)if(r<t.length&&t[r]<=u){let n=t[r+1];r+=2,u=Math.max(u,n);for(let t=i;t<e.length&&e[t].fromB<=u;t++)s=e[t].toA-e[t].toB;h=Math.max(h,n+s)}else{if(!(i<e.length&&e[i].fromB<=u))break;{let t=e[i++];u=Math.max(u,t.toB),h=Math.max(h,t.toA),s=t.toA-t.toB}}n.push(new Us(c,h,l,u))}return n}}class Xs{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=On.empty(this.startState.doc.length);for(let r of n)this.changes=this.changes.compose(r.changes);let i=[];this.changes.iterChangedRanges((e,t,n,r)=>i.push(new Us(e,t,n,r))),this.changedRanges=i}static create(e,t,n){return new Xs(e,t,n)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}}const qs=[];class Zs{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.dom=e,this.length=t,this.flags=n,this.parent=null,e.cmTile=this}get breakAfter(){return 1&this.flags}get children(){return qs}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,4&this.flags){this.flags&=-5;let e=this.domAttrs;e&&function(e,t){for(let n=e.attributes.length-1;n>=0;n--){let i=e.attributes[n].name;null==t[i]&&e.removeAttribute(i)}for(let n in t){let i=t[n];"style"==n?e.style.cssText=i:e.getAttribute(n)!=i&&e.setAttribute(n,i)}}(this.dom,e)}}toString(){return this.constructor.name+(this.children.length?"(".concat(this.children,")"):"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,t){return null}domPosFor(e,t){let n=_r(this.dom),i=this.length?e>0:t>0;return new Ur(this.parent.dom,n+(i?1:0),0==e||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&2&this.parent.flags&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof Gs)return e;return null}static get(e){return e.cmTile}}class Hs extends Zs{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(2&this.flags)return;super.sync(e);let t,n=this.dom,i=null,r=(null===e||void 0===e?void 0:e.node)==n?e:null,s=0;for(let o of this.children){if(o.sync(e),s+=o.length+o.breakAfter,t=i?i.nextSibling:n.firstChild,r&&t!=o.dom&&(r.written=!0),o.dom.parentNode==n)for(;t&&t!=o.dom;)t=Ys(t);else n.insertBefore(o.dom,t);i=o.dom}for(t=i?i.nextSibling:n.firstChild,r&&t&&(r.written=!0);t;)t=Ys(t);this.length=s}}function Ys(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class Gs extends Hs{constructor(e,t){super(t),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let t=Zs.get(e);if(t&&this.owns(t))return t;e=e.parentNode}}blockTiles(e){for(let t=[],n=this,i=0,r=0;;)if(i==n.children.length){if(!t.length)return;n=n.parent,n.breakAfter&&r++,i=t.pop()}else{let s=n.children[i++];if(s instanceof Ks)t.push(i),n=s,i=0;else{let t=r+s.length,n=e(s,r);if(void 0!==n)return n;r=t+s.breakAfter}}}resolveBlock(e,t){let n,i,r=-1,s=-1;if(this.blockTiles((o,a)=>{let l=a+o.length;if(e>=a&&e<=l){if(o.isWidget()&&t>=-1&&t<=1){if(32&o.flags)return!0;16&o.flags&&(n=void 0)}(a<e||e==l&&(t<-1?o.length:o.covers(1)))&&(!n||!o.isWidget()&&n.isWidget())&&(n=o,r=e-a),(l>e||e==a&&(t>1?o.length:o.covers(-1)))&&(!i||!o.isWidget()&&i.isWidget())&&(i=o,s=e-a)}}),!n&&!i)throw new Error("No tile at position "+e);return n&&t<0||!i?{tile:n,offset:r}:{tile:i,offset:s}}}class Ks extends Hs{constructor(e,t){super(e),this.wrapper=t}isBlock(){return!0}covers(e){return!!this.children.length&&(e<0?this.children[0].covers(-1):this.lastChild.covers(1))}get domAttrs(){return this.wrapper.attributes}static of(e,t){let n=new Ks(t||document.createElement(e.tagName),e);return t||(n.flags|=4),n}}class Js extends Hs{constructor(e,t){super(e),this.attrs=t}isLine(){return!0}static start(e,t,n){let i=new Js(t||document.createElement("div"),e);return t&&n||(i.flags|=4),i}get domAttrs(){return this.attrs}resolveInline(e,t,n){let i=null,r=-1,s=null,o=-1;!function e(a,l){for(let c=0,u=0;c<a.children.length&&u<=l;c++){let h=a.children[c],d=u+h.length;d>=l&&(h.isComposite()?e(h,l-u):(!s||s.isHidden&&(t>0||n&&eo(s,h)))&&(d>l||32&h.flags)?(s=h,o=l-u):(u<l||16&h.flags&&!h.isHidden)&&(i=h,r=l-u)),u=d}}(this,e);let a=(t<0?i:s)||i||s;return a?{tile:a,offset:a==i?r:o}:null}coordsIn(e,t){let n=this.resolveInline(e,t,!0);return n?n.tile.coordsIn(Math.max(0,n.offset),t):function(e){let t=e.dom.lastChild;if(!t)return e.dom.getBoundingClientRect();let n=Ar(t);return n[n.length-1]||null}(this)}domIn(e,t){let n=this.resolveInline(e,t);if(n){let{tile:e,offset:i}=n;if(this.dom.contains(e.dom))return e.isText()?new Ur(e.dom,Math.min(e.dom.nodeValue.length,i)):e.domPosFor(i,16&e.flags?1:32&e.flags?-1:t);let r=n.tile.parent,s=!1;for(let t of r.children){if(s)return new Ur(t.dom,0);t==n.tile&&(s=!0)}}return new Ur(this.dom,0)}}function eo(e,t){let n=e.coordsIn(0,1),i=t.coordsIn(0,1);return n&&i&&i.top<n.bottom}class to extends Hs{constructor(e,t){super(e),this.mark=t}get domAttrs(){return this.mark.attrs}static of(e,t){let n=new to(t||document.createElement(e.tagName),e);return t||(n.flags|=4),n}}class no extends Zs{constructor(e,t){super(e,t.length),this.text=t}sync(e){2&this.flags||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,t){let n=this.dom.nodeValue.length;e>n&&(e=n);let i=e,r=e,s=0;0==e&&t<0||e==n&&t>=0?cr.chrome||cr.gecko||(e?(i--,s=1):r<n&&(r++,s=-1)):t<0?i--:r<n&&r++;let o=jr(this.dom,i,r).getClientRects();if(!o.length)return null;let a=o[(s?s<0:t>=0)?0:o.length-1];return cr.safari&&!s&&0==a.width&&(a=Array.prototype.find.call(o,e=>e.width)||a),s?Fr(a,s<0):a||null}static of(e,t){let n=new no(t||document.createTextNode(e),e);return t||(n.flags|=2),n}}class io extends Zs{constructor(e,t,n,i){super(e,t,i),this.widget=n}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return!(48&this.flags)&&(this.flags&(e<0?64:128))>0}coordsIn(e,t){return this.coordsInWidget(e,t,!1)}coordsInWidget(e,t,n){let i=this.widget.coordsAt(this.dom,e,t);if(i)return i;if(n)return Fr(this.dom.getBoundingClientRect(),this.length?0==e:t<=0);{let t=this.dom.getClientRects(),n=null;if(!t.length)return null;let i=!!(16&this.flags)||!(32&this.flags)&&e>0;for(let r=i?t.length-1:0;n=t[r],!(e>0?0==r:r==t.length-1||n.top<n.bottom);r+=i?-1:1);return Fr(n,!i)}}get overrideDOMText(){if(!this.length)return tn.empty;let{root:e}=this;if(!e)return tn.empty;let t=this.posAtStart;return e.view.state.doc.slice(t,t+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,t,n,i,r){return r||(r=e.toDOM(t),e.editable||(r.contentEditable="false")),new io(r,n,e,i)}}class ro extends Zs{constructor(e){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),super(t,0,e)}get isHidden(){return!0}get overrideDOMText(){return tn.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class so{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,t,n){let{tile:i,index:r,beforeBreak:s,parents:o}=this;for(;e||t>0;)if(i.isComposite())if(s){if(!e)break;n&&n.break(),e--,s=!1}else if(r==i.children.length){if(!e&&!o.length)break;n&&n.leave(i),s=!!i.breakAfter,({tile:i,index:r}=o.pop()),r++}else{let a=i.children[r],l=a.breakAfter;!(t>0?a.length<=e:a.length<e)||n&&!1===n.skip(a,0,a.length)&&a.isComposite?(o.push({tile:i,index:r}),i=a,r=0,n&&a.isComposite()&&n.enter(a)):(s=!!l,r++,e-=a.length)}else if(r==i.length)s=!!i.breakAfter,({tile:i,index:r}=o.pop()),r++;else{if(!e)break;{let t=Math.min(e,i.length-r);n&&n.skip(i,r,r+t),e-=t,r+=t}}return this.tile=i,this.index=r,this.beforeBreak=s,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class oo{constructor(e,t,n,i){this.from=e,this.to=t,this.wrapper=n,this.rank=i}}class ao{constructor(e,t,n){this.cache=e,this.root=t,this.blockWrappers=n,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,t,n,i){var r;this.flushBuffer();let s=this.ensureMarks(t,n),o=s.lastChild;if(o&&o.isText()&&!(8&o.flags)&&o.length+e.length<512){this.cache.reused.set(o,2),(s.children[s.children.length-1]=new no(o.dom,o.text+e)).parent=s}else s.append(i||no.of(e,null===(r=this.cache.find(no))||void 0===r?void 0:r.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,t){let n=this.curLine;n.dom!=t.line.dom&&(n.setDOM(this.cache.reused.has(t.line)?mo(t.line.dom):t.line.dom),this.cache.reused.set(t.line,2));let i=n;for(let o=t.marks.length-1;o>=0;o--){let e=t.marks[o],n=i.lastChild;if(n instanceof to&&n.mark.eq(e.mark))n.dom!=e.dom&&n.setDOM(mo(e.dom)),i=n;else{if(this.cache.reused.get(e)){let t=Zs.get(e.dom);t&&t.setDOM(mo(e.dom))}let t=to.of(e.mark,e.dom);i.append(t),i=t}this.cache.reused.set(e,2)}let r=Zs.get(e.text);r&&this.cache.reused.set(r,2);let s=new no(e.text,e.text.nodeValue);s.flags|=8,i.append(s)}addInlineWidget(e,t,n){let i=this.afterWidget&&48&e.flags&&(48&this.afterWidget.flags)==(48&e.flags);i||this.flushBuffer();let r=this.ensureMarks(t,n);i||16&e.flags||r.append(this.getBuffer(1)),r.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,t,n){this.flushBuffer(),this.ensureMarks(t,n).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){(this.afterWidget||this.lastBlock).length+=e,this.pos+=e}addLineStart(e,t){var n;e||(e=fo);let i=Js.start(e,t||(null===(n=this.cache.find(Js))||void 0===n?void 0:n.dom),!!t);this.getBlockPos().append(this.lastBlock=this.curLine=i)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,t){var n;let i=this.curLine;for(let r=e.length-1;r>=0;r--){let s,o=e[r];if(t>0&&(s=i.lastChild)&&s instanceof to&&s.mark.eq(o))i=s,t--;else{let e=to.of(o,null===(n=this.cache.find(to,e=>e.mark.eq(o)))||void 0===n?void 0:n.dom);i.append(e),i=e,t=0}}return i}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;e&&po(this.curLine,!1)&&("BR"==e.dom.nodeName||!e.isWidget()||cr.ios&&po(this.curLine,!0))||this.curLine.append(this.cache.findWidget(vo,0,32)||new io(vo.toDOM(),0,vo,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let t=new oo(e.from,e.to,e.value,e.rank),n=this.wrappers.length;for(;n>0&&(this.wrappers[n-1].rank-t.rank||this.wrappers[n-1].to-t.to)<0;)n--;this.wrappers.splice(n,0,t)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let t=this.root;for(let n of this.wrappers){let i=t.lastChild;if(n.from<this.pos&&i instanceof Ks&&i.wrapper.eq(n.wrapper))t=i;else{let i=Ks.of(n.wrapper,null===(e=this.cache.find(Ks,e=>e.wrapper.eq(n.wrapper)))||void 0===e?void 0:e.dom);t.append(i),t=i}}return t}blockPosCovered(){let e=this.lastBlock;return null!=e&&!e.breakAfter&&(!e.isWidget()||(160&e.flags)>0)}getBuffer(e){let t=2|(e<0?16:32),n=this.cache.find(ro,void 0,1);return n&&(n.flags=t),n||new ro(t)}flushBuffer(){!this.afterWidget||32&this.afterWidget.flags||(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class lo{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:t,lineBreak:n,done:i}=this.cursor.next(this.skipCount);if(this.skipCount=0,i)throw new Error("Ran out of text content when drawing inline views");this.text=t;let r=this.textOff=Math.min(e,t.length);return n?null:t.slice(0,r)}let t=Math.min(this.text.length,this.textOff+e),n=this.text.slice(this.textOff,t);return this.textOff=t,n}}const co=[io,Js,no,to,ro,Ks,Gs];for(let os=0;os<co.length;os++)co[os].bucket=os;class uo{constructor(e){this.view=e,this.buckets=co.map(()=>[]),this.index=co.map(()=>0),this.reused=new Map}add(e){let t=e.constructor.bucket,n=this.buckets[t];n.length<6?n.push(e):n[this.index[t]=(this.index[t]+1)%6]=e}find(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=e.bucket,r=this.buckets[i],s=this.index[i];for(let o=r.length-1;o>=0;o--){let e=(o+s)%r.length,a=r[e];if((!t||t(a))&&!this.reused.has(a))return r.splice(e,1),e<s&&this.index[i]--,this.reused.set(a,n),a}return null}findWidget(e,t,n){let i=this.buckets[0];if(i.length)for(let r=0,s=0;;r++){if(r==i.length){if(s)return null;s=1,r=0}let o=i[r];if(!this.reused.has(o)&&(0==s?o.widget.compare(e):o.widget.constructor==e.constructor&&e.updateDOM(o.dom,this.view)))return i.splice(r,1),r<this.index[0]&&this.index[0]--,o.widget==e&&o.length==t&&(497&o.flags)==n?(this.reused.set(o,1),o):(this.reused.set(o,2),new io(o.dom,t,e,-498&o.flags|n))}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!this.reused.has(e))return this.reused.set(e,t),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class ho{constructor(e,t,n,i,r){this.view=e,this.decorations=i,this.disallowBlockEffectsFor=r,this.openWidget=!1,this.openMarks=0,this.cache=new uo(e),this.text=new lo(e.state.doc),this.builder=new ao(this.cache,new Gs(e,e.contentDOM),Si.iter(n)),this.cache.reused.set(t,2),this.old=new so(t),this.reuseWalker={skip:(e,t,n)=>{if(this.cache.add(e),e.isComposite())return!1},enter:e=>this.cache.add(e),leave:()=>{},break:()=>{}}}run(e,t){let n=t&&this.getCompositionContext(t.text);for(let i=0,r=0,s=0;;){let o=s<e.length?e[s++]:null,a=o?o.fromA:this.old.root.length;if(a>i){let e=a-i;this.preserve(e,!s,!o),i=a,r+=e}if(!o)break;t&&o.fromA<=t.range.fromA&&o.toA>=t.range.toA?(this.forward(o.fromA,t.range.fromA,t.range.fromA<t.range.toA?1:-1),this.emit(r,t.range.fromB),this.cache.clear(),this.builder.addComposition(t,n),this.text.skip(t.range.toB-t.range.fromB),this.forward(t.range.fromA,o.toA),this.emit(t.range.toB,o.toB)):(this.forward(o.fromA,o.toA),this.emit(r,o.toB)),r=o.toB,i=o.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,t,n){let i=function(e){let t=[];for(let n=e.parents.length;n>1;n--){let i=n==e.parents.length?e.tile:e.parents[n].tile;i instanceof to&&t.push(i.mark)}return t}(this.old),r=this.openMarks;this.old.advance(e,n?1:-1,{skip:(e,t,n)=>{if(e.isWidget())if(this.openWidget)this.builder.continueWidget(n-t);else{let s=n>0||t<e.length?io.of(e.widget,this.view,n-t,496&e.flags,this.cache.maybeReuse(e)):this.cache.reuse(e);256&s.flags?(s.flags&=-2,this.builder.addBlockWidget(s)):(this.builder.ensureLine(null),this.builder.addInlineWidget(s,i,r),r=i.length)}else if(e.isText())this.builder.ensureLine(null),t||n!=e.length?(this.cache.add(e),this.builder.addText(e.text.slice(t,n),i,r)):this.builder.addText(e.text,i,r,this.cache.reuse(e)),r=i.length;else if(e.isLine())e.flags&=-2,this.cache.reused.set(e,1),this.builder.addLine(e);else if(e instanceof ro)this.cache.add(e);else{if(!(e instanceof to))return!1;this.builder.ensureLine(null),this.builder.addMark(e,i,r),this.cache.reused.set(e,1),r=i.length}this.openWidget=!1},enter:e=>{e.isLine()?this.builder.addLineStart(e.attrs,this.cache.maybeReuse(e)):(this.cache.add(e),e instanceof to&&i.unshift(e.mark)),this.openWidget=!1},leave:e=>{e.isLine()?i.length&&(i.length=r=0):e instanceof to&&(i.shift(),r=Math.min(r,i.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,t){let n=null,i=this.builder,r=0,s=Si.spans(this.decorations,e,t,{point:(e,t,s,o,a,l)=>{if(s instanceof wr){if(this.disallowBlockEffectsFor[l]){if(s.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.view.state.doc.lineAt(e).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(r=o.length,a>o.length)i.continueWidget(t-e);else{let r=s.widget||(s.block?go.block:go.inline),l=function(e){let t=e.isReplace?(e.startSide<0?64:0)|(e.endSide>0?128:0):e.startSide>0?32:16;e.block&&(t|=256);return t}(s),c=this.cache.findWidget(r,t-e,l)||io.of(r,this.view,t-e,l);s.block?(s.startSide>0&&i.addLineStartIfNotCovered(n),i.addBlockWidget(c)):(i.ensureLine(n),i.addInlineWidget(c,o,a))}n=null}else n=function(e,t){let n=t.spec.attributes,i=t.spec.class;if(!n&&!i)return e;e||(e={class:"cm-line"});n&&ur(n,e);i&&(e.class+=" "+i);return e}(n,s);t>e&&this.text.skip(t-e)},span:(e,t,r,s)=>{for(let o=e;o<t;){let a=this.text.next(Math.min(512,t-o));null==a?(i.addLineStartIfNotCovered(n),i.addBreak(),o++):(i.ensureLine(n),i.addText(a,r,o==e?s:r.length),o+=a.length),n=null}}});i.addLineStartIfNotCovered(n),this.openWidget=s>r,this.openMarks=s}forward(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t-e<=10?this.old.advance(t-e,n,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(t-e-10,-1),this.old.advance(5,n,this.reuseWalker))}getCompositionContext(e){let t=[],n=null;for(let i=e.parentNode;;i=i.parentNode){let e=Zs.get(i);if(i==this.view.contentDOM)break;e instanceof to?t.push(e):(null===e||void 0===e?void 0:e.isLine())?n=e:"DIV"!=i.nodeName||n||i==this.view.contentDOM?t.push(to.of(new yr({tagName:i.nodeName.toLowerCase(),attributes:fr(i)}),i)):n=new Js(i,fo)}return{line:n,marks:t}}}function po(e,t){let n=e=>{for(let i of e.children)if((t?i.isText():i.length)||n(i))return!0;return!1};return n(e)}const fo={class:"cm-line"};function mo(e){let t=Zs.get(e);return t&&t.setDOM(e.cloneNode()),e}class go extends mr{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}go.inline=new go("span"),go.block=new go("div");const vo=new class extends mr{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class yo{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=vr.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new Gs(e,e.contentDOM),this.updateInner([new Us(0,0,0,e.state.doc.length)],null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(e=>{let{fromA:t,toA:n}=e;return n<this.minWidthFrom||t>this.minWidthTo})?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let i=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null===(t=this.domChanged)||void 0===t?void 0:t.newSel)?i=this.domChanged.newSel.head:function(e,t){let n=!1;t&&e.iterChangedRanges((e,i)=>{e<t.to&&i>t.from&&(n=!0)});return n}(e.changes,this.hasComposition)||e.selectionSet||(i=e.state.selection.main.head));let r=i>-1?function(e,t,n){let i=wo(e,n);if(!i)return null;let{node:r,from:s,to:o}=i,a=r.nodeValue;if(/[\n\r]/.test(a))return null;if(e.state.doc.sliceString(i.from,i.to)!=a)return null;let l=t.invertedDesc;return{range:new Us(l.mapPos(s),l.mapPos(o),s,o),text:r}}(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){let{from:t,to:i}=this.hasComposition;n=new Us(t,i,e.changes.mapPos(t,-1),e.changes.mapPos(i,1)).addToSet(n.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(cr.ie||cr.chrome)&&!r&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let s=this.decorations,o=this.blockWrappers;this.updateDeco();let a=function(e,t,n){let i=new bo;return Si.compare(e,t,n,i),i.changes}(s,this.decorations,e.changes);a.length&&(n=Us.extendWithRanges(n,a));let l=function(e,t,n){let i=new ko;return Si.compare(e,t,n,i),i.changes}(o,this.blockWrappers,e.changes);return l.length&&(n=Us.extendWithRanges(n,l)),r&&!n.some(e=>e.fromA<=r.range.fromA&&e.toA>=r.range.toA)&&(n=r.range.addToSet(n.slice())),!(2&this.tile.flags&&0==n.length)&&(this.updateInner(n,r),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0;let{observer:n}=this.view;n.ignore(()=>{if(t||e.length){let n=this.tile,i=new ho(this.view,n,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=i.run(e,t),Oo(n,i.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let i=cr.chrome||cr.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(i),!i||!i.written&&n.selectionRange.focusNode==i.node&&this.tile.dom.contains(i.node)||(this.forceSelection=!0),this.tile.dom.style.height=""});let i=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let r of this.tile.children)r.isWidget()&&r.widget instanceof xo&&i.push(r.dom);n.updateGaps(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let e of t.effects)e.is(As)&&(this.editContextFormatting=e.value)}updateSelection(){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let{dom:t}=this.tile,n=this.view.root.activeElement,i=n==t,r=!i&&!(this.view.state.facet(_s)||t.tabIndex>-1)&&Cr(t,this.view.observer.selectionRange)&&!(n&&t.contains(n));if(!(i||e||r))return;let s=this.forceSelection;this.forceSelection=!1;let o,a,l=this.view.state.selection.main;if(l.empty?a=o=this.inlineDOMNearPos(l.anchor,l.assoc||1):(a=this.inlineDOMNearPos(l.head,l.head==l.from?1:-1),o=this.inlineDOMNearPos(l.anchor,l.anchor==l.from?1:-1)),cr.gecko&&l.empty&&!this.hasComposition&&(1==(c=o).node.nodeType&&c.node.firstChild&&(0==c.offset||"false"==c.node.childNodes[c.offset-1].contentEditable)&&(c.offset==c.node.childNodes.length||"false"==c.node.childNodes[c.offset].contentEditable))){let e=document.createTextNode("");this.view.observer.ignore(()=>o.node.insertBefore(e,o.node.childNodes[o.offset]||null)),o=a=new Ur(e,0),s=!0}var c;let u=this.view.observer.selectionRange;!s&&u.focusNode&&(Er(o.node,o.offset,u.anchorNode,u.anchorOffset)&&Er(a.node,a.offset,u.focusNode,u.focusOffset)||this.suppressWidgetCursorChange(u,l))||(this.view.observer.ignore(()=>{cr.android&&cr.chrome&&t.contains(u.focusNode)&&function(e,t){for(let n=e;n&&n!=t;n=n.assignedSlot||n.parentNode)if(1==n.nodeType&&"false"==n.contentEditable)return!0;return!1}(u.focusNode,t)&&(t.blur(),t.focus({preventScroll:!0}));let e=Dr(this.view.root);if(e)if(l.empty){if(cr.gecko){let e=function(e,t){return 1!=e.nodeType?0:(t&&"false"==e.childNodes[t-1].contentEditable?1:0)|(t<e.childNodes.length&&"false"==e.childNodes[t].contentEditable?2:0)}(o.node,o.offset);if(e&&3!=e){let t=(1==e?Wr:Vr)(o.node,o.offset);t&&(o=new Ur(t.node,t.offset))}}e.collapse(o.node,o.offset),null!=l.bidiLevel&&void 0!==e.caretBidiLevel&&(e.caretBidiLevel=l.bidiLevel)}else if(e.extend){e.collapse(o.node,o.offset);try{e.extend(a.node,a.offset)}catch(Jre){}}else{let t=document.createRange();l.anchor>l.head&&([o,a]=[a,o]),t.setEnd(a.node,a.offset),t.setStart(o.node,o.offset),e.removeAllRanges(),e.addRange(t)}else;r&&this.view.root.activeElement==t&&(t.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(o,a)),this.impreciseAnchor=o.precise?null:new Ur(u.anchorNode,u.anchorOffset),this.impreciseHead=a.precise?null:new Ur(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&Er(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=Dr(e.root),{anchorNode:i,anchorOffset:r}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let s=this.lineAt(t.head,t.assoc);if(!s)return;let o=s.posAtStart;if(t.head==o||t.head==o+s.length)return;let a=this.coordsAt(t.head,-1),l=this.coordsAt(t.head,1);if(!a||!l||a.bottom>l.top)return;let c=this.domAtPos(t.head+t.assoc,t.assoc);n.collapse(c.node,c.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let u=e.observer.selectionRange;e.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=t.from&&n.collapse(i,r)}posFromDOM(e,t){let n=this.tile.nearest(e);if(!n)return 2&this.tile.dom.compareDocumentPosition(e)?0:this.view.state.doc.length;let i=n.posAtStart;if(!n.isComposite())return n.isText()?e==n.dom?i+t:i+(t?n.length:0):i;{let r;if(e==n.dom)r=n.dom.childNodes[t];else{let i=0==Mr(e)?0:0==t?-1:1;for(;;){let t=e.parentNode;if(t==n.dom)break;0==i&&t.firstChild!=t.lastChild&&(i=e==t.firstChild?-1:1),e=t}r=i<0?e:e.nextSibling}if(r==n.dom.firstChild)return i;for(;r&&!Zs.get(r);)r=r.nextSibling;if(!r)return i+n.length;for(let e=0,t=i;;e++){let i=n.children[e];if(i.dom==r)return t;t+=i.length+i.breakAfter}}}domAtPos(e,t){let{tile:n,offset:i}=this.tile.resolveBlock(e,t);return n.isWidget()?n.domPosFor(e,t):n.domIn(i,t)}inlineDOMNearPos(e,t){let n,i,r=-1,s=!1,o=-1,a=!1;return this.tile.blockTiles((t,l)=>{if(t.isWidget()){if(32&t.flags&&l>=e)return!0;16&t.flags&&(s=!0)}else{let c=l+t.length;if(l<=e&&(n=t,r=e-l,s=c<e),c>=e&&!i&&(i=t,o=e-l,a=l>e),l>e&&i)return!0}}),n||i?(s&&i?n=null:a&&n&&(i=null),n&&t<0||!i?n.domIn(r,t):i.domIn(o,t)):this.domAtPos(e,t)}coordsAt(e,t){let{tile:n,offset:i}=this.tile.resolveBlock(e,t);return n.isWidget()?n.widget instanceof xo?null:n.coordsInWidget(i,t,!0):n.coordsIn(i,t)}lineAt(e,t){let{tile:n}=this.tile.resolveBlock(e,t);return n.isLine()?n:null}coordsForChar(e){let{tile:t,offset:n}=this.tile.resolveBlock(e,1);if(!t.isLine())return null;return function e(t,n){if(t.isComposite())for(let i of t.children){if(i.length>=n){let t=e(i,n);if(t)return t}if((n-=i.length)<0)break}else if(t.isText()&&n<t.length){let e=dn(t.text,n);if(e==n)return null;let i=jr(t.dom,n,e).getClientRects();for(let t=0;t<i.length;t++){let e=i[t];if(t==i.length-1||e.top<e.bottom&&e.left<e.right)return e}}return null}(t,n)}measureVisibleLineHeights(e){let t=[],{from:n,to:i}=e,r=this.view.contentDOM.clientWidth,s=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,a=this.view.textDirection==Xr.LTR,l=0,c=(e,u,h)=>{for(let d=0;d<e.children.length&&!(u>i);d++){let i=e.children[d],p=u+i.length,f=i.dom.getBoundingClientRect(),{height:m}=f;if(h&&!d&&(l+=f.top-h.top),i instanceof Ks)p>n&&c(i,u,f);else if(u>=n&&(l>0&&t.push(-l),t.push(m+l),l=0,s)){let e=i.dom.lastChild,t=e?Ar(e):[];if(t.length){let e=t[t.length-1],n=a?e.right-f.left:f.right-e.left;n>o&&(o=n,this.minWidth=r,this.minWidthFrom=u,this.minWidthTo=p)}}h&&d==e.children.length-1&&(l+=h.bottom-f.bottom),u=p+i.breakAfter}};return c(this.tile,0,null),t}textDirectionAt(e){let{tile:t}=this.tile.resolveBlock(e,1);return"rtl"==getComputedStyle(t.dom).direction?Xr.RTL:Xr.LTR}measureTextSize(){let e=this.tile.blockTiles(e=>{if(e.isLine()&&e.children.length&&e.length<=20){let t,n=0;for(let i of e.children){if(!i.isText()||/[^ -~]/.test(i.text))return;let e=Ar(i.dom);if(1!=e.length)return;n+=e[0].width,t=e[0].height}if(n)return{lineHeight:e.dom.getBoundingClientRect().height,charWidth:n/e.length,textHeight:t}}});if(e)return e;let t,n,i,r=document.createElement("div");return r.className="cm-line",r.style.width="99999px",r.style.position="absolute",r.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(r);let e=Ar(r.firstChild)[0];t=r.getBoundingClientRect().height,n=e&&e.width?e.width/27:7,i=e&&e.height?e.height:t,r.remove()}),{lineHeight:t,charWidth:n,textHeight:i}}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,i=0;;i++){let r=i==t.viewports.length?null:t.viewports[i],s=r?r.from-1:this.view.state.doc.length;if(s>n){let i=(t.lineBlockAt(s).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(vr.replace({widget:new xo(i),block:!0,inclusive:!0,isBlockGap:!0}).range(n,s))}if(!r)break;n=r.to+1}return vr.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Is).map(t=>(this.dynamicDecorationMap[e++]="function"==typeof t)?t(this.view):t),n=!1,i=this.view.state.facet(Qs).map((e,t)=>{let i="function"==typeof e;return i&&(n=!0),i?e(this.view):e});for(i.length&&(this.dynamicDecorationMap[e++]=n,t.push(Si.join(i))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(Bs).map(e=>"function"==typeof e?e(this.view):e)}scrollIntoView(e){if(e.isSnapshot){let t=this.view.viewState.lineBlockAt(e.range.head);return this.view.scrollDOM.scrollTop=t.top-e.yMargin,void(this.view.scrollDOM.scrollLeft=e.xMargin)}for(let l of this.view.state.facet(Ds))try{if(l(this.view,e.range,e))return!0}catch(Kre){Es(this.view.state,Kre,"scroll handler")}let t,{range:n}=e,i=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1);if(!i)return;!n.empty&&(t=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(i={left:Math.min(i.left,t.left),top:Math.min(i.top,t.top),right:Math.max(i.right,t.right),bottom:Math.max(i.bottom,t.bottom)});let r=Ws(this.view),s={left:i.left-r.left,top:i.top-r.top,right:i.right+r.right,bottom:i.bottom+r.bottom},{offsetWidth:o,offsetHeight:a}=this.view.scrollDOM;!function(e,t,n,i,r,s,o,a){let l=e.ownerDocument,c=l.defaultView||window;for(let u=e,h=!1;u&&!h;)if(1==u.nodeType){let e,d=u==l.body,p=1,f=1;if(d)e=Rr(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(h=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let t=u.getBoundingClientRect();({scaleX:p,scaleY:f}=Nr(u,t)),e={left:t.left,right:t.left+u.clientWidth*p,top:t.top,bottom:t.top+u.clientHeight*f}}let m=0,g=0;if("nearest"==r)t.top<e.top?(g=t.top-(e.top+o),n>0&&t.bottom>e.bottom+g&&(g=t.bottom-e.bottom+o)):t.bottom>e.bottom&&(g=t.bottom-e.bottom+o,n<0&&t.top-g<e.top&&(g=t.top-(e.top+o)));else{let i=t.bottom-t.top,s=e.bottom-e.top;g=("center"==r&&i<=s?t.top+i/2-s/2:"start"==r||"center"==r&&n<0?t.top-o:t.bottom-s+o)-e.top}if("nearest"==i?t.left<e.left?(m=t.left-(e.left+s),n>0&&t.right>e.right+m&&(m=t.right-e.right+s)):t.right>e.right&&(m=t.right-e.right+s,n<0&&t.left<e.left+m&&(m=t.left-(e.left+s))):m=("center"==i?t.left+(t.right-t.left)/2-(e.right-e.left)/2:"start"==i==a?t.left-s:t.right-(e.right-e.left)+s)-e.left,m||g)if(d)c.scrollBy(m,g);else{let e=0,n=0;if(g){let e=u.scrollTop;u.scrollTop+=g/f,n=(u.scrollTop-e)*f}if(m){let t=u.scrollLeft;u.scrollLeft+=m/p,e=(u.scrollLeft-t)*p}t={left:t.left-e,top:t.top-n,right:t.right-e,bottom:t.bottom-n},e&&Math.abs(e-m)<1&&(i="nearest"),n&&Math.abs(n-g)<1&&(r="nearest")}if(d)break;(t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)&&(t={left:Math.max(t.left,e.left),right:Math.min(t.right,e.right),top:Math.max(t.top,e.top),bottom:Math.min(t.bottom,e.bottom)}),u=u.assignedSlot||u.parentNode}else{if(11!=u.nodeType)break;u=u.host}}(this.view.scrollDOM,s,n.head<n.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==Xr.LTR)}lineHasWidget(e){let t=e=>e.isWidget()||e.children.some(t);return t(this.tile.resolveBlock(e,1).tile)}destroy(){Oo(this.tile)}}function Oo(e,t){let n=null===t||void 0===t?void 0:t.get(e);if(1!=n){null==n&&e.destroy();for(let n of e.children)Oo(n,t)}}function wo(e,t){let n=e.observer.selectionRange;if(!n.focusNode)return null;let i=Wr(n.focusNode,n.focusOffset),r=Vr(n.focusNode,n.focusOffset),s=i||r;if(r&&i&&r.node!=i.node){let t=Zs.get(r.node);if(!t||t.isText()&&t.text!=r.node.nodeValue)s=r;else if(e.docView.lastCompositionAfterCursor){let e=Zs.get(i.node);!e||e.isText()&&e.text!=i.node.nodeValue||(s=r)}}if(e.docView.lastCompositionAfterCursor=s!=i,!s)return null;let o=t-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}let bo=class{constructor(){this.changes=[]}compareRange(e,t){kr(e,t,this.changes)}comparePoint(e,t){kr(e,t,this.changes)}boundChange(e){kr(e,e,this.changes)}};class ko{constructor(){this.changes=[]}compareRange(e,t){kr(e,t,this.changes)}comparePoint(){}boundChange(e){kr(e,e,this.changes)}}class xo extends mr{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function Do(e,t,n){let i=e.lineBlockAt(t);if(Array.isArray(i.type)){let e;for(let r of i.type){if(r.from>t)break;if(!(r.to<t)){if(r.from<t&&r.to>t)return r;e&&(r.type!=gr.Text||e.type==r.type&&!(n<0?r.from<t:r.to>t))||(e=r)}}return e||i}return i}function So(e,t,n,i){let r=e.state.doc.lineAt(t.head),s=e.bidiSpans(r),o=e.textDirectionAt(r.from);for(let a=t,l=null;;){let t=hs(r,s,o,a,n),c=us;if(!t){if(r.number==(n?e.state.doc.lines:1))return a;c="\n",r=e.state.doc.line(r.number+(n?1:-1)),s=e.bidiSpans(r),t=e.visualLineSide(r,!n)}if(l){if(!l(c))return a}else{if(!i)return t;l=i(c)}a=t}}function Co(e,t,n){for(;;){let i=0;for(let r of e)r.between(t-1,t+1,(e,r,s)=>{if(t>e&&t<r){let s=i||n||(t-e<r-t?-1:1);t=s<0?e:r,i=s}});if(!i)return t}}function Ao(e,t){let n=null;for(let i=0;i<t.ranges.length;i++){let r=t.ranges[i],s=null;if(r.empty){let t=Co(e,r.from,0);t!=r.from&&(s=An.cursor(t,-1))}else{let t=Co(e,r.from,-1),n=Co(e,r.to,1);t==r.from&&n==r.to||(s=An.range(r.from==r.anchor?t:n,r.from==r.head?t:n))}s&&(n||(n=t.ranges.slice()),n[i]=s)}return n?An.create(n,t.mainIndex):t}function Eo(e,t,n){let i=Co(e.state.facet(Ls).map(t=>t(e)),n.from,t.head>n.from?-1:1);return i==n.from?n:An.cursor(i,i<n.from?1:-1)}class _o{constructor(e,t){this.pos=e,this.assoc=t}}function To(e,t,n,i){let r,s=e.contentDOM.getBoundingClientRect(),o=s.top+e.viewState.paddingTop,{x:a,y:l}=t,c=l-o;for(;;){if(c<0)return new _o(0,1);if(c>e.viewState.docHeight)return new _o(e.state.doc.length,-1);if(r=e.elementAtHeight(c),null==i)break;if(r.type==gr.Text){if(i<0?r.to<e.viewport.from:r.from>e.viewport.to)break;let t=e.docView.coordsAt(i<0?r.from:r.to,i);if(t&&(i<0?t.top<=c+o:t.bottom>=c+o))break}let t=e.viewState.heightOracle.textHeight/2;c=i>0?r.bottom+t:r.top-t}if(e.viewport.from>=r.to||e.viewport.to<=r.from){if(n)return null;if(r.type==gr.Text){let t=function(e,t,n,i,r){let s=Math.round((i-t.left)*e.defaultCharacterWidth);if(e.lineWrapping&&n.height>1.5*e.defaultLineHeight){let t=e.viewState.heightOracle.textHeight;s+=Math.floor((r-n.top-.5*(e.defaultLineHeight-t))/t)*e.viewState.heightOracle.lineLength}let o=e.state.sliceDoc(n.from,n.to);return n.from+Qi(o,s,e.state.tabSize)}(e,s,r,a,l);return new _o(t,t==r.from?1:-1)}}if(r.type!=gr.Text)return c<(r.top+r.bottom)/2?new _o(r.from,1):new _o(r.to,-1);let u=e.docView.lineAt(r.from,2);return u&&u.length==r.length||(u=e.docView.lineAt(r.from,-2)),Po(e,u,r.from,a,l)}function Po(e,t,n,i,r){let s=-1,o=null,a=1e9,l=1e9,c=r,u=r,h=(e,t)=>{for(let n=0;n<e.length;n++){let h=e[n];if(h.top==h.bottom)continue;let d=h.left>i?h.left-i:h.right<i?i-h.right:0,p=h.top>r?h.top-r:h.bottom<r?r-h.bottom:0;h.top<=u&&h.bottom>=c&&(c=Math.min(h.top,c),u=Math.max(h.bottom,u),p=0),(s<0||(p-l||d-a)<0)&&(s>=0&&l&&a<d&&o.top<=u-2&&o.bottom>=c+2?l=0:(s=t,a=d,l=p,o=h))}};if(t.isText()){for(let e=0;e<t.length;){let n=dn(t.text,e);if(h(jr(t.dom,e,n).getClientRects(),e),!a&&!l)break;e=n}return i>(o.left+o.right)/2==(Mo(e,s+n)==Xr.LTR)?new _o(n+dn(t.text,s),-1):new _o(n+s,1)}{if(!t.length)return new _o(n,1);for(let e=0;e<t.children.length;e++){let n=t.children[e];if(!(48&n.flags)&&(h((1==n.dom.nodeType?n.dom:jr(n.dom,0,n.length)).getClientRects(),e),!a&&!l))break}let c=t.children[s],u=t.posBefore(c,n);return c.isComposite()||c.isText()?Po(e,c,u,Math.max(o.left,Math.min(o.right,i)),r):i>(o.left+o.right)/2==(Mo(e,s+n)==Xr.LTR)?new _o(u+c.length,-1):new _o(u,1)}}function Mo(e,t){let n=e.state.doc.lineAt(t);return e.bidiSpans(n)[ns.find(e.bidiSpans(n),t-n.from,-1,1)].dir}const Fo="\uffff";class Ro{constructor(e,t){this.points=e,this.view=t,this.text="",this.lineSeparator=t.state.facet(yi.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Fo}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let i=e;;){this.findPointBefore(n,i);let e=this.text.length;this.readNode(i);let r=Zs.get(i),s=i.nextSibling;if(s==t){(null===r||void 0===r?void 0:r.breakAfter)&&!s&&n!=this.view.contentDOM&&this.lineBreak();break}let o=Zs.get(s);(r&&o?r.breakAfter:(r?r.breakAfter:Tr(i))||Tr(s)&&("BR"!=i.nodeName||(null===r||void 0===r?void 0:r.isWidget()))&&this.text.length>e)&&!Io(s,t)&&this.lineBreak(),i=s}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let r,s=-1,o=1;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(r=i.exec(t))&&(s=r.index,o=r[0].length),this.append(t.slice(n,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let t of this.points)t.node==e&&t.pos>this.text.length&&(t.pos-=o-1);n=s+o}}readNode(e){let t=Zs.get(e),n=t&&t.overrideDOMText;if(null!=n){this.findPointInside(e,n.length);for(let e=n.iter();!e.next().done;)e.lineBreak?this.lineBreak():this.append(e.value)}else 3==e.nodeType?this.readTextNode(e):"BR"==e.nodeName?e.nextSibling&&this.lineBreak():1==e.nodeType&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(3==e.nodeType?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(No(e,n.node,n.offset)?t:0))}}function No(e,t,n){for(;;){if(!t||n<Mr(t))return!1;if(t==e)return!0;n=_r(t)+1,t=t.parentNode}}function Io(e,t){let n;for(;e!=t&&e;e=e.nextSibling){let t=Zs.get(e);if(!(null===t||void 0===t?void 0:t.isWidget()))return!1;t&&(n||(n=[])).push(t)}if(n)for(let i of n){let e=i.overrideDOMText;if(null===e||void 0===e?void 0:e.length)return!1}return!0}class Bo{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class Qo{constructor(e,t,n,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:r,impreciseAnchor:s}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=Lo(e.docView.tile,t,n,0))){let t=r||s?[]:function(e){let t=[];if(e.root.activeElement!=e.contentDOM)return t;let{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}=e.observer.selectionRange;n&&(t.push(new Bo(n,i)),r==n&&s==i||t.push(new Bo(r,s)));return t}(e),n=new Ro(t,e);n.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=n.text,this.newSel=function(e,t){if(0==e.length)return null;let n=e[0].pos,i=2==e.length?e[1].pos:n;return n>-1&&i>-1?An.single(n+t,i+t):null}(t,this.bounds.from)}else{let t=e.observer.selectionRange,n=r&&r.node==t.focusNode&&r.offset==t.focusOffset||!Sr(e.contentDOM,t.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(t.focusNode,t.focusOffset),i=s&&s.node==t.anchorNode&&s.offset==t.anchorOffset||!Sr(e.contentDOM,t.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(t.anchorNode,t.anchorOffset),o=e.viewport;if((cr.ios||cr.chrome)&&e.state.selection.main.empty&&n!=i&&(o.from>0||o.to<e.state.doc.length)){let t=Math.min(n,i),r=Math.max(n,i),s=o.from-t,a=o.to-r;0!=s&&1!=s&&0!=t||0!=a&&-1!=a&&r!=e.state.doc.length||(n=0,i=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(An.range(i,n)):this.newSel=An.single(i,n)}}}function Lo(e,t,n,i){if(e.isComposite()){let r=-1,s=-1,o=-1,a=-1;for(let l=0,c=i,u=i;l<e.children.length;l++){let i=e.children[l],h=c+i.length;if(c<t&&h>n)return Lo(i,t,n,c);if(h>=t&&-1==r&&(r=l,s=c),c>n&&i.dom.parentNode==e.dom){o=l,a=u;break}u=h,c=h+i.breakAfter}return{from:s,to:a<0?i+e.length:a,startDOM:(r?e.children[r-1].dom.nextSibling:null)||e.dom.firstChild,endDOM:o<e.children.length&&o>=0?e.children[o].dom:null}}return e.isText()?{from:i,to:i+e.length,startDOM:e.dom,endDOM:e.dom.nextSibling}:null}function jo(e,t){let n,{newSel:i}=t,r=e.state.selection.main,s=e.inputState.lastKeyTime>Date.now()-100?e.inputState.lastKeyCode:-1;if(t.bounds){let{from:i,to:o}=t.bounds,a=r.from,l=null;(8===s||cr.android&&t.text.length<o-i)&&(a=r.to,l="end");let c=zo(e.state.doc.sliceString(i,o,Fo),t.text,a-i,l);c&&(cr.chrome&&13==s&&c.toB==c.from+2&&t.text.slice(c.from,c.toB)==Fo+Fo&&c.toB--,n={from:i+c.from,to:i+c.toA,insert:tn.of(t.text.slice(c.from,c.toB).split(Fo))})}else i&&(!e.hasFocus&&e.state.facet(_s)||Wo(i,r))&&(i=null);if(!n&&!i)return!1;if(!n&&t.typeOver&&!r.empty&&i&&i.main.empty?n={from:r.from,to:r.to,insert:e.state.doc.slice(r.from,r.to)}:(cr.mac||cr.android)&&n&&n.from==n.to&&n.from==r.head-1&&/^\. ?$/.test(n.insert.toString())&&"off"==e.contentDOM.getAttribute("autocorrect")?(i&&2==n.insert.length&&(i=An.single(i.main.anchor-1,i.main.head-1)),n={from:n.from,to:n.to,insert:tn.of([n.insert.toString().replace("."," ")])}):n&&n.from>=r.from&&n.to<=r.to&&(n.from!=r.from||n.to!=r.to)&&r.to-r.from-(n.to-n.from)<=4?n={from:r.from,to:r.to,insert:e.state.doc.slice(r.from,n.from).append(n.insert).append(e.state.doc.slice(n.to,r.to))}:e.state.doc.lineAt(r.from).to<r.to&&e.docView.lineHasWidget(r.to)&&e.inputState.insertingTextAt>Date.now()-50?n={from:r.from,to:r.to,insert:e.state.toText(e.inputState.insertingText)}:cr.chrome&&n&&n.from==n.to&&n.from==r.head&&"\n "==n.insert.toString()&&e.lineWrapping&&(i&&(i=An.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:tn.of([" "])}),n)return $o(e,n,i,s);if(i&&!Wo(i,r)){let t=!1,n="select";return e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(t=!0),n=e.inputState.lastSelectionOrigin,"select.pointer"==n&&(i=Ao(e.state.facet(Ls).map(t=>t(e)),i))),e.dispatch({selection:i,scrollIntoView:t,userEvent:n}),!0}return!1}function $o(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if(cr.ios&&e.inputState.flushIOSKey(t))return!0;let r=e.state.selection.main;if(cr.android&&(t.to==r.to&&(t.from==r.from||t.from==r.from-1&&" "==e.state.sliceDoc(t.from,r.from))&&1==t.insert.length&&2==t.insert.lines&&$r(e.contentDOM,"Enter",13)||(t.from==r.from-1&&t.to==r.to&&0==t.insert.length||8==i&&t.insert.length<t.to-t.from&&t.to>r.head)&&$r(e.contentDOM,"Backspace",8)||t.from==r.from&&t.to==r.to+1&&0==t.insert.length&&$r(e.contentDOM,"Delete",46)))return!0;let s,o=t.insert.toString();e.inputState.composing>=0&&e.inputState.composing++;let a=()=>s||(s=function(e,t,n){let i,r=e.state,s=r.selection.main,o=-1;if(t.from==t.to&&t.from<s.from||t.from>s.to){let n=t.from<s.from?-1:1,i=n<0?s.from:s.to,a=Co(r.facet(Ls).map(t=>t(e)),i,n);t.from==a&&(o=a)}if(o>-1)i={changes:t,selection:An.cursor(t.from+t.insert.length,-1)};else if(t.from>=s.from&&t.to<=s.to&&t.to-t.from>=(s.to-s.from)/3&&(!n||n.main.empty&&n.main.from==t.from+t.insert.length)&&e.inputState.composing<0){let n=s.from<t.from?r.sliceDoc(s.from,t.from):"",o=s.to>t.to?r.sliceDoc(t.to,s.to):"";i=r.replaceSelection(e.state.toText(n+t.insert.sliceString(0,void 0,e.state.lineBreak)+o))}else{let o=r.changes(t),a=n&&n.main.to<=o.newLength?n.main:void 0;if(r.selection.ranges.length>1&&(e.inputState.composing>=0||e.inputState.compositionPendingChange)&&t.to<=s.to+10&&t.to>=s.to-10){let l,c=e.state.sliceDoc(t.from,t.to),u=n&&wo(e,n.main.head);if(u){let e=t.insert.length-(t.to-t.from);l={from:u.from,to:u.to-e}}else l=e.state.doc.lineAt(s.head);let h=s.to-t.to;i=r.changeByRange(n=>{if(n.from==s.from&&n.to==s.to)return{changes:o,range:a||n.map(o)};let i=n.to-h,u=i-c.length;if(e.state.sliceDoc(u,i)!=c||i>=l.from&&u<=l.to)return{range:n};let d=r.changes({from:u,to:i,insert:t.insert}),p=n.to-s.to;return{changes:d,range:a?An.range(Math.max(0,a.anchor+p),Math.max(0,a.head+p)):n.map(d)}})}else i={changes:o,selection:a&&r.selection.replaceRange(a)}}let a="input.type";(e.composing||e.inputState.compositionPendingChange&&e.inputState.compositionEndedAt>Date.now()-50)&&(e.inputState.compositionPendingChange=!1,a+=".compose",e.inputState.compositionFirstChange&&(a+=".start",e.inputState.compositionFirstChange=!1));return r.update(i,{userEvent:a,scrollIntoView:!0})}(e,t,n));return e.state.facet(ys).some(n=>n(e,t.from,t.to,o,a))||e.dispatch(a()),!0}function zo(e,t,n,i){let r=Math.min(e.length,t.length),s=0;for(;s<r&&e.charCodeAt(s)==t.charCodeAt(s);)s++;if(s==r&&e.length==t.length)return null;let o=e.length,a=t.length;for(;o>0&&a>0&&e.charCodeAt(o-1)==t.charCodeAt(a-1);)o--,a--;if("end"==i){n-=o+Math.max(0,s-Math.min(o,a))-s}if(o<s&&e.length<t.length){s-=n<=s&&n>=o?s-n:0,a=s+(a-o),o=s}else if(a<s){s-=n<=s&&n>=a?s-n:0,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function Wo(e,t){return t.head==e.main.head&&t.anchor==e.main.anchor}class Vo{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,cr.safari&&e.contentDOM.addEventListener("input",()=>null),cr.gecko&&function(e){fa.has(e)||(fa.add(e),e.addEventListener("copy",()=>{}),e.addEventListener("cut",()=>{}))}(e.contentDOM.ownerDocument)}handleEvent(e){(function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n,i=t.target;i!=e.contentDOM;i=i.parentNode)if(!i||11==i.nodeType||(n=Zs.get(i))&&n.isWidget()&&!n.isHidden&&n.widget.ignoreEvent(t))return!1;return!0})(this.view,e)&&!this.ignoreDuringComposition(e)&&("keydown"==e.type&&this.keydown(e)||(0!=this.view.updateState?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e)))}runHandlers(e,t){let n=this.handlers[e];if(n){for(let e of n.observers)e(this.view,t);for(let e of n.handlers){if(t.defaultPrevented)break;if(e(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=Xo(e),n=this.handlers,i=this.view.contentDOM;for(let r in t)if("scroll"!=r){let e=!t[r].handlers.length,s=n[r];s&&e!=!s.handlers.length&&(i.removeEventListener(r,this.handleEvent),s=null),s||i.addEventListener(r,this.handleEvent,{passive:e})}for(let r in n)"scroll"==r||t[r]||i.removeEventListener(r,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),9==e.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&27!=e.keyCode&&Ho.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),cr.android&&cr.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return!cr.ios||e.synthetic||e.altKey||e.metaKey||!((t=qo.find(t=>t.keyCode==e.keyCode))&&!e.ctrlKey||Zo.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(229!=e.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0)}flushIOSKey(e){let t=this.pendingIOSKey;return!!t&&(!("Enter"==t.key&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString()))&&(this.pendingIOSKey=void 0,$r(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0)))}ignoreDuringComposition(e){return!(!/^key/.test(e.type)||e.synthetic)&&(this.composing>0||!!(cr.safari&&!cr.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Uo(e,t){return(n,i)=>{try{return t.call(e,i,n)}catch(Kre){Es(n.state,Kre)}}}function Xo(e){let t=Object.create(null);function n(e){return t[e]||(t[e]={observers:[],handlers:[]})}for(let i of e){let e=i.spec,t=e&&e.plugin.domEventHandlers,r=e&&e.plugin.domEventObservers;if(t)for(let s in t){let e=t[s];e&&n(s).handlers.push(Uo(i.value,e))}if(r)for(let s in r){let e=r[s];e&&n(s).observers.push(Uo(i.value,e))}}for(let i in Ko)n(i).handlers.push(Ko[i]);for(let i in Jo)n(i).observers.push(Jo[i]);return t}const qo=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Zo="dthko",Ho=[16,17,18,20,91,92,224,225];function Yo(e){return.7*Math.max(0,e)+8}class Go{constructor(e,t,n,i){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=function(e){let t,n,i=e.ownerDocument;for(let r=e.parentNode;r&&!(r==i.body||t&&n);)if(1==r.nodeType)!n&&r.scrollHeight>r.clientHeight&&(n=r),!t&&r.scrollWidth>r.clientWidth&&(t=r),r=r.assignedSlot||r.parentNode;else{if(11!=r.nodeType)break;r=r.host}return{x:t,y:n}}(e.contentDOM),this.atoms=e.state.facet(Ls).map(t=>t(e));let r=e.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(yi.allowMultipleSelections)&&function(e,t){let n=e.state.facet(ps);return n.length?n[0](t):cr.mac?t.metaKey:t.ctrlKey}(e,t),this.dragging=!(!function(e,t){let{main:n}=e.state.selection;if(n.empty)return!1;let i=Dr(e.root);if(!i||0==i.rangeCount)return!0;let r=i.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let e=r[s];if(e.left<=t.clientX&&e.right>=t.clientX&&e.top<=t.clientY&&e.bottom>=t.clientY)return!0}return!1}(e,t)||1!=la(t))&&null}start(e){!1===this.dragging&&this.select(e)}move(e){if(0==e.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(t=this.startEvent,n=e,Math.max(Math.abs(t.clientX-n.clientX),Math.abs(t.clientY-n.clientY))<10))return;var t,n;this.select(this.lastEvent=e);let i=0,r=0,s=0,o=0,a=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:o,bottom:l}=this.scrollParents.y.getBoundingClientRect());let c=Ws(this.view);e.clientX-c.left<=s+6?i=-Yo(s-e.clientX):e.clientX+c.right>=a-6&&(i=Yo(e.clientX-a)),e.clientY-c.top<=o+6?r=-Yo(o-e.clientY):e.clientY+c.bottom>=l-6&&(r=Yo(e.clientY-l)),this.setScrollSpeed(i,r)}up(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),!1===this.dragging&&this.select(this.lastEvent)}select(e){let{view:t}=this,n=Ao(this.atoms,this.style.get(e,this.extend,this.multiple));!this.mustSelect&&n.eq(t.state.selection,!1===this.dragging)||this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}const Ko=Object.create(null),Jo=Object.create(null),ea=cr.ie&&cr.ie_version<15||cr.ios&&cr.webkit_version<604;function ta(e,t,n){for(let i of e.facet(t))n=i(n,e);return n}function na(e,t){t=ta(e.state,ws,t);let n,{state:i}=e,r=1,s=i.toText(t),o=s.lines==i.selection.ranges.length;if(null!=ua&&i.selection.ranges.every(e=>e.empty)&&ua==s.toString()){let e=-1;n=i.changeByRange(n=>{let a=i.doc.lineAt(n.from);if(a.from==e)return{range:n};e=a.from;let l=i.toText((o?s.line(r++).text:t)+i.lineBreak);return{changes:{from:a.from,insert:l},range:An.cursor(n.from+l.length)}})}else n=o?i.changeByRange(e=>{let t=s.line(r++);return{changes:{from:e.from,to:e.to,insert:t.text},range:An.cursor(e.from+t.length)}}):i.replaceSelection(s);e.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}function ia(e,t,n,i){if(1==i)return An.cursor(t,n);if(2==i)return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=e.charCategorizer(t),r=e.doc.lineAt(t),s=t-r.from;if(0==r.length)return An.cursor(t);0==s?n=1:s==r.length&&(n=-1);let o=s,a=s;n<0?o=dn(r.text,s,!1):a=dn(r.text,s);let l=i(r.text.slice(o,a));for(;o>0;){let e=dn(r.text,o,!1);if(i(r.text.slice(e,o))!=l)break;o=e}for(;a<r.length;){let e=dn(r.text,a);if(i(r.text.slice(a,e))!=l)break;a=e}return An.range(o+r.from,a+r.from)}(e.state,t,n);{let i=e.docView.lineAt(t,n),r=e.state.doc.lineAt(i?i.posAtEnd:t),s=i?i.posAtStart:r.from,o=i?i.posAtEnd:r.to;return o<e.state.doc.length&&o==r.to&&o++,An.range(s,o)}}Jo.scroll=e=>{e.inputState.lastScrollTop=e.scrollDOM.scrollTop,e.inputState.lastScrollLeft=e.scrollDOM.scrollLeft},Ko.keydown=(e,t)=>(e.inputState.setSelectionOrigin("select"),27==t.keyCode&&0!=e.inputState.tabFocusMode&&(e.inputState.tabFocusMode=Date.now()+2e3),!1),Jo.touchstart=(e,t)=>{e.inputState.lastTouchTime=Date.now(),e.inputState.setSelectionOrigin("select.pointer")},Jo.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")},Ko.mousedown=(e,t)=>{if(e.observer.flush(),e.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let i of e.state.facet(ms))if(n=i(e,t),n)break;if(n||0!=t.button||(n=function(e,t){let n=e.posAndSideAtCoords({x:t.clientX,y:t.clientY},!1),i=la(t),r=e.state.selection;return{update(e){e.docChanged&&(n.pos=e.changes.mapPos(n.pos),r=r.map(e.changes))},get(t,s,o){let a,l=e.posAndSideAtCoords({x:t.clientX,y:t.clientY},!1),c=ia(e,l.pos,l.assoc,i);if(n.pos!=l.pos&&!s){let t=ia(e,n.pos,n.assoc,i),r=Math.min(t.from,c.from),s=Math.max(t.to,c.to);c=r<c.from?An.range(r,s):An.range(s,r)}return s?r.replaceRange(r.main.extend(c.from,c.to)):o&&1==i&&r.ranges.length>1&&(a=function(e,t){for(let n=0;n<e.ranges.length;n++){let{from:i,to:r}=e.ranges[n];if(i<=t&&r>=t)return An.create(e.ranges.slice(0,n).concat(e.ranges.slice(n+1)),e.mainIndex==n?0:e.mainIndex-(e.mainIndex>n?1:0))}return null}(r,l.pos))?a:o?r.addRange(c):An.create([c])}}}(e,t)),n){let i=!e.hasFocus;e.inputState.startMouseSelection(new Go(e,t,n,i)),i&&e.observer.ignore(()=>{Lr(e.contentDOM);let t=e.root.activeElement;t&&!t.contains(e.contentDOM)&&t.blur()});let r=e.inputState.mouseSelection;if(r)return r.start(t),!1===r.dragging}else e.inputState.setSelectionOrigin("select.pointer");return!1};const ra=cr.ie&&cr.ie_version<=11;let sa=null,oa=0,aa=0;function la(e){if(!ra)return e.detail;let t=sa,n=aa;return sa=e,aa=Date.now(),oa=!t||n>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(oa+1)%3:1}function ca(e,t,n,i){if(!(n=ta(e.state,ws,n)))return;let r=e.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:s}=e.inputState,o=i&&s&&function(e,t){let n=e.state.facet(fs);return n.length?n[0](t):cr.mac?!t.altKey:!t.ctrlKey}(e,t)?{from:s.from,to:s.to}:null,a={from:r,insert:n},l=e.state.changes(o?[o,a]:a);e.focus(),e.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),e.inputState.draggedContent=null}Ko.dragstart=(e,t)=>{let{selection:{main:n}}=e.state;if(t.target.draggable){let i=e.docView.tile.nearest(t.target);if(i&&i.isWidget()){let e=i.posAtStart,t=e+i.length;(e>=n.to||t<=n.from)&&(n=An.range(e,t))}}let{inputState:i}=e;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=n,t.dataTransfer&&(t.dataTransfer.setData("Text",ta(e.state,bs,e.state.sliceDoc(n.from,n.to))),t.dataTransfer.effectAllowed="copyMove"),!1},Ko.dragend=e=>(e.inputState.draggedContent=null,!1),Ko.drop=(e,t)=>{if(!t.dataTransfer)return!1;if(e.state.readOnly)return!0;let n=t.dataTransfer.files;if(n&&n.length){let i=Array(n.length),r=0,s=()=>{++r==n.length&&ca(e,t,i.filter(e=>null!=e).join(e.state.lineBreak),!1)};for(let e=0;e<n.length;e++){let t=new FileReader;t.onerror=s,t.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(t.result)||(i[e]=t.result),s()},t.readAsText(n[e])}return!0}{let n=t.dataTransfer.getData("Text");if(n)return ca(e,t,n,!0),!0}return!1},Ko.paste=(e,t)=>{if(e.state.readOnly)return!0;e.observer.flush();let n=ea?null:t.clipboardData;return n?(na(e,n.getData("text/plain")||n.getData("text/uri-list")),!0):(function(e){let t=e.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{e.focus(),n.remove(),na(e,n.value)},50)}(e),!1)};let ua=null;Ko.copy=Ko.cut=(e,t)=>{let n=Dr(e.root);if(n&&!Cr(e.contentDOM,n))return!1;let{text:i,ranges:r,linewise:s}=function(e){let t=[],n=[],i=!1;for(let r of e.selection.ranges)r.empty||(t.push(e.sliceDoc(r.from,r.to)),n.push(r));if(!t.length){let r=-1;for(let{from:i}of e.selection.ranges){let s=e.doc.lineAt(i);s.number>r&&(t.push(s.text),n.push({from:s.from,to:Math.min(e.doc.length,s.to+1)})),r=s.number}i=!0}return{text:ta(e,bs,t.join(e.lineBreak)),ranges:n,linewise:i}}(e.state);if(!i&&!s)return!1;ua=s?i:null,"cut"!=t.type||e.state.readOnly||e.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"});let o=ea?null:t.clipboardData;return o?(o.clearData(),o.setData("text/plain",i),!0):(function(e,t){let n=e.dom.parentNode;if(!n)return;let i=n.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=t,i.focus(),i.selectionEnd=t.length,i.selectionStart=0,setTimeout(()=>{i.remove(),e.focus()},50)}(e,i),!1)};const ha=ii.define();function da(e,t){let n=[];for(let i of e.facet(Os)){let r=i(e,t);r&&n.push(r)}return n.length?e.update({effects:n,annotations:ha.of(!0)}):null}function pa(e){setTimeout(()=>{let t=e.hasFocus;if(t!=e.inputState.notifiedFocused){let n=da(e.state,t);n?e.dispatch(n):e.update([])}},10)}Jo.focus=e=>{e.inputState.lastFocusTime=Date.now(),e.scrollDOM.scrollTop||!e.inputState.lastScrollTop&&!e.inputState.lastScrollLeft||(e.scrollDOM.scrollTop=e.inputState.lastScrollTop,e.scrollDOM.scrollLeft=e.inputState.lastScrollLeft),pa(e)},Jo.blur=e=>{e.observer.clearSelectionRange(),pa(e)},Jo.compositionstart=Jo.compositionupdate=e=>{e.observer.editContext||(null==e.inputState.compositionFirstChange&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0))},Jo.compositionend=e=>{e.observer.editContext||(e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionPendingKey=!0,e.inputState.compositionPendingChange=e.observer.pendingRecords().length>0,e.inputState.compositionFirstChange=null,cr.chrome&&cr.android?e.observer.flushSoon():e.inputState.compositionPendingChange?Promise.resolve().then(()=>e.observer.flush()):setTimeout(()=>{e.inputState.composing<0&&e.docView.hasComposition&&e.update([])},50))},Jo.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()},Ko.beforeinput=(e,t)=>{var n,i;if("insertText"!=t.inputType&&"insertCompositionText"!=t.inputType||(e.inputState.insertingText=t.data,e.inputState.insertingTextAt=Date.now()),"insertReplacementText"==t.inputType&&e.observer.editContext){let i=null===(n=t.dataTransfer)||void 0===n?void 0:n.getData("text/plain"),r=t.getTargetRanges();if(i&&r.length){let t=r[0],n=e.posAtDOM(t.startContainer,t.startOffset),s=e.posAtDOM(t.endContainer,t.endOffset);return $o(e,{from:n,to:s,insert:e.state.toText(i)},null),!0}}let r;if(cr.chrome&&cr.android&&(r=qo.find(e=>e.inputType==t.inputType))&&(e.observer.delayAndroidKey(r.key,r.keyCode),"Backspace"==r.key||"Delete"==r.key)){let t=(null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0;setTimeout(()=>{var n;((null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0)>t+10&&e.hasFocus&&(e.contentDOM.blur(),e.focus())},100)}return cr.ios&&"deleteContentForward"==t.inputType&&e.observer.flushSoon(),cr.safari&&"insertText"==t.inputType&&e.inputState.composing>=0&&setTimeout(()=>Jo.compositionend(e,t),20),!1};const fa=new Set;const ma=["pre-wrap","normal","pre-line","break-spaces"];let ga=!1;function va(){ga=!1}class ya{constructor(e){this.lineWrapping=e,this.doc=tn.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return ma.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let i=e[n];i<0?n++:this.heightSamples[Math.floor(10*i)]||(t=!0,this.heightSamples[Math.floor(10*i)]=!0)}return t}refresh(e,t,n,i,r,s){let o=ma.indexOf(e)>-1,a=Math.abs(t-this.lineHeight)>.3||this.lineWrapping!=o||Math.abs(n-this.charWidth)>.1;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=n,this.textHeight=i,this.lineLength=r,a){this.heightSamples={};for(let e=0;e<s.length;e++){let t=s[e];t<0?e++:this.heightSamples[Math.floor(10*t)]=!0}}return a}}class Oa{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class wa{constructor(e,t,n,i,r){this.from=e,this.length=t,this.top=n,this.height=i,this._content=r}get type(){return"number"==typeof this._content?gr.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof wr?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new wa(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var ba=function(e){return e[e.ByPos=0]="ByPos",e[e.ByHeight=1]="ByHeight",e[e.ByPosNoHeight=2]="ByPosNoHeight",e}(ba||(ba={}));const ka=.001;class xa{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this.length=e,this.height=t,this.flags=n}get outdated(){return(2&this.flags)>0}set outdated(e){this.flags=(e?2:0)|-3&this.flags}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>ka&&(ga=!0),this.height=e)}replace(e,t,n){return xa.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,i){let r=this,s=n.doc;for(let o=i.length-1;o>=0;o--){let{fromA:a,toA:l,fromB:c,toB:u}=i[o],h=r.lineAt(a,ba.ByPosNoHeight,n.setDoc(t),0,0),d=h.to>=l?h:r.lineAt(l,ba.ByPosNoHeight,n,0,0);for(u+=d.to-l,l=d.to;o>0&&h.from<=i[o-1].toA;)a=i[o-1].fromA,c=i[o-1].fromB,o--,a<h.from&&(h=r.lineAt(a,ba.ByPosNoHeight,n,0,0));c+=h.from-a,a=h.from;let p=Pa.build(n.setDoc(s),e,c,u);r=Da(r,r.replace(a,l,p))}return r.updateHeight(n,0)}static empty(){return new Aa(0,0,0)}static of(e){if(1==e.length)return e[0];let t=0,n=e.length,i=0,r=0;for(;;)if(t==n)if(i>2*r){let r=e[t-1];r.break?e.splice(--t,1,r.left,null,r.right):e.splice(--t,1,r.left,r.right),n+=1+r.break,i-=r.size}else{if(!(r>2*i))break;{let t=e[n];t.break?e.splice(n,1,t.left,null,t.right):e.splice(n,1,t.left,t.right),n+=2+t.break,r-=t.size}}else if(i<r){let n=e[t++];n&&(i+=n.size)}else{let t=e[--n];t&&(r+=t.size)}let s=0;return null==e[t-1]?(s=1,t--):null==e[t]&&(s=1,n++),new _a(xa.of(e.slice(0,t)),s,xa.of(e.slice(n)))}}function Da(e,t){return e==t?e:(e.constructor!=t.constructor&&(ga=!0),t)}xa.prototype.size=1;const Sa=vr.replace({});class Ca extends xa{constructor(e,t,n){super(e,t),this.deco=n,this.spaceAbove=0}mainBlock(e,t){return new wa(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,t,n,i){return this.spaceAbove&&e<n+this.spaceAbove?new wa(i,0,n,this.spaceAbove,Sa):this.mainBlock(n,i)}lineAt(e,t,n,i,r){let s=this.mainBlock(i,r);return this.spaceAbove?this.blockAt(0,n,i,r).join(s):s}forEachLine(e,t,n,i,r,s){e<=r+this.length&&t>=r&&s(this.lineAt(0,ba.ByPos,n,i,r))}setMeasuredHeight(e){let t=e.heights[e.index++];t<0?(this.spaceAbove=-t,t=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(t)}updateHeight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>3?arguments[3]:void 0;return n&&n.from<=t&&n.more&&this.setMeasuredHeight(n),this.outdated=!1,this}toString(){return"block(".concat(this.length,")")}}class Aa extends Ca{constructor(e,t,n){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=n}mainBlock(e,t){return new wa(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,t,n){let i=n[0];return 1==n.length&&(i instanceof Aa||i instanceof Ea&&4&i.flags)&&Math.abs(this.length-i.length)<10?(i instanceof Ea?i=new Aa(i.length,this.height,this.spaceAbove):i.height=this.height,this.outdated||(i.outdated=!1),i):xa.of(n)}updateHeight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;return i&&i.from<=t&&i.more?this.setMeasuredHeight(i):(n||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return"line(".concat(this.length).concat(this.collapsed?-this.collapsed:"").concat(this.widgetHeight?":"+this.widgetHeight:"",")")}}class Ea extends xa{constructor(e){super(e,0)}heightMetrics(e,t){let n,i=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,s=r-i+1,o=0;if(e.lineWrapping){let t=Math.min(this.height,e.lineHeight*s);n=t/s,this.length>s+1&&(o=(this.height-t)/(this.length-s-1))}else n=this.height/s;return{firstLine:i,lastLine:r,perLine:n,perChar:o}}blockAt(e,t,n,i){let{firstLine:r,lastLine:s,perLine:o,perChar:a}=this.heightMetrics(t,i);if(t.lineWrapping){let r=i+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),s=t.doc.lineAt(r),l=o+s.length*a,c=Math.max(n,e-l/2);return new wa(s.from,s.length,c,l,0)}{let i=Math.max(0,Math.min(s-r,Math.floor((e-n)/o))),{from:a,length:l}=t.doc.line(r+i);return new wa(a,l,n+o*i,o,0)}}lineAt(e,t,n,i,r){if(t==ba.ByHeight)return this.blockAt(e,n,i,r);if(t==ba.ByPosNoHeight){let{from:t,to:i}=n.doc.lineAt(e);return new wa(t,i-t,0,0,0)}let{firstLine:s,perLine:o,perChar:a}=this.heightMetrics(n,r),l=n.doc.lineAt(e),c=o+l.length*a,u=l.number-s,h=i+o*u+a*(l.from-r-u);return new wa(l.from,l.length,Math.max(i,Math.min(h,i+this.height-c)),c,0)}forEachLine(e,t,n,i,r,s){e=Math.max(e,r),t=Math.min(t,r+this.length);let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(n,r);for(let c=e,u=i;c<=t;){let t=n.doc.lineAt(c);if(c==e){let n=t.number-o;u+=a*n+l*(e-r-n)}let i=a+l*t.length;s(new wa(t.from,t.length,u,i,0)),u+=i,c=t.to+1}}replace(e,t,n){let i=this.length-t;if(i>0){let e=n[n.length-1];e instanceof Ea?n[n.length-1]=new Ea(e.length+i):n.push(null,new Ea(i-1))}if(e>0){let t=n[0];t instanceof Ea?n[0]=new Ea(e+t.length):n.unshift(new Ea(e-1),null)}return xa.of(n)}decomposeLeft(e,t){t.push(new Ea(e-1),null)}decomposeRight(e,t){t.push(null,new Ea(this.length-e-1))}updateHeight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,r=t+this.length;if(i&&i.from<=t+this.length&&i.more){let n=[],s=Math.max(t,i.from),o=-1;for(i.from>t&&n.push(new Ea(i.from-t-1).updateHeight(e,t));s<=r&&i.more;){let t=e.doc.lineAt(s).length;n.length&&n.push(null);let r=i.heights[i.index++],a=0;r<0&&(a=-r,r=i.heights[i.index++]),-1==o?o=r:Math.abs(r-o)>=ka&&(o=-2);let l=new Aa(t,r,a);l.outdated=!1,n.push(l),s+=t+1}s<=r&&n.push(null,new Ea(r-s).updateHeight(e,s));let a=xa.of(n);return(o<0||Math.abs(a.height-this.height)>=ka||Math.abs(o-this.heightMetrics(e,t).perLine)>=ka)&&(ga=!0),Da(this,a)}return(n||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1),this}toString(){return"gap(".concat(this.length,")")}}class _a extends xa{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return 1&this.flags}blockAt(e,t,n,i){let r=n+this.left.height;return e<r?this.left.blockAt(e,t,n,i):this.right.blockAt(e,t,r,i+this.left.length+this.break)}lineAt(e,t,n,i,r){let s=i+this.left.height,o=r+this.left.length+this.break,a=t==ba.ByHeight?e<s:e<o,l=a?this.left.lineAt(e,t,n,i,r):this.right.lineAt(e,t,n,s,o);if(this.break||(a?l.to<o:l.from>o))return l;let c=t==ba.ByPosNoHeight?ba.ByPosNoHeight:ba.ByPos;return a?l.join(this.right.lineAt(o,c,n,s,o)):this.left.lineAt(o,c,n,i,r).join(l)}forEachLine(e,t,n,i,r,s){let o=i+this.left.height,a=r+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,n,i,r,s),t>=a&&this.right.forEachLine(e,t,n,o,a,s);else{let l=this.lineAt(a,ba.ByPos,n,i,r);e<l.from&&this.left.forEachLine(e,l.from-1,n,i,r,s),l.to>=e&&l.from<=t&&s(l),t>l.to&&this.right.forEachLine(l.to+1,t,n,o,a,s)}}replace(e,t,n){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,n));let r=[];e>0&&this.decomposeLeft(e,r);let s=r.length;for(let o of n)r.push(o);if(e>0&&Ta(r,s-1),t<this.length){let e=r.length;this.decomposeRight(t,r),Ta(r,e)}return xa.of(r)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,i=n+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?xa.of(this.break?[e,null,t]:[e,t]):(this.left=Da(this.left,e),this.right=Da(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,{left:r,right:s}=this,o=t+r.length+this.break,a=null;return i&&i.from<=t+r.length&&i.more?a=r=r.updateHeight(e,t,n,i):r.updateHeight(e,t,n),i&&i.from<=o+s.length&&i.more?a=s=s.updateHeight(e,o,n,i):s.updateHeight(e,o,n),a?this.balanced(r,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Ta(e,t){let n,i;null==e[t]&&(n=e[t-1])instanceof Ea&&(i=e[t+1])instanceof Ea&&e.splice(t-1,3,new Ea(n.length+1+i.length))}class Pa{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let e=Math.min(t,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof Aa?n.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new Aa(e-this.pos,-1,0)),this.writtenTo=e,t>e&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let i=n.widget?n.widget.estimatedHeight:0,r=n.widget?n.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let s=t-e;n.block?this.addBlock(new Ca(s,i,n)):(s||r||i>=5)&&this.addLineDeco(i,r,s)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Aa(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,t){let n=new Ea(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Aa)return e;let t=new Aa(0,-1,0);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let i=this.ensureLine();i.length+=n,i.collapsed+=n,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof Aa||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new Aa(0,-1,0));let n=e;for(let i of this.nodes)i instanceof Aa&&i.updateHeight(this.oracle,n),n+=i?i.length:1;return this.nodes}static build(e,t,n,i){let r=new Pa(n,e);return Si.spans(t,n,i,r,0),r.finish(n)}}class Ma{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,i){(e<t||n&&n.heightRelevant||i&&i.heightRelevant)&&kr(e,t,this.changes,5)}}function Fa(e,t){let n=e.getBoundingClientRect(),i=e.ownerDocument,r=i.defaultView||window,s=Math.max(0,n.left),o=Math.min(r.innerWidth,n.right),a=Math.max(0,n.top),l=Math.min(r.innerHeight,n.bottom);for(let c=e.parentNode;c&&c!=i.body;)if(1==c.nodeType){let t=c,n=window.getComputedStyle(t);if((t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)&&"visible"!=n.overflow){let n=t.getBoundingClientRect();s=Math.max(s,n.left),o=Math.min(o,n.right),a=Math.max(a,n.top),l=Math.min(c==e.parentNode?r.innerHeight:l,n.bottom)}c="absolute"==n.position||"fixed"==n.position?t.offsetParent:t.parentNode}else{if(11!=c.nodeType)break;c=c.host}return{left:s-n.left,right:Math.max(s,o)-n.left,top:a-(n.top+t),bottom:Math.max(a,l)-(n.top+t)}}function Ra(e,t){let n=e.getBoundingClientRect();return{left:0,right:n.right-n.left,top:t,bottom:n.bottom-(n.top+t)}}class Na{constructor(e,t,n,i){this.from=e,this.to=t,this.size=n,this.displaySize=i}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],r=t[n];if(i.from!=r.from||i.to!=r.to||i.size!=r.size)return!1}return!0}draw(e,t){return vr.replace({widget:new Ia(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Ia extends mr{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Ba{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=$a,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Xr.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(Ns).some(e=>"function"!=typeof e&&"cm-lineWrapping"==e.class);this.heightOracle=new ya(t),this.stateDeco=za(e),this.heightMap=xa.empty().applyChanges(this.stateDeco,tn.empty,this.heightOracle.setDoc(e.doc),[new Us(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=vr.set(this.lineGaps.map(e=>e.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let i=n?t.head:t.anchor;if(!e.some(e=>{let{from:t,to:n}=e;return i>=t&&i<=n})){let{from:t,to:n}=this.lineBlockAt(i);e.push(new Qa(t,n))}}return this.viewports=e.sort((e,t)=>e.from-t.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?$a:new Wa(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Va(e,this.scaler))})}update(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.state=e.state;let n=this.stateDeco;this.stateDeco=za(this.state);let i=e.changedRanges,r=Us.extendWithRanges(i,function(e,t,n){let i=new Ma;return Si.compare(e,t,n,i,0),i.changes}(n,this.stateDeco,e?e.changes:On.empty(this.state.doc.length))),s=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);va(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),r),(this.heightMap.height!=s||ga)&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=s);let a=r.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let l=a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,e.flags|=this.updateForViewport(),(l||!e.changes.empty||2&e.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(xs)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),i=this.heightOracle,r=n.whiteSpace;this.defaultTextDirection="rtl"==n.direction?Xr.RTL:Xr.LTR;let s=this.heightOracle.mustRefreshForWrapping(r)||this.mustMeasureContent,o=t.getBoundingClientRect(),a=s||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let l=0,c=0;if(o.width&&o.height){let{scaleX:e,scaleY:n}=Nr(t,o);(e>.005&&Math.abs(this.scaleX-e)>.005||n>.005&&Math.abs(this.scaleY-n)>.005)&&(this.scaleX=e,this.scaleY=n,l|=16,s=a=!0)}let u=(parseInt(n.paddingTop)||0)*this.scaleY,h=(parseInt(n.paddingBottom)||0)*this.scaleY;this.paddingTop==u&&this.paddingBottom==h||(this.paddingTop=u,this.paddingBottom=h,l|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,l|=16);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=zr(e.scrollDOM);let p=(this.printing?Ra:Fa)(t,this.paddingTop),f=p.top-this.pixelViewport.top,m=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let g=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(g!=this.inView&&(this.inView=g,g&&(a=!0)),!this.inView&&!this.scrollTarget&&!function(e){let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView||window;return t.left<n.innerWidth&&t.right>0&&t.top<n.innerHeight&&t.bottom>0}(e.dom))return 0;let v=o.width;if(this.contentDOMWidth==v&&this.editorHeight==e.scrollDOM.clientHeight||(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,l|=16),a){let t=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(t)&&(s=!0),s||i.lineWrapping&&Math.abs(v-this.contentDOMWidth)>i.charWidth){let{lineHeight:n,charWidth:o,textHeight:a}=e.docView.measureTextSize();s=n>0&&i.refresh(r,n,o,a,Math.max(5,v/o),t),s&&(e.docView.minWidth=0,l|=16)}f>0&&m>0?c=Math.max(f,m):f<0&&m<0&&(c=Math.min(f,m)),va();for(let n of this.viewports){let r=n.from==this.viewport.from?t:e.docView.measureVisibleLineHeights(n);this.heightMap=(s?xa.empty().applyChanges(this.stateDeco,tn.empty,this.heightOracle,[new Us(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,s,new Oa(n.from,r))}ga&&(l|=2)}let y=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return y&&(2&l&&(l|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),l|=this.updateForViewport()),(2&l||y)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps,e)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,r=this.heightOracle,{visibleTop:s,visibleBottom:o}=this,a=new Qa(i.lineAt(s-1e3*n,ba.ByHeight,r,0,0).from,i.lineAt(o+1e3*(1-n),ba.ByHeight,r,0,0).to);if(t){let{head:e}=t.range;if(e<a.from||e>a.to){let n,s=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=i.lineAt(e,ba.ByPos,r,0,0);n="center"==t.y?(o.top+o.bottom)/2-s/2:"start"==t.y||"nearest"==t.y&&e<a.from?o.top:o.bottom-s,a=new Qa(i.lineAt(n-500,ba.ByHeight,r,0,0).from,i.lineAt(n+s+500,ba.ByHeight,r,0,0).to)}}return a}mapViewport(e,t){let n=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new Qa(this.heightMap.lineAt(n,ba.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,ba.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate(e){let{from:t,to:n}=e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(t,ba.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(n,ba.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(0==t||r<=o-Math.max(10,Math.min(-i,250)))&&(n==this.state.doc.length||s>=a+Math.max(10,Math.min(i,250)))&&r>o-2e3&&s<a+2e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let i of e)t.touchesRange(i.from,i.to)||n.push(new Na(t.mapPos(i.from),t.mapPos(i.to),i.size,i.displaySize));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,i=n?1e4:2e3,r=i>>1,s=i<<1;if(this.defaultTextDirection!=Xr.LTR&&!n)return[];let o=[],a=(i,s,l,c)=>{if(s-i<r)return;let u=this.state.selection.main,h=[u.from];u.empty||h.push(u.to);for(let e of h)if(e>i&&e<s)return a(i,e-10,l,c),void a(e+10,s,l,c);let d=function(e,t){for(let n of e)if(t(n))return n;return}(e,e=>e.from>=l.from&&e.to<=l.to&&Math.abs(e.from-i)<r&&Math.abs(e.to-s)<r&&!h.some(t=>e.from<t&&e.to>t));if(!d){if(s<l.to&&t&&n&&t.visibleRanges.some(e=>e.from<=s&&e.to>=s)){let e=t.moveToLineBoundary(An.cursor(s),!1,!0).head;e>i&&(s=e)}let e=this.gapSize(l,i,s,c);d=new Na(i,s,e,n||e<2e6?e:2e6)}o.push(d)},l=t=>{if(t.length<s||t.type!=gr.Text)return;let r=function(e,t,n){let i=[],r=e,s=0;Si.spans(n,e,t,{span(){},point(e,t){e>r&&(i.push({from:r,to:e}),s+=e-r),r=t}},20),r<t&&(i.push({from:r,to:t}),s+=t-r);return{total:s,ranges:i}}(t.from,t.to,this.stateDeco);if(r.total<s)return;let o,l,c=this.scrollTarget?this.scrollTarget.range.head:null;if(n){let e,n,s=i/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=c){let i=ja(r,c),o=((this.visibleBottom-this.visibleTop)/2+s)/t.height;e=i-o,n=i+o}else e=(this.visibleTop-t.top-s)/t.height,n=(this.visibleBottom-t.top+s)/t.height;o=La(r,e),l=La(r,n)}else{let n=r.total*this.heightOracle.charWidth,s=i*this.heightOracle.charWidth,a=0;if(n>2e6)for(let i of e)i.from>=t.from&&i.from<t.to&&i.size!=i.displaySize&&i.from*this.heightOracle.charWidth+a<this.pixelViewport.left&&(a=i.size-i.displaySize);let u,h,d=this.pixelViewport.left+a,p=this.pixelViewport.right+a;if(null!=c){let e=ja(r,c),t=((p-d)/2+s)/n;u=e-t,h=e+t}else u=(d-s)/n,h=(p+s)/n;o=La(r,u),l=La(r,h)}o>t.from&&a(t.from,o,t,r),l<t.to&&a(l,t.to,t,r)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(l):l(c);return o}gapSize(e,t,n,i){let r=ja(i,n)-ja(i,t);return this.heightOracle.lineWrapping?e.height*r:i.total*this.heightOracle.charWidth*r}updateLineGaps(e){Na.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=vr.set(e.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let n=[];Si.spans(t,this.viewport.from,this.viewport.to,{span(e,t){n.push({from:e,to:t})},point(){}},20);let i=0;if(n.length!=this.visibleRanges.length)i=12;else for(let r=0;r<n.length&&!(8&i);r++){let t=this.visibleRanges[r],s=n[r];t.from==s.from&&t.to==s.to||(i|=4,e&&e.mapPos(t.from,-1)==s.from&&e.mapPos(t.to,1)==s.to||(i|=8))}return this.visibleRanges=n,i}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Va(this.heightMap.lineAt(e,ba.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Va(this.heightMap.lineAt(this.scaler.fromDOM(e),ba.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Va(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Qa{constructor(e,t){this.from=e,this.to=t}}function La(e,t){let{total:n,ranges:i}=e;if(t<=0)return i[0].from;if(t>=1)return i[i.length-1].to;let r=Math.floor(n*t);for(let s=0;;s++){let{from:e,to:t}=i[s],n=t-e;if(r<=n)return e+r;r-=n}}function ja(e,t){let n=0;for(let{from:i,to:r}of e.ranges){if(t<=r){n+=t-i;break}n+=r-i}return n/e.total}const $a={toDOM:e=>e,fromDOM:e=>e,scale:1,eq(e){return e==this}};function za(e){let t=e.facet(Is).filter(e=>"function"!=typeof e),n=e.facet(Qs).filter(e=>"function"!=typeof e);return n.length&&t.push(Si.join(n)),t}class Wa{constructor(e,t,n){let i=0,r=0,s=0;this.viewports=n.map(n=>{let{from:r,to:s}=n,o=t.lineAt(r,ba.ByPos,e,0,0).top,a=t.lineAt(s,ba.ByPos,e,0,0).bottom;return i+=a-o,{from:r,to:s,top:o,bottom:a,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(t.height-i);for(let o of this.viewports)o.domTop=s+(o.top-r)*this.scale,s=o.domBottom=o.domTop+(o.bottom-o.top),r=o.bottom}toDOM(e){for(let t=0,n=0,i=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.top)return i+(e-n)*this.scale;if(e<=r.bottom)return r.domTop+(e-r.top);n=r.bottom,i=r.domBottom}}fromDOM(e){for(let t=0,n=0,i=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.domTop)return n+(e-i)/this.scale;if(e<=r.domBottom)return r.top+(e-r.domTop);n=r.bottom,i=r.domBottom}}eq(e){return e instanceof Wa&&(this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,n)=>t.from==e.viewports[n].from&&t.to==e.viewports[n].to))}}function Va(e,t){if(1==t.scale)return e;let n=t.toDOM(e.top),i=t.toDOM(e.bottom);return new wa(e.from,e.length,n,i-n,Array.isArray(e._content)?e._content.map(e=>Va(e,t)):e._content)}const Ua=Tn.define({combine:e=>e.join(" ")}),Xa=Tn.define({combine:e=>e.indexOf(!0)>-1}),qa=zi.newName(),Za=zi.newName(),Ha=zi.newName(),Ya={"&light":"."+Za,"&dark":"."+Ha};function Ga(e,t,n){return new zi(t,{finish:t=>/&/.test(t)?t.replace(/&\w*/,t=>{if("&"==t)return e;if(!n||!n[t])throw new RangeError("Unsupported selector: ".concat(t));return n[t]}):e+" "+t})}const Ka=Ga("."+qa,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Ya),Ja={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},el=cr.ie&&cr.ie_version<=11;class tl{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new Ir,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let e of t)this.queue.push(e);(cr.ie&&cr.ie_version<=11||cr.ios&&e.composing)&&t.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),!window.EditContext||!cr.android||!1===e.constructor.EDIT_CONTEXT||cr.chrome&&cr.chrome_version<126||(this.editContext=new rl(e),e.state.facet(_s)&&(e.contentDOM.editContext=this.editContext.editContext)),el&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver(()=>{var e;(null===(e=this.view.docView)||void 0===e?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){("change"!=e.type&&e.type||e.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,i=this.selectionRange;if(n.state.facet(_s)?n.root.activeElement!=this.dom:!Cr(this.dom,i))return;let r=i.anchorNode&&n.docView.tile.nearest(i.anchorNode);r&&r.isWidget()&&r.widget.ignoreEvent(e)?t||(this.selectionChanged=!1):(cr.ie&&cr.ie_version<=11||cr.android&&cr.chrome)&&!n.state.selection.main.empty&&i.focusNode&&Er(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Dr(e.root);if(!t)return!1;let n=cr.safari&&11==e.root.nodeType&&e.root.activeElement==this.dom&&function(e,t){if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return il(e,n)}let n=null;function i(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.contentDOM.addEventListener("beforeinput",i,!0),e.dom.ownerDocument.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",i,!0),n?il(e,n):null}(this.view,t)||t;if(!n||this.selectionRange.eq(n))return!1;let i=Cr(this.dom,n);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&function(e,t){let n=t.focusNode,i=t.focusOffset;if(!n||t.anchorNode!=n||t.anchorOffset!=i)return!1;for(i=Math.min(i,Mr(n));;)if(i){if(1!=n.nodeType)return!1;let e=n.childNodes[i-1];"false"==e.contentEditable?i--:(n=e,i=Mr(n))}else{if(n==e)return!0;i=_r(n),n=n.parentNode}}(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(1==n.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else{if(11!=n.nodeType)break;n=n.host}if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);for(let e of this.scrollTargets=t)e.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Ja),el&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),el&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let e=()=>{let e=this.delayedAndroidKey;if(e){this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=e.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&e.force&&$r(this.dom,e.key,e.keyCode)}};this.flushingAndroidKey=this.view.win.requestAnimationFrame(e)}this.delayedAndroidKey&&"Enter"!=e||(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(null===(n=this.delayedAndroidKey)||void 0===n?void 0:n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,i=!1;for(let r of e){let e=this.readMutation(r);e&&(e.typeOver&&(i=!0),-1==t?({from:t,to:n}=e):(t=Math.min(e.from,t),n=Math.max(e.to,n)))}return{from:t,to:n,typeOver:i}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),i=this.selectionChanged&&Cr(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new Qo(this.view,e,t,n);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,i=jo(this.view,t);return this.view.state==n&&(t.domChanged||t.newSel&&!Wo(this.view.state.selection,t.newSel.main))&&this.view.update([]),i}readMutation(e){let t=this.view.docView.tile.nearest(e.target);if(!t||t.isWidget())return null;if(t.markDirty("attributes"==e.type),"childList"==e.type){let n=nl(t,e.previousSibling||e.target.previousSibling,-1),i=nl(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}return"characterData"==e.type?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(_s)!=e.state.facet(_s)&&(e.view.contentDOM.editContext=e.state.facet(_s)?this.editContext.editContext:null))}destroy(){var e,t,n;this.stop(),null===(e=this.intersection)||void 0===e||e.disconnect(),null===(t=this.gapIntersection)||void 0===t||t.disconnect(),null===(n=this.resizeScroll)||void 0===n||n.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function nl(e,t,n){for(;t;){let i=Zs.get(t);if(i&&i.parent==e)return i;let r=t.parentNode;t=r!=e.dom?r:n>0?t.nextSibling:t.previousSibling}return null}function il(e,t){let n=t.startContainer,i=t.startOffset,r=t.endContainer,s=t.endOffset,o=e.docView.domAtPos(e.state.selection.main.anchor,1);return Er(o.node,o.offset,r,s)&&([n,i,r,s]=[r,s,n,i]),{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}}class rl{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let i=e.state.selection.main,{anchor:r,head:s}=i,o=this.toEditorPos(n.updateRangeStart),a=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:o,drifted:!1});let l=a-o>n.text.length;o==this.from&&r<this.from?o=r:a==this.to&&r>this.to&&(a=r);let c=zo(e.state.sliceDoc(o,a),n.text,(l?i.from:i.to)-o,l?"end":null);if(!c){let t=An.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));return void(Wo(t,i)||e.dispatch({selection:t,userEvent:"select"}))}let u={from:c.from+o,to:c.toA+o,insert:tn.of(n.text.slice(c.from,c.toB).split("\n"))};if((cr.mac||cr.android)&&u.from==s-1&&/^\. ?$/.test(n.text)&&"off"==e.contentDOM.getAttribute("autocorrect")&&(u={from:o,to:a,insert:tn.of([n.text.replace("."," ")])}),this.pendingContextChange=u,!e.state.readOnly){let t=this.to-this.from+(u.to-u.from+u.insert.length);$o(e,u,An.single(this.toEditorPos(n.selectionStart,t),this.toEditorPos(n.selectionEnd,t)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),u.from<u.to&&!u.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,n.updateRangeStart-1),Math.min(t.text.length,n.updateRangeStart+1)))&&this.handlers.compositionend(n)},this.handlers.characterboundsupdate=n=>{let i=[],r=null;for(let t=this.toEditorPos(n.rangeStart),s=this.toEditorPos(n.rangeEnd);t<s;t++){let n=e.coordsForChar(t);r=n&&new DOMRect(n.left,n.top,n.right-n.left,n.bottom-n.top)||r||new DOMRect,i.push(r)}t.updateCharacterBounds(n.rangeStart,i)},this.handlers.textformatupdate=t=>{let n=[];for(let e of t.getTextFormats()){let t=e.underlineStyle,i=e.underlineThickness;if(!/none/i.test(t)&&!/none/i.test(i)){let r=this.toEditorPos(e.rangeStart),s=this.toEditorPos(e.rangeEnd);if(r<s){let e="text-decoration: underline ".concat(/^[a-z]/.test(t)?t+" ":"Dashed"==t?"dashed ":"Squiggle"==t?"wavy ":"").concat(/thin/i.test(i)?1:2,"px");n.push(vr.mark({attributes:{style:e}}).range(r,s))}}}e.dispatch({effects:As.of(vr.set(n))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:t}=this.composing;this.composing=null,t&&this.reset(e.state)}};for(let n in this.handlers)t.addEventListener(n,this.handlers[n]);this.measureReq={read:e=>{this.editContext.updateControlBounds(e.contentDOM.getBoundingClientRect());let t=Dr(e.root);t&&t.rangeCount&&this.editContext.updateSelectionBounds(t.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,n=!1,i=this.pendingContextChange;return e.changes.iterChanges((r,s,o,a,l)=>{if(n)return;let c=l.length-(s-r);if(i&&s>=i.to){if(i.from==r&&i.to==s&&i.insert.eq(l))return i=this.pendingContextChange=null,t+=c,void(this.to+=c);i=null,this.revertPending(e.state)}if(r+=t,(s+=t)<=this.from)this.from+=c,this.to+=c;else if(r<this.to){if(r<this.from||s>this.to||this.to-this.from+l.length>3e4)return void(n=!0);this.editContext.updateText(this.toContextPos(r),this.toContextPos(s),l.toString()),this.to+=c}t+=c}),i&&!n&&this.revertPending(e.state),!n}update(e){let t=this.pendingContextChange,n=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(n.from,n.to)&&e.transactions.some(e=>!e.isUserEvent("input.type")&&e.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):this.applyEdits(e)&&this.rangeIsValid(e.state)?(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state):(this.pendingContextChange=null,this.reset(e.state)),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),i=this.toContextPos(t.head);this.editContext.selectionStart==n&&this.editContext.selectionEnd==i||this.editContext.updateSelection(n,i)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>3e4)}toEditorPos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.to-this.from;e=Math.min(e,t);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class sl{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(e=>e.forEach(e=>n(e,this)))||(e=>this.update(e)),this.dispatch=this.dispatch.bind(this),this._root=e.root||function(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}(e.parent)||document,this.viewState=new Ba(e.state||yi.create(e)),e.scrollTo&&e.scrollTo.is(Cs)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Ps).map(e=>new Fs(e));for(let i of this.plugins)i.update(this);this.observer=new tl(this),this.inputState=new Vo(this),this.inputState.ensureHandlers(this.plugins),this.docView=new yo(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null===(t=document.fonts)||void 0===t?void 0:t.ready)&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=1==t.length&&t[0]instanceof ai?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(i,this)}update(e){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t,n=!1,i=!1,r=this.state;for(let h of e){if(h.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=h.state}if(this.destroyed)return void(this.viewState.state=r);let s=this.hasFocus,o=0,a=null;e.some(e=>e.annotation(ha))?(this.inputState.notifiedFocused=s,o=1):s!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=s,a=da(r,s),a||(o=1));let l=this.observer.delayedAndroidKey,c=null;if(l?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(c=null)):this.observer.clear(),r.facet(yi.phrases)!=this.state.facet(yi.phrases))return this.setState(r);t=Xs.create(this,r,e),t.flags|=o;let u=this.viewState.scrollTarget;try{this.updateState=2;for(let t of e){if(u&&(u=u.map(t.changes)),t.scrollIntoView){let{main:e}=t.state.selection;u=new Ss(e.empty?e:An.cursor(e.head,e.head>e.anchor?-1:1))}for(let e of t.effects)e.is(Cs)&&(u=e.value.clip(this.state))}this.viewState.update(t,u),this.bidiCache=ll.update(this.bidiCache,t.changes),t.empty||(this.updatePlugins(t),this.inputState.update(t)),n=this.docView.update(t),this.state.facet(Vs)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some(e=>e.isUserEvent("select.pointer")))}finally{this.updateState=0}if(t.startState.facet(Ua)!=t.state.facet(Ua)&&(this.viewState.mustMeasureContent=!0),(n||i||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),n&&this.docViewUpdate(),!t.empty)for(let h of this.state.facet(vs))try{h(t)}catch(Kre){Es(this.state,Kre,"update listener")}(a||c)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),c&&!jo(this,c)&&l.force&&$r(this.contentDOM,l.key,l.keyCode)})}setState(e){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=e);this.updateState=2;let t=this.hasFocus;try{for(let e of this.plugins)e.destroy(this);this.viewState=new Ba(e),this.plugins=e.facet(Ps).map(e=>new Fs(e)),this.pluginMap.clear();for(let e of this.plugins)e.update(this);this.docView.destroy(),this.docView=new yo(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Ps),n=e.state.facet(Ps);if(t!=n){let i=[];for(let r of n){let n=t.indexOf(r);if(n<0)i.push(new Fs(r));else{let t=this.plugins[n];t.mustUpdate=e,i.push(t)}}for(let t of this.plugins)t.mustUpdate!=e&&t.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(Kre){Es(this.state,Kre,"doc view update listener")}}}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,i=n.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:s}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(s=-1),this.viewState.scrollAnchorHeight=-1;try{for(let e=0;;e++){if(s<0)if(zr(n))r=-1,s=this.viewState.heightMap.height;else{let e=this.viewState.scrollAnchorAt(i);r=e.from,s=e.top}this.updateState=1;let o=this.viewState.measure(this);if(!o&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(e>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let a=[];4&o||([this.measureRequests,a]=[a,this.measureRequests]);let l=a.map(e=>{try{return e.read(this)}catch(Kre){return Es(this.state,Kre),al}}),c=Xs.create(this,this.state,[]),u=!1;c.flags|=o,t?t.flags|=o:t=c,this.updateState=2,c.empty||(this.updatePlugins(c),this.inputState.update(c),this.updateAttrs(),u=this.docView.update(c),u&&this.docViewUpdate());for(let e=0;e<a.length;e++)if(l[e]!=al)try{let t=a[e];t.write&&t.write(l[e],this)}catch(Kre){Es(this.state,Kre)}if(u&&this.docView.updateSelection(!0),!c.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,s=-1;continue}{let e=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-s;if(e>1||e<-1){i+=e,n.scrollTop=i/this.scaleY,s=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let o of this.state.facet(vs))o(t)}get themeClasses(){return qa+" "+(this.state.facet(Xa)?Ha:Za)+" "+this.state.facet(Ua)}updateAttrs(){let e=cl(this,Rs,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(_s)?"true":"false",class:"cm-content",style:"".concat(cr.tabSize,": ").concat(this.state.tabSize),role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),cl(this,Ns,t);let n=this.observer.ignore(()=>{let n=pr(this.contentDOM,this.contentAttrs,t),i=pr(this.dom,this.editorAttrs,e);return n||i});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let e of n.effects)if(e.is(sl.announce)){t&&(this.announceDOM.textContent=""),t=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=e.value}}mountStyles(){this.styleModules=this.state.facet(Vs);let e=this.state.facet(sl.cspNonce);zi.mount(this.root,this.styleModules.concat(Ka).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(null!=e.key)for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key)return void(this.measureRequests[t]=e);this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(void 0===t||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(t=>t.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return Eo(this,e,So(this,e,t,n))}moveByGroup(e,t){return Eo(this,e,So(this,e,t,t=>function(e,t,n){let i=e.state.charCategorizer(t),r=i(n);return e=>{let t=i(e);return r==fi.Space&&(r=t),r==t}}(this,e.head,t)))}visualLineSide(e,t){let n=this.bidiSpans(e),i=this.textDirectionAt(e.from),r=n[t?n.length-1:0];return An.cursor(r.side(t,i)+e.from,r.forward(!t,i)?1:-1)}moveToLineBoundary(e,t){return function(e,t,n,i){let r=Do(e,t.head,t.assoc||-1),s=i&&r.type==gr.Text&&(e.lineWrapping||r.widgetLineBreaks)?e.coordsAtPos(t.assoc<0&&t.head>r.from?t.head-1:t.head):null;if(s){let t=e.dom.getBoundingClientRect(),i=e.textDirectionAt(r.from),o=e.posAtCoords({x:n==(i==Xr.LTR)?t.right-1:t.left+1,y:(s.top+s.bottom)/2});if(null!=o)return An.cursor(o,n?-1:1)}return An.cursor(n?r.to:r.from,n?-1:1)}(this,e,t,!(arguments.length>2&&void 0!==arguments[2])||arguments[2])}moveVertically(e,t,n){return Eo(this,e,function(e,t,n,i){let r=t.head,s=n?1:-1;if(r==(n?e.state.doc.length:0))return An.cursor(r,t.assoc);let o,a=t.goalColumn,l=e.contentDOM.getBoundingClientRect(),c=e.coordsAtPos(r,t.assoc||-1),u=e.documentTop;if(c)null==a&&(a=c.left-l.left),o=s<0?c.top:c.bottom;else{let t=e.viewState.lineBlockAt(r);null==a&&(a=Math.min(l.right-l.left,e.defaultCharacterWidth*(r-t.from))),o=(s<0?t.top:t.bottom)+u}let h=To(e,{x:l.left+a,y:o+(null!==i&&void 0!==i?i:e.viewState.heightOracle.textHeight>>1)*s},!1,s);return An.cursor(h.pos,h.assoc,void 0,a)}(this,e,t,n))}domAtPos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.docView.domAtPos(e,t)}posAtDOM(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.posFromDOM(e,t)}posAtCoords(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.readMeasured();let n=To(this,e,t);return n&&n.pos}posAndSideAtCoords(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.readMeasured(),To(this,e,t)}coordsAtPos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let i=this.state.doc.lineAt(e),r=this.bidiSpans(i);return Fr(n,r[ns.find(r,e-i.from,-1,t)].dir==Xr.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(ks)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>ol)return cs(e.length);let t,n=this.textDirectionAt(e.from);for(let r of this.bidiCache)if(r.from==e.from&&r.dir==n&&(r.fresh||is(r.isolates,t=$s(this,e))))return r.order;t||(t=$s(this,e));let i=ls(e.text,n,t);return this.bidiCache.push(new ll(e.from,e.to,n,t,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||cr.safari&&(null===(e=this.inputState)||void 0===e?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Lr(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((9==e.nodeType?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Cs.of(new Ss("number"==typeof e?An.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return Cs.of(new Ss(An.cursor(n.from),"start","start",n.top-e,t,!0))}setTabFocusMode(e){null==e?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof e?this.inputState.tabFocusMode=e?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Ms.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Ms.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=zi.newName(),i=[Ua.of(n),Vs.of(Ga(".".concat(n),e))];return t&&t.dark&&i.push(Xa.of(!0)),i}static baseTheme(e){return Wn.lowest(Vs.of(Ga("."+qa,e,Ya)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),i=n&&Zs.get(n)||Zs.get(e);return(null===(t=null===i||void 0===i?void 0:i.root)||void 0===t?void 0:t.view)||null}}sl.styleModule=Vs,sl.inputHandler=ys,sl.clipboardInputFilter=ws,sl.clipboardOutputFilter=bs,sl.scrollHandler=Ds,sl.focusChangeEffect=Os,sl.perLineTextDirection=ks,sl.exceptionSink=gs,sl.updateListener=vs,sl.editable=_s,sl.mouseSelectionStyle=ms,sl.dragMovesSelection=fs,sl.clickAddsSelectionRange=ps,sl.decorations=Is,sl.blockWrappers=Bs,sl.outerDecorations=Qs,sl.atomicRanges=Ls,sl.bidiIsolatedRanges=js,sl.scrollMargins=zs,sl.darkTheme=Xa,sl.cspNonce=Tn.define({combine:e=>e.length?e[0]:""}),sl.contentAttributes=Ns,sl.editorAttributes=Rs,sl.lineWrapping=sl.contentAttributes.of({class:"cm-lineWrapping"}),sl.announce=oi.define();const ol=4096,al={};class ll{constructor(e,t,n,i,r,s){this.from=e,this.to=t,this.dir=n,this.isolates=i,this.fresh=r,this.order=s}static update(e,t){if(t.empty&&!e.some(e=>e.fresh))return e;let n=[],i=e.length?e[e.length-1].dir:Xr.LTR;for(let r=Math.max(0,e.length-10);r<e.length;r++){let s=e[r];s.dir!=i||t.touchesRange(s.from,s.to)||n.push(new ll(t.mapPos(s.from,1),t.mapPos(s.to,-1),s.dir,s.isolates,!1,s.order))}return n}}function cl(e,t,n){for(let i=e.state.facet(t),r=i.length-1;r>=0;r--){let t=i[r],s="function"==typeof t?t(e):t;s&&ur(s,n)}return n}const ul=cr.mac?"mac":cr.windows?"win":cr.linux?"linux":"key";function hl(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}const dl=Wn.default(sl.domEventHandlers({keydown:(e,t)=>Ol(ml(t.state),e,t,"editor")})),pl=Tn.define({enables:dl}),fl=new WeakMap;function ml(e){let t=e.facet(pl),n=fl.get(t);return n||fl.set(t,n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ul,n=Object.create(null),i=Object.create(null),r=(e,t)=>{let n=i[e];if(null==n)i[e]=t;else if(n!=t)throw new Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},s=(e,i,s,o,a)=>{var l,c;let u=n[e]||(n[e]=Object.create(null)),h=i.split(/ (?!$)/).map(e=>function(e,t){const n=e.split(/-(?!$)/);let i,r,s,o,a=n[n.length-1];"Space"==a&&(a=" ");for(let l=0;l<n.length-1;++l){const e=n[l];if(/^(cmd|meta|m)$/i.test(e))o=!0;else if(/^a(lt)?$/i.test(e))i=!0;else if(/^(c|ctrl|control)$/i.test(e))r=!0;else if(/^s(hift)?$/i.test(e))s=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);"mac"==t?o=!0:r=!0}}return i&&(a="Alt-"+a),r&&(a="Ctrl-"+a),o&&(a="Meta-"+a),s&&(a="Shift-"+a),a}(e,t));for(let t=1;t<h.length;t++){let n=h.slice(0,t).join(" ");r(n,!0),u[n]||(u[n]={preventDefault:!0,stopPropagation:!1,run:[t=>{let i=gl={view:t,prefix:n,scope:e};return setTimeout(()=>{gl==i&&(gl=null)},vl),!0}]})}let d=h.join(" ");r(d,!1);let p=u[d]||(u[d]={preventDefault:!1,stopPropagation:!1,run:(null===(c=null===(l=u._any)||void 0===l?void 0:l.run)||void 0===c?void 0:c.slice())||[]});s&&p.run.push(s),o&&(p.preventDefault=!0),a&&(p.stopPropagation=!0)};for(let o of e){let e=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let t of e){let e=n[t]||(n[t]=Object.create(null));e._any||(e._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:i}=o;for(let t in e)e[t].run.push(e=>i(e,yl))}let i=o[t]||o.key;if(i)for(let t of e)s(t,i,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(t,"Shift-"+i,o.shift,o.preventDefault,o.stopPropagation)}return n}(t.reduce((e,t)=>e.concat(t),[]))),n}let gl=null;const vl=4e3;let yl=null;function Ol(e,t,n,i){yl=t;let r=Gi(t),s=mn(pn(r,0))==r.length&&" "!=r,o="",a=!1,l=!1,c=!1;gl&&gl.view==n&&gl.scope==i&&(o=gl.prefix+" ",Ho.indexOf(t.keyCode)<0&&(l=!0,gl=null));let u,h,d=new Set,p=e=>{if(e){for(let t of e.run)if(!d.has(t)&&(d.add(t),t(n)))return e.stopPropagation&&(c=!0),!0;e.preventDefault&&(e.stopPropagation&&(c=!0),l=!0)}return!1},f=e[i];return f&&(p(f[o+hl(r,t,!s)])?a=!0:!s||!(t.altKey||t.metaKey||t.ctrlKey)||cr.windows&&t.ctrlKey&&t.altKey||cr.mac&&t.altKey&&!t.ctrlKey&&!t.metaKey||!(u=Ui[t.keyCode])||u==r?s&&t.shiftKey&&p(f[o+hl(r,t,!0)])&&(a=!0):(p(f[o+hl(u,t,!0)])||t.shiftKey&&(h=Xi[t.keyCode])!=r&&h!=u&&p(f[o+hl(h,t,!1)]))&&(a=!0),!a&&p(f._any)&&(a=!0)),l&&(a=!0),a&&c&&t.stopPropagation(),yl=null,a}class wl{constructor(e,t,n,i,r){this.className=e,this.left=t,this.top=n,this.width=i,this.height=r}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className==this.className&&(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",null!=this.width&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let i=e.coordsAtPos(n.head,n.assoc||1);if(!i)return[];let r=bl(e);return[new wl(t,i.left-r.left,i.top-r.top,null,i.bottom-i.top)]}return function(e,t,n){if(n.to<=e.viewport.from||n.from>=e.viewport.to)return[];let i=Math.max(n.from,e.viewport.from),r=Math.min(n.to,e.viewport.to),s=e.textDirection==Xr.LTR,o=e.contentDOM,a=o.getBoundingClientRect(),l=bl(e),c=o.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),h=a.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),d=a.right-(u?parseInt(u.paddingRight):0),p=Do(e,i,1),f=Do(e,r,-1),m=p.type==gr.Text?p:null,g=f.type==gr.Text?f:null;m&&(e.lineWrapping||p.widgetLineBreaks)&&(m=kl(e,i,1,m));g&&(e.lineWrapping||f.widgetLineBreaks)&&(g=kl(e,r,-1,g));if(m&&g&&m.from==g.from&&m.to==g.to)return y(O(n.from,n.to,m));{let t=m?O(n.from,null,m):w(p,!1),i=g?O(null,n.to,g):w(f,!0),r=[];return(m||p).to<(g||f).from-(m&&g?1:0)||p.widgetLineBreaks>1&&t.bottom+e.defaultLineHeight/2<i.top?r.push(v(h,t.bottom,d,i.top)):t.bottom<i.top&&e.elementAtHeight((t.bottom+i.top)/2).type==gr.Text&&(t.bottom=i.top=(t.bottom+i.top)/2),y(t).concat(r).concat(y(i))}function v(e,n,i,r){return new wl(t,e-l.left,n-l.top,Math.max(0,i-e),r-n)}function y(e){let{top:t,bottom:n,horizontal:i}=e,r=[];for(let s=0;s<i.length;s+=2)r.push(v(i[s],t,i[s+1],n));return r}function O(t,n,i){let r=1e9,o=-1e9,a=[];function l(t,n,l,c,u){let p=e.coordsAtPos(t,t==i.to?-2:2),f=e.coordsAtPos(l,l==i.from?2:-2);p&&f&&(r=Math.min(p.top,f.top,r),o=Math.max(p.bottom,f.bottom,o),u==Xr.LTR?a.push(s&&n?h:p.left,s&&c?d:f.right):a.push(!s&&c?h:f.left,!s&&n?d:p.right))}let c=null!==t&&void 0!==t?t:i.from,u=null!==n&&void 0!==n?n:i.to;for(let s of e.visibleRanges)if(s.to>c&&s.from<u)for(let i=Math.max(s.from,c),r=Math.min(s.to,u);;){let s=e.state.doc.lineAt(i);for(let o of e.bidiSpans(s)){let e=o.from+s.from,a=o.to+s.from;if(e>=r)break;a>i&&l(Math.max(e,i),null==t&&e<=c,Math.min(a,r),null==n&&a>=u,o.dir)}if(i=s.to+1,i>=r)break}return 0==a.length&&l(c,null==t,u,null==n,e.textDirection),{top:r,bottom:o,horizontal:a}}function w(e,t){let n=a.top+(t?e.top:e.bottom);return{top:n,bottom:n,horizontal:[]}}}(e,t,n)}}function bl(e){let t=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==Xr.LTR?t.left:t.right-e.scrollDOM.clientWidth*e.scaleX)-e.scrollDOM.scrollLeft*e.scaleX,top:t.top-e.scrollDOM.scrollTop*e.scaleY}}function kl(e,t,n,i){let r=e.coordsAtPos(t,2*n);if(!r)return i;let s=e.dom.getBoundingClientRect(),o=(r.top+r.bottom)/2,a=e.posAtCoords({x:s.left+1,y:o}),l=e.posAtCoords({x:s.right-1,y:o});return null==a||null==l?i:{from:Math.max(i.from,Math.min(a,l)),to:Math.min(i.to,Math.max(a,l))}}class xl{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Dl)!=e.state.facet(Dl)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){!1!==this.layer.updateOnDocViewUpdate&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(Dl);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;e==this.scaleX&&t==this.scaleY||(this.scaleX=e,this.scaleY=t,this.dom.style.transform="scale(".concat(1/e,", ").concat(1/t,")"))}draw(e){if(e.length!=this.drawn.length||e.some((e,t)=>{return n=e,i=this.drawn[t],!(n.constructor==i.constructor&&n.eq(i));var n,i})){let t=this.dom.firstChild,n=0;for(let i of e)i.update&&t&&i.constructor&&this.drawn[n].constructor&&i.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(i.draw(),t);for(;t;){let e=t.nextSibling;t.remove(),t=e}this.drawn=e,cr.safari&&cr.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Dl=Tn.define();function Sl(e){return[Ms.define(t=>new xl(t,e)),Dl.of(e)]}const Cl=Tn.define({combine:e=>Oi(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})});function Al(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[Cl.of(e),_l,Pl,Ml,xs.of(!0)]}function El(e){return e.startState.facet(Cl)!=e.state.facet(Cl)}const _l=Sl({above:!0,markers(e){let{state:t}=e,n=t.facet(Cl),i=[];for(let r of t.selection.ranges){let s=r==t.selection.main;if(r.empty||n.drawRangeCursor){let t=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",n=r.empty?r:An.cursor(r.head,r.head>r.anchor?-1:1);for(let r of wl.forRange(e,t,n))i.push(r)}}return i},update(e,t){e.transactions.some(e=>e.selection)&&(t.style.animationName="cm-blink"==t.style.animationName?"cm-blink2":"cm-blink");let n=El(e);return n&&Tl(e.state,t),e.docChanged||e.selectionSet||n},mount(e,t){Tl(t.state,e)},class:"cm-cursorLayer"});function Tl(e,t){t.style.animationDuration=e.facet(Cl).cursorBlinkRate+"ms"}const Pl=Sl({above:!1,markers:e=>e.state.selection.ranges.map(t=>t.empty?[]:wl.forRange(e,"cm-selectionBackground",t)).reduce((e,t)=>e.concat(t)),update:(e,t)=>e.docChanged||e.selectionSet||e.viewportChanged||El(e),class:"cm-selectionLayer"}),Ml=Wn.highest(sl.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),Fl=oi.define({map:(e,t)=>null==e?null:t.mapPos(e)}),Rl=Bn.define({create:()=>null,update:(e,t)=>(null!=e&&(e=t.changes.mapPos(e)),t.effects.reduce((e,t)=>t.is(Fl)?t.value:e,e))}),Nl=Ms.fromClass(class{constructor(e){this.view=e,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t;let n=e.state.field(Rl);null==n?null!=this.cursor&&(null===(t=this.cursor)||void 0===t||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(Rl)!=n||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:e}=this,t=e.state.field(Rl),n=null!=t&&e.coordsAtPos(t);if(!n)return null;let i=e.scrollDOM.getBoundingClientRect();return{left:n.left-i.left+e.scrollDOM.scrollLeft*e.scaleX,top:n.top-i.top+e.scrollDOM.scrollTop*e.scaleY,height:n.bottom-n.top}}drawCursor(e){if(this.cursor){let{scaleX:t,scaleY:n}=this.view;e?(this.cursor.style.left=e.left/t+"px",this.cursor.style.top=e.top/n+"px",this.cursor.style.height=e.height/n+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(e){this.view.state.field(Rl)!=e&&this.view.dispatch({effects:Fl.of(e)})}},{eventObservers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){e.target!=this.view.contentDOM&&this.view.contentDOM.contains(e.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Il(e,t,n,i,r){t.lastIndex=0;for(let s,o=e.iterRange(n,i),a=n;!o.next().done;a+=o.value.length)if(!o.lineBreak)for(;s=t.exec(o.value);)r(a+s.index,s)}class Bl{constructor(e){const{regexp:t,decoration:n,decorate:i,boundary:r,maxLength:s=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(e,t,n,r)=>i(r,n,n+e[0].length,e,t);else if("function"==typeof n)this.addMatch=(e,t,i,r)=>{let s=n(e,t,i);s&&r(i,i+e[0].length,s)};else{if(!n)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=(e,t,i,r)=>r(i,i+e[0].length,n)}this.boundary=r,this.maxLength=s}createDeco(e){let t=new Ci,n=t.add.bind(t);for(let{from:i,to:r}of function(e,t){let n=e.visibleRanges;if(1==n.length&&n[0].from==e.viewport.from&&n[0].to==e.viewport.to)return n;let i=[];for(let{from:r,to:s}of n)r=Math.max(e.state.doc.lineAt(r).from,r-t),s=Math.min(e.state.doc.lineAt(s).to,s+t),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}(e,this.maxLength))Il(e.state.doc,this.regexp,i,r,(t,i)=>this.addMatch(i,e,t,n));return t.finish()}updateDeco(e,t){let n=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((t,r,s,o)=>{o>=e.view.viewport.from&&s<=e.view.viewport.to&&(n=Math.min(s,n),i=Math.max(o,i))}),e.viewportMoved||i-n>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),n,i):t}updateRange(e,t,n,i){for(let r of e.visibleRanges){let s=Math.max(r.from,n),o=Math.min(r.to,i);if(o>=s){let n=e.state.doc.lineAt(s),i=n.to<o?e.state.doc.lineAt(o):n,a=Math.max(r.from,n.from),l=Math.min(r.to,i.to);if(this.boundary){for(;s>n.from;s--)if(this.boundary.test(n.text[s-1-n.from])){a=s;break}for(;o<i.to;o++)if(this.boundary.test(i.text[o-i.from])){l=o;break}}let c,u=[],h=(e,t,n)=>u.push(n.range(e,t));if(n==i)for(this.regexp.lastIndex=a-n.from;(c=this.regexp.exec(n.text))&&c.index<l-n.from;)this.addMatch(c,e,c.index+n.from,h);else Il(e.state.doc,this.regexp,a,l,(t,n)=>this.addMatch(n,e,t,h));t=t.update({filterFrom:a,filterTo:l,filter:(e,t)=>e<a||t>l,add:u})}}return t}}const Ql=null!=/x/.unicode?"gu":"g",Ll=new RegExp("[\0-\b\n-\x1f\x7f-\x9f\xad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]",Ql),jl={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let $l=null;const zl=Tn.define({combine(e){let t=Oi(e,{render:null,specialChars:Ll,addSpecialChars:null});return(t.replaceTabs=!function(){var e;if(null==$l&&"undefined"!=typeof document&&document.body){let t=document.body.style;$l=null!=(null!==(e=t.tabSize)&&void 0!==e?e:t.MozTabSize)}return $l||!1}())&&(t.specialChars=new RegExp("\t|"+t.specialChars.source,Ql)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,Ql)),t}});function Wl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[zl.of(e),Vl||(Vl=Ms.fromClass(class{constructor(e){this.view=e,this.decorations=vr.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(e.state.facet(zl)),this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new Bl({regexp:e.specialChars,decoration:(t,n,i)=>{let{doc:r}=n.state,s=pn(t[0],0);if(9==s){let e=r.lineAt(i),t=n.state.tabSize,s=Bi(e.text,t,i-e.from);return vr.replace({widget:new Xl((t-s%t)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=vr.replace({widget:new Ul(e,s)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let t=e.state.facet(zl);e.startState.facet(zl)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations}))]}let Vl=null;class Ul extends mr{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=function(e){return e>=32?"\u2022":10==e?"\u2424":String.fromCharCode(9216+e)}(this.code),n=e.state.phrase("Control character")+" "+(jl[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,t);if(i)return i;let r=document.createElement("span");return r.textContent=t,r.title=n,r.setAttribute("aria-label",n),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class Xl extends mr{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="\t",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const ql=vr.line({class:"cm-activeLine"}),Zl=Ms.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=-1,n=[];for(let i of e.state.selection.ranges){let r=e.lineBlockAt(i.head);r.from>t&&(n.push(ql.range(r.from)),t=r.from)}return vr.set(n)}},{decorations:e=>e.decorations});const Hl=2e3;function Yl(e,t){let n=e.posAtCoords({x:t.clientX,y:t.clientY},!1),i=e.state.doc.lineAt(n),r=n-i.from,s=r>Hl?-1:r==i.length?function(e,t){let n=e.coordsAtPos(e.viewport.from);return n?Math.round(Math.abs((n.left-t)/e.defaultCharacterWidth)):-1}(e,t.clientX):Bi(i.text,e.state.tabSize,n-i.from);return{line:i.number,col:s,off:r}}function Gl(e,t){let n=Yl(e,t),i=e.state.selection;return n?{update(e){if(e.docChanged){let t=e.changes.mapPos(e.startState.doc.line(n.line).from),r=e.state.doc.lineAt(t);n={line:r.number,col:n.col,off:Math.min(n.off,r.length)},i=i.map(e.changes)}},get(t,r,s){let o=Yl(e,t);if(!o)return i;let a=function(e,t,n){let i=Math.min(t.line,n.line),r=Math.max(t.line,n.line),s=[];if(t.off>Hl||n.off>Hl||t.col<0||n.col<0){let o=Math.min(t.off,n.off),a=Math.max(t.off,n.off);for(let t=i;t<=r;t++){let n=e.doc.line(t);n.length<=a&&s.push(An.range(n.from+o,n.to+a))}}else{let o=Math.min(t.col,n.col),a=Math.max(t.col,n.col);for(let t=i;t<=r;t++){let n=e.doc.line(t),i=Qi(n.text,o,e.tabSize,!0);if(i<0)s.push(An.cursor(n.to));else{let t=Qi(n.text,a,e.tabSize);s.push(An.range(n.from+i,n.from+t))}}}return s}(e.state,n,o);return a.length?s?An.create(a.concat(i.ranges)):An.create(a):i}}:null}function Kl(e){let t=(null===e||void 0===e?void 0:e.eventFilter)||(e=>e.altKey&&0==e.button);return sl.mouseSelectionStyle.of((e,n)=>t(n)?Gl(e,n):null)}const Jl={Alt:[18,e=>!!e.altKey],Control:[17,e=>!!e.ctrlKey],Shift:[16,e=>!!e.shiftKey],Meta:[91,e=>!!e.metaKey]},ec={style:"cursor: crosshair"};function tc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,n]=Jl[e.key||"Alt"],i=Ms.fromClass(class{constructor(e){this.view=e,this.isDown=!1}set(e){this.isDown!=e&&(this.isDown=e,this.view.update([]))}},{eventObservers:{keydown(e){this.set(e.keyCode==t||n(e))},keyup(e){e.keyCode!=t&&n(e)||this.set(!1)},mousemove(e){this.set(n(e))}}});return[i,sl.contentAttributes.of(e=>{var t;return(null===(t=e.plugin(i))||void 0===t?void 0:t.isDown)?ec:null})]}const nc="-10000px";class ic{constructor(e,t,n,i){this.facet=t,this.createTooltipView=n,this.removeTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(e=>e);let r=null;this.tooltipViews=this.tooltips.map(e=>r=n(e,r))}update(e,t){var n;let i=e.state.facet(this.facet),r=i.filter(e=>e);if(i===this.input){for(let t of this.tooltipViews)t.update&&t.update(e);return!1}let s=[],o=t?[]:null;for(let a=0;a<r.length;a++){let n=r[a],i=-1;if(n){for(let e=0;e<this.tooltips.length;e++){let t=this.tooltips[e];t&&t.create==n.create&&(i=e)}if(i<0)s[a]=this.createTooltipView(n,a?s[a-1]:null),o&&(o[a]=!!n.above);else{let n=s[a]=this.tooltipViews[i];o&&(o[a]=t[i]),n.update&&n.update(e)}}}for(let a of this.tooltipViews)s.indexOf(a)<0&&(this.removeTooltipView(a),null===(n=a.destroy)||void 0===n||n.call(a));return t&&(o.forEach((e,n)=>t[n]=e),t.length=o.length),this.input=i,this.tooltips=r,this.tooltipViews=s,!0}}function rc(e){let t=e.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:t.clientHeight,right:t.clientWidth}}const sc=Tn.define({combine:e=>{var t,n,i;return{position:cr.ios?"absolute":(null===(t=e.find(e=>e.position))||void 0===t?void 0:t.position)||"fixed",parent:(null===(n=e.find(e=>e.parent))||void 0===n?void 0:n.parent)||null,tooltipSpace:(null===(i=e.find(e=>e.tooltipSpace))||void 0===i?void 0:i.tooltipSpace)||rc}}}),oc=new WeakMap,ac=Ms.fromClass(class{constructor(e){this.view=e,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=e.state.facet(sc);this.position=t.position,this.parent=t.parent,this.classes=e.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver="function"==typeof ResizeObserver?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new ic(e,hc,(e,t)=>this.createTooltip(e,t),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),e.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let e of this.manager.tooltipViews)this.intersectionObserver.observe(e.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(e){e.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(e,this.above);t&&this.observeIntersection();let n=t||e.geometryChanged,i=e.state.facet(sc);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let e of this.manager.tooltipViews)e.dom.style.position=this.position;n=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let e of this.manager.tooltipViews)this.container.appendChild(e.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(e,t){let n=e.create(this.view),i=t?t.dom:null;if(n.dom.classList.add("cm-tooltip"),e.arrow&&!n.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow",n.dom.appendChild(e)}return n.dom.style.position=this.position,n.dom.style.top=nc,n.dom.style.left="0px",this.container.insertBefore(n.dom,i),n.mount&&n.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(n.dom),n}destroy(){var e,t,n;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),null===(e=i.destroy)||void 0===e||e.call(i);this.parent&&this.container.remove(),null===(t=this.resizeObserver)||void 0===t||t.disconnect(),null===(n=this.intersectionObserver)||void 0===n||n.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let e=1,t=1,n=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:e}=this.manager.tooltipViews[0];if(cr.safari){let t=e.getBoundingClientRect();n=Math.abs(t.top+1e4)>1||Math.abs(t.left)>1}else n=!!e.offsetParent&&e.offsetParent!=this.container.ownerDocument.body}if(n||"absolute"==this.position)if(this.parent){let n=this.parent.getBoundingClientRect();n.width&&n.height&&(e=n.width/this.parent.offsetWidth,t=n.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:t}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),r=Ws(this.view);return{visible:{left:i.left+r.left,top:i.top+r.top,right:i.right-r.right,bottom:i.bottom-r.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((e,t)=>{let n=this.manager.tooltipViews[t];return n.getCoords?n.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(e=>{let{dom:t}=e;return t.getBoundingClientRect()}),space:this.view.state.facet(sc).tooltipSpace(this.view),scaleX:e,scaleY:t,makeAbsolute:n}}writeMeasure(e){var t;if(e.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let e of this.manager.tooltipViews)e.dom.style.position="absolute"}let{visible:n,space:i,scaleX:r,scaleY:s}=e,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:u}=c,h=e.pos[a],d=e.size[a];if(!h||!1!==l.clip&&(h.bottom<=Math.max(n.top,i.top)||h.top>=Math.min(n.bottom,i.bottom)||h.right<Math.max(n.left,i.left)-.1||h.left>Math.min(n.right,i.right)+.1)){u.style.top=nc;continue}let p=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,f=p?7:0,m=d.right-d.left,g=null!==(t=oc.get(c))&&void 0!==t?t:d.bottom-d.top,v=c.offset||uc,y=this.view.textDirection==Xr.LTR,O=d.width>i.right-i.left?y?i.left:i.right-d.width:y?Math.max(i.left,Math.min(h.left-(p?14:0)+v.x,i.right-m)):Math.min(Math.max(i.left,h.left-m+(p?14:0)-v.x),i.right-m),w=this.above[a];!l.strictSide&&(w?h.top-g-f-v.y<i.top:h.bottom+g+f+v.y>i.bottom)&&w==i.bottom-h.bottom>h.top-i.top&&(w=this.above[a]=!w);let b=(w?h.top-i.top:i.bottom-h.bottom)-f;if(b<g&&!1!==c.resize){if(b<this.view.defaultLineHeight){u.style.top=nc;continue}oc.set(c,g),u.style.height=(g=b)/s+"px"}else u.style.height&&(u.style.height="");let k=w?h.top-g-f-v.y:h.bottom+f+v.y,x=O+m;if(!0!==c.overlap)for(let e of o)e.left<x&&e.right>O&&e.top<k+g&&e.bottom>k&&(k=w?e.top-g-2-f:e.bottom+f+2);if("absolute"==this.position?(u.style.top=(k-e.parent.top)/s+"px",lc(u,(O-e.parent.left)/r)):(u.style.top=k/s+"px",lc(u,O/r)),p){let e=h.left+(y?v.x:-v.x)-(O+14-7);p.style.left=e/r+"px"}!0!==c.overlap&&o.push({left:O,top:k,right:x,bottom:k+g}),u.classList.toggle("cm-tooltip-above",w),u.classList.toggle("cm-tooltip-below",!w),c.positioned&&c.positioned(e.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let e of this.manager.tooltipViews)e.dom.style.top=nc}},{eventObservers:{scroll(){this.maybeMeasure()}}});function lc(e,t){let n=parseInt(e.style.left,10);(isNaN(n)||Math.abs(t-n)>1)&&(e.style.left=t+"px")}const cc=sl.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"".concat(7,"px"),width:"".concat(14,"px"),position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"".concat(7,"px solid transparent"),borderRight:"".concat(7,"px solid transparent")},".cm-tooltip-above &":{bottom:"-".concat(7,"px"),"&:before":{borderTop:"".concat(7,"px solid #bbb")},"&:after":{borderTop:"".concat(7,"px solid #f5f5f5"),bottom:"1px"}},".cm-tooltip-below &":{top:"-".concat(7,"px"),"&:before":{borderBottom:"".concat(7,"px solid #bbb")},"&:after":{borderBottom:"".concat(7,"px solid #f5f5f5"),top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),uc={x:0,y:0},hc=Tn.define({enables:[ac,cc]});function dc(e,t){let n=e.plugin(ac);if(!n)return null;let i=n.manager.tooltips.indexOf(t);return i<0?null:n.manager.tooltipViews[i]}class pc extends wi{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}pc.prototype.elementClass="",pc.prototype.toDOM=void 0,pc.prototype.mapMode=vn.TrackBefore,pc.prototype.startSide=pc.prototype.endSide=-1,pc.prototype.point=!0;const fc=Tn.define(),mc=Tn.define(),gc={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Si.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},vc=Tn.define();function yc(e){return[wc(),vc.of(p(p({},gc),e))]}const Oc=Tn.define({combine:e=>e.some(e=>e)});function wc(e){let t=[bc];return e&&!1===e.fixed&&t.push(Oc.of(!0)),t}const bc=Ms.fromClass(class{constructor(e){this.view=e,this.domAfter=null,this.prevViewport=e.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=e.state.facet(vc).map(t=>new Sc(e,t)),this.fixed=!e.state.facet(Oc);for(let t of this.gutters)"after"==t.config.side?this.getDOMAfter().appendChild(t.dom):this.dom.appendChild(t.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),e.scrollDOM.insertBefore(this.dom,e.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(e){if(this.updateGutters(e)){let t=this.prevViewport,n=e.view.viewport,i=Math.min(t.to,n.to)-Math.max(t.from,n.from);this.syncGutters(i<.8*(n.to-n.from))}if(e.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(Oc)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=e.view.viewport}syncGutters(e){let t=this.dom.nextSibling;e&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let n=Si.iter(this.view.state.facet(fc),this.view.viewport.from),i=[],r=this.gutters.map(e=>new Dc(e,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(s.type)){let e=!0;for(let t of s.type)if(t.type==gr.Text&&e){xc(n,i,t.from);for(let e of r)e.line(this.view,t,i);e=!1}else if(t.widget)for(let e of r)e.widget(this.view,t)}else if(s.type==gr.Text){xc(n,i,s.from);for(let e of r)e.line(this.view,s,i)}else if(s.widget)for(let e of r)e.widget(this.view,s);for(let s of r)s.finish();e&&(this.view.scrollDOM.insertBefore(this.dom,t),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(e){let t=e.startState.facet(vc),n=e.state.facet(vc),i=e.docChanged||e.heightChanged||e.viewportChanged||!Si.eq(e.startState.facet(fc),e.state.facet(fc),e.view.viewport.from,e.view.viewport.to);if(t==n)for(let r of this.gutters)r.update(e)&&(i=!0);else{i=!0;let r=[];for(let i of n){let n=t.indexOf(i);n<0?r.push(new Sc(this.view,i)):(this.gutters[n].update(e),r.push(this.gutters[n]))}for(let e of this.gutters)e.dom.remove(),r.indexOf(e)<0&&e.destroy();for(let e of r)"after"==e.config.side?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.gutters=r}return i}destroy(){for(let e of this.gutters)e.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:e=>sl.scrollMargins.of(t=>{let n=t.plugin(e);if(!n||0==n.gutters.length||!n.fixed)return null;let i=n.dom.offsetWidth*t.scaleX,r=n.domAfter?n.domAfter.offsetWidth*t.scaleX:0;return t.textDirection==Xr.LTR?{left:i,right:r}:{right:i,left:r}})});function kc(e){return Array.isArray(e)?e:[e]}function xc(e,t,n){for(;e.value&&e.from<=n;)e.from==n&&t.push(e.value),e.next()}class Dc{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=Si.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:i}=this,r=(t.top-this.height)/e.scaleY,s=t.height/e.scaleY;if(this.i==i.elements.length){let t=new Cc(e,s,r,n);i.elements.push(t),i.dom.appendChild(t.dom)}else i.elements[this.i].update(e,s,r,n);this.height=t.bottom,this.i++}line(e,t,n){let i=[];xc(this.cursor,i,t.from),n.length&&(i=i.concat(n));let r=this.gutter.config.lineMarker(e,t,i);r&&i.unshift(r);let s=this.gutter;(0!=i.length||s.config.renderEmptyElements)&&this.addElement(e,t,i)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t),i=n?[n]:null;for(let r of e.state.facet(mc)){let n=r(e,t.widget,t);n&&(i||(i=[])).push(n)}i&&this.addElement(e,t,i)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Sc{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,i=>{let r,s=i.target;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let e=s.getBoundingClientRect();r=(e.top+e.bottom)/2}else r=i.clientY;let o=e.lineBlockAtHeight(r-e.documentTop);t.domEventHandlers[n](e,o,i)&&i.preventDefault()});this.markers=kc(t.markers(e)),t.initialSpacer&&(this.spacer=new Cc(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=kc(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let t=this.config.updateSpacer(this.spacer.markers[0],e);t!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[t])}let n=e.view.viewport;return!Si.eq(this.markers,t,n.from,n.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)}destroy(){for(let e of this.elements)e.destroy()}}class Cc{constructor(e,t,n,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,i)}update(e,t,n,i){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),function(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].compare(t[n]))return!1;return!0}(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let n="cm-gutterElement",i=this.dom.firstChild;for(let r=0,s=0;;){let o=s,a=r<t.length?t[r++]:null,l=!1;if(a){let e=a.elementClass;e&&(n+=" "+e);for(let t=s;t<this.markers.length;t++)if(this.markers[t].compare(a)){o=t,l=!0;break}}else o=this.markers.length;for(;s<o;){let e=this.markers[s++];if(e.toDOM){e.destroy(i);let t=i.nextSibling;i.remove(),i=t}}if(!a)break;a.toDOM&&(l?i=i.nextSibling:this.dom.insertBefore(a.toDOM(e),i)),l&&s++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}const Ac=Tn.define(),Ec=Tn.define(),_c=Tn.define({combine:e=>Oi(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let i in t){let e=n[i],r=t[i];n[i]=e?(t,n,i)=>e(t,n,i)||r(t,n,i):r}return n}})});class Tc extends pc{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Pc(e,t){return e.state.facet(_c).formatNumber(t,e.state)}const Mc=vc.compute([_c],e=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:e=>e.state.facet(Ac),lineMarker:(e,t,n)=>n.some(e=>e.toDOM)?null:new Tc(Pc(e,e.state.doc.lineAt(t.from).number)),widgetMarker:(e,t,n)=>{for(let i of e.state.facet(Ec)){let r=i(e,t,n);if(r)return r}return null},lineMarkerChange:e=>e.startState.facet(_c)!=e.state.facet(_c),initialSpacer:e=>new Tc(Pc(e,Rc(e.state.doc.lines))),updateSpacer(e,t){let n=Pc(t.view,Rc(t.view.state.doc.lines));return n==e.number?e:new Tc(n)},domEventHandlers:e.facet(_c).domEventHandlers,side:"before"}));function Fc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[_c.of(e),wc(),Mc]}function Rc(e){let t=9;for(;t<e;)t=10*t+9;return t}const Nc=new class extends pc{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Ic=fc.compute(["selection"],e=>{let t=[],n=-1;for(let i of e.selection.ranges){let r=e.doc.lineAt(i.head).from;r>n&&(n=r,t.push(Nc.range(r)))}return Si.of(t)});const Bc=1024;let Qc=0;class Lc{constructor(e,t){this.from=e,this.to=t}}class jc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id=Qc++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=Wc.match(e)),t=>{let n=e(t);return void 0===n?null:[this,n]}}}jc.closedBy=new jc({deserialize:e=>e.split(" ")}),jc.openedBy=new jc({deserialize:e=>e.split(" ")}),jc.group=new jc({deserialize:e=>e.split(" ")}),jc.isolate=new jc({deserialize:e=>{if(e&&"rtl"!=e&&"ltr"!=e&&"auto"!=e)throw new RangeError("Invalid value for isolate: "+e);return e||"auto"}}),jc.contextHash=new jc({perNode:!0}),jc.lookAhead=new jc({perNode:!0}),jc.mounted=new jc({perNode:!0});class $c{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.tree=e,this.overlay=t,this.parser=n,this.bracketed=i}static get(e){return e&&e.props&&e.props[jc.mounted.id]}}const zc=Object.create(null);class Wc{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):zc,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0),i=new Wc(e.name||"",t,e.id,n);if(e.props)for(let r of e.props)if(Array.isArray(r)||(r=r(i)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}return i}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(jc.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return e=>{for(let n=e.prop(jc.group),i=-1;i<(n?n.length:0);i++){let r=t[i<0?e.name:n[i]];if(r)return r}}}}Wc.none=new Wc("",Object.create(null),0,8);class Vc{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(){let e=[];for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(let r of this.types){let t=null;for(let e of n){let n=e(r);if(n){t||(t=Object.assign({},r.props));let e=n[1],i=n[0];i.combine&&i.id in t&&(e=i.combine(t[i.id],e)),t[i.id]=e}}e.push(t?new Wc(r.name,t,r.id,r.flags):r)}return new Vc(e)}}const Uc=new WeakMap,Xc=new WeakMap;var qc;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays",e[e.EnterBracketed=16]="EnterBracketed"}(qc||(qc={}));class Zc{constructor(e,t,n,i,r){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,r&&r.length){this.props=Object.create(null);for(let[e,t]of r)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=$c.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let e=n.toString();e&&(t&&(t+=","),t+=e)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new au(this.topNode,e)}cursorAt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Uc.get(this)||this.topNode,i=new au(n);return i.moveTo(e,t),Uc.set(this,i._tree),i}get topNode(){return new eu(this,0,0,null)}resolve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Kc(Uc.get(this)||this.topNode,e,t,!1);return Uc.set(this,n),n}resolveInner(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Kc(Xc.get(this)||this.topNode,e,t,!0);return Xc.set(this,n),n}resolveStack(e){return function(e,t,n){let i=e.resolveInner(t,n),r=null;for(let s=i instanceof eu?i:i.context.parent;s;s=s.parent)if(s.index<0){let e=s.parent;(r||(r=[i])).push(e.resolve(t,n)),s=e}else{let e=$c.get(s.tree);if(e&&e.overlay&&e.overlay[0].from<=t&&e.overlay[e.overlay.length-1].to>=t){let o=new eu(e.tree,e.overlay[0].from+s.from,-1,s);(r||(r=[i])).push(Kc(o,t,n,!1))}}return r?su(r):i}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}iterate(e){let{enter:t,leave:n,from:i=0,to:r=this.length}=e,s=e.mode||0,o=(s&qc.IncludeAnonymous)>0;for(let a=this.cursor(s|qc.IncludeAnonymous);;){let e=!1;if(a.from<=r&&a.to>=i&&(!o&&a.type.isAnonymous||!1!==t(a))){if(a.firstChild())continue;e=!0}for(;e&&n&&(o||!a.type.isAnonymous)&&n(a),!a.nextSibling();){if(!a.parent())return;e=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.children.length<=8?this:hu(Wc.none,this.children,this.positions,0,this.children.length,0,this.length,(e,t,n)=>new Zc(this.type,e,t,n,this.propValues),e.makeTree||((e,t,n)=>new Zc(Wc.none,e,t,n)))}static build(e){return function(e){var t;let{buffer:n,nodeSet:i,maxBufferLength:r=Bc,reused:s=[],minRepeatType:o=i.types.length}=e,a=Array.isArray(n)?new Hc(n,n.length):n,l=i.types,c=0,u=0;function h(e,t,n,y,O,w){let{id:b,start:k,end:x,size:D}=a,S=u,C=c;if(D<0){if(a.next(),-1==D){let t=s[b];return n.push(t),void y.push(k-e)}if(-3==D)return void(c=b);if(-4==D)return void(u=b);throw new RangeError("Unrecognized record size: ".concat(D))}let A,E,_=l[b],T=k-e;if(x-k<=r&&(E=g(a.pos-t,O))){let t=new Uint16Array(E.size-E.skip),n=a.pos-E.size,r=t.length;for(;a.pos>n;)r=v(E.start,t,r);A=new Yc(t,x-E.start,i),T=E.start-e}else{let e=a.pos-D;a.next();let t=[],n=[],i=b>=o?b:-1,s=0,l=x;for(;a.pos>e;)i>=0&&a.id==i&&a.size>=0?(a.end<=l-r&&(f(t,n,k,s,a.end,l,i,S,C),s=t.length,l=a.end),a.next()):w>2500?d(k,e,t,n):h(k,e,t,n,i,w+1);if(i>=0&&s>0&&s<t.length&&f(t,n,k,s,k,l,i,S,C),t.reverse(),n.reverse(),i>-1&&s>0){let e=p(_,C);A=hu(_,t,n,0,t.length,0,x-k,e,e)}else A=m(_,t,n,x-k,S-x,C)}n.push(A),y.push(T)}function d(e,t,n,s){let o=[],l=0,c=-1;for(;a.pos>t;){let{id:e,start:t,end:n,size:i}=a;if(i>4)a.next();else{if(c>-1&&t<c)break;c<0&&(c=n-r),o.push(e,t,n),l++,a.next()}}if(l){let t=new Uint16Array(4*l),r=o[o.length-2];for(let e=o.length-3,n=0;e>=0;e-=3)t[n++]=o[e],t[n++]=o[e+1]-r,t[n++]=o[e+2]-r,t[n++]=n;n.push(new Yc(t,o[2]-r,i)),s.push(r-e)}}function p(e,t){return(n,i,r)=>{let s,o,a=0,l=n.length-1;if(l>=0&&(s=n[l])instanceof Zc){if(!l&&s.type==e&&s.length==r)return s;(o=s.prop(jc.lookAhead))&&(a=i[l]+s.length+o)}return m(e,n,i,r,a,t)}}function f(e,t,n,r,s,o,a,l,c){let u=[],h=[];for(;e.length>r;)u.push(e.pop()),h.push(t.pop()+n-s);e.push(m(i.types[a],u,h,o-s,l-o,c)),t.push(s-n)}function m(e,t,n,i,r,s,o){if(s){let e=[jc.contextHash,s];o=o?[e].concat(o):[e]}if(r>25){let e=[jc.lookAhead,r];o=o?[e].concat(o):[e]}return new Zc(e,t,n,i,o)}function g(e,t){let n=a.fork(),i=0,s=0,l=0,c=n.end-r,u={size:0,start:0,skip:0};e:for(let r=n.pos-e;n.pos>r;){let e=n.size;if(n.id==t&&e>=0){u.size=i,u.start=s,u.skip=l,l+=4,i+=4,n.next();continue}let a=n.pos-e;if(e<0||a<r||n.start<c)break;let h=n.id>=o?4:0,d=n.start;for(n.next();n.pos>a;){if(n.size<0){if(-3!=n.size&&-4!=n.size)break e;h+=4}else n.id>=o&&(h+=4);n.next()}s=d,i+=e,l+=h}return(t<0||i==e)&&(u.size=i,u.start=s,u.skip=l),u.size>4?u:void 0}function v(e,t,n){let{id:i,start:r,end:s,size:l}=a;if(a.next(),l>=0&&i<o){let o=n;if(l>4){let i=a.pos-(l-4);for(;a.pos>i;)n=v(e,t,n)}t[--n]=o,t[--n]=s-e,t[--n]=r-e,t[--n]=i}else-3==l?c=i:-4==l&&(u=i);return n}let y=[],O=[];for(;a.pos>0;)h(e.start||0,e.bufferStart||0,y,O,-1,0);let w=null!==(t=e.length)&&void 0!==t?t:y.length?O[0]+y[0].length:0;return new Zc(l[e.topID],y.reverse(),O.reverse(),w)}(e)}}Zc.empty=new Zc(Wc.none,[],[],0);class Hc{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Hc(this.buffer,this.index)}}class Yc{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Wc.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],r=i.name;if(/\W/.test(r)&&!i.isError&&(r=JSON.stringify(r)),n==(e+=4))return r;let s=[];for(;e<n;)s.push(this.childString(e)),e=this.buffer[e+3];return r+"("+s.join(",")+")"}findChild(e,t,n,i,r){let{buffer:s}=this,o=-1;for(let a=e;a!=t&&!(Gc(r,i,s[a+1],s[a+2])&&(o=a,n>0));a=s[a+3]);return o}slice(e,t,n){let i=this.buffer,r=new Uint16Array(t-e),s=0;for(let o=e,a=0;o<t;){r[a++]=i[o++],r[a++]=i[o++]-n;let t=r[a++]=i[o++]-n;r[a++]=i[o++]-e,s=Math.max(s,t)}return new Yc(r,s,this.set)}}function Gc(e,t,n,i){switch(e){case-2:return n<t;case-1:return i>=t&&n<t;case 0:return n<t&&i>t;case 1:return n<=t&&i>t;case 2:return i>t;case 4:return!0}}function Kc(e,t,n,i){for(var r;e.from==e.to||(n<1?e.from>=t:e.from>t)||(n>-1?e.to<=t:e.to<t);){let t=!i&&e instanceof eu&&e.index<0?null:e.parent;if(!t)return e;e=t}let s=i?0:qc.IgnoreOverlays;if(i)for(let o=e,a=o.parent;a;o=a,a=o.parent)o instanceof eu&&o.index<0&&(null===(r=a.enter(t,n,s))||void 0===r?void 0:r.from)!=o.from&&(e=a);for(;;){let i=e.enter(t,n,s);if(!i)return e;e=i}}class Jc{cursor(){return new au(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)}getChild(e){let t=tu(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);return t.length?t[0]:null}getChildren(e){return tu(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}resolve(e){return Kc(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!1)}resolveInner(e){return Kc(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!0)}matchContext(e){return nu(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let e=t.lastChild;if(!e||e.to!=t.to)break;e.type.isError&&e.from==e.to?(n=t,t=e.prevSibling):t=e}return n}get node(){return this}get next(){return this.parent}}class eu extends Jc{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;for(let s=this;;){for(let{children:o,positions:a}=s._tree,l=t>0?o.length:-1;e!=l;e+=t){let l,c=o[e],u=a[e]+s.from;if(r&qc.EnterBracketed&&c instanceof Zc&&(l=$c.get(c))&&!l.overlay&&l.bracketed&&n>=u&&n<=u+c.length||Gc(i,n,u,u+c.length))if(c instanceof Yc){if(r&qc.ExcludeBuffers)continue;let o=c.findChild(0,c.buffer.length,t,n-u,i);if(o>-1)return new ru(new iu(s,c,e,u),null,o)}else if(r&qc.IncludeAnonymous||!c.type.isAnonymous||lu(c)){let o;if(!(r&qc.IgnoreMounts)&&(o=$c.get(c))&&!o.overlay)return new eu(o.tree,u,e,s);let a=new eu(c,u,e,s);return r&qc.IncludeAnonymous||!a.type.isAnonymous?a:a.nextChild(t<0?c.children.length-1:0,t,n,i,r)}}if(r&qc.IncludeAnonymous||!s.type.isAnonymous)return null;if(e=s.index>=0?s.index+t:t<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!(i&qc.IgnoreOverlays)&&(n=$c.get(this._tree))&&n.overlay){let r=e-this.from,s=i&qc.EnterBracketed&&n.bracketed;for(let{from:e,to:i}of n.overlay)if((t>0||s?e<=r:e<r)&&(t<0||s?i>=r:i>r))return new eu(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function tu(e,t,n,i){let r=e.cursor(),s=[];if(!r.firstChild())return s;if(null!=n)for(let o=!1;!o;)if(o=r.type.is(n),!r.nextSibling())return s;for(;;){if(null!=i&&r.type.is(i))return s;if(r.type.is(t)&&s.push(r.node),!r.nextSibling())return null==i?s:[]}}function nu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length-1;for(let i=e;n>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[n]&&t[n]!=i.name)return!1;n--}}return!0}class iu{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}}class ru extends Jc{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,r=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return r<0?null:new ru(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,t){if((arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)&qc.ExcludeBuffers)return null;let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return i<0?null:new ru(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new ru(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new ru(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,r=n.buffer[this.index+3];if(r>i){let s=n.buffer[this.index+1];e.push(n.slice(i,r,s)),t.push(0)}return new Zc(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function su(e){if(!e.length)return null;let t=0,n=e[0];for(let s=1;s<e.length;s++){let i=e[s];(i.from>n.from||i.to<n.to)&&(n=i,t=s)}let i=n instanceof eu&&n.index<0?null:n.parent,r=e.slice();return i?r[t]=i:r.splice(t,1),new ou(r,n)}class ou{constructor(e,t){this.heads=e,this.node=t}get next(){return su(this.heads)}}class au{get name(){return this.type.name}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=t&~qc.EnterBracketed,e instanceof eu)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return!!e&&(e instanceof eu?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,r=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.mode;return this.buffer?!(n&qc.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&qc.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&qc.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let e=n<0?0:this.stack[n]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(e)}return n<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(i.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;({index:t,_parent:n}=n))if(t>-1)for(let i=t+e,r=e<0?-1:n._tree.children.length;i!=r;i+=e){let e=n._tree.children[i];if(this.mode&qc.IncludeAnonymous||e instanceof Yc||!e.type.isAnonymous||lu(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.move(1,e)}prev(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.move(-1,e)}moveTo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,r=this.stack.length;r>=0;){for(let s=e;s;s=s._parent)if(s.index==i){if(i==this.index)return s;t=s,n=r+1;break e}i=this.stack[--r]}for(let i=n;i<this.stack.length;i++)t=new ru(this.buffer,t,this.stack[i]);return this.bufferNode=new ru(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return nu(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,r=this.stack.length-1;i>=0;r--){if(r<0)return nu(this._tree,e,i);let s=n[t.buffer[this.stack[r]]];if(!s.isAnonymous){if(e[i]&&e[i]!=s.name)return!1;i--}}return!0}}function lu(e){return e.children.some(e=>e instanceof Yc||!e.type.isAnonymous||lu(e))}const cu=new WeakMap;function uu(e,t){if(!e.isAnonymous||t instanceof Yc||t.type!=e)return 1;let n=cu.get(t);if(null==n){n=1;for(let i of t.children){if(i.type!=e||!(i instanceof Zc)){n=1;break}n+=uu(e,i)}cu.set(t,n)}return n}function hu(e,t,n,i,r,s,o,a,l){let c=0;for(let p=i;p<r;p++)c+=uu(e,t[p]);let u=Math.ceil(1.5*c/8),h=[],d=[];return function t(n,i,r,o,a){for(let c=r;c<o;){let r=c,p=i[c],f=uu(e,n[c]);for(c++;c<o;c++){let t=uu(e,n[c]);if(f+t>=u)break;f+=t}if(c==r+1){if(f>u){let e=n[r];t(e.children,e.positions,0,e.children.length,i[r]+a);continue}h.push(n[r])}else{let t=i[c-1]+n[c-1].length-p;h.push(hu(e,n,i,r,c,p,t,null,l))}d.push(p+a-s)}}(t,n,i,r,0),(a||l)(h,d,o)}class du{constructor(){this.map=new WeakMap}setBuffer(e,t,n){let i=this.map.get(e);i||this.map.set(e,i=new Map),i.set(t,n)}getBuffer(e,t){let n=this.map.get(e);return n&&n.get(t)}set(e,t){e instanceof ru?this.setBuffer(e.context.buffer,e.index,t):e instanceof eu&&this.map.set(e.tree,t)}get(e){return e instanceof ru?this.getBuffer(e.context.buffer,e.index):e instanceof eu?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class pu{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[new pu(0,e.length,e,0,!1,n)];for(let r of t)r.to>e.length&&i.push(r);return i}static applyChanges(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128;if(!t.length)return e;let i=[],r=1,s=e.length?e[0]:null;for(let o=0,a=0,l=0;;o++){let c=o<t.length?t[o]:null,u=c?c.fromA:1e9;if(u-a>=n)for(;s&&s.from<u;){let t=s;if(a>=t.from||u<=t.to||l){let e=Math.max(t.from,a)-l,n=Math.min(t.to,u)-l;t=e>=n?null:new pu(e,n,t.tree,t.offset+l,o>0,!!c)}if(t&&i.push(t),s.to>u)break;s=r<e.length?e[r++]:null}if(!c)break;a=c.toA,l=c.toA-c.toB}return i}}class fu{startParse(e,t,n){return"string"==typeof e&&(e=new mu(e)),n=n?n.length?n.map(e=>new Lc(e.from,e.to)):[new Lc(0,0)]:[new Lc(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let e=i.advance();if(e)return e}}}class mu{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function gu(e){return(t,n,i,r)=>new bu(t,e,n,i,r)}class vu{constructor(e,t,n,i,r,s){this.parser=e,this.parse=t,this.overlay=n,this.bracketed=i,this.target=r,this.from=s}}function yu(e){if(!e.length||e.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(e))}class Ou{constructor(e,t,n,i,r,s,o,a){this.parser=e,this.predicate=t,this.mounts=n,this.index=i,this.start=r,this.bracketed=s,this.target=o,this.prev=a,this.depth=0,this.ranges=[]}}const wu=new jc({perNode:!0});class bu{constructor(e,t,n,i,r){this.nest=t,this.input=n,this.fragments=i,this.ranges=r,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let e=this.baseParse.advance();if(!e)return null;if(this.baseParse=null,this.baseTree=e,this.startInner(),null!=this.stoppedAt)for(let t of this.inner)t.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let e=this.baseTree;return null!=this.stoppedAt&&(e=new Zc(e.type,e.children,e.positions,e.length,e.propValues.concat([[wu,this.stoppedAt]]))),e}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[jc.mounted.id]=new $c(t,e.overlay,e.parser,e.bracketed),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new Cu(this.fragments),t=null,n=null,i=new au(new eu(this.baseTree,this.ranges[0].from,0,null),qc.IncludeAnonymous|qc.IgnoreMounts);e:for(let r,s;;){let o,a=!0;if(null!=this.stoppedAt&&i.from>=this.stoppedAt)a=!1;else if(e.hasNode(i)){if(t){let e=t.mounts.find(e=>e.frag.from<=i.from&&e.frag.to>=i.to&&e.mount.overlay);if(e)for(let n of e.mount.overlay){let r=n.from+e.pos,s=n.to+e.pos;r>=i.from&&s<=i.to&&!t.ranges.some(e=>e.from<s&&e.to>r)&&t.ranges.push({from:r,to:s})}}a=!1}else if(n&&(s=ku(n.ranges,i.from,i.to)))a=2!=s;else if(!i.type.isAnonymous&&(r=this.nest(i,this.input))&&(i.from<i.to||!r.overlay)){i.tree||(Du(i),t&&t.depth++,n&&n.depth++);let s=e.findMounts(i.from,r.parser);if("function"==typeof r.overlay)t=new Ou(r.parser,r.overlay,s,this.inner.length,i.from,!!r.bracketed,i.tree,t);else{let e=Au(this.ranges,r.overlay||(i.from<i.to?[new Lc(i.from,i.to)]:[]));e.length&&yu(e),!e.length&&r.overlay||this.inner.push(new vu(r.parser,e.length?r.parser.startParse(this.input,_u(s,e),e):r.parser.startParse(""),r.overlay?r.overlay.map(e=>new Lc(e.from-i.from,e.to-i.from)):null,!!r.bracketed,i.tree,e.length?e[0].from:i.from)),r.overlay?e.length&&(n={ranges:e,depth:0,prev:n}):a=!1}}else if(t&&(o=t.predicate(i))&&(!0===o&&(o=new Lc(i.from,i.to)),o.from<o.to)){let e=t.ranges.length-1;e>=0&&t.ranges[e].to==o.from?t.ranges[e]={from:t.ranges[e].from,to:o.to}:t.ranges.push(o)}if(a&&i.firstChild())t&&t.depth++,n&&n.depth++;else for(;!i.nextSibling();){if(!i.parent())break e;if(t&&! --t.depth){let e=Au(this.ranges,t.ranges);e.length&&(yu(e),this.inner.splice(t.index,0,new vu(t.parser,t.parser.startParse(this.input,_u(t.mounts,e),e),t.ranges.map(e=>new Lc(e.from-t.start,e.to-t.start)),t.bracketed,t.target,e[0].from))),t=t.prev}n&&! --n.depth&&(n=n.prev)}}}}function ku(e,t,n){for(let i of e){if(i.from>=n)break;if(i.to>t)return i.from<=t&&i.to>=n?2:1}return 0}function xu(e,t,n,i,r,s){if(t<n){let o=e.buffer[t+1];i.push(e.slice(t,n,o)),r.push(o-s)}}function Du(e){let{node:t}=e,n=[],i=t.context.buffer;do{n.push(e.index),e.parent()}while(!e.tree);let r=e.tree,s=r.children.indexOf(i),o=r.children[s],a=o.buffer,l=[s];r.children[s]=function e(i,r,s,c,u,h){let d=n[h],p=[],f=[];xu(o,i,d,p,f,c);let m=a[d+1],g=a[d+2];l.push(p.length);let v=h?e(d+4,a[d+3],o.set.types[a[d]],m,g-m,h-1):t.toTree();return p.push(v),f.push(m-c),xu(o,a[d+3],r,p,f,c),new Zc(s,p,f,u)}(0,a.length,Wc.none,0,o.length,n.length-1);for(let c of l){let t=e.tree.children[c],n=e.tree.positions[c];e.yield(new eu(t,n+e.from,c,e._tree))}}class Su{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(qc.IncludeAnonymous|qc.IgnoreMounts)}moveTo(e){let{cursor:t}=this,n=e-this.offset;for(;!this.done&&t.from<n;)t.to>=e&&t.enter(n,1,qc.IgnoreOverlays|qc.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(!(t.children.length&&0==t.positions[0]&&t.children[0]instanceof Zc))break;t=t.children[0]}return!1}}class Cu{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=null!==(t=n.tree.prop(wu))&&void 0!==t?t:n.to,this.inner=new Su(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=null!==(e=t.tree.prop(wu))&&void 0!==e?e:t.to,this.inner=new Su(t.tree,-t.offset)}}findMounts(e,t){var n;let i=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let e=this.inner.cursor.node;e;e=e.parent){let r=null===(n=e.tree)||void 0===n?void 0:n.prop(jc.mounted);if(r&&r.parser==t)for(let t=this.fragI;t<this.fragments.length;t++){let n=this.fragments[t];if(n.from>=e.to)break;n.tree==this.curFrag.tree&&i.push({frag:n,pos:e.from-n.offset,mount:r})}}}return i}}function Au(e,t){let n=null,i=t;for(let r=1,s=0;r<e.length;r++){let o=e[r-1].to,a=e[r].from;for(;s<i.length;s++){let e=i[s];if(e.from>=a)break;e.to<=o||(n||(i=n=t.slice()),e.from<o?(n[s]=new Lc(e.from,o),e.to>a&&n.splice(s+1,0,new Lc(a,e.to))):e.to>a?n[s--]=new Lc(a,e.to):n.splice(s--,1))}}return i}function Eu(e,t,n,i){let r=0,s=0,o=!1,a=!1,l=-1e9,c=[];for(;;){let u=r==e.length?1e9:o?e[r].to:e[r].from,h=s==t.length?1e9:a?t[s].to:t[s].from;if(o!=a){let e=Math.max(l,n),t=Math.min(u,h,i);e<t&&c.push(new Lc(e,t))}if(l=Math.min(u,h),1e9==l)break;u==l&&(o?(o=!1,r++):o=!0),h==l&&(a?(a=!1,s++):a=!0)}return c}function _u(e,t){let n=[];for(let{pos:i,mount:r,frag:s}of e){let e=i+(r.overlay?r.overlay[0].from:0),o=e+r.tree.length,a=Math.max(s.from,e),l=Math.min(s.to,o);if(r.overlay){let o=Eu(t,r.overlay.map(e=>new Lc(e.from+i,e.to+i)),a,l);for(let t=0,i=a;;t++){let a=t==o.length,c=a?l:o[t].from;if(c>i&&n.push(new pu(i,c,r.tree,-e,s.from>=i||s.openStart,s.to<=c||s.openEnd)),a)break;i=o[t].to}}else n.push(new pu(a,l,r.tree,-e,s.from>=e||s.openStart,s.to<=o||s.openEnd))}return n}let Tu=0;class Pu{constructor(e,t,n,i){this.name=e,this.set=t,this.base=n,this.modified=i,this.id=Tu++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e="".concat(t.name,"(").concat(e,")"));return e}static define(e,t){let n="string"==typeof e?e:"?";if(e instanceof Pu&&(t=e),null===t||void 0===t?void 0:t.base)throw new Error("Can not derive from a modified tag");let i=new Pu(n,[],null,[]);if(i.set.push(i),t)for(let r of t.set)i.set.push(r);return i}static defineModifier(e){let t=new Fu(e);return e=>e.modified.indexOf(t)>-1?e:Fu.get(e.base||e,e.modified.concat(t).sort((e,t)=>e.id-t.id))}}let Mu=0;class Fu{constructor(e){this.name=e,this.instances=[],this.id=Mu++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(n=>{return n.base==e&&(i=t,r=n.modified,i.length==r.length&&i.every((e,t)=>e==r[t]));var i,r});if(n)return n;let i=[],r=new Pu(e.name,i,e,t);for(let o of t)o.instances.push(r);let s=function(e){let t=[[]];for(let n=0;n<e.length;n++)for(let i=0,r=t.length;i<r;i++)t.push(t[i].concat(e[n]));return t.sort((e,t)=>t.length-e.length)}(t);for(let o of e.set)if(!o.modified.length)for(let e of s)i.push(Fu.get(o,e));return r}}function Ru(e){let t=Object.create(null);for(let n in e){let i=e[n];Array.isArray(i)||(i=[i]);for(let e of n.split(" "))if(e){let n=[],r=2,s=e;for(let t=0;;){if("..."==s&&t>0&&t+3==e.length){r=1;break}let i=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!i)throw new RangeError("Invalid path: "+e);if(n.push("*"==i[0]?"":'"'==i[0][0]?JSON.parse(i[0]):i[0]),t+=i[0].length,t==e.length)break;let o=e[t++];if(t==e.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+e);s=e.slice(t)}let o=n.length-1,a=n[o];if(!a)throw new RangeError("Invalid path: "+e);let l=new Iu(i,r,o>0?n.slice(0,o):null);t[a]=l.sort(t[a])}}return Nu.add(t)}const Nu=new jc({combine(e,t){let n,i,r;for(;e||t;){if(!e||t&&e.depth>=t.depth?(r=t,t=t.next):(r=e,e=e.next),n&&n.mode==r.mode&&!r.context&&!n.context)continue;let s=new Iu(r.tags,r.mode,r.context);n?n.next=s:i=s,n=s}return i}});class Iu{constructor(e,t,n,i){this.tags=e,this.mode=t,this.context=n,this.next=i}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}function Bu(e,t){let n=Object.create(null);for(let s of e)if(Array.isArray(s.tag))for(let e of s.tag)n[e.id]=s.class;else n[s.tag.id]=s.class;let{scope:i,all:r=null}=t||{};return{style:e=>{let t=r;for(let i of e)for(let e of i.set){let i=n[e.id];if(i){t=t?t+" "+i:i;break}}return t},scope:i}}function Qu(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length,s=new Lu(i,Array.isArray(t)?t:[t],n);s.highlightRange(e.cursor(),i,r,"",s.highlighters),s.flush(r)}Iu.empty=new Iu([],2,null);class Lu{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,i,r){let{type:s,from:o,to:a}=e;if(o>=n||a<=t)return;s.isTop&&(r=this.highlighters.filter(e=>!e.scope||e.scope(s)));let l=i,c=function(e){let t=e.type.prop(Nu);for(;t&&t.context&&!e.matchContext(t.context);)t=t.next;return t||null}(e)||Iu.empty,u=function(e,t){let n=null;for(let i of e){let e=i.style(t);e&&(n=n?n+" "+e:e)}return n}(r,c.tags);if(u&&(l&&(l+=" "),l+=u,1==c.mode&&(i+=(i?" ":"")+u)),this.startSpan(Math.max(t,o),l),c.opaque)return;let h=e.tree&&e.tree.prop(jc.mounted);if(h&&h.overlay){let s=e.node.enter(h.overlay[0].from+o,1),c=this.highlighters.filter(e=>!e.scope||e.scope(h.tree.type)),u=e.firstChild();for(let d=0,p=o;;d++){let f=d<h.overlay.length?h.overlay[d]:null,m=f?f.from+o:a,g=Math.max(t,p),v=Math.min(n,m);if(g<v&&u)for(;e.from<v&&(this.highlightRange(e,g,v,i,r),this.startSpan(Math.min(v,e.to),l),!(e.to>=m)&&e.nextSibling()););if(!f||m>n)break;p=f.to+o,p>t&&(this.highlightRange(s.cursor(),Math.max(t,f.from+o),Math.min(n,p),"",c),this.startSpan(Math.min(n,p),l))}u&&e.parent()}else if(e.firstChild()){h&&(i="");do{if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,i,r),this.startSpan(Math.min(n,e.to),l)}}while(e.nextSibling());e.parent()}}}const ju=Pu.define,$u=ju(),zu=ju(),Wu=ju(zu),Vu=ju(zu),Uu=ju(),Xu=ju(Uu),qu=ju(Uu),Zu=ju(),Hu=ju(Zu),Yu=ju(),Gu=ju(),Ku=ju(),Ju=ju(Ku),eh=ju(),th={comment:$u,lineComment:ju($u),blockComment:ju($u),docComment:ju($u),name:zu,variableName:ju(zu),typeName:Wu,tagName:ju(Wu),propertyName:Vu,attributeName:ju(Vu),className:ju(zu),labelName:ju(zu),namespace:ju(zu),macroName:ju(zu),literal:Uu,string:Xu,docString:ju(Xu),character:ju(Xu),attributeValue:ju(Xu),number:qu,integer:ju(qu),float:ju(qu),bool:ju(Uu),regexp:ju(Uu),escape:ju(Uu),color:ju(Uu),url:ju(Uu),keyword:Yu,self:ju(Yu),null:ju(Yu),atom:ju(Yu),unit:ju(Yu),modifier:ju(Yu),operatorKeyword:ju(Yu),controlKeyword:ju(Yu),definitionKeyword:ju(Yu),moduleKeyword:ju(Yu),operator:Gu,derefOperator:ju(Gu),arithmeticOperator:ju(Gu),logicOperator:ju(Gu),bitwiseOperator:ju(Gu),compareOperator:ju(Gu),updateOperator:ju(Gu),definitionOperator:ju(Gu),typeOperator:ju(Gu),controlOperator:ju(Gu),punctuation:Ku,separator:ju(Ku),bracket:Ju,angleBracket:ju(Ju),squareBracket:ju(Ju),paren:ju(Ju),brace:ju(Ju),content:Zu,heading:Hu,heading1:ju(Hu),heading2:ju(Hu),heading3:ju(Hu),heading4:ju(Hu),heading5:ju(Hu),heading6:ju(Hu),contentSeparator:ju(Zu),list:ju(Zu),quote:ju(Zu),emphasis:ju(Zu),strong:ju(Zu),link:ju(Zu),monospace:ju(Zu),strikethrough:ju(Zu),inserted:ju(),deleted:ju(),changed:ju(),invalid:ju(),meta:eh,documentMeta:ju(eh),annotation:ju(eh),processingInstruction:ju(eh),definition:Pu.defineModifier("definition"),constant:Pu.defineModifier("constant"),function:Pu.defineModifier("function"),standard:Pu.defineModifier("standard"),local:Pu.defineModifier("local"),special:Pu.defineModifier("special")};for(let os in th){let e=th[os];e instanceof Pu&&(e.name=os)}Bu([{tag:th.link,class:"tok-link"},{tag:th.heading,class:"tok-heading"},{tag:th.emphasis,class:"tok-emphasis"},{tag:th.strong,class:"tok-strong"},{tag:th.keyword,class:"tok-keyword"},{tag:th.atom,class:"tok-atom"},{tag:th.bool,class:"tok-bool"},{tag:th.url,class:"tok-url"},{tag:th.labelName,class:"tok-labelName"},{tag:th.inserted,class:"tok-inserted"},{tag:th.deleted,class:"tok-deleted"},{tag:th.literal,class:"tok-literal"},{tag:th.string,class:"tok-string"},{tag:th.number,class:"tok-number"},{tag:[th.regexp,th.escape,th.special(th.string)],class:"tok-string2"},{tag:th.variableName,class:"tok-variableName"},{tag:th.local(th.variableName),class:"tok-variableName tok-local"},{tag:th.definition(th.variableName),class:"tok-variableName tok-definition"},{tag:th.special(th.variableName),class:"tok-variableName2"},{tag:th.definition(th.propertyName),class:"tok-propertyName tok-definition"},{tag:th.typeName,class:"tok-typeName"},{tag:th.namespace,class:"tok-namespace"},{tag:th.className,class:"tok-className"},{tag:th.macroName,class:"tok-macroName"},{tag:th.propertyName,class:"tok-propertyName"},{tag:th.operator,class:"tok-operator"},{tag:th.comment,class:"tok-comment"},{tag:th.meta,class:"tok-meta"},{tag:th.invalid,class:"tok-invalid"},{tag:th.punctuation,class:"tok-punctuation"}]);var nh;const ih=new jc;function rh(e){return Tn.define({combine:e?t=>t.concat(e):void 0})}const sh=new jc;class oh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.data=e,this.name=i,yi.prototype.hasOwnProperty("tree")||Object.defineProperty(yi.prototype,"tree",{get(){return ch(this)}}),this.parser=t,this.extension=[yh.of(this),yi.languageData.of((e,t,n)=>{let i=ah(e,t,n),r=i.type.prop(ih);if(!r)return[];let s=e.facet(r),o=i.type.prop(sh);if(o){let r=i.resolve(t-i.from,n);for(let t of o)if(t.test(r,e)){let n=e.facet(t.facet);return"replace"==t.type?n:n.concat(s)}}return s})].concat(n)}isActiveAt(e,t){return ah(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1).type.prop(ih)==this.data}findRegions(e){let t=e.facet(yh);if((null===t||void 0===t?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(e,t)=>{if(e.prop(ih)==this.data)return void n.push({from:t,to:t+e.length});let r=e.prop(jc.mounted);if(r){if(r.tree.prop(ih)==this.data){if(r.overlay)for(let e of r.overlay)n.push({from:e.from+t,to:e.to+t});else n.push({from:t,to:t+e.length});return}if(r.overlay){let e=n.length;if(i(r.tree,r.overlay[0].from+t),n.length>e)return}}for(let n=0;n<e.children.length;n++){let r=e.children[n];r instanceof Zc&&i(r,e.positions[n]+t)}};return i(ch(e),0),n}get allowsNesting(){return!0}}function ah(e,t,n){let i=e.facet(yh),r=ch(e).topNode;if(!i||i.allowsNesting)for(let s=r;s;s=s.enter(t,n,qc.ExcludeBuffers|qc.EnterBracketed))s.type.isTop&&(r=s);return r}oh.setState=oi.define();class lh extends oh{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=rh(e.languageData);return new lh(t,e.parser.configure({props:[ih.add(e=>e.isTop?t:void 0)]}),e.name)}configure(e,t){return new lh(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function ch(e){let t=e.field(oh.state,!1);return t?t.tree:Zc.empty}class uh{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}let hh=null;class dh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0;this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new dh(e,t,[],Zc.empty,0,n,[],null)}startParse(){return this.parser.startParse(new uh(this.state.doc),this.fragments)}work(e,t){return null!=t&&t>=this.state.doc.length&&(t=void 0),this.tree!=Zc.empty&&this.isDone(null!==t&&void 0!==t?t:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if("number"==typeof e){let t=Date.now()+e;e=()=>Date.now()>t}for(this.parse||(this.parse=this.startParse()),null!=t&&(null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i){if(this.fragments=this.withoutTempSkipped(pu.addTree(i,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(n=this.parse.stoppedAt)&&void 0!==n?n:this.state.doc.length,this.tree=i,this.parse=null,!(this.treeLen<(null!==t&&void 0!==t?t:this.state.doc.length)))return!0;this.parse=this.startParse()}if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(pu.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=hh;hh=this;try{return e()}finally{hh=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=ph(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:r,viewport:s,skipped:o}=this;if(this.takeTree(),!e.empty){let t=[];if(e.iterChangedRanges((e,n,i,r)=>t.push({fromA:e,toA:n,fromB:i,toB:r})),n=pu.applyChanges(n,t),i=Zc.empty,r=0,s={from:e.mapPos(s.from,-1),to:e.mapPos(s.to,1)},this.skipped.length){o=[];for(let t of this.skipped){let n=e.mapPos(t.from,1),i=e.mapPos(t.to,-1);n<i&&o.push({from:n,to:i})}}}return new dh(this.parser,t,n,i,r,s,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:t,to:i}=this.skipped[n];t<e.to&&i>e.from&&(this.fragments=ph(this.fragments,t,i),this.skipped.splice(n--,1))}return!(this.skipped.length>=t)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends fu{createParse(t,n,i){let r=i[0].from,s=i[i.length-1].to;return{parsedPos:r,advance(){let t=hh;if(t){for(let e of i)t.tempSkipped.push(e);e&&(t.scheduleOn=t.scheduleOn?Promise.all([t.scheduleOn,e]):e)}return this.parsedPos=s,new Zc(Wc.none,[],[],s-r)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return hh}}function ph(e,t,n){return pu.applyChanges(e,[{fromA:t,toA:n,fromB:t,toB:n}])}class fh{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new fh(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=dh.create(e.facet(yh).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new fh(n)}}oh.state=Bn.define({create:fh.init,update(e,t){for(let n of t.effects)if(n.is(oh.setState))return n.value;return t.startState.facet(yh)!=t.state.facet(yh)?fh.init(t.state):e.apply(t)}});let mh=e=>{let t=setTimeout(()=>e(),500);return()=>clearTimeout(t)};"undefined"!=typeof requestIdleCallback&&(mh=e=>{let t=-1,n=setTimeout(()=>{t=requestIdleCallback(e,{timeout:400})},100);return()=>t<0?clearTimeout(n):cancelIdleCallback(t)});const gh="undefined"!=typeof navigator&&(null===(nh=navigator.scheduling)||void 0===nh?void 0:nh.isInputPending)?()=>navigator.scheduling.isInputPending():null,vh=Ms.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(oh.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(oh.state);t.tree==t.context.tree&&t.context.isDone(e.doc.length)||(this.working=mh(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,r=n.field(oh.state);if(r.tree==r.context.tree&&r.context.isDone(i+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,e&&!gh?Math.max(25,e.timeRemaining()-5):1e9),o=r.context.treeLen<i&&n.doc.length>i+1e3,a=r.context.work(()=>gh&&gh()||Date.now()>s,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:oh.setState.of(new fh(r.context))})),this.chunkBudget>0&&(!a||o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(e=>Es(this.view.state,e)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),yh=Tn.define({combine:e=>e.length?e[0]:null,enables:e=>[oh.state,vh,sl.contentAttributes.compute([e],t=>{let n=t.facet(e);return n&&n.name?{"data-language":n.name}:{}})]});class Oh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.language=e,this.support=t,this.extension=[e,t]}}class wh{constructor(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;this.name=e,this.alias=t,this.extensions=n,this.filename=i,this.loadFunc=r,this.support=s,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:n}=e;if(!t){if(!n)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(n)}return new wh(e.name,(e.alias||[]).concat(e.name).map(e=>e.toLowerCase()),e.extensions||[],e.filename,t,n)}static matchFilename(e,t){for(let i of e)if(i.filename&&i.filename.test(t))return i;let n=/\.([^.]+)$/.exec(t);if(n)for(let i of e)if(i.extensions.indexOf(n[1])>-1)return i;return null}static matchLanguageName(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=t.toLowerCase();for(let i of e)if(i.alias.some(e=>e==t))return i;if(n)for(let i of e)for(let e of i.alias){let n=t.indexOf(e);if(n>-1&&(e.length>2||!/\w/.test(t[n-1])&&!/\w/.test(t[n+e.length])))return i}return null}}const bh=Tn.define(),kh=Tn.define({combine:e=>{if(!e.length)return"  ";let t=e[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return t}});function xh(e){let t=e.facet(kh);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function Dh(e,t){let n="",i=e.tabSize,r=e.facet(kh)[0];if("\t"==r){for(;t>=i;)n+="\t",t-=i;r=" "}for(let s=0;s<t;s++)n+=r;return n}function Sh(e,t){e instanceof yi&&(e=new Ch(e));for(let i of e.state.facet(bh)){let n=i(e,t);if(void 0!==n)return n}let n=ch(e.state);return n.length>=t?function(e,t,n){let i=t.resolveStack(n),r=t.resolveInner(n,-1).resolve(n,0).enterUnfinishedNodesBefore(n);if(r!=i.node){let e=[];for(let t=r;t&&!(t.from<i.node.from||t.to>i.node.to||t.from==i.node.from&&t.type==i.node.type);t=t.parent)e.push(t);for(let t=e.length-1;t>=0;t--)i={node:e[t],next:i}}return Eh(i,e,n)}(e,n,t):null}class Ch{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.state=e,this.options=t,this.unit=xh(e)}lineAt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:r}=this.options;return null!=i&&i>=n.from&&i<=n.to?r&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}textAfterPos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:i}=this.lineAt(e,t);return n.slice(e-i,Math.min(n.length,e+100-i))}column(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{text:n,from:i}=this.lineAt(e,t),r=this.countColumn(n,e-i),s=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return s>-1&&(r+=s-this.countColumn(n,n.search(/\S|$/))),r}countColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;return Bi(e,this.state.tabSize,t)}lineIndent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{text:n,from:i}=this.lineAt(e,t),r=this.options.overrideIndentation;if(r){let e=r(i);if(e>-1)return e}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Ah=new jc;function Eh(e,t,n){for(let i=e;i;i=i.next){let e=_h(i.node);if(e)return e(Ph.create(t,n,i))}return 0}function _h(e){let t=e.type.prop(Ah);if(t)return t;let n,i=e.firstChild;if(i&&(n=i.type.prop(jc.closedBy))){let t=e.lastChild,i=t&&n.indexOf(t.name)>-1;return e=>Rh(e,!0,1,void 0,i&&!function(e){return e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak}(e)?t.from:void 0)}return null==e.parent?Th:null}function Th(){return 0}class Ph extends Ch{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e,t,n){return new Ph(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(Mh(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return Eh(this.context.next,this.base,this.pos)}}function Mh(e,t){for(let n=t;n;n=n.parent)if(e==n)return!0;return!1}function Fh(e){let{closing:t,align:n=!0,units:i=1}=e;return e=>Rh(e,n,i,t)}function Rh(e,t,n,i,r){let s=e.textAfter,o=s.match(/^\s*/)[0].length,a=i&&s.slice(o,o+i.length)==i||r==e.pos+o,l=t?function(e){let t=e.node,n=t.childAfter(t.from),i=t.lastChild;if(!n)return null;let r=e.options.simulateBreak,s=e.state.doc.lineAt(n.from),o=null==r||r<=s.from?s.to:Math.min(s.to,r);for(let a=n.to;;){let e=t.childAfter(a);if(!e||e==i)return null;if(!e.type.isSkipped){if(e.from>=o)return null;let t=/^ */.exec(s.text.slice(n.to-s.from))[0].length;return{from:n.from,to:n.to+t}}a=e.to}}(e):null;return l?a?e.column(l.from):e.column(l.to):e.baseIndent+(a?0:e.unit*n)}function Nh(){let{except:e,units:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n=>{let i=e&&e.test(n.textAfter);return n.baseIndent+(i?0:t*n.unit)}}const Ih=Tn.define(),Bh=new jc;function Qh(e){let t=e.firstChild,n=e.lastChild;return t&&t.to<n.from?{from:t.to,to:n.type.isError?e.to:n.from}:null}function Lh(e){let t=e.lastChild;return t&&t.to==e.to&&t.type.isError}function jh(e,t,n){for(let i of e.facet(Ih)){let r=i(e,t,n);if(r)return r}return function(e,t,n){let i=ch(e);if(i.length<n)return null;let r=null;for(let s=i.resolveStack(n,1);s;s=s.next){let o=s.node;if(o.to<=n||o.from>n)continue;if(r&&o.from<t)break;let a=o.type.prop(Bh);if(a&&(o.to<i.length-50||i.length==e.doc.length||!Lh(o))){let i=a(o,e);i&&i.from<=n&&i.from>=t&&i.to>n&&(r=i)}}return r}(e,t,n)}function $h(e,t){let n=t.mapPos(e.from,1),i=t.mapPos(e.to,-1);return n>=i?void 0:{from:n,to:i}}const zh=oi.define({map:$h}),Wh=oi.define({map:$h});function Vh(e){let t=[];for(let{head:n}of e.state.selection.ranges)t.some(e=>e.from<=n&&e.to>=n)||t.push(e.lineBlockAt(n));return t}const Uh=Bn.define({create:()=>vr.none,update(e,t){t.isUserEvent("delete")&&t.changes.iterChangedRanges((t,n)=>e=Xh(e,t,n)),e=e.map(t.changes);for(let n of t.effects)if(n.is(zh)&&!Zh(e,n.value.from,n.value.to)){let{preparePlaceholder:i}=t.state.facet(Jh),r=i?vr.replace({widget:new id(i(t.state,n.value))}):nd;e=e.update({add:[r.range(n.value.from,n.value.to)]})}else n.is(Wh)&&(e=e.update({filter:(e,t)=>n.value.from!=e||n.value.to!=t,filterFrom:n.value.from,filterTo:n.value.to}));return t.selection&&(e=Xh(e,t.selection.main.head)),e},provide:e=>sl.decorations.from(e),toJSON(e,t){let n=[];return e.between(0,t.doc.length,(e,t)=>{n.push(e,t)}),n},fromJSON(e){if(!Array.isArray(e)||e.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let n=0;n<e.length;){let i=e[n++],r=e[n++];if("number"!=typeof i||"number"!=typeof r)throw new RangeError("Invalid JSON for fold state");t.push(nd.range(i,r))}return vr.set(t,!0)}});function Xh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=!1;return e.between(t,n,(e,r)=>{e<n&&r>t&&(i=!0)}),i?e.update({filterFrom:t,filterTo:n,filter:(e,i)=>e>=n||i<=t}):e}function qh(e,t,n){var i;let r=null;return null===(i=e.field(Uh,!1))||void 0===i||i.between(t,n,(e,t)=>{(!r||r.from>e)&&(r={from:e,to:t})}),r}function Zh(e,t,n){let i=!1;return e.between(t,t,(e,r)=>{e==t&&r==n&&(i=!0)}),i}function Hh(e,t){return e.field(Uh,!1)?t:t.concat(oi.appendConfig.of(ed()))}function Yh(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.state.doc.lineAt(t.from).number,r=e.state.doc.lineAt(t.to).number;return sl.announce.of("".concat(e.state.phrase(n?"Folded lines":"Unfolded lines")," ").concat(i," ").concat(e.state.phrase("to")," ").concat(r,"."))}const Gh=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:e=>{for(let t of Vh(e)){let n=jh(e.state,t.from,t.to);if(n)return e.dispatch({effects:Hh(e.state,[zh.of(n),Yh(e,n)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:e=>{if(!e.state.field(Uh,!1))return!1;let t=[];for(let n of Vh(e)){let i=qh(e.state,n.from,n.to);i&&t.push(Wh.of(i),Yh(e,i,!1))}return t.length&&e.dispatch({effects:t}),t.length>0}},{key:"Ctrl-Alt-[",run:e=>{let{state:t}=e,n=[];for(let i=0;i<t.doc.length;){let r=e.lineBlockAt(i),s=jh(t,r.from,r.to);s&&n.push(zh.of(s)),i=(s?e.lineBlockAt(s.to):r).to+1}return n.length&&e.dispatch({effects:Hh(e.state,n)}),!!n.length}},{key:"Ctrl-Alt-]",run:e=>{let t=e.state.field(Uh,!1);if(!t||!t.size)return!1;let n=[];return t.between(0,e.state.doc.length,(e,t)=>{n.push(Wh.of({from:e,to:t}))}),e.dispatch({effects:n}),!0}}],Kh={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},Jh=Tn.define({combine:e=>Oi(e,Kh)});function ed(e){let t=[Uh,ad];return e&&t.push(Jh.of(e)),t}function td(e,t){let{state:n}=e,i=n.facet(Jh),r=t=>{let n=e.lineBlockAt(e.posAtDOM(t.target)),i=qh(e.state,n.from,n.to);i&&e.dispatch({effects:Wh.of(i)}),t.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(e,r,t);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",n.phrase("folded code")),s.title=n.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}const nd=vr.replace({widget:new class extends mr{toDOM(e){return td(e,null)}}});class id extends mr{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return td(e,this.value)}}const rd={openText:"\u2304",closedText:"\u203a",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class sd extends pc{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function od(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=p(p({},rd),e),n=new sd(t,!0),i=new sd(t,!1),r=Ms.fromClass(class{constructor(e){this.from=e.viewport.from,this.markers=this.buildMarkers(e)}update(e){(e.docChanged||e.viewportChanged||e.startState.facet(yh)!=e.state.facet(yh)||e.startState.field(Uh,!1)!=e.state.field(Uh,!1)||ch(e.startState)!=ch(e.state)||t.foldingChanged(e))&&(this.markers=this.buildMarkers(e.view))}buildMarkers(e){let t=new Ci;for(let r of e.viewportLineBlocks){let s=qh(e.state,r.from,r.to)?i:jh(e.state,r.from,r.to)?n:null;s&&t.add(r.from,r.from,s)}return t.finish()}}),{domEventHandlers:s}=t;return[r,yc({class:"cm-foldGutter",markers(e){var t;return(null===(t=e.plugin(r))||void 0===t?void 0:t.markers)||Si.empty},initialSpacer:()=>new sd(t,!1),domEventHandlers:p(p({},s),{},{click:(e,t,n)=>{if(s.click&&s.click(e,t,n))return!0;let i=qh(e.state,t.from,t.to);if(i)return e.dispatch({effects:Wh.of(i)}),!0;let r=jh(e.state,t.from,t.to);return!!r&&(e.dispatch({effects:zh.of(r)}),!0)}})}),ed()]}const ad=sl.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ld{constructor(e,t){let n;function i(e){let t=zi.newName();return(n||(n=Object.create(null)))["."+t]=e,t}this.specs=e;const r="string"==typeof t.all?t.all:t.all?i(t.all):void 0,s=t.scope;this.scope=s instanceof oh?e=>e.prop(ih)==s.data:s?e=>e==s:void 0,this.style=Bu(e.map(e=>({tag:e.tag,class:e.class||i(Object.assign({},e,{tag:null}))})),{all:r}).style,this.module=n?new zi(n):null,this.themeType=t.themeType}static define(e,t){return new ld(e,t||{})}}const cd=Tn.define(),ud=Tn.define({combine:e=>e.length?[e[0]]:null});function hd(e){let t=e.facet(cd);return t.length?t:e.facet(ud)}function dd(e,t){let n,i=[fd];return e instanceof ld&&(e.module&&i.push(sl.styleModule.of(e.module)),n=e.themeType),(null===t||void 0===t?void 0:t.fallback)?i.push(ud.of(e)):n?i.push(cd.computeN([sl.darkTheme],t=>t.facet(sl.darkTheme)==("dark"==n)?[e]:[])):i.push(cd.of(e)),i}class pd{constructor(e){this.markCache=Object.create(null),this.tree=ch(e.state),this.decorations=this.buildDeco(e,hd(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=ch(e.state),n=hd(e.state),i=n!=hd(e.startState),{viewport:r}=e.view,s=e.changes.mapPos(this.decoratedTo,1);t.length<r.to&&!i&&t.type==this.tree.type&&s>=r.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=s):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=r.to)}buildDeco(e,t){if(!t||!this.tree.length)return vr.none;let n=new Ci;for(let{from:i,to:r}of e.visibleRanges)Qu(this.tree,t,(e,t,i)=>{n.add(e,t,this.markCache[i]||(this.markCache[i]=vr.mark({class:i})))},i,r);return n.finish()}}const fd=Wn.high(Ms.fromClass(pd,{decorations:e=>e.decorations})),md=ld.define([{tag:th.meta,color:"#404740"},{tag:th.link,textDecoration:"underline"},{tag:th.heading,textDecoration:"underline",fontWeight:"bold"},{tag:th.emphasis,fontStyle:"italic"},{tag:th.strong,fontWeight:"bold"},{tag:th.strikethrough,textDecoration:"line-through"},{tag:th.keyword,color:"#708"},{tag:[th.atom,th.bool,th.url,th.contentSeparator,th.labelName],color:"#219"},{tag:[th.literal,th.inserted],color:"#164"},{tag:[th.string,th.deleted],color:"#a11"},{tag:[th.regexp,th.escape,th.special(th.string)],color:"#e40"},{tag:th.definition(th.variableName),color:"#00f"},{tag:th.local(th.variableName),color:"#30a"},{tag:[th.typeName,th.namespace],color:"#085"},{tag:th.className,color:"#167"},{tag:[th.special(th.variableName),th.macroName],color:"#256"},{tag:th.definition(th.propertyName),color:"#00c"},{tag:th.comment,color:"#940"},{tag:th.invalid,color:"#f00"}]),gd=sl.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),vd="()[]{}",yd=Tn.define({combine:e=>Oi(e,{afterCursor:!0,brackets:vd,maxScanDistance:1e4,renderMatch:bd})}),Od=vr.mark({class:"cm-matchingBracket"}),wd=vr.mark({class:"cm-nonmatchingBracket"});function bd(e){let t=[],n=e.matched?Od:wd;return t.push(n.range(e.start.from,e.start.to)),e.end&&t.push(n.range(e.end.from,e.end.to)),t}const kd=Bn.define({create:()=>vr.none,update(e,t){if(!t.docChanged&&!t.selection)return e;let n=[],i=t.state.facet(yd);for(let r of t.state.selection.ranges){if(!r.empty)continue;let e=Ed(t.state,r.head,-1,i)||r.head>0&&Ed(t.state,r.head-1,1,i)||i.afterCursor&&(Ed(t.state,r.head,1,i)||r.head<t.state.doc.length&&Ed(t.state,r.head+1,-1,i));e&&(n=n.concat(i.renderMatch(e,t.state)))}return vr.set(n,!0)},provide:e=>sl.decorations.from(e)}),xd=[kd,gd];function Dd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[yd.of(e),xd]}const Sd=new jc;function Cd(e,t,n){let i=e.prop(t<0?jc.openedBy:jc.closedBy);if(i)return i;if(1==e.name.length){let i=n.indexOf(e.name);if(i>-1&&i%2==(t<0?1:0))return[n[i+t]]}return null}function Ad(e){let t=e.type.prop(Sd);return t?t(e.node):e}function Ed(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=i.maxScanDistance||1e4,s=i.brackets||vd,o=ch(e),a=o.resolveInner(t,n);for(let l=a;l;l=l.parent){let i=Cd(l.type,n,s);if(i&&l.from<l.to){let r=Ad(l);if(r&&(n>0?t>=r.from&&t<r.to:t>r.from&&t<=r.to))return _d(e,t,n,l,r,i,s)}}return function(e,t,n,i,r,s,o){let a=n<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),l=o.indexOf(a);if(l<0||l%2==0!=n>0)return null;let c={from:n<0?t-1:t,to:n>0?t+1:t},u=e.doc.iterRange(t,n>0?e.doc.length:0),h=0;for(let d=0;!u.next().done&&d<=s;){let e=u.value;n<0&&(d+=e.length);let s=t+d*n;for(let t=n>0?0:e.length-1,a=n>0?e.length:-1;t!=a;t+=n){let a=o.indexOf(e[t]);if(!(a<0||i.resolveInner(s+t,1).type!=r))if(a%2==0==n>0)h++;else{if(1==h)return{start:c,end:{from:s+t,to:s+t+1},matched:a>>1==l>>1};h--}}n>0&&(d+=e.length)}return u.done?{start:c,matched:!1}:null}(e,t,n,o,a.type,r,s)}function _d(e,t,n,i,r,s,o){let a=i.parent,l={from:r.from,to:r.to},c=0,u=null===a||void 0===a?void 0:a.cursor();if(u&&(n<0?u.childBefore(i.from):u.childAfter(i.to)))do{if(n<0?u.to<=i.from:u.from>=i.to){if(0==c&&s.indexOf(u.type.name)>-1&&u.from<u.to){let e=Ad(u);return{start:l,end:e?{from:e.from,to:e.to}:void 0,matched:!0}}if(Cd(u.type,n,o))c++;else if(Cd(u.type,-n,o)){if(0==c){let e=Ad(u);return{start:l,end:e&&e.from<e.to?{from:e.from,to:e.to}:void 0,matched:!1}}c--}}}while(n<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}const Td=Object.create(null),Pd=[Wc.none],Md=[],Fd=Object.create(null),Rd=Object.create(null);for(let[os,ese]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Rd[os]=Id(Td,ese);function Nd(e,t){Md.indexOf(e)>-1||(Md.push(e),console.warn(t))}function Id(e,t){let n=[];for(let a of t.split(" ")){let t=[];for(let n of a.split(".")){let i=e[n]||th[n];i?"function"==typeof i?t.length?t=t.map(i):Nd(n,"Modifier ".concat(n," used at start of tag")):t.length?Nd(n,"Tag ".concat(n," used as modifier")):t=Array.isArray(i)?i:[i]:Nd(n,"Unknown highlighting tag ".concat(n))}for(let e of t)n.push(e)}if(!n.length)return 0;let i=t.replace(/ /g,"_"),r=i+" "+n.map(e=>e.id),s=Fd[r];if(s)return s.id;let o=Fd[r]=Wc.define({id:Pd.length,name:i,props:[Ru({[i]:n})]});return Pd.push(o),o.id}Xr.RTL,Xr.LTR;class Bd{constructor(e,t,n,i){this.state=e,this.pos=t,this.explicit=n,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=ch(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),i=t.text.slice(n-t.from,this.pos-t.from),r=i.search(zd(e,!1));return r<0?null:{from:n+r,to:this.pos,text:i.slice(r)}}get aborted(){return null==this.abortListeners}addEventListener(e,t,n){"abort"==e&&this.abortListeners&&(this.abortListeners.push(t),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function Qd(e){let t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),"[".concat(n?"\\w":"").concat(t.replace(/[^\w\s]/g,"\\$&"),"]")}function Ld(e){let t=e.map(e=>"string"==typeof e?{label:e}:e),[n,i]=t.every(e=>/^\w+$/.test(e.label))?[/\w*$/,/\w+$/]:function(e){let t=Object.create(null),n=Object.create(null);for(let{label:r}of e){t[r[0]]=!0;for(let e=1;e<r.length;e++)n[r[e]]=!0}let i=Qd(t)+Qd(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}(t);return e=>{let r=e.matchBefore(i);return r||e.explicit?{from:r?r.from:e.pos,options:t,validFor:n}:null}}class jd{constructor(e,t,n,i){this.completion=e,this.source=t,this.match=n,this.score=i}}function $d(e){return e.selection.main.from}function zd(e,t){var n;let{source:i}=e,r=t&&"^"!=i[0],s="$"!=i[i.length-1];return r||s?new RegExp("".concat(r?"^":"","(?:").concat(i,")").concat(s?"$":""),null!==(n=e.flags)&&void 0!==n?n:e.ignoreCase?"i":""):e}const Wd=ii.define();const Vd=new WeakMap;function Ud(e){if(!Array.isArray(e))return e;let t=Vd.get(e);return t||Vd.set(e,t=Ld(e)),t}const Xd=oi.define(),qd=oi.define();class Zd{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=pn(e,t),i=mn(n);this.chars.push(n);let r=e.slice(t,t+i),s=r.toUpperCase();this.folded.push(pn(s==r?r.toLowerCase():s,0)),t+=i}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(0==this.pattern.length)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:i,precise:r,byWord:s}=this;if(1==t.length){let i=pn(e,0),r=mn(i),s=r==e.length?0:-100;if(i==t[0]);else{if(i!=n[0])return null;s+=-200}return this.ret(s,[0,r])}let o=e.indexOf(this.pattern);if(0==o)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,l=0;if(o<0){for(let r=0,s=Math.min(e.length,200);r<s&&l<a;){let s=pn(e,r);s!=t[l]&&s!=n[l]||(i[l++]=r),r+=mn(s)}if(l<a)return null}let c=0,u=0,h=!1,d=0,p=-1,f=-1,m=/[a-z]/.test(e),g=!0;for(let v=0,y=Math.min(e.length,200),O=0;v<y&&u<a;){let i=pn(e,v);o<0&&(c<a&&i==t[c]&&(r[c++]=v),d<a&&(i==t[d]||i==n[d]?(0==d&&(p=v),f=v+1,d++):d=0));let l,y=i<255?i>=48&&i<=57||i>=97&&i<=122?2:i>=65&&i<=90?1:0:(l=fn(i))!=l.toLowerCase()?1:l!=l.toUpperCase()?2:0;(!v||1==y&&m||0==O&&0!=y)&&(t[u]==i||n[u]==i&&(h=!0)?s[u++]=v:s.length&&(g=!1)),O=y,v+=mn(i)}return u==a&&0==s[0]&&g?this.result((h?-200:0)-100,s,e):d==a&&0==p?this.ret(-200-e.length+(f==e.length?0:-100),[0,f]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):d==a?this.ret(-900-e.length,[p,f]):u==a?this.result((h?-200:0)-100-700+(g?0:-1100),s,e):2==t.length?null:this.result((i[0]?-700:0)-200-1100,i,e)}result(e,t,n){let i=[],r=0;for(let s of t){let e=s+(this.astral?mn(pn(n,s)):1);r&&i[r-1]==s?i[r-1]=e:(i[r++]=s,i[r++]=e)}return this.ret(e-n.length,i)}}class Hd{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),n=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return null==n?null:(this.matched=[0,t.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const Yd=Tn.define({combine:e=>Oi(e,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Kd,filterStrict:!1,compareCompletions:(e,t)=>(e.sortText||e.label).localeCompare(t.sortText||t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>Gd(e(n),t(n)),optionClass:(e,t)=>n=>Gd(e(n),t(n)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})});function Gd(e,t){return e?t?e+" "+t:e:t}function Kd(e,t,n,i,r,s){let o,a,l=e.textDirection==Xr.RTL,c=l,u=!1,h="top",d=t.left-r.left,p=r.right-t.right,f=i.right-i.left,m=i.bottom-i.top;if(c&&d<Math.min(f,p)?c=!1:!c&&p<Math.min(f,d)&&(c=!0),f<=(c?d:p))o=Math.max(r.top,Math.min(n.top,r.bottom-m))-t.top,a=Math.min(400,c?d:p);else{u=!0,a=Math.min(400,(l?t.right:r.right-t.left)-30);let e=r.bottom-t.bottom;e>=m||e>t.top?o=n.bottom-t.top:(h="bottom",o=t.bottom-n.top)}let g=(t.bottom-t.top)/s.offsetHeight,v=(t.right-t.left)/s.offsetWidth;return{style:"".concat(h,": ").concat(o/g,"px; max-width: ").concat(a/v,"px"),class:"cm-completionInfo-"+(u?l?"left-narrow":"right-narrow":c?"left":"right")}}function Jd(e,t,n){if(e<=n)return{from:0,to:e};if(t<0&&(t=0),t<=e>>1){let e=Math.floor(t/n);return{from:e*n,to:(e+1)*n}}let i=Math.floor((e-t)/n);return{from:e-(i+1)*n,to:e-i*n}}class ep{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:e=>this.placeInfo(e),key:this},this.space=null,this.currentClass="";let i=e.state.field(t),{options:r,selected:s}=i.open,o=e.state.facet(Yd);this.optionContent=function(e){let t=e.addToOptions.slice();return e.icons&&t.push({render(e){let t=document.createElement("div");return t.classList.add("cm-completionIcon"),e.type&&t.classList.add(...e.type.split(/\s+/g).map(e=>"cm-completionIcon-"+e)),t.setAttribute("aria-hidden","true"),t},position:20}),t.push({render(e,t,n,i){let r=document.createElement("span");r.className="cm-completionLabel";let s=e.displayLabel||e.label,o=0;for(let a=0;a<i.length;){let e=i[a++],t=i[a++];e>o&&r.appendChild(document.createTextNode(s.slice(o,e)));let n=r.appendChild(document.createElement("span"));n.appendChild(document.createTextNode(s.slice(e,t))),n.className="cm-completionMatchedText",o=t}return o<s.length&&r.appendChild(document.createTextNode(s.slice(o))),r},position:50},{render(e){if(!e.detail)return null;let t=document.createElement("span");return t.className="cm-completionDetail",t.textContent=e.detail,t},position:80}),t.sort((e,t)=>e.position-t.position).map(e=>e.render)}(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=Jd(r.length,s,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",n=>{let{options:i}=e.state.field(t).open;for(let t,r=n.target;r&&r!=this.dom;r=r.parentNode)if("LI"==r.nodeName&&(t=/-(\d+)$/.exec(r.id))&&+t[1]<i.length)return this.applyCompletion(e,i[+t[1]]),void n.preventDefault()}),this.dom.addEventListener("focusout",t=>{let n=e.state.field(this.stateField,!1);n&&n.tooltip&&e.state.facet(Yd).closeOnBlur&&t.relatedTarget!=e.contentDOM&&e.dispatch({effects:qd.of(null)})}),this.showOptions(r,i.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let n=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=i){let{options:r,selected:s,disabled:o}=n.open;i.open&&i.open.options==r||(this.range=Jd(r.length,s,e.state.facet(Yd).maxRenderedOptions),this.showOptions(r,n.id)),this.updateSel(),o!=(null===(t=i.open)||void 0===t?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let e of this.currentClass.split(" "))e&&this.dom.classList.remove(e);for(let e of t.split(" "))e&&this.dom.classList.add(e);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;(t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Jd(t.options.length,t.selected,this.view.state.facet(Yd).maxRenderedOptions),this.showOptions(t.options,e.id));let n=this.updateSelectedOption(t.selected);if(n){this.destroyInfo();let{completion:i}=t.options[t.selected],{info:r}=i;if(!r)return;let s="string"===typeof r?document.createTextNode(r):r(i);if(!s)return;"then"in s?s.then(t=>{t&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(t,i)}).catch(e=>Es(this.view.state,e,"completion info")):(this.addInfoPane(s,i),n.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",n.id="cm-completionInfo-"+Math.floor(65535*Math.random()).toString(16),null!=e.nodeType)n.appendChild(e),this.infoDestroy=null;else{let{dom:t,destroy:i}=e;n.appendChild(t),this.infoDestroy=i||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,i=this.range.from;n;n=n.nextSibling,i++)"LI"==n.nodeName&&n.id?i==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&(n.removeAttribute("aria-selected"),n.removeAttribute("aria-describedby")):i--;return t&&function(e,t){let n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),r=n.height/e.offsetHeight;i.top<n.top?e.scrollTop-=(n.top-i.top)/r:i.bottom>n.bottom&&(e.scrollTop+=(i.bottom-n.bottom)/r)}(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),r=this.space;if(!r){let e=this.dom.ownerDocument.documentElement;r={left:0,top:0,right:e.clientWidth,bottom:e.clientHeight}}return i.top>Math.min(r.bottom,t.bottom)-10||i.bottom<Math.max(r.top,t.top)+10?null:this.view.state.facet(Yd).positionInfo(this.view,t,i,n,r,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){const i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions")),i.addEventListener("mousedown",e=>{e.target==i&&e.preventDefault()});let r=null;for(let s=n.from;s<n.to;s++){let{completion:o,match:a}=e[s],{section:l}=o;if(l){let e="string"==typeof l?l:l.name;if(e!=r&&(s>n.from||0==n.from))if(r=e,"string"!=typeof l&&l.header)i.appendChild(l.header(l));else{i.appendChild(document.createElement("completion-section")).textContent=e}}const c=i.appendChild(document.createElement("li"));c.id=t+"-"+s,c.setAttribute("role","option");let u=this.optionClass(o);u&&(c.className=u);for(let e of this.optionContent){let t=e(o,this.view.state,this.view,a);t&&c.appendChild(t)}}return n.from&&i.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function tp(e,t){return n=>new ep(n,e,t)}function np(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}class ip{constructor(e,t,n,i,r,s){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=i,this.selected=r,this.disabled=s}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new ip(this.options,ap(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,i,r,s){if(i&&!s&&e.some(e=>e.isPending))return i.setDisabled();let o=function(e,t){let n=[],i=null,r=null,s=e=>{n.push(e);let{section:t}=e.completion;if(t){i||(i=[]);let e="string"==typeof t?t:t.name;i.some(t=>t.name==e)||i.push("string"==typeof t?{name:e}:t)}},o=t.facet(Yd);for(let u of e)if(u.hasResult()){let e=u.result.getMatch;if(!1===u.result.filter)for(let t of u.result.options)s(new jd(t,u.source,e?e(t):[],1e9-n.length));else{let n,i=t.sliceDoc(u.from,u.to),a=o.filterStrict?new Hd(i):new Zd(i);for(let t of u.result.options)if(n=a.match(t.label)){let i=t.displayLabel?e?e(t,n.matched):[]:n.matched,o=n.score+(t.boost||0);if(s(new jd(t,u.source,i,o)),"object"==typeof t.section&&"dynamic"===t.section.rank){let{name:e}=t.section;r||(r=Object.create(null)),r[e]=Math.max(o,r[e]||-1e9)}}}}if(i){let e=Object.create(null),t=0,s=(e,t)=>("dynamic"===e.rank&&"dynamic"===t.rank?r[t.name]-r[e.name]:0)||("number"==typeof e.rank?e.rank:1e9)-("number"==typeof t.rank?t.rank:1e9)||(e.name<t.name?-1:1);for(let n of i.sort(s))t-=1e5,e[n.name]=t;for(let i of n){let{section:t}=i.completion;t&&(i.score+=e["string"==typeof t?t:t.name])}}let a=[],l=null,c=o.compareCompletions;for(let u of n.sort((e,t)=>t.score-e.score||c(e.completion,t.completion))){let e=u.completion;!l||l.label!=e.label||l.detail!=e.detail||null!=l.type&&null!=e.type&&l.type!=e.type||l.apply!=e.apply||l.boost!=e.boost?a.push(u):np(u.completion)>np(l)&&(a[a.length-1]=u),l=u.completion}return a}(e,t);if(!o.length)return i&&e.some(e=>e.isPending)?i.setDisabled():null;let a=t.facet(Yd).selectOnOpen?0:-1;if(i&&i.selected!=a&&-1!=i.selected){let e=i.options[i.selected].completion;for(let t=0;t<o.length;t++)if(o[t].completion==e){a=t;break}}return new ip(o,ap(n,a),{pos:e.reduce((e,t)=>t.hasResult()?Math.min(e,t.from):e,1e8),create:gp,above:r.aboveCursor},i?i.timestamp:Date.now(),a,!1)}map(e){return new ip(this.options,this.attrs,p(p({},this.tooltip),{},{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new ip(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class rp{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new rp(lp,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(e){let{state:t}=e,n=t.facet(Yd),i=(n.override||t.languageDataAt("autocomplete",$d(t)).map(Ud)).map(t=>(this.active.find(e=>e.source==t)||new up(t,this.active.some(e=>0!=e.state)?1:0)).update(e,n));i.length==this.active.length&&i.every((e,t)=>e==this.active[t])&&(i=this.active);let r=this.open,s=e.effects.some(e=>e.is(dp));r&&e.docChanged&&(r=r.map(e.changes)),e.selection||i.some(t=>t.hasResult()&&e.changes.touchesRange(t.from,t.to))||!function(e,t){if(e==t)return!0;for(let n=0,i=0;;){for(;n<e.length&&!e[n].hasResult();)n++;for(;i<t.length&&!t[i].hasResult();)i++;let r=n==e.length,s=i==t.length;if(r||s)return r==s;if(e[n++].result!=t[i++].result)return!1}}(i,this.active)||s?r=ip.build(i,t,this.id,r,n,s):r&&r.disabled&&!i.some(e=>e.isPending)&&(r=null),!r&&i.every(e=>!e.isPending)&&i.some(e=>e.hasResult())&&(i=i.map(e=>e.hasResult()?new up(e.source,0):e));for(let o of e.effects)o.is(pp)&&(r=r&&r.setSelected(o.value,this.id));return i==this.active&&r==this.open?this:new rp(i,this.id,r)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?sp:op}}const sp={"aria-autocomplete":"list"},op={};function ap(e,t){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};return t>-1&&(n["aria-activedescendant"]=e+"-"+t),n}const lp=[];function cp(e,t){if(e.isUserEvent("input.complete")){let n=e.annotation(Wd);if(n&&t.activateOnCompletion(n))return 12}let n=e.isUserEvent("input.type");return n&&t.activateOnTyping?5:n?1:e.isUserEvent("delete.backward")?2:e.selection?8:e.docChanged?16:0}class up{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.source=e,this.state=t,this.explicit=n}hasResult(){return!1}get isPending(){return 1==this.state}update(e,t){let n=cp(e,t),i=this;(8&n||16&n&&this.touches(e))&&(i=new up(i.source,0)),4&n&&0==i.state&&(i=new up(this.source,1)),i=i.updateFor(e,n);for(let r of e.effects)if(r.is(Xd))i=new up(i.source,1,r.value);else if(r.is(qd))i=new up(i.source,0);else if(r.is(dp))for(let e of r.value)e.source==i.source&&(i=e);return i}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange($d(e.state))}}class hp extends up{constructor(e,t,n,i,r,s){super(e,3,t),this.limit=n,this.result=i,this.from=r,this.to=s}hasResult(){return!0}updateFor(e,t){var n;if(!(3&t))return this.map(e.changes);let i=this.result;i.map&&!e.changes.empty&&(i=i.map(i,e.changes));let r=e.changes.mapPos(this.from),s=e.changes.mapPos(this.to,1),o=$d(e.state);if(o>s||!i||2&t&&($d(e.startState)==this.from||o<this.limit))return new up(this.source,4&t?1:0);let a=e.changes.mapPos(this.limit);return function(e,t,n,i){if(!e)return!1;let r=t.sliceDoc(n,i);return"function"==typeof e?e(r,n,i,t):zd(e,!0).test(r)}(i.validFor,e.state,r,s)?new hp(this.source,this.explicit,a,i,r,s):i.update&&(i=i.update(i,r,s,new Bd(e.state,o,!1)))?new hp(this.source,this.explicit,a,i,i.from,null!==(n=i.to)&&void 0!==n?n:$d(e.state)):new up(this.source,1,this.explicit)}map(e){if(e.empty)return this;return(this.result.map?this.result.map(this.result,e):this.result)?new hp(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new up(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}const dp=oi.define({map:(e,t)=>e.map(e=>e.map(t))}),pp=oi.define(),fp=Bn.define({create:()=>rp.start(),update:(e,t)=>e.update(t),provide:e=>[hc.from(e,e=>e.tooltip),sl.contentAttributes.from(e,e=>e.attrs)]});function mp(e,t){const n=t.completion.apply||t.completion.label;let i=e.state.field(fp).active.find(e=>e.source==t.source);return i instanceof hp&&("string"==typeof n?e.dispatch(p(p({},function(e,t,n,i){let{main:r}=e.selection,s=n-r.from,o=i-r.from;return p(p({},e.changeByRange(a=>{if(a!=r&&n!=i&&e.sliceDoc(a.from+s,a.from+o)!=e.sliceDoc(n,i))return{range:a};let l=e.toText(t);return{changes:{from:a.from+s,to:i==r.from?a.to:a.from+o,insert:l},range:An.cursor(a.from+s+l.length)}})),{},{scrollIntoView:!0,userEvent:"input.complete"})}(e.state,n,i.from,i.to)),{},{annotations:Wd.of(t.completion)})):n(e,t.completion,i.from,i.to),!0)}const gp=tp(fp,mp);function vp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"option";return n=>{let i=n.state.field(fp,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<n.state.facet(Yd).interactionDelay)return!1;let r,s=1;"page"==t&&(r=dc(n,i.open.tooltip))&&(s=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,a=i.open.selected>-1?i.open.selected+s*(e?1:-1):e?0:o-1;return a<0?a="page"==t?0:o-1:a>=o&&(a="page"==t?o-1:0),n.dispatch({effects:pp.of(a)}),!0}}const yp=e=>!!e.state.field(fp,!1)&&(e.dispatch({effects:Xd.of(!0)}),!0);class Op{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const wp=Ms.fromClass(class{constructor(e){this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let t of e.state.field(fp).active)t.isPending&&this.startQuery(t)}update(e){let t=e.state.field(fp),n=e.state.facet(Yd);if(!e.selectionSet&&!e.docChanged&&e.startState.field(fp)==t)return;let i=e.transactions.some(e=>{let t=cp(e,n);return 8&t||(e.selection||e.docChanged)&&!(3&t)});for(let s=0;s<this.running.length;s++){let t=this.running[s];if(i||t.context.abortOnDocChange&&e.docChanged||t.updates.length+e.transactions.length>50&&Date.now()-t.time>1e3){for(let e of t.context.abortListeners)try{e()}catch(Kre){Es(this.view.state,Kre)}t.context.abortListeners=null,this.running.splice(s--,1)}else t.updates.push(...e.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),e.transactions.some(e=>e.effects.some(e=>e.is(Xd)))&&(this.pendingStart=!0);let r=this.pendingStart?50:n.activateOnTypingDelay;if(this.debounceUpdate=t.active.some(e=>e.isPending&&!this.running.some(t=>t.active.source==e.source))?setTimeout(()=>this.startUpdate(),r):-1,0!=this.composing)for(let s of e.transactions)s.isUserEvent("input.type")?this.composing=2:2==this.composing&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:e}=this.view,t=e.field(fp);for(let n of t.active)n.isPending&&!this.running.some(e=>e.active.source==n.source)&&this.startQuery(n);this.running.length&&t.open&&t.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Yd).updateSyncTime))}startQuery(e){let{state:t}=this.view,n=$d(t),i=new Bd(t,n,e.explicit,this.view),r=new Op(e,i);this.running.push(r),Promise.resolve(e.source(i)).then(e=>{r.context.aborted||(r.done=e||null,this.scheduleAccept())},e=>{this.view.dispatch({effects:qd.of(null)}),Es(this.view.state,e)})}scheduleAccept(){this.running.every(e=>void 0!==e.done)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Yd).updateSyncTime))}accept(){var e;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],n=this.view.state.facet(Yd),i=this.view.state.field(fp);for(let r=0;r<this.running.length;r++){let s=this.running[r];if(void 0===s.done)continue;if(this.running.splice(r--,1),s.done){let i=$d(s.updates.length?s.updates[0].startState:this.view.state),r=Math.min(i,s.done.from+(s.active.explicit?0:1)),o=new hp(s.active.source,s.active.explicit,r,s.done,s.done.from,null!==(e=s.done.to)&&void 0!==e?e:i);for(let e of s.updates)o=o.update(e,n);if(o.hasResult()){t.push(o);continue}}let o=i.active.find(e=>e.source==s.active.source);if(o&&o.isPending)if(null==s.done){let e=new up(s.active.source,0);for(let t of s.updates)e=e.update(t,n);e.isPending||t.push(e)}else this.startQuery(o)}(t.length||i.open&&i.open.disabled)&&this.view.dispatch({effects:dp.of(t)})}},{eventHandlers:{blur(e){let t=this.view.state.field(fp,!1);if(t&&t.tooltip&&this.view.state.facet(Yd).closeOnBlur){let n=t.open&&dc(this.view,t.open.tooltip);n&&n.dom.contains(e.relatedTarget)||setTimeout(()=>this.view.dispatch({effects:qd.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:Xd.of(!1)}),20),this.composing=0}}}),bp="object"==typeof navigator&&/Win/.test(navigator.platform),kp=Wn.highest(sl.domEventHandlers({keydown(e,t){let n=t.state.field(fp,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||e.key.length>1||e.ctrlKey&&(!bp||!e.altKey)||e.metaKey)return!1;let i=n.open.options[n.open.selected],r=n.active.find(e=>e.source==i.source),s=i.completion.commitCharacters||r.result.commitCharacters;return s&&s.indexOf(e.key)>-1&&mp(t,i),!1}})),xp=sl.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xb7\xb7\xb7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"".concat(400,"px"),boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"".concat(30,"px")},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"".concat(30,"px")},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25cb'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25cc'"}},".cm-completionIcon-variable":{"&:after":{content:"'\ud835\udc65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\ud835\udc36'"}},".cm-completionIcon-type":{"&:after":{content:"'\ud835\udc61'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222a'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25a1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\ud83d\udd11\ufe0e'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25a2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Dp{constructor(e,t,n,i){this.field=e,this.line=t,this.from=n,this.to=i}}class Sp{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,vn.TrackDel),n=e.mapPos(this.to,1,vn.TrackDel);return null==t||null==n?null:new Sp(this.field,t,n)}}class Cp{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],i=[t],r=e.doc.lineAt(t),s=/^\s*/.exec(r.text)[0];for(let a of this.lines){if(n.length){let n=s,r=/^\t*/.exec(a)[0].length;for(let t=0;t<r;t++)n+=e.facet(kh);i.push(t+n.length-r),a=n+a.slice(r)}n.push(a),t+=a.length+1}let o=this.fieldPositions.map(e=>new Sp(e.field,i[e.line]+e.from,i[e.line]+e.to));return{text:n,ranges:o}}static parse(e){let t,n=[],i=[],r=[];for(let s of e.split(/\r\n?|\n/)){for(;t=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(s);){let e=t[1]?+t[1]:null,o=t[2]||t[3]||"",a=-1,l=o.replace(/\\[{}]/g,e=>e[1]);for(let t=0;t<n.length;t++)(null!=e?n[t].seq==e:l&&n[t].name==l)&&(a=t);if(a<0){let t=0;for(;t<n.length&&(null==e||null!=n[t].seq&&n[t].seq<e);)t++;n.splice(t,0,{seq:e,name:l}),a=t;for(let e of r)e.field>=a&&e.field++}for(let n of r)if(n.line==i.length&&n.from>t.index){let e=t[2]?3+(t[1]||"").length:2;n.from-=e,n.to-=e}r.push(new Dp(a,i.length,t.index,t.index+l.length)),s=s.slice(0,t.index)+o+s.slice(t.index+t[0].length)}s=s.replace(/\\([{}])/g,(e,t,n)=>{for(let s of r)s.line==i.length&&s.from>n&&(s.from--,s.to--);return t}),i.push(s)}return new Cp(i,r)}}let Ap=vr.widget({widget:new class extends mr{toDOM(){let e=document.createElement("span");return e.className="cm-snippetFieldPosition",e}ignoreEvent(){return!1}}}),Ep=vr.mark({class:"cm-snippetField"});class _p{constructor(e,t){this.ranges=e,this.active=t,this.deco=vr.set(e.map(e=>(e.from==e.to?Ap:Ep).range(e.from,e.to)),!0)}map(e){let t=[];for(let n of this.ranges){let i=n.map(e);if(!i)return null;t.push(i)}return new _p(t,this.active)}selectionInsideField(e){return e.ranges.every(e=>this.ranges.some(t=>t.field==this.active&&t.from<=e.from&&t.to>=e.to))}}const Tp=oi.define({map:(e,t)=>e&&e.map(t)}),Pp=oi.define(),Mp=Bn.define({create:()=>null,update(e,t){for(let n of t.effects){if(n.is(Tp))return n.value;if(n.is(Pp)&&e)return new _p(e.ranges,n.value)}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.selectionInsideField(t.selection)&&(e=null),e},provide:e=>sl.decorations.from(e,e=>e?e.deco:vr.none)});function Fp(e,t){return An.create(e.filter(e=>e.field==t).map(e=>An.range(e.from,e.to)))}function Rp(e){let t=Cp.parse(e);return(e,n,i,r)=>{let{text:s,ranges:o}=t.instantiate(e.state,i),{main:a}=e.state.selection,l={changes:{from:i,to:r==a.from?a.to:r,insert:tn.of(s)},scrollIntoView:!0,annotations:n?[Wd.of(n),ai.userEvent.of("input.complete")]:void 0};if(o.length&&(l.selection=Fp(o,0)),o.some(e=>e.field>0)){let t=new _p(o,0),n=l.effects=[Tp.of(t)];void 0===e.state.field(Mp,!1)&&n.push(oi.appendConfig.of([Mp,Qp,jp,xp]))}e.dispatch(e.state.update(l))}}function Np(e){return t=>{let{state:n,dispatch:i}=t,r=n.field(Mp,!1);if(!r||e<0&&0==r.active)return!1;let s=r.active+e,o=e>0&&!r.ranges.some(t=>t.field==s+e);return i(n.update({selection:Fp(r.ranges,s),effects:Tp.of(o?null:new _p(r.ranges,s)),scrollIntoView:!0})),!0}}const Ip=[{key:"Tab",run:Np(1),shift:Np(-1)},{key:"Escape",run:e=>{let{state:t,dispatch:n}=e;return!!t.field(Mp,!1)&&(n(t.update({effects:Tp.of(null)})),!0)}}],Bp=Tn.define({combine:e=>e.length?e[0]:Ip}),Qp=Wn.highest(pl.compute([Bp],e=>e.facet(Bp)));function Lp(e,t){return p(p({},t),{},{apply:Rp(e)})}const jp=sl.domEventHandlers({mousedown(e,t){let n,i=t.state.field(Mp,!1);if(!i||null==(n=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;let r=i.ranges.find(e=>e.from<=n&&e.to>=n);return!(!r||r.field==i.active)&&(t.dispatch({selection:Fp(i.ranges,r.field),effects:Tp.of(i.ranges.some(e=>e.field>r.field)?new _p(i.ranges,r.field):null),scrollIntoView:!0}),!0)}});const $p={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},zp=oi.define({map(e,t){let n=t.mapPos(e,-1,vn.TrackAfter);return null==n?void 0:n}}),Wp=new class extends wi{};Wp.startSide=1,Wp.endSide=-1;const Vp=Bn.define({create:()=>Si.empty,update(e,t){if(e=e.map(t.changes),t.selection){let n=t.state.doc.lineAt(t.selection.main.head);e=e.update({filter:e=>e>=n.from&&e<=n.to})}for(let n of t.effects)n.is(zp)&&(e=e.update({add:[Wp.range(n.value,n.value+1)]}));return e}});const Up="()[]{}<>\xab\xbb\xbb\xab\uff3b\uff3d\uff5b\uff5d";function Xp(e){for(let t=0;t<16;t+=2)if(Up.charCodeAt(t)==e)return Up.charAt(t+1);return fn(e<128?e:e+1)}function qp(e,t){return e.languageDataAt("closeBrackets",t)[0]||$p}const Zp="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),Hp=sl.inputHandler.of((e,t,n,i)=>{if((Zp?e.composing:e.compositionStarted)||e.state.readOnly)return!1;let r=e.state.selection.main;if(i.length>2||2==i.length&&1==mn(pn(i,0))||t!=r.from||n!=r.to)return!1;let s=function(e,t){let n=qp(e,e.selection.main.head),i=n.brackets||$p.brackets;for(let r of i){let s=Xp(pn(r,0));if(t==r)return s==r?tf(e,r,i.indexOf(r+r+r)>-1,n):Jp(e,r,s,n.before||$p.before);if(t==s&&Gp(e,e.selection.main.from))return ef(e,r,s)}return null}(e.state,i);return!!s&&(e.dispatch(s),!0)}),Yp=[{key:"Backspace",run:e=>{let{state:t,dispatch:n}=e;if(t.readOnly)return!1;let i=qp(t,t.selection.main.head).brackets||$p.brackets,r=null,s=t.changeByRange(e=>{if(e.empty){let n=function(e,t){let n=e.sliceString(t-2,t);return mn(pn(n,0))==n.length?n:n.slice(1)}(t.doc,e.head);for(let r of i)if(r==n&&Kp(t.doc,e.head)==Xp(pn(r,0)))return{changes:{from:e.head-r.length,to:e.head+r.length},range:An.cursor(e.head-r.length)}}return{range:r=e}});return r||n(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!r}}];function Gp(e,t){let n=!1;return e.field(Vp).between(0,e.doc.length,e=>{e==t&&(n=!0)}),n}function Kp(e,t){let n=e.sliceString(t,t+2);return n.slice(0,mn(pn(n,0)))}function Jp(e,t,n,i){let r=null,s=e.changeByRange(s=>{if(!s.empty)return{changes:[{insert:t,from:s.from},{insert:n,from:s.to}],effects:zp.of(s.to+t.length),range:An.range(s.anchor+t.length,s.head+t.length)};let o=Kp(e.doc,s.head);return!o||/\s/.test(o)||i.indexOf(o)>-1?{changes:{insert:t+n,from:s.head},effects:zp.of(s.head+t.length),range:An.cursor(s.head+t.length)}:{range:r=s}});return r?null:e.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function ef(e,t,n){let i=null,r=e.changeByRange(t=>t.empty&&Kp(e.doc,t.head)==n?{changes:{from:t.head,to:t.head+n.length,insert:n},range:An.cursor(t.head+n.length)}:i={range:t});return i?null:e.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function tf(e,t,n,i){let r=i.stringPrefixes||$p.stringPrefixes,s=null,o=e.changeByRange(i=>{if(!i.empty)return{changes:[{insert:t,from:i.from},{insert:t,from:i.to}],effects:zp.of(i.to+t.length),range:An.range(i.anchor+t.length,i.head+t.length)};let o,a=i.head,l=Kp(e.doc,a);if(l==t){if(nf(e,a))return{changes:{insert:t+t,from:a},effects:zp.of(a+t.length),range:An.cursor(a+t.length)};if(Gp(e,a)){let i=n&&e.sliceDoc(a,a+3*t.length)==t+t+t?t+t+t:t;return{changes:{from:a,to:a+i.length,insert:i},range:An.cursor(a+i.length)}}}else{if(n&&e.sliceDoc(a-2*t.length,a)==t+t&&(o=rf(e,a-2*t.length,r))>-1&&nf(e,o))return{changes:{insert:t+t+t+t,from:a},effects:zp.of(a+t.length),range:An.cursor(a+t.length)};if(e.charCategorizer(a)(l)!=fi.Word&&rf(e,a,r)>-1&&!function(e,t,n,i){let r=ch(e).resolveInner(t,-1),s=i.reduce((e,t)=>Math.max(e,t.length),0);for(let o=0;o<5;o++){let o=e.sliceDoc(r.from,Math.min(r.to,r.from+n.length+s)),a=o.indexOf(n);if(!a||a>-1&&i.indexOf(o.slice(0,a))>-1){let t=r.firstChild;for(;t&&t.from==r.from&&t.to-t.from>n.length+a;){if(e.sliceDoc(t.to-n.length,t.to)==n)return!1;t=t.firstChild}return!0}let l=r.to==t&&r.parent;if(!l)break;r=l}return!1}(e,a,t,r))return{changes:{insert:t+t,from:a},effects:zp.of(a+t.length),range:An.cursor(a+t.length)}}return{range:s=i}});return s?null:e.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function nf(e,t){let n=ch(e).resolveInner(t+1);return n.parent&&n.from==t}function rf(e,t,n){let i=e.charCategorizer(t);if(i(e.sliceDoc(t-1,t))!=fi.Word)return t;for(let r of n){let n=t-r.length;if(e.sliceDoc(n,t)==r&&i(e.sliceDoc(n-1,n))!=fi.Word)return n}return-1}function sf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[kp,fp,Yd.of(e),wp,af,xp]}const of=[{key:"Ctrl-Space",run:yp},{mac:"Alt-`",run:yp},{mac:"Alt-i",run:yp},{key:"Escape",run:e=>{let t=e.state.field(fp,!1);return!(!t||!t.active.some(e=>0!=e.state))&&(e.dispatch({effects:qd.of(null)}),!0)}},{key:"ArrowDown",run:vp(!0)},{key:"ArrowUp",run:vp(!1)},{key:"PageDown",run:vp(!0,"page")},{key:"PageUp",run:vp(!1,"page")},{key:"Enter",run:e=>{let t=e.state.field(fp,!1);return!(e.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<e.state.facet(Yd).interactionDelay)&&mp(e,t.open.options[t.open.selected])}}],af=Wn.highest(pl.computeN([Yd],e=>e.facet(Yd).defaultKeymap?[of]:[]));class lf{static create(e,t,n,i,r){return new lf(e,t,n,i+(i<<8)+e+(t<<4)|0,r,[],[])}constructor(e,t,n,i,r,s,o){this.type=e,this.value=t,this.from=n,this.hash=i,this.end=r,this.children=s,this.positions=o,this.hashProp=[[jc.contextHash,i]]}addChild(e,t){e.prop(jc.contextHash)!=this.hash&&(e=new Zc(e.type,e.children,e.positions,e.length,this.hashProp)),this.children.push(e),this.positions.push(t)}toTree(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.end,n=this.children.length-1;return n>=0&&(t=Math.max(t,this.positions[n]+this.children[n].length+this.from)),new Zc(e.types[this.type],this.children,this.positions,t-this.from).balance({makeTree:(e,t,n)=>new Zc(Wc.none,e,t,n,this.hashProp)})}}var cf;!function(e){e[e.Document=1]="Document",e[e.CodeBlock=2]="CodeBlock",e[e.FencedCode=3]="FencedCode",e[e.Blockquote=4]="Blockquote",e[e.HorizontalRule=5]="HorizontalRule",e[e.BulletList=6]="BulletList",e[e.OrderedList=7]="OrderedList",e[e.ListItem=8]="ListItem",e[e.ATXHeading1=9]="ATXHeading1",e[e.ATXHeading2=10]="ATXHeading2",e[e.ATXHeading3=11]="ATXHeading3",e[e.ATXHeading4=12]="ATXHeading4",e[e.ATXHeading5=13]="ATXHeading5",e[e.ATXHeading6=14]="ATXHeading6",e[e.SetextHeading1=15]="SetextHeading1",e[e.SetextHeading2=16]="SetextHeading2",e[e.HTMLBlock=17]="HTMLBlock",e[e.LinkReference=18]="LinkReference",e[e.Paragraph=19]="Paragraph",e[e.CommentBlock=20]="CommentBlock",e[e.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",e[e.Escape=22]="Escape",e[e.Entity=23]="Entity",e[e.HardBreak=24]="HardBreak",e[e.Emphasis=25]="Emphasis",e[e.StrongEmphasis=26]="StrongEmphasis",e[e.Link=27]="Link",e[e.Image=28]="Image",e[e.InlineCode=29]="InlineCode",e[e.HTMLTag=30]="HTMLTag",e[e.Comment=31]="Comment",e[e.ProcessingInstruction=32]="ProcessingInstruction",e[e.Autolink=33]="Autolink",e[e.HeaderMark=34]="HeaderMark",e[e.QuoteMark=35]="QuoteMark",e[e.ListMark=36]="ListMark",e[e.LinkMark=37]="LinkMark",e[e.EmphasisMark=38]="EmphasisMark",e[e.CodeMark=39]="CodeMark",e[e.CodeText=40]="CodeText",e[e.CodeInfo=41]="CodeInfo",e[e.LinkTitle=42]="LinkTitle",e[e.LinkLabel=43]="LinkLabel",e[e.URL=44]="URL"}(cf||(cf={}));class uf{constructor(e,t){this.start=e,this.content=t,this.marks=[],this.parsers=[]}}class hf{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let e=this.skipSpace(this.basePos);this.indent=this.countIndent(e,this.pos,this.indent),this.pos=e,this.next=e==this.text.length?-1:this.text.charCodeAt(e)}skipSpace(e){return mf(this.text,e)}reset(e){for(this.text=e,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(e){this.basePos=e,this.baseIndent=this.countIndent(e,this.pos,this.indent)}moveBaseColumn(e){this.baseIndent=e,this.basePos=this.findColumn(e)}addMarker(e){this.markers.push(e)}countIndent(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n<e;n++)t+=9==this.text.charCodeAt(n)?4-t%4:1;return t}findColumn(e){let t=0;for(let n=0;t<this.text.length&&n<e;t++)n+=9==this.text.charCodeAt(t)?4-n%4:1;return t}scrub(){if(!this.baseIndent)return this.text;let e="";for(let t=0;t<this.basePos;t++)e+=" ";return e+this.text.slice(this.basePos)}}function df(e,t,n){if(n.pos==n.text.length||e!=t.block&&n.indent>=t.stack[n.depth+1].value+n.baseIndent)return!0;if(n.indent>=n.baseIndent+4)return!1;let i=(e.type==cf.OrderedList?kf:bf)(n,t,!1);return i>0&&(e.type!=cf.BulletList||Of(n,t,!1)<0)&&n.text.charCodeAt(n.pos+i-1)==e.value}const pf={[cf.Blockquote]:(e,t,n)=>62==n.next&&(n.markers.push(Yf(cf.QuoteMark,t.lineStart+n.pos,t.lineStart+n.pos+1)),n.moveBase(n.pos+(ff(n.text.charCodeAt(n.pos+1))?2:1)),e.end=t.lineStart+n.text.length,!0),[cf.ListItem]:(e,t,n)=>!(n.indent<n.baseIndent+e.value&&n.next>-1)&&(n.moveBaseColumn(n.baseIndent+e.value),!0),[cf.OrderedList]:df,[cf.BulletList]:df,[cf.Document]:()=>!0};function ff(e){return 32==e||9==e||10==e||13==e}function mf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(;t<e.length&&ff(e.charCodeAt(t));)t++;return t}function gf(e,t,n){for(;t>n&&ff(e.charCodeAt(t-1));)t--;return t}function vf(e){if(96!=e.next&&126!=e.next)return-1;let t=e.pos+1;for(;t<e.text.length&&e.text.charCodeAt(t)==e.next;)t++;if(t<e.pos+3)return-1;if(96==e.next)for(let n=t;n<e.text.length;n++)if(96==e.text.charCodeAt(n))return-1;return t}function yf(e){return 62!=e.next?-1:32==e.text.charCodeAt(e.pos+1)?2:1}function Of(e,t,n){if(42!=e.next&&45!=e.next&&95!=e.next)return-1;let i=1;for(let r=e.pos+1;r<e.text.length;r++){let t=e.text.charCodeAt(r);if(t==e.next)i++;else if(!ff(t))return-1}return n&&45==e.next&&Df(e)>-1&&e.depth==t.stack.length&&t.parser.leafBlockParsers.indexOf(If.SetextHeading)>-1||i<3?-1:1}function wf(e,t){for(let n=e.stack.length-1;n>=0;n--)if(e.stack[n].type==t)return!0;return!1}function bf(e,t,n){return 45!=e.next&&43!=e.next&&42!=e.next||e.pos!=e.text.length-1&&!ff(e.text.charCodeAt(e.pos+1))||!(!n||wf(t,cf.BulletList)||e.skipSpace(e.pos+2)<e.text.length)?-1:1}function kf(e,t,n){let i=e.pos,r=e.next;for(;r>=48&&r<=57;){if(i++,i==e.text.length)return-1;r=e.text.charCodeAt(i)}return i==e.pos||i>e.pos+9||46!=r&&41!=r||i<e.text.length-1&&!ff(e.text.charCodeAt(i+1))||n&&!wf(t,cf.OrderedList)&&(e.skipSpace(i+1)==e.text.length||i>e.pos+1||49!=e.next)?-1:i+1-e.pos}function xf(e){if(35!=e.next)return-1;let t=e.pos+1;for(;t<e.text.length&&35==e.text.charCodeAt(t);)t++;if(t<e.text.length&&32!=e.text.charCodeAt(t))return-1;let n=t-e.pos;return n>6?-1:n}function Df(e){if(45!=e.next&&61!=e.next||e.indent>=e.baseIndent+4)return-1;let t=e.pos+1;for(;t<e.text.length&&e.text.charCodeAt(t)==e.next;)t++;let n=t;for(;t<e.text.length&&ff(e.text.charCodeAt(t));)t++;return t==e.text.length?n:-1}const Sf=/^[ \t]*$/,Cf=/-->/,Af=/\?>/,Ef=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,Cf],[/^\s*<\?/,Af],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,Sf],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,Sf]];function _f(e,t,n){if(60!=e.next)return-1;let i=e.text.slice(e.pos);for(let r=0,s=Ef.length-(n?1:0);r<s;r++)if(Ef[r][0].test(i))return r;return-1}function Tf(e,t){let n=e.countIndent(t,e.pos,e.indent),i=e.countIndent(e.skipSpace(t),t,n);return i>=n+5?n+1:i}function Pf(e,t,n){let i=e.length-1;i>=0&&e[i].to==t&&e[i].type==cf.CodeText?e[i].to=n:e.push(Yf(cf.CodeText,t,n))}const Mf={LinkReference:void 0,IndentedCode(e,t){let n=t.baseIndent+4;if(t.indent<n)return!1;let i=t.findColumn(n),r=e.lineStart+i,s=e.lineStart+t.text.length,o=[],a=[];for(Pf(o,r,s);e.nextLine()&&t.depth>=e.stack.length;)if(t.pos==t.text.length){Pf(a,e.lineStart-1,e.lineStart);for(let e of t.markers)a.push(e)}else{if(t.indent<n)break;{if(a.length){for(let e of a)e.type==cf.CodeText?Pf(o,e.from,e.to):o.push(e);a=[]}Pf(o,e.lineStart-1,e.lineStart);for(let e of t.markers)o.push(e);s=e.lineStart+t.text.length;let n=e.lineStart+t.findColumn(t.baseIndent+4);n<s&&Pf(o,n,s)}}return a.length&&(a=a.filter(e=>e.type!=cf.CodeText),a.length&&(t.markers=a.concat(t.markers))),e.addNode(e.buffer.writeElements(o,-r).finish(cf.CodeBlock,s-r),r),!0},FencedCode(e,t){let n=vf(t);if(n<0)return!1;let i=e.lineStart+t.pos,r=t.next,s=n-t.pos,o=t.skipSpace(n),a=gf(t.text,t.text.length,o),l=[Yf(cf.CodeMark,i,i+s)];o<a&&l.push(Yf(cf.CodeInfo,e.lineStart+o,e.lineStart+a));for(let c=!0,u=!0,h=!1;e.nextLine()&&t.depth>=e.stack.length;c=!1){let n=t.pos;if(t.indent-t.baseIndent<4)for(;n<t.text.length&&t.text.charCodeAt(n)==r;)n++;if(n-t.pos>=s&&t.skipSpace(n)==t.text.length){for(let e of t.markers)l.push(e);u&&h&&Pf(l,e.lineStart-1,e.lineStart),l.push(Yf(cf.CodeMark,e.lineStart+t.pos,e.lineStart+n)),e.nextLine();break}{h=!0,c||(Pf(l,e.lineStart-1,e.lineStart),u=!1);for(let e of t.markers)l.push(e);let n=e.lineStart+t.basePos,i=e.lineStart+t.text.length;n<i&&(Pf(l,n,i),u=!1)}}return e.addNode(e.buffer.writeElements(l,-i).finish(cf.FencedCode,e.prevLineEnd()-i),i),!0},Blockquote(e,t){let n=yf(t);return!(n<0)&&(e.startContext(cf.Blockquote,t.pos),e.addNode(cf.QuoteMark,e.lineStart+t.pos,e.lineStart+t.pos+1),t.moveBase(t.pos+n),null)},HorizontalRule(e,t){if(Of(t,e,!1)<0)return!1;let n=e.lineStart+t.pos;return e.nextLine(),e.addNode(cf.HorizontalRule,n),!0},BulletList(e,t){let n=bf(t,e,!1);if(n<0)return!1;e.block.type!=cf.BulletList&&e.startContext(cf.BulletList,t.basePos,t.next);let i=Tf(t,t.pos+1);return e.startContext(cf.ListItem,t.basePos,i-t.baseIndent),e.addNode(cf.ListMark,e.lineStart+t.pos,e.lineStart+t.pos+n),t.moveBaseColumn(i),null},OrderedList(e,t){let n=kf(t,e,!1);if(n<0)return!1;e.block.type!=cf.OrderedList&&e.startContext(cf.OrderedList,t.basePos,t.text.charCodeAt(t.pos+n-1));let i=Tf(t,t.pos+n);return e.startContext(cf.ListItem,t.basePos,i-t.baseIndent),e.addNode(cf.ListMark,e.lineStart+t.pos,e.lineStart+t.pos+n),t.moveBaseColumn(i),null},ATXHeading(e,t){let n=xf(t);if(n<0)return!1;let i=t.pos,r=e.lineStart+i,s=gf(t.text,t.text.length,i),o=s;for(;o>i&&t.text.charCodeAt(o-1)==t.next;)o--;o!=s&&o!=i&&ff(t.text.charCodeAt(o-1))||(o=t.text.length);let a=e.buffer.write(cf.HeaderMark,0,n).writeElements(e.parser.parseInline(t.text.slice(i+n+1,o),r+n+1),-r);o<t.text.length&&a.write(cf.HeaderMark,o-i,s-i);let l=a.finish(cf.ATXHeading1-1+n,t.text.length-i);return e.nextLine(),e.addNode(l,r),!0},HTMLBlock(e,t){let n=_f(t,0,!1);if(n<0)return!1;let i=e.lineStart+t.pos,r=Ef[n][1],s=[],o=r!=Sf;for(;!r.test(t.text)&&e.nextLine();){if(t.depth<e.stack.length){o=!1;break}for(let e of t.markers)s.push(e)}o&&e.nextLine();let a=r==Cf?cf.CommentBlock:r==Af?cf.ProcessingInstructionBlock:cf.HTMLBlock,l=e.prevLineEnd();return e.addNode(e.buffer.writeElements(s,-i).finish(a,l-i),i),!0},SetextHeading:void 0};class Ff{constructor(e){this.stage=0,this.elts=[],this.pos=0,this.start=e.start,this.advance(e.content)}nextLine(e,t,n){if(-1==this.stage)return!1;let i=n.content+"\n"+t.scrub(),r=this.advance(i);return r>-1&&r<i.length&&this.complete(e,n,r)}finish(e,t){return(2==this.stage||3==this.stage)&&mf(t.content,this.pos)==t.content.length&&this.complete(e,t,t.content.length)}complete(e,t,n){return e.addLeafElement(t,Yf(cf.LinkReference,this.start,this.start+n,this.elts)),!0}nextStage(e){return e?(this.pos=e.to-this.start,this.elts.push(e),this.stage++,!0):(!1===e&&(this.stage=-1),!1)}advance(e){for(;;){if(-1==this.stage)return-1;if(0==this.stage){if(!this.nextStage(lm(e,this.pos,this.start,!0)))return-1;if(58!=e.charCodeAt(this.pos))return this.stage=-1;this.elts.push(Yf(cf.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else{if(1!=this.stage){if(2==this.stage){let t=mf(e,this.pos),n=0;if(t>this.pos){let i=am(e,t,this.start);if(i){let t=Rf(e,i.to-this.start);t>0&&(this.nextStage(i),n=t)}}return n||(n=Rf(e,this.pos)),n>0&&n<e.length?n:-1}return Rf(e,this.pos)}if(!this.nextStage(om(e,mf(e,this.pos),this.start)))return-1}}}}function Rf(e,t){for(;t<e.length;t++){let n=e.charCodeAt(t);if(10==n)break;if(!ff(n))return-1}return t}class Nf{nextLine(e,t,n){let i=t.depth<e.stack.length?-1:Df(t),r=t.next;if(i<0)return!1;let s=Yf(cf.HeaderMark,e.lineStart+t.pos,e.lineStart+i);return e.nextLine(),e.addLeafElement(n,Yf(61==r?cf.SetextHeading1:cf.SetextHeading2,n.start,e.prevLineEnd(),[...e.parser.parseInline(n.content,n.start),s])),!0}finish(){return!1}}const If={LinkReference:(e,t)=>91==t.content.charCodeAt(0)?new Ff(t):null,SetextHeading:()=>new Nf},Bf=[(e,t)=>xf(t)>=0,(e,t)=>vf(t)>=0,(e,t)=>yf(t)>=0,(e,t)=>bf(t,e,!0)>=0,(e,t)=>kf(t,e,!0)>=0,(e,t)=>Of(t,e,!0)>=0,(e,t)=>_f(t,0,!0)>=0],Qf={text:"",end:0};class Lf{constructor(e,t,n,i){this.parser=e,this.input=t,this.ranges=i,this.line=new hf,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=i[i.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=i[0].from,this.block=lf.create(cf.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=n.length?new dm(n,t):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(null!=this.stoppedAt&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:e}=this;for(;;){for(let t=0;;){let n=e.depth<this.stack.length?this.stack[this.stack.length-1]:null;for(;t<e.markers.length&&(!n||e.markers[t].from<n.end);){let n=e.markers[t++];this.addNode(n.type,n.from,n.to)}if(!n)break;this.finishContext()}if(e.pos<e.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(e.basePos))return null;e:for(;;){for(let t of this.parser.blockParsers)if(t){let n=t(this,e);if(0!=n){if(1==n)return null;e.forward();continue e}}break}let t=new uf(this.lineStart+e.pos,e.text.slice(e.pos));for(let n of this.parser.leafBlockParsers)if(n){let e=n(this,t);e&&t.parsers.push(e)}e:for(;this.nextLine()&&e.pos!=e.text.length;){if(e.indent<e.baseIndent+4)for(let n of this.parser.endLeafBlock)if(n(this,e,t))break e;for(let n of t.parsers)if(n.nextLine(this,e,t))return null;t.content+="\n"+e.scrub();for(let n of e.markers)t.marks.push(n)}return this.finishLeaf(t),null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}reuseFragment(e){if(!this.fragments.moveTo(this.absoluteLineStart+e,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let t=this.fragments.takeNodes(this);return!!t&&(this.absoluteLineStart+=t,this.lineStart=pm(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0)}get depth(){return this.stack.length}parentType(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.depth-1;return this.parser.nodeSet.types[this.stack[e].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}peekLine(){return this.scanLine(this.absoluteLineEnd+1).text}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(e){let t=Qf;if(t.end=e,e>=this.to)t.text="";else if(t.text=this.lineChunkAt(e),t.end+=t.text.length,this.ranges.length>1){let e=this.absoluteLineStart,n=this.rangeI;for(;this.ranges[n].to<t.end;){n++;let i=this.ranges[n].from,r=this.lineChunkAt(i);t.end=i+r.length,t.text=t.text.slice(0,this.ranges[n-1].to-e)+r,e=t.end-t.text.length}}return t}readLine(){let{line:e}=this,{text:t,end:n}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=n,e.reset(t);e.depth<this.stack.length;e.depth++){let t=this.stack[e.depth],n=this.parser.skipContextMarkup[t.type];if(!n)throw new Error("Unhandled block context "+cf[t.type]);let i=this.line.markers.length;if(!n(t,this,e)){this.line.markers.length>i&&(t.end=this.line.markers[this.line.markers.length-1].to),e.forward();break}e.forward()}}lineChunkAt(e){let t,n=this.input.chunk(e);if(this.input.lineChunks)t="\n"==n?"":n;else{let e=n.indexOf("\n");t=e<0?n:n.slice(0,e)}return e+t.length>this.to?t.slice(0,this.to-e):t}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.block=lf.create(e,n,this.lineStart+t,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.startContext(this.parser.getNodeType(e),t,n)}addNode(e,t,n){"number"==typeof e&&(e=new Zc(this.parser.nodeSet.types[e],Xf,Xf,(null!==n&&void 0!==n?n:this.prevLineEnd())-t)),this.block.addChild(e,t-this.block.from)}addElement(e){this.block.addChild(e.toTree(this.parser.nodeSet),e.from-this.block.from)}addLeafElement(e,t){this.addNode(this.buffer.writeElements(um(t.children,e.marks),-t.from).finish(t.type,t.to-t.from),t.from)}finishContext(){let e=this.stack.pop(),t=this.stack[this.stack.length-1];t.addChild(e.toTree(this.parser.nodeSet),e.from-t.from),this.block=t}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(e){return this.ranges.length>1?jf(this.ranges,0,e.topNode,this.ranges[0].from,this.reusePlaceholders):e}finishLeaf(e){for(let n of e.parsers)if(n.finish(this,e))return;let t=um(this.parser.parseInline(e.content,e.start),e.marks);this.addNode(this.buffer.writeElements(t,-e.start).finish(cf.Paragraph,e.content.length),e.start)}elt(e,t,n,i){return"string"==typeof e?Yf(this.parser.getNodeType(e),t,n,i):new Hf(e,t)}get buffer(){return new qf(this.parser.nodeSet)}}function jf(e,t,n,i,r){let s=e[t].to,o=[],a=[],l=n.from+i;function c(n,r){for(;r?n>=s:n>s;){let r=e[t+1].from-s;i+=r,n+=r,t++,s=e[t].to}}for(let u=n.firstChild;u;u=u.nextSibling){c(u.from+i,!0);let n,h=u.from+i,d=r.get(u.tree);d?n=d:u.to+i>s?(n=jf(e,t,u,i,r),c(u.to+i,!1)):n=u.toTree(),o.push(n),a.push(h-l)}return c(n.to+i,!1),new Zc(n.type,o,a,n.to+i-l,n.tree?n.tree.propValues:void 0)}class $f extends fu{constructor(e,t,n,i,r,s,o,a,l){super(),this.nodeSet=e,this.blockParsers=t,this.leafBlockParsers=n,this.blockNames=i,this.endLeafBlock=r,this.skipContextMarkup=s,this.inlineParsers=o,this.inlineNames=a,this.wrappers=l,this.nodeTypes=Object.create(null);for(let c of e.types)this.nodeTypes[c.name]=c.id}createParse(e,t,n){let i=new Lf(this,e,t,n);for(let r of this.wrappers)i=r(i,e,t,n);return i}configure(e){let t=Wf(e);if(!t)return this;let{nodeSet:n,skipContextMarkup:i}=this,r=this.blockParsers.slice(),s=this.leafBlockParsers.slice(),o=this.blockNames.slice(),a=this.inlineParsers.slice(),l=this.inlineNames.slice(),c=this.endLeafBlock.slice(),u=this.wrappers;if(zf(t.defineNodes)){i=Object.assign({},i);let e,r=n.types.slice();for(let n of t.defineNodes){let{name:t,block:s,composite:o,style:a}="string"==typeof n?{name:n}:n;if(r.some(e=>e.name==t))continue;o&&(i[r.length]=(e,t,n)=>o(t,n,e.value));let l=r.length,c=o?["Block","BlockContext"]:s?l>=cf.ATXHeading1&&l<=cf.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;r.push(Wc.define({id:l,name:t,props:c&&[[jc.group,c]]})),a&&(e||(e={}),Array.isArray(a)||a instanceof Pu?e[t]=a:Object.assign(e,a))}n=new Vc(r),e&&(n=n.extend(Ru(e)))}if(zf(t.props)&&(n=n.extend(...t.props)),zf(t.remove))for(let h of t.remove){let e=this.blockNames.indexOf(h),t=this.inlineNames.indexOf(h);e>-1&&(r[e]=s[e]=void 0),t>-1&&(a[t]=void 0)}if(zf(t.parseBlock))for(let h of t.parseBlock){let e=o.indexOf(h.name);if(e>-1)r[e]=h.parse,s[e]=h.leaf;else{let e=h.before?Vf(o,h.before):h.after?Vf(o,h.after)+1:o.length-1;r.splice(e,0,h.parse),s.splice(e,0,h.leaf),o.splice(e,0,h.name)}h.endLeaf&&c.push(h.endLeaf)}if(zf(t.parseInline))for(let h of t.parseInline){let e=l.indexOf(h.name);if(e>-1)a[e]=h.parse;else{let e=h.before?Vf(l,h.before):h.after?Vf(l,h.after)+1:l.length-1;a.splice(e,0,h.parse),l.splice(e,0,h.name)}}return t.wrap&&(u=u.concat(t.wrap)),new $f(n,r,s,o,c,i,a,l,u)}getNodeType(e){let t=this.nodeTypes[e];if(null==t)throw new RangeError("Unknown node type '".concat(e,"'"));return t}parseInline(e,t){let n=new cm(this,e,t);e:for(let i=t;i<n.end;){let e=n.char(i);for(let t of this.inlineParsers)if(t){let r=t(n,e,i);if(r>=0){i=r;continue e}}i++}return n.resolveMarkers(0)}}function zf(e){return null!=e&&e.length>0}function Wf(e){if(!Array.isArray(e))return e;if(0==e.length)return null;let t=Wf(e[0]);if(1==e.length)return t;let n=Wf(e.slice(1));if(!n||!t)return t||n;let i=(e,t)=>(e||Xf).concat(t||Xf),r=t.wrap,s=n.wrap;return{props:i(t.props,n.props),defineNodes:i(t.defineNodes,n.defineNodes),parseBlock:i(t.parseBlock,n.parseBlock),parseInline:i(t.parseInline,n.parseInline),remove:i(t.remove,n.remove),wrap:r?s?(e,t,n,i)=>r(s(e,t,n,i),t,n,i):r:s}}function Vf(e,t){let n=e.indexOf(t);if(n<0)throw new RangeError("Position specified relative to unknown parser ".concat(t));return n}let Uf=[Wc.none];for(let os,ese=1;os=cf[ese];ese++)Uf[ese]=Wc.define({id:ese,name:os,props:ese>=cf.Escape?[]:[[jc.group,ese in pf?["Block","BlockContext"]:["Block","LeafBlock"]]],top:"Document"==os});const Xf=[];class qf{constructor(e){this.nodeSet=e,this.content=[],this.nodes=[]}write(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.content.push(e,t,n,4+4*i),this}writeElements(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n of e)n.writeTo(this,t);return this}finish(e,t){return Zc.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:e,length:t})}}class Zf{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xf;this.type=e,this.from=t,this.to=n,this.children=i}writeTo(e,t){let n=e.content.length;e.writeElements(this.children,t),e.content.push(this.type,this.from+t,this.to+t,e.content.length+4-n)}toTree(e){return new qf(e).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}}class Hf{constructor(e,t){this.tree=e,this.from=t}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return Xf}writeTo(e,t){e.nodes.push(this.tree),e.content.push(e.nodes.length-1,this.from+t,this.to+t,-1)}toTree(){return this.tree}}function Yf(e,t,n,i){return new Zf(e,t,n,i)}const Gf={resolve:"Emphasis",mark:"EmphasisMark"},Kf={resolve:"Emphasis",mark:"EmphasisMark"},Jf={},em={};class tm{constructor(e,t,n,i){this.type=e,this.from=t,this.to=n,this.side=i}}const nm="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let im=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{im=new RegExp("[\\p{S}|\\p{P}]","u")}catch(Jre){}const rm={Escape(e,t,n){if(92!=t||n==e.end-1)return-1;let i=e.char(n+1);for(let r=0;r<32;r++)if(nm.charCodeAt(r)==i)return e.append(Yf(cf.Escape,n,n+2));return-1},Entity(e,t,n){if(38!=t)return-1;let i=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(e.slice(n+1,n+31));return i?e.append(Yf(cf.Entity,n,n+1+i[0].length)):-1},InlineCode(e,t,n){if(96!=t||n&&96==e.char(n-1))return-1;let i=n+1;for(;i<e.end&&96==e.char(i);)i++;let r=i-n,s=0;for(;i<e.end;i++)if(96==e.char(i)){if(s++,s==r&&96!=e.char(i+1))return e.append(Yf(cf.InlineCode,n,i+1,[Yf(cf.CodeMark,n,n+r),Yf(cf.CodeMark,i+1-r,i+1)]))}else s=0;return-1},HTMLTag(e,t,n){if(60!=t||n==e.end-1)return-1;let i=e.slice(n+1,e.end),r=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(i);if(r)return e.append(Yf(cf.Autolink,n,n+1+r[0].length,[Yf(cf.LinkMark,n,n+1),Yf(cf.URL,n+1,n+r[0].length),Yf(cf.LinkMark,n+r[0].length,n+1+r[0].length)]));let s=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(i);if(s)return e.append(Yf(cf.Comment,n,n+1+s[0].length));let o=/^\?[^]*?\?>/.exec(i);if(o)return e.append(Yf(cf.ProcessingInstruction,n,n+1+o[0].length));let a=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(i);return a?e.append(Yf(cf.HTMLTag,n,n+1+a[0].length)):-1},Emphasis(e,t,n){if(95!=t&&42!=t)return-1;let i=n+1;for(;e.char(i)==t;)i++;let r=e.slice(n-1,n),s=e.slice(i,i+1),o=im.test(r),a=im.test(s),l=/\s|^$/.test(r),c=/\s|^$/.test(s),u=!c&&(!a||l||o),h=!l&&(!o||c||a),d=u&&(42==t||!h||o),p=h&&(42==t||!u||a);return e.append(new tm(95==t?Gf:Kf,n,i,(d?1:0)|(p?2:0)))},HardBreak(e,t,n){if(92==t&&10==e.char(n+1))return e.append(Yf(cf.HardBreak,n,n+2));if(32==t){let t=n+1;for(;32==e.char(t);)t++;if(10==e.char(t)&&t>=n+2)return e.append(Yf(cf.HardBreak,n,t+1))}return-1},Link:(e,t,n)=>91==t?e.append(new tm(Jf,n,n+1,1)):-1,Image:(e,t,n)=>33==t&&91==e.char(n+1)?e.append(new tm(em,n,n+2,1)):-1,LinkEnd(e,t,n){if(93!=t)return-1;for(let i=e.parts.length-1;i>=0;i--){let t=e.parts[i];if(t instanceof tm&&(t.type==Jf||t.type==em)){if(!t.side||e.skipSpace(t.to)==n&&!/[(\[]/.test(e.slice(n+1,n+2)))return e.parts[i]=null,-1;let r=e.takeContent(i),s=e.parts[i]=sm(e,r,t.type==Jf?cf.Link:cf.Image,t.from,n+1);if(t.type==Jf)for(let t=0;t<i;t++){let n=e.parts[t];n instanceof tm&&n.type==Jf&&(n.side=0)}return s.to}}return-1}};function sm(e,t,n,i,r){let{text:s}=e,o=e.char(r),a=r;if(t.unshift(Yf(cf.LinkMark,i,i+(n==cf.Image?2:1))),t.push(Yf(cf.LinkMark,r-1,r)),40==o){let n,i=e.skipSpace(r+1),o=om(s,i-e.offset,e.offset);o&&(i=e.skipSpace(o.to),i!=o.to&&(n=am(s,i-e.offset,e.offset),n&&(i=e.skipSpace(n.to)))),41==e.char(i)&&(t.push(Yf(cf.LinkMark,r,r+1)),a=i+1,o&&t.push(o),n&&t.push(n),t.push(Yf(cf.LinkMark,i,a)))}else if(91==o){let n=lm(s,r-e.offset,e.offset,!1);n&&(t.push(n),a=n.to)}return Yf(n,i,a,t)}function om(e,t,n){if(60==e.charCodeAt(t)){for(let i=t+1;i<e.length;i++){let r=e.charCodeAt(i);if(62==r)return Yf(cf.URL,t+n,i+1+n);if(60==r||10==r)return!1}return null}{let i=0,r=t;for(let t=!1;r<e.length;r++){let n=e.charCodeAt(r);if(ff(n))break;if(t)t=!1;else if(40==n)i++;else if(41==n){if(!i)break;i--}else 92==n&&(t=!0)}return r>t?Yf(cf.URL,t+n,r+n):r==e.length&&null}}function am(e,t,n){let i=e.charCodeAt(t);if(39!=i&&34!=i&&40!=i)return!1;let r=40==i?41:i;for(let s=t+1,o=!1;s<e.length;s++){let i=e.charCodeAt(s);if(o)o=!1;else{if(i==r)return Yf(cf.LinkTitle,t+n,s+1+n);92==i&&(o=!0)}}return null}function lm(e,t,n,i){for(let r=!1,s=t+1,o=Math.min(e.length,s+999);s<o;s++){let o=e.charCodeAt(s);if(r)r=!1;else{if(93==o)return!i&&Yf(cf.LinkLabel,t+n,s+1+n);if(i&&!ff(o)&&(i=!1),91==o)return!1;92==o&&(r=!0)}}return null}class cm{constructor(e,t,n){this.parser=e,this.text=t,this.offset=n,this.parts=[]}char(e){return e>=this.end?-1:this.text.charCodeAt(e-this.offset)}get end(){return this.offset+this.text.length}slice(e,t){return this.text.slice(e-this.offset,t-this.offset)}append(e){return this.parts.push(e),e.to}addDelimiter(e,t,n,i,r){return this.append(new tm(e,t,n,(i?1:0)|(r?2:0)))}get hasOpenLink(){for(let e=this.parts.length-1;e>=0;e--){let t=this.parts[e];if(t instanceof tm&&(t.type==Jf||t.type==em))return!0}return!1}addElement(e){return this.append(e)}resolveMarkers(e){for(let n=e;n<this.parts.length;n++){let t=this.parts[n];if(!(t instanceof tm&&t.type.resolve&&2&t.side))continue;let i,r=t.type==Gf||t.type==Kf,s=t.to-t.from,o=n-1;for(;o>=e;o--){let e=this.parts[o];if(e instanceof tm&&1&e.side&&e.type==t.type&&!(r&&(1&t.side||2&e.side)&&(e.to-e.from+s)%3==0&&((e.to-e.from)%3||s%3))){i=e;break}}if(!i)continue;let a=t.type.resolve,l=[],c=i.from,u=t.to;if(r){let e=Math.min(2,i.to-i.from,s);c=i.to-e,u=t.from+e,a=1==e?"Emphasis":"StrongEmphasis"}i.type.mark&&l.push(this.elt(i.type.mark,c,i.to));for(let e=o+1;e<n;e++)this.parts[e]instanceof Zf&&l.push(this.parts[e]),this.parts[e]=null;t.type.mark&&l.push(this.elt(t.type.mark,t.from,u));let h=this.elt(a,c,u,l);this.parts[o]=r&&i.from!=c?new tm(i.type,i.from,c,i.side):null,(this.parts[n]=r&&t.to!=u?new tm(t.type,u,t.to,t.side):null)?this.parts.splice(n,0,h):this.parts[n]=h}let t=[];for(let n=e;n<this.parts.length;n++){let e=this.parts[n];e instanceof Zf&&t.push(e)}return t}findOpeningDelimiter(e){for(let t=this.parts.length-1;t>=0;t--){let n=this.parts[t];if(n instanceof tm&&n.type==e&&1&n.side)return t}return null}takeContent(e){let t=this.resolveMarkers(e);return this.parts.length=e,t}getDelimiterAt(e){let t=this.parts[e];return t instanceof tm?t:null}skipSpace(e){return mf(this.text,e-this.offset)+this.offset}elt(e,t,n,i){return"string"==typeof e?Yf(this.parser.getNodeType(e),t,n,i):new Hf(e,t)}}function um(e,t){if(!t.length)return e;if(!e.length)return t;let n=e.slice(),i=0;for(let r of t){for(;i<n.length&&n[i].to<r.to;)i++;if(i<n.length&&n[i].from<r.from){let e=n[i];e instanceof Zf&&(n[i]=new Zf(e.type,e.from,e.to,um(e.children,[r])))}else n.splice(i++,0,r)}return n}cm.linkStart=Jf,cm.imageStart=em;const hm=[cf.CodeBlock,cf.ListItem,cf.OrderedList,cf.BulletList];class dm{constructor(e,t){this.fragments=e,this.input=t,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,e.length&&(this.fragment=e[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(e,t){for(;this.fragment&&this.fragment.to<=e;)this.nextFragment();if(!this.fragment||this.fragment.from>(e?e-1:0))return!1;if(this.fragmentEnd<0){let e=this.fragment.to;for(;e>0&&"\n"!=this.input.read(e-1,e);)e--;this.fragmentEnd=e?e-1:0}let n=this.cursor;n||(n=this.cursor=this.fragment.tree.cursor(),n.firstChild());let i=e+this.fragment.offset;for(;n.to<=i;)if(!n.parent())return!1;for(;;){if(n.from>=i)return this.fragment.from<=t;if(!n.childAfter(i))return!1}}matches(e){let t=this.cursor.tree;return t&&t.prop(jc.contextHash)==e}takeNodes(e){let t=this.cursor,n=this.fragment.offset,i=this.fragmentEnd-(this.fragment.openEnd?1:0),r=e.absoluteLineStart,s=r,o=e.block.children.length,a=s,l=o;for(;;){if(t.to-n>i){if(t.type.isAnonymous&&t.firstChild())continue;break}let r=pm(t.from-n,e.ranges);if(t.to-n<=e.ranges[e.rangeI].to)e.addNode(t.tree,r);else{let n=new Zc(e.parser.nodeSet.types[cf.Paragraph],[],[],0,e.block.hashProp);e.reusePlaceholders.set(n,t.tree),e.addNode(n,r)}if(t.type.is("Block")&&(hm.indexOf(t.type.id)<0?(s=t.to-n,o=e.block.children.length):(s=a,o=l),a=t.to-n,l=e.block.children.length),!t.nextSibling())break}for(;e.block.children.length>o;)e.block.children.pop(),e.block.positions.pop();return s-r}}function pm(e,t){let n=e;for(let i=1;i<t.length;i++){let r=t[i-1].to,s=t[i].from;r<e&&(n-=s-r)}return n}const fm=Ru({"Blockquote/...":th.quote,HorizontalRule:th.contentSeparator,"ATXHeading1/... SetextHeading1/...":th.heading1,"ATXHeading2/... SetextHeading2/...":th.heading2,"ATXHeading3/...":th.heading3,"ATXHeading4/...":th.heading4,"ATXHeading5/...":th.heading5,"ATXHeading6/...":th.heading6,"Comment CommentBlock":th.comment,Escape:th.escape,Entity:th.character,"Emphasis/...":th.emphasis,"StrongEmphasis/...":th.strong,"Link/... Image/...":th.link,"OrderedList/... BulletList/...":th.list,"BlockQuote/...":th.quote,"InlineCode CodeText":th.monospace,"URL Autolink":th.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":th.processingInstruction,"CodeInfo LinkLabel":th.labelName,LinkTitle:th.string,Paragraph:th.content}),mm=new $f(new Vc(Uf).extend(fm),Object.keys(Mf).map(e=>Mf[e]),Object.keys(Mf).map(e=>If[e]),Object.keys(Mf),Bf,pf,Object.keys(rm).map(e=>rm[e]),Object.keys(rm),[]);function gm(e,t,n){let i=[];for(let r=e.firstChild,s=t;;r=r.nextSibling){let e=r?r.from:n;if(e>s&&i.push({from:s,to:e}),!r)break;s=r.to}return i}const vm={resolve:"Strikethrough",mark:"StrikethroughMark"},ym={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":th.strikethrough}},{name:"StrikethroughMark",style:th.processingInstruction}],parseInline:[{name:"Strikethrough",parse(e,t,n){if(126!=t||126!=e.char(n+1)||126==e.char(n+2))return-1;let i=e.slice(n-1,n),r=e.slice(n+2,n+3),s=/\s|^$/.test(i),o=/\s|^$/.test(r),a=im.test(i),l=im.test(r);return e.addDelimiter(vm,n,n+2,!o&&(!l||s||a),!s&&(!a||o||l))},after:"Emphasis"}]};function Om(e,t){let n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=0,s=!0,o=-1,a=-1,l=!1,c=()=>{n.push(e.elt("TableCell",i+o,i+a,e.parser.parseInline(t.slice(o,a),i+o)))};for(let u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;u<t.length;u++){let h=t.charCodeAt(u);124!=h||l?(l||32!=h&&9!=h)&&(o<0&&(o=u),a=u+1):((!s||o>-1)&&r++,s=!1,n&&(o>-1&&c(),n.push(e.elt("TableDelimiter",u+i,u+i+1))),o=a=-1),l=!l&&92==h}return o>-1&&(r++,n&&c()),r}function wm(e,t){for(let n=t;n<e.length;n++){let t=e.charCodeAt(n);if(124==t)return!0;92==t&&n++}return!1}const bm=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class km{constructor(){this.rows=null}nextLine(e,t,n){if(null==this.rows){let i;if(this.rows=!1,(45==t.next||58==t.next||124==t.next)&&bm.test(i=t.text.slice(t.pos))){let r=[];Om(e,n.content,0,r,n.start)==Om(e,i,t.pos)&&(this.rows=[e.elt("TableHeader",n.start,n.start+n.content.length,r),e.elt("TableDelimiter",e.lineStart+t.pos,e.lineStart+t.text.length)])}}else if(this.rows){let n=[];Om(e,t.text,t.pos,n,e.lineStart),this.rows.push(e.elt("TableRow",e.lineStart+t.pos,e.lineStart+t.text.length,n))}return!1}finish(e,t){return!!this.rows&&(e.addLeafElement(t,e.elt("Table",t.start,t.start+t.content.length,this.rows)),!0)}}const xm={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":th.heading}},"TableRow",{name:"TableCell",style:th.content},{name:"TableDelimiter",style:th.processingInstruction}],parseBlock:[{name:"Table",leaf:(e,t)=>wm(t.content,0)?new km:null,endLeaf(e,t,n){if(n.parsers.some(e=>e instanceof km)||!wm(t.text,t.basePos))return!1;let i=e.peekLine();return bm.test(i)&&Om(e,t.text,t.basePos)==Om(e,i,t.basePos)},before:"SetextHeading"}]};class Dm{nextLine(){return!1}finish(e,t){return e.addLeafElement(t,e.elt("Task",t.start,t.start+t.content.length,[e.elt("TaskMarker",t.start,t.start+3),...e.parser.parseInline(t.content.slice(3),t.start+3)])),!0}}const Sm={defineNodes:[{name:"Task",block:!0,style:th.list},{name:"TaskMarker",style:th.atom}],parseBlock:[{name:"TaskList",leaf:(e,t)=>/^\[[ xX]\][ \t]/.test(t.content)&&"ListItem"==e.parentType().name?new Dm:null,after:"SetextHeading"}]},Cm=/(www\.)|(https?:\/\/)|([\w.+-]{1,100}@)|(mailto:|xmpp:)/gy,Am=/[\w-]+(\.[\w-]+)+(\/[^\s<]*)?/gy,Em=/[\w-]+\.[\w-]+($|\/)/,_m=/[\w.+-]+@[\w-]+(\.[\w.-]+)+/gy,Tm=/\/[a-zA-Z\d@.]+/gy;function Pm(e,t,n,i){let r=0;for(let s=t;s<n;s++)e[s]==i&&r++;return r}function Mm(e,t){_m.lastIndex=t;let n=_m.exec(e);if(!n)return-1;let i=n[0][n[0].length-1];return"_"==i||"-"==i?-1:t+n[0].length-("."==i?1:0)}const Fm={parseInline:[{name:"Autolink",parse(e,t,n){let i=n-e.offset;if(i&&/\w/.test(e.text[i-1]))return-1;Cm.lastIndex=i;let r=Cm.exec(e.text),s=-1;if(!r)return-1;if(r[1]||r[2]){if(s=function(e,t){Am.lastIndex=t;let n=Am.exec(e);if(!n||Em.exec(n[0])[0].indexOf("_")>-1)return-1;let i=t+n[0].length;for(;;){let n,r=e[i-1];if(/[?!.,:*_~]/.test(r)||")"==r&&Pm(e,t,i,")")>Pm(e,t,i,"("))i--;else{if(";"!=r||!(n=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(e.slice(t,i))))break;i=t+n.index}}return i}(e.text,i+r[0].length),s>-1&&e.hasOpenLink){s=i+/([^\[\]]|\[[^\]]*\])*/.exec(e.text.slice(i,s))[0].length}}else r[3]?s=Mm(e.text,i):(s=Mm(e.text,i+r[0].length),s>-1&&"xmpp:"==r[0]&&(Tm.lastIndex=s,r=Tm.exec(e.text),r&&(s=r.index+r[0].length)));return s<0?-1:(e.addElement(e.elt("URL",n,s+e.offset)),s+e.offset)}}]},Rm=[xm,Sm,ym,Fm];function Nm(e,t,n){return(i,r,s)=>{if(r!=e||i.char(s+1)==e)return-1;let o=[i.elt(n,s,s+1)];for(let a=s+1;a<i.end;a++){let r=i.char(a);if(r==e)return i.addElement(i.elt(t,s,a+1,o.concat(i.elt(n,a,a+1))));if(92==r&&o.push(i.elt("Escape",a,2+a++)),ff(r))break}return-1}}const Im={defineNodes:[{name:"Superscript",style:th.special(th.content)},{name:"SuperscriptMark",style:th.processingInstruction}],parseInline:[{name:"Superscript",parse:Nm(94,"Superscript","SuperscriptMark")}]},Bm={defineNodes:[{name:"Subscript",style:th.special(th.content)},{name:"SubscriptMark",style:th.processingInstruction}],parseInline:[{name:"Subscript",parse:Nm(126,"Subscript","SubscriptMark")}]},Qm={defineNodes:[{name:"Emoji",style:th.character}],parseInline:[{name:"Emoji",parse(e,t,n){let i;return 58==t&&(i=/^[a-zA-Z_0-9]+:/.exec(e.slice(n+1,e.end)))?e.addElement(e.elt("Emoji",n,n+1+i[0].length)):-1}}]};class Lm{constructor(e,t,n,i,r,s,o,a,l){let c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,u=arguments.length>10?arguments[10]:void 0;this.p=e,this.stack=t,this.state=n,this.reducePos=i,this.pos=r,this.score=s,this.buffer=o,this.bufferBase=a,this.curContext=l,this.lookAhead=c,this.parent=u}toString(){return"[".concat(this.stack.filter((e,t)=>t%3==0).concat(this.state),"]@").concat(this.pos).concat(this.score?"!"+this.score:"")}static start(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=e.parser.context;return new Lm(e,[],t,n,n,0,[],0,i?new jm(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,i=65535&e,{parser:r}=this.p,s=this.reducePos<this.pos-25&&this.setLookAhead(this.pos),o=r.dynamicPrecedence(i);if(o&&(this.score+=o),0==n)return this.pushState(r.getGoto(this.state,i,!0),this.reducePos),i<r.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,s?8:4,!0),void this.reduceContext(i,this.reducePos);let a=this.stack.length-3*(n-1)-(262144&e?6:0),l=a?this.stack[a-2]:this.p.ranges[0].from,c=this.reducePos-l;c>=2e3&&!(null===(t=this.p.parser.nodeSet.types[i])||void 0===t?void 0:t.isAnonymous)&&(l==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=c):this.p.lastBigReductionSize<c&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=l,this.p.lastBigReductionSize=c));let u=a?this.stack[a-1]:0,h=this.bufferBase+this.buffer.length-u;if(i<r.minRepeatTerm||131072&e){let e=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,l,e,h+4,!0)}if(262144&e)this.state=this.stack[a];else{let e=this.stack[a-3];this.state=r.getGoto(e,i,!0)}for(;this.stack.length>a;)this.stack.pop();this.reduceContext(i,l)}storeNode(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(0==e&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let e=this,i=this.buffer.length;if(0==i&&e.parent&&(i=e.bufferBase-e.parent.bufferBase,e=e.parent),i>0&&0==e.buffer[i-4]&&e.buffer[i-1]>-1){if(t==n)return;if(e.buffer[i-2]>=t)return void(e.buffer[i-2]=n)}}if(r&&this.pos!=n){let r=this.buffer.length;if(r>0&&(0!=this.buffer[r-4]||this.buffer[r-1]<0)){let e=!1;for(let t=r;t>0&&this.buffer[t-2]>n;t-=4)if(this.buffer[t-1]>=0){e=!0;break}if(e)for(;r>0&&this.buffer[r-2]>n;)this.buffer[r]=this.buffer[r-4],this.buffer[r+1]=this.buffer[r-3],this.buffer[r+2]=this.buffer[r-2],this.buffer[r+3]=this.buffer[r-1],r-=4,i>4&&(i-=4)}this.buffer[r]=e,this.buffer[r+1]=t,this.buffer[r+2]=n,this.buffer[r+3]=i}else this.buffer.push(e,t,n,i)}shift(e,t,n,i){if(131072&e)this.pushState(65535&e,this.pos);else if(0==(262144&e)){let r=e,{parser:s}=this.p;this.pos=i;let o=s.stateFlag(r,1);!o&&(i>n||t<=s.maxNode)&&(this.reducePos=i),this.pushState(r,o?n:Math.min(n,this.reducePos)),this.shiftContext(t,n),t<=s.maxNode&&this.buffer.push(t,n,i,4)}else this.pos=i,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,i,4)}apply(e,t,n,i){65536&e?this.reduce(e):this.shift(e,t,n,i)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(t,i),this.buffer.push(n,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),i=e.bufferBase+t;for(;e&&i==e.bufferBase;)e=e.parent;return new Lm(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,i,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new $m(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==n)return!1;if(0==(65536&n))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let n=[];for(let i,r=0;r<t.length;r+=2)(i=t[r+1])!=this.state&&this.p.parser.hasAction(i,e)&&n.push(t[r],i);if(this.stack.length<120)for(let e=0;n.length<8&&e<t.length;e+=2){let i=t[e+1];n.some((e,t)=>1&t&&e==i)||n.push(t[e],i)}t=n}let n=[];for(let i=0;i<t.length&&n.length<4;i+=2){let e=t[i+1];if(e==this.state)continue;let r=this.split();r.pushState(e,this.pos),r.storeNode(0,r.pos,r.pos,4,!0),r.shiftContext(t[i],this.pos),r.reducePos=this.pos,r.score-=200,n.push(r)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(0==(65536&t))return!1;if(!e.validAction(this.state,t)){let n=t>>19,i=65535&t,r=this.stack.length-3*n;if(r<0||e.getGoto(this.stack[r],i,!1)<0){let e=this.findForcedReduction();if(null==e)return!1;t=e}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(i,r)=>{if(!t.includes(i))return t.push(i),e.allActions(i,t=>{if(393216&t);else if(65536&t){let n=(t>>19)-r;if(n>1){let i=65535&t,r=this.stack.length-3*n;if(r>=0&&e.getGoto(this.stack[r],i,!1)>=0)return n<<19|65536|i}}else{let e=n(t,r+1);if(null!=e)return e}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:e}=this.p;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new jm(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){return!(e<=this.lookAhead)&&(this.emitLookAhead(),this.lookAhead=e,!0)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class jm{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class $m{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=65535&e,n=e>>19;0==n?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(n-1);let i=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=i}}class zm{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,0==this.index&&this.maybeNext()}static create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.bufferBase+e.buffer.length;return new zm(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new zm(this.stack,this.pos,this.index)}}function Wm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uint16Array;if("string"!=typeof e)return e;let n=null;for(let i=0,r=0;i<e.length;){let s=0;for(;;){let t=e.charCodeAt(i++),n=!1;if(126==t){s=65535;break}t>=92&&t--,t>=34&&t--;let r=t-32;if(r>=46&&(r-=46,n=!0),s+=r,n)break;s*=46}n?n[r++]=s:n=new t(s)}return n}class Vm{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Um=new Vm;class Xm{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Um,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,i=this.rangeIndex,r=this.pos+e;for(;r<n.from;){if(!i)return null;let e=this.ranges[--i];r-=n.from-e.to,n=e}for(;t<0?r>n.to:r>=n.to;){if(i==this.ranges.length-1)return null;let e=this.ranges[++i];r+=e.from-n.to,n=e}return r}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t,n,i=this.chunkOff+e;if(i>=0&&i<this.chunk.length)t=this.pos+e,n=this.chunk.charCodeAt(i);else{let i=this.resolveOffset(e,1);if(null==i)return-1;if(t=i,t>=this.chunk2Pos&&t<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(t-this.chunk2Pos);else{let e=this.rangeIndex,i=this.range;for(;i.to<=t;)i=this.ranges[++e];this.chunk2=this.input.chunk(this.chunk2Pos=t),t+this.chunk2.length>i.to&&(this.chunk2=this.chunk2.slice(0,i.to-t)),n=this.chunk2.charCodeAt(0)}}return t>=this.token.lookAhead&&(this.token.lookAhead=t+1),n}acceptToken(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t?this.resolveOffset(t,-1):this.pos;if(null==n||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=Um,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let i of this.ranges){if(i.from>=t)break;i.to>e&&(n+=this.input.read(Math.max(i.from,e),Math.min(i.to,t)))}return n}}class qm{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;Ym(this.data,e,t,this.id,n.data,n.tokenPrecTable)}}qm.prototype.contextual=qm.prototype.fallback=qm.prototype.extend=!1;class Zm{constructor(e,t,n){this.precTable=t,this.elseToken=n,this.data="string"==typeof e?Wm(e):e}token(e,t){let n=e.pos,i=0;for(;;){let n=e.next<0,r=e.resolveOffset(1,1);if(Ym(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(null==this.elseToken)return;if(n||i++,null==r)break;e.reset(r,e.token)}i&&(e.reset(n,e.token),e.acceptToken(this.elseToken,i))}}Zm.prototype.contextual=qm.prototype.fallback=qm.prototype.extend=!1;class Hm{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function Ym(e,t,n,i,r,s){let o=0,a=1<<i,{dialect:l}=n.p.parser;e:for(;0!=(a&e[o]);){let n=e[o+1];for(let h=o+3;h<n;h+=2)if((e[h+1]&a)>0){let n=e[h];if(l.allows(n)&&(-1==t.token.value||t.token.value==n||Km(n,t.token.value,r,s))){t.acceptToken(n);break}}let i=t.next,c=0,u=e[o+2];if(!(t.next<0&&u>c&&65535==e[n+3*u-3])){for(;c<u;){let r=c+u>>1,s=n+r+(r<<1),a=e[s],l=e[s+1]||65536;if(i<a)u=r;else{if(!(i>=l)){o=e[s+2],t.advance();continue e}c=r+1}}break}o=e[n+3*u-1]}}function Gm(e,t,n){for(let i,r=t;65535!=(i=e[r]);r++)if(i==n)return r-t;return-1}function Km(e,t,n,i){let r=Gm(n,i,t);return r<0||Gm(n,i,e)<r}const Jm="undefined"!=typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/flashy",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production",REACT_APP_SUPABASE_URL:"https://juberlfvyedrbiixrkxt.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp1YmVybGZ2eWVkcmJpaXhya3h0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwNTcyMTcsImV4cCI6MjA4NTYzMzIxN30.Xom-I23EyDMIq_skpdF4lmLNDEg8NZQ9498QfVI6siA",REACT_APP_SHARED_PASSWORD:"password"}&&/\bparse\b/.test({NODE_ENV:"production",PUBLIC_URL:"/flashy",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production",REACT_APP_SUPABASE_URL:"https://juberlfvyedrbiixrkxt.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp1YmVybGZ2eWVkcmJpaXhya3h0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwNTcyMTcsImV4cCI6MjA4NTYzMzIxN30.Xom-I23EyDMIq_skpdF4lmLNDEg8NZQ9498QfVI6siA",REACT_APP_SHARED_PASSWORD:"password"}.LOG);let eg=null;function tg(e,t,n){let i=e.cursor(qc.IncludeAnonymous);for(i.moveTo(t);;)if(!(n<0?i.childBefore(t):i.childAfter(t)))for(;;){if((n<0?i.to<t:i.from>t)&&!i.type.isError)return n<0?Math.max(0,Math.min(i.to-1,t-25)):Math.min(e.length,Math.max(i.from+1,t+25));if(n<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return n<0?0:e.length}}class ng{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?tg(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?tg(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],i=this.index[t];if(i==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=n.children[i],s=this.start[t]+n.positions[i];if(s>e)return this.nextStart=s,null;if(r instanceof Zc){if(s==e){if(s<this.safeFrom)return null;let e=s+r.length;if(e<=this.safeTo){let t=r.prop(jc.lookAhead);if(!t||e+t<this.fragment.to)return r}}this.index[t]++,s+r.length>=Math.max(this.safeFrom,e)&&(this.trees.push(r),this.start.push(s),this.index.push(0))}else this.index[t]++,this.nextStart=s+r.length}}}class ig{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(e=>new Vm)}getActions(e){let t=0,n=null,{parser:i}=e.p,{tokenizers:r}=i,s=i.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,a=0;for(let l=0;l<r.length;l++){if(0==(1<<l&s))continue;let i=r[l],c=this.tokens[l];if((!n||i.fallback)&&((i.contextual||c.start!=e.pos||c.mask!=s||c.context!=o)&&(this.updateCachedToken(c,i,e),c.mask=s,c.context=o),c.lookAhead>c.end+25&&(a=Math.max(c.lookAhead,a)),0!=c.value)){let r=t;if(c.extended>-1&&(t=this.addActions(e,c.extended,c.end,t)),t=this.addActions(e,c.value,c.end,t),!i.extend&&(n=c,t>r))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),n||e.pos!=this.stream.end||(n=new Vm,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new Vm,{pos:n,p:i}=e;return t.start=n,t.end=Math.min(n+1,i.stream.end),t.value=n==i.stream.end?i.parser.eofTerm:0,t}updateCachedToken(e,t,n){let i=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(i,e),n),e.value>-1){let{parser:t}=n.p;for(let i=0;i<t.specialized.length;i++)if(t.specialized[i]==e.value){let r=t.specializers[i](this.stream.read(e.start,e.end),n);if(r>=0&&n.p.parser.dialect.allows(r>>1)){0==(1&r)?e.value=r>>1:e.extended=r>>1;break}}}else e.value=0,e.end=this.stream.clipPos(i+1)}putAction(e,t,n,i){for(let r=0;r<i;r+=3)if(this.actions[r]==e)return i;return this.actions[i++]=e,this.actions[i++]=t,this.actions[i++]=n,i}addActions(e,t,n,i){let{state:r}=e,{parser:s}=e.p,{data:o}=s;for(let a=0;a<2;a++)for(let e=s.stateSlot(r,a?2:1);;e+=3){if(65535==o[e]){if(1!=o[e+1]){0==i&&2==o[e+1]&&(i=this.putAction(ug(o,e+2),t,n,i));break}e=ug(o,e+2)}o[e]==t&&(i=this.putAction(ug(o,e+1),t,n,i))}return i}}class rg{constructor(e,t,n,i){this.parser=e,this.input=t,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new Xm(t,i),this.tokens=new ig(e,this.stream),this.topTerm=e.top[1];let{from:r}=i[0];this.stacks=[Lm.start(this,e.top[0],r)],this.fragments=n.length&&this.stream.end-r>4*e.bufferLength?new ng(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e,t,n=this.stacks,i=this.minStackPos,r=this.stacks=[];if(this.bigReductionCount>300&&1==n.length){let[e]=n;for(;e.forceReduce()&&e.stack.length&&e.stack[e.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let s=0;s<n.length;s++){let o=n[s];for(;;){if(this.tokens.mainToken=null,o.pos>i)r.push(o);else{if(this.advanceStack(o,r,n))continue;{e||(e=[],t=[]),e.push(o);let n=this.tokens.getMainToken(o);t.push(n.value,n.end)}}break}}if(!r.length){let t=e&&function(e){let t=null;for(let n of e){let e=n.p.stoppedAt;(n.pos==n.p.stream.end||null!=e&&n.pos>e)&&n.p.parser.stateFlag(n.state,2)&&(!t||t.score<n.score)&&(t=n)}return t}(e);if(t)return Jm&&console.log("Finish with "+this.stackID(t)),this.stackToTree(t);if(this.parser.strict)throw Jm&&e&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+i);this.recovering||(this.recovering=5)}if(this.recovering&&e){let n=null!=this.stoppedAt&&e[0].pos>this.stoppedAt?e[0]:this.runRecovery(e,t,r);if(n)return Jm&&console.log("Force-finish "+this.stackID(n)),this.stackToTree(n.forceAll())}if(this.recovering){let e=1==this.recovering?1:3*this.recovering;if(r.length>e)for(r.sort((e,t)=>t.score-e.score);r.length>e;)r.pop();r.some(e=>e.reducePos>i)&&this.recovering--}else if(r.length>1){e:for(let e=0;e<r.length-1;e++){let t=r[e];for(let n=e+1;n<r.length;n++){let i=r[n];if(t.sameState(i)||t.buffer.length>500&&i.buffer.length>500){if(!((t.score-i.score||t.buffer.length-i.buffer.length)>0)){r.splice(e--,1);continue e}r.splice(n--,1)}}}r.length>12&&(r.sort((e,t)=>t.score-e.score),r.splice(12,r.length-12))}this.minStackPos=r[0].pos;for(let s=1;s<r.length;s++)r[s].pos<this.minStackPos&&(this.minStackPos=r[s].pos);return null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let i=e.pos,{parser:r}=this,s=Jm?this.stackID(e)+" -> ":"";if(null!=this.stoppedAt&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let t=e.curContext&&e.curContext.tracker.strict,n=t?e.curContext.hash:0;for(let o=this.fragments.nodeAt(i);o;){let i=this.parser.nodeSet.types[o.type.id]==o.type?r.getGoto(e.state,o.type.id):-1;if(i>-1&&o.length&&(!t||(o.prop(jc.contextHash)||0)==n))return e.useNode(o,i),Jm&&console.log(s+this.stackID(e)+" (via reuse of ".concat(r.getName(o.type.id),")")),!0;if(!(o instanceof Zc)||0==o.children.length||o.positions[0]>0)break;let a=o.children[0];if(!(a instanceof Zc&&0==o.positions[0]))break;o=a}}let o=r.stateSlot(e.state,4);if(o>0)return e.reduce(o),Jm&&console.log(s+this.stackID(e)+" (via always-reduce ".concat(r.getName(65535&o),")")),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let a=this.tokens.getActions(e);for(let l=0;l<a.length;){let o=a[l++],c=a[l++],u=a[l++],h=l==a.length||!n,d=h?e:e.split(),p=this.tokens.mainToken;if(d.apply(o,c,p?p.start:d.pos,u),Jm&&console.log(s+this.stackID(d)+" (via ".concat(0==(65536&o)?"shift":"reduce of ".concat(r.getName(65535&o))," for ").concat(r.getName(c)," @ ").concat(i).concat(d==e?"":", split",")")),h)return!0;d.pos>i?t.push(d):n.push(d)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return sg(e,t),!0}}runRecovery(e,t,n){let i=null,r=!1;for(let s=0;s<e.length;s++){let o=e[s],a=t[s<<1],l=t[1+(s<<1)],c=Jm?this.stackID(o)+" -> ":"";if(o.deadEnd){if(r)continue;if(r=!0,o.restart(),Jm&&console.log(c+this.stackID(o)+" (restarted)"),this.advanceFully(o,n))continue}let u=o.split(),h=c;for(let e=0;e<10&&u.forceReduce();e++){if(Jm&&console.log(h+this.stackID(u)+" (via force-reduce)"),this.advanceFully(u,n))break;Jm&&(h=this.stackID(u)+" -> ")}for(let e of o.recoverByInsert(a))Jm&&console.log(c+this.stackID(e)+" (via recover-insert)"),this.advanceFully(e,n);this.stream.end>o.pos?(l==o.pos&&(l++,a=0),o.recoverByDelete(a,l),Jm&&console.log(c+this.stackID(o)+" (via recover-delete ".concat(this.parser.getName(a),")")),sg(o,n)):(!i||i.score<u.score)&&(i=u)}return i}stackToTree(e){return e.close(),Zc.build({buffer:zm.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(eg||(eg=new WeakMap)).get(e);return t||eg.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function sg(e,t){for(let n=0;n<t.length;n++){let i=t[n];if(i.pos==e.pos&&i.sameState(e))return void(t[n].score<e.score&&(t[n]=e))}t.push(e)}class og{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||0==this.disabled[e]}}const ag=e=>e;class lg{constructor(e){this.start=e.start,this.shift=e.shift||ag,this.reduce=e.reduce||ag,this.reuse=e.reuse||ag,this.hash=e.hash||(()=>0),this.strict=!1!==e.strict}}class cg extends fu{constructor(e){if(super(),this.wrappers=[],14!=e.version)throw new RangeError("Parser version (".concat(e.version,") doesn't match runtime version (",14,")"));let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let o=0;o<e.repeatNodeCount;o++)t.push("");let n=Object.keys(e.topRules).map(t=>e.topRules[t][1]),i=[];for(let o=0;o<t.length;o++)i.push([]);function r(e,t,n){i[e].push([t,t.deserialize(String(n))])}if(e.nodeProps)for(let o of e.nodeProps){let e=o[0];"string"==typeof e&&(e=jc[e]);for(let t=1;t<o.length;){let n=o[t++];if(n>=0)r(n,e,o[t++]);else{let i=o[t+-n];for(let s=-n;s>0;s--)r(o[t++],e,i);t++}}}this.nodeSet=new Vc(t.map((t,r)=>Wc.define({name:r>=this.minRepeatTerm?void 0:t,id:r,props:i[r],top:n.indexOf(r)>-1,error:0==r,skipped:e.skippedNodes&&e.skippedNodes.indexOf(r)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=Bc;let s=Wm(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let o=0;o<this.specializerSpecs.length;o++)this.specialized[o]=this.specializerSpecs[o].term;this.specializers=this.specializerSpecs.map(hg),this.states=Wm(e.states,Uint32Array),this.data=Wm(e.stateData),this.goto=Wm(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(e=>"number"==typeof e?new qm(s,e):e),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let i=new rg(this,e,t,n);for(let r of this.wrappers)i=r(i,e,t,n);return i}getGoto(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.goto;if(t>=i[0])return-1;for(let r=i[t+1];;){let t=i[r++],s=1&t,o=i[r++];if(s&&n)return o;for(let n=r+(t>>1);r<n;r++)if(i[r]==e)return o;if(s)return-1}}hasAction(e,t){let n=this.data;for(let i=0;i<2;i++)for(let r,s=this.stateSlot(e,i?2:1);;s+=3){if(65535==(r=n[s])){if(1!=n[s+1]){if(2==n[s+1])return ug(n,s+2);break}r=n[s=ug(n,s+2)]}if(r==t||0==r)return ug(n,s+1)}return 0}stateSlot(e,t){return this.states[6*e+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,e=>e==t||null)}allActions(e,t){let n=this.stateSlot(e,4),i=n?t(n):void 0;for(let r=this.stateSlot(e,1);null==i;r+=3){if(65535==this.data[r]){if(1!=this.data[r+1])break;r=ug(this.data,r+2)}i=t(ug(this.data,r+1))}return i}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])break;n=ug(this.data,n+2)}if(0==(1&this.data[n+2])){let e=this.data[n+1];t.some((t,n)=>1&n&&t==e)||t.push(this.data[n],e)}}return t}configure(e){let t=Object.assign(Object.create(cg.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError("Invalid top rule name ".concat(e.top));t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(t=>{let n=e.tokenizers.find(e=>e.from==t);return n?n.to:t})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((n,i)=>{let r=e.specializers.find(e=>e.from==n.external);if(!r)return n;let s=Object.assign(Object.assign({},n),{external:r.to});return t.specializers[i]=hg(s),s})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),null!=e.strict&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),null!=e.bufferLength&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return null==t?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map(()=>!1);if(e)for(let r of e.split(" ")){let e=t.indexOf(r);e>=0&&(n[e]=!0)}let i=null;for(let r=0;r<t.length;r++)if(!n[r])for(let e,n=this.dialects[t[r]];65535!=(e=this.data[n++]);)(i||(i=new Uint8Array(this.maxTerm+1)))[e]=1;return new og(e,n,i)}static deserialize(e){return new cg(e)}}function ug(e,t){return e[t]|e[t+1]<<16}function hg(e){if(e.external){let t=e.extend?1:0;return(n,i)=>e.external(n,i)<<1|t}return e.get}const dg={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},pg={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},fg={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function mg(e){return 45==e||46==e||58==e||e>=65&&e<=90||95==e||e>=97&&e<=122||e>=161}let gg=null,vg=null,yg=0;function Og(e,t){let n=e.pos+t;if(yg==n&&vg==e)return gg;let i=e.peek(t),r="";for(;mg(i);)r+=String.fromCharCode(i),i=e.peek(++t);return vg=e,yg=n,gg=r?r.toLowerCase():i==wg||i==bg?void 0:null}const wg=63,bg=33;function kg(e,t){this.name=e,this.parent=t}const xg=[6,10,7,8,9],Dg=new lg({start:null,shift:(e,t,n,i)=>xg.indexOf(t)>-1?new kg(Og(i,1)||"",e):e,reduce:(e,t)=>21==t&&e?e.parent:e,reuse(e,t,n,i){let r=t.type.id;return 6==r||37==r?new kg(Og(i,1)||"",e):e},strict:!1}),Sg=new Hm((e,t)=>{if(60!=e.next)return void(e.next<0&&t.context&&e.acceptToken(58));e.advance();let n=47==e.next;n&&e.advance();let i=Og(e,0);if(void 0===i)return;if(!i)return e.acceptToken(n?15:14);let r=t.context?t.context.name:null;if(n){if(i==r)return e.acceptToken(11);if(r&&pg[r])return e.acceptToken(58,-2);if(t.dialectEnabled(0))return e.acceptToken(12);for(let e=t.context;e;e=e.parent)if(e.name==i)return;e.acceptToken(13)}else{if("script"==i)return e.acceptToken(7);if("style"==i)return e.acceptToken(8);if("textarea"==i)return e.acceptToken(9);if(dg.hasOwnProperty(i))return e.acceptToken(10);r&&fg[r]&&fg[r][i]?e.acceptToken(58,-1):e.acceptToken(6)}},{contextual:!0}),Cg=new Hm(e=>{for(let t=0,n=0;;n++){if(e.next<0){n&&e.acceptToken(59);break}if(45==e.next)t++;else{if(62==e.next&&t>=2){n>=3&&e.acceptToken(59,-2);break}t=0}e.advance()}});const Ag=new Hm((e,t)=>{if(47==e.next&&62==e.peek(1)){let n=t.dialectEnabled(1)||function(e){for(;e;e=e.parent)if("svg"==e.name||"math"==e.name)return!0;return!1}(t.context);e.acceptToken(n?5:4,2)}else 62==e.next&&e.acceptToken(4,1)});function Eg(e,t,n){let i=2+e.length;return new Hm(r=>{for(let s=0,o=0,a=0;;a++){if(r.next<0){a&&r.acceptToken(t);break}if(0==s&&60==r.next||1==s&&47==r.next||s>=2&&s<i&&r.next==e.charCodeAt(s-2))s++,o++;else{if(s==i&&62==r.next){a>o?r.acceptToken(t,-o):r.acceptToken(n,-(o-2));break}if((10==r.next||13==r.next)&&a){r.acceptToken(t,1);break}s=o=0}r.advance()}})}const _g=Eg("script",55,1),Tg=Eg("style",56,2),Pg=Eg("textarea",57,3),Mg=Ru({"Text RawText IncompleteTag IncompleteCloseTag":th.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":th.angleBracket,TagName:th.tagName,"MismatchedCloseTag/TagName":[th.tagName,th.invalid],AttributeName:th.attributeName,"AttributeValue UnquotedAttributeValue":th.attributeValue,Is:th.definitionOperator,"EntityReference CharacterReference":th.character,Comment:th.blockComment,ProcessingInst:th.processingInstruction,DoctypeDecl:th.documentMeta}),Fg=cg.deserialize({version:14,states:",xOVO!rOOO!ZQ#tO'#CrO!`Q#tO'#C{O!eQ#tO'#DOO!jQ#tO'#DRO!oQ#tO'#DTO!tOaO'#CqO#PObO'#CqO#[OdO'#CqO$kO!rO'#CqOOO`'#Cq'#CqO$rO$fO'#DUO$zQ#tO'#DWO%PQ#tO'#DXOOO`'#Dl'#DlOOO`'#DZ'#DZQVO!rOOO%UQ&rO,59^O%aQ&rO,59gO%lQ&rO,59jO%wQ&rO,59mO&SQ&rO,59oOOOa'#D_'#D_O&_OaO'#CyO&jOaO,59]OOOb'#D`'#D`O&rObO'#C|O&}ObO,59]OOOd'#Da'#DaO'VOdO'#DPO'bOdO,59]OOO`'#Db'#DbO'jO!rO,59]O'qQ#tO'#DSOOO`,59],59]OOOp'#Dc'#DcO'vO$fO,59pOOO`,59p,59pO(OQ#|O,59rO(TQ#|O,59sOOO`-E7X-E7XO(YQ&rO'#CtOOQW'#D['#D[O(hQ&rO1G.xOOOa1G.x1G.xOOO`1G/Z1G/ZO(sQ&rO1G/ROOOb1G/R1G/RO)OQ&rO1G/UOOOd1G/U1G/UO)ZQ&rO1G/XOOO`1G/X1G/XO)fQ&rO1G/ZOOOa-E7]-E7]O)qQ#tO'#CzOOO`1G.w1G.wOOOb-E7^-E7^O)vQ#tO'#C}OOOd-E7_-E7_O){Q#tO'#DQOOO`-E7`-E7`O*QQ#|O,59nOOOp-E7a-E7aOOO`1G/[1G/[OOO`1G/^1G/^OOO`1G/_1G/_O*VQ,UO,59`OOQW-E7Y-E7YOOOa7+$d7+$dOOO`7+$u7+$uOOOb7+$m7+$mOOOd7+$p7+$pOOO`7+$s7+$sO*bQ#|O,59fO*gQ#|O,59iO*lQ#|O,59lOOO`1G/Y1G/YO*qO7[O'#CwO+SOMhO'#CwOOQW1G.z1G.zOOO`1G/Q1G/QOOO`1G/T1G/TOOO`1G/W1G/WOOOO'#D]'#D]O+eO7[O,59cOOQW,59c,59cOOOO'#D^'#D^O+vOMhO,59cOOOO-E7Z-E7ZOOQW1G.}1G.}OOOO-E7[-E7[",stateData:",c~O!_OS~OUSOVPOWQOXROYTO[]O][O^^O_^Oa^Ob^Oc^Od^Oy^O|_O!eZO~OgaO~OgbO~OgcO~OgdO~OgeO~O!XfOPmP![mP~O!YiOQpP![pP~O!ZlORsP![sP~OUSOVPOWQOXROYTOZqO[]O][O^^O_^Oa^Ob^Oc^Od^Oy^O!eZO~O![rO~P#gO!]sO!fuO~OgvO~OgwO~OS|OT}OiyO~OS!POT}OiyO~OS!ROT}OiyO~OS!TOT}OiyO~OS}OT}OiyO~O!XfOPmX![mX~OP!WO![!XO~O!YiOQpX![pX~OQ!ZO![!XO~O!ZlORsX![sX~OR!]O![!XO~O![!XO~P#gOg!_O~O!]sO!f!aO~OS!bO~OS!cO~Oj!dOShXThXihX~OS!fOT!gOiyO~OS!hOT!gOiyO~OS!iOT!gOiyO~OS!jOT!gOiyO~OS!gOT!gOiyO~Og!kO~Og!lO~Og!mO~OS!nO~Ol!qO!a!oO!c!pO~OS!rO~OS!sO~OS!tO~Ob!uOc!uOd!uO!a!wO!b!uO~Ob!xOc!xOd!xO!c!wO!d!xO~Ob!uOc!uOd!uO!a!{O!b!uO~Ob!xOc!xOd!xO!c!{O!d!xO~OT~cbd!ey|!e~",goto:"%q!aPPPPPPPPPPPPPPPPPPPPP!b!hP!nPP!zP!}#Q#T#Z#^#a#g#j#m#s#y!bP!b!bP$P$V$m$s$y%P%V%]%cPPPPPPPP%iX^OX`pXUOX`pezabcde{!O!Q!S!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ!ObQ!QcQ!SdQ!UeZ!e{!O!Q!S!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:"\u26a0 StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:68,context:Dg,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,22,31,34,37,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,30,33,36,38,"OpenTag"],["group",-10,14,15,18,19,20,21,40,41,42,43,"Entity",17,"Entity TextContent",-3,29,32,35,"TextContent Entity"],["isolate",-11,22,30,31,33,34,36,37,38,39,42,43,"ltr",-3,27,28,40,""]],propSources:[Mg],skippedNodes:[0],repeatNodeCount:9,tokenData:"!<p!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs3_sv-_vw3}wxHYx}-_}!OH{!O!P-_!P!Q$q!Q![-_![!]Mz!]!^-_!^!_!$S!_!`!;x!`!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4U-_4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!Z$|caPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bXaP!b`!dpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UVaP!dpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pTaPOv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!dpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({WaP!b`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!b`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!b`!dpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYlWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]`aP!b`!dp!_^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljiSaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/ebiSlWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0rXiSqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0mS1bP;=`<%l0m[1hP;=`<%l/^!V1vciSaP!b`!dpOq&Xqr1krs&}sv1kvw0mwx(tx!P1k!P!Q&X!Q!^1k!^!_*V!_!a&X!a#s1k#s$f&X$f;'S1k;'S;=`3R<%l?Ah1k?Ah?BY&X?BY?Mn1k?MnO&X!V3UP;=`<%l1k!_3[P;=`<%l-_!Z3hV!ahaP!dpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_4WiiSlWd!ROX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst>]tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^/^!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!Z5zblWOX5uXZ7SZ[5u[^7S^p5uqr5urs7Sst+Ptw5uwx7Sx!]5u!]!^7w!^!a7S!a#S5u#S#T7S#T;'S5u;'S;=`8n<%lO5u!R7VVOp7Sqs7St!]7S!]!^7l!^;'S7S;'S;=`7q<%lO7S!R7qOb!R!R7tP;=`<%l7S!Z8OYlWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z8qP;=`<%l5u!_8{iiSlWOX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst/^tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^:j!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!_:sbiSlWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V<QciSOp7Sqr;{rs7Sst0mtw;{wx7Sx!P;{!P!Q7S!Q!];{!]!^=]!^!a7S!a#s;{#s$f7S$f;'S;{;'S;=`>P<%l?Ah;{?Ah?BY7S?BY?Mn;{?MnO7S!V=dXiSb!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!V>SP;=`<%l;{!_>YP;=`<%l8t!_>dhiSlWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^/^!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!Z@TalWOX@OXZAYZ[@O[^AY^p@Oqr@OrsAYsw@OwxAYx!]@O!]!^Az!^!aAY!a#S@O#S#TAY#T;'S@O;'S;=`Bq<%lO@O!RA]UOpAYq!]AY!]!^Ao!^;'SAY;'S;=`At<%lOAY!RAtOc!R!RAwP;=`<%lAY!ZBRYlWc!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZBtP;=`<%l@O!_COhiSlWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^Dj!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!_DsbiSlWc!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VFQbiSOpAYqrE{rsAYswE{wxAYx!PE{!P!QAY!Q!]E{!]!^GY!^!aAY!a#sE{#s$fAY$f;'SE{;'S;=`G|<%l?AhE{?Ah?BYAY?BY?MnE{?MnOAY!VGaXiSc!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!VHPP;=`<%lE{!_HVP;=`<%lBw!ZHcW!cxaP!b`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aIYliSaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OKQ!O!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aK_kiSaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!`&X!`!aMS!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!TM_XaP!b`!dp!fQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!aNZ!ZiSgQaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMz!O!PMz!P!Q$q!Q![Mz![!]Mz!]!^-_!^!_*V!_!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f$}-_$}%OMz%O%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4UMz4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Je-_$Je$JgMz$Jg$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!a!$PP;=`<%lMz!R!$ZY!b`!dpOq*Vqr!$yrs(Vsv*Vwx)ex!a*V!a!b!4t!b;'S*V;'S;=`*s<%lO*V!R!%Q]!b`!dpOr*Vrs(Vsv*Vwx)ex}*V}!O!%y!O!f*V!f!g!']!g#W*V#W#X!0`#X;'S*V;'S;=`*s<%lO*V!R!&QX!b`!dpOr*Vrs(Vsv*Vwx)ex}*V}!O!&m!O;'S*V;'S;=`*s<%lO*V!R!&vV!b`!dp!ePOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!'dX!b`!dpOr*Vrs(Vsv*Vwx)ex!q*V!q!r!(P!r;'S*V;'S;=`*s<%lO*V!R!(WX!b`!dpOr*Vrs(Vsv*Vwx)ex!e*V!e!f!(s!f;'S*V;'S;=`*s<%lO*V!R!(zX!b`!dpOr*Vrs(Vsv*Vwx)ex!v*V!v!w!)g!w;'S*V;'S;=`*s<%lO*V!R!)nX!b`!dpOr*Vrs(Vsv*Vwx)ex!{*V!{!|!*Z!|;'S*V;'S;=`*s<%lO*V!R!*bX!b`!dpOr*Vrs(Vsv*Vwx)ex!r*V!r!s!*}!s;'S*V;'S;=`*s<%lO*V!R!+UX!b`!dpOr*Vrs(Vsv*Vwx)ex!g*V!g!h!+q!h;'S*V;'S;=`*s<%lO*V!R!+xY!b`!dpOr!+qrs!,hsv!+qvw!-Swx!.[x!`!+q!`!a!/j!a;'S!+q;'S;=`!0Y<%lO!+qq!,mV!dpOv!,hvx!-Sx!`!,h!`!a!-q!a;'S!,h;'S;=`!.U<%lO!,hP!-VTO!`!-S!`!a!-f!a;'S!-S;'S;=`!-k<%lO!-SP!-kO|PP!-nP;=`<%l!-Sq!-xS!dp|POv(Vx;'S(V;'S;=`(h<%lO(Vq!.XP;=`<%l!,ha!.aX!b`Or!.[rs!-Ssv!.[vw!-Sw!`!.[!`!a!.|!a;'S!.[;'S;=`!/d<%lO!.[a!/TT!b`|POr)esv)ew;'S)e;'S;=`)y<%lO)ea!/gP;=`<%l!.[!R!/sV!b`!dp|POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!0]P;=`<%l!+q!R!0gX!b`!dpOr*Vrs(Vsv*Vwx)ex#c*V#c#d!1S#d;'S*V;'S;=`*s<%lO*V!R!1ZX!b`!dpOr*Vrs(Vsv*Vwx)ex#V*V#V#W!1v#W;'S*V;'S;=`*s<%lO*V!R!1}X!b`!dpOr*Vrs(Vsv*Vwx)ex#h*V#h#i!2j#i;'S*V;'S;=`*s<%lO*V!R!2qX!b`!dpOr*Vrs(Vsv*Vwx)ex#m*V#m#n!3^#n;'S*V;'S;=`*s<%lO*V!R!3eX!b`!dpOr*Vrs(Vsv*Vwx)ex#d*V#d#e!4Q#e;'S*V;'S;=`*s<%lO*V!R!4XX!b`!dpOr*Vrs(Vsv*Vwx)ex#X*V#X#Y!+q#Y;'S*V;'S;=`*s<%lO*V!R!4{Y!b`!dpOr!4trs!5ksv!4tvw!6Vwx!8]x!a!4t!a!b!:]!b;'S!4t;'S;=`!;r<%lO!4tq!5pV!dpOv!5kvx!6Vx!a!5k!a!b!7W!b;'S!5k;'S;=`!8V<%lO!5kP!6YTO!a!6V!a!b!6i!b;'S!6V;'S;=`!7Q<%lO!6VP!6lTO!`!6V!`!a!6{!a;'S!6V;'S;=`!7Q<%lO!6VP!7QOyPP!7TP;=`<%l!6Vq!7]V!dpOv!5kvx!6Vx!`!5k!`!a!7r!a;'S!5k;'S;=`!8V<%lO!5kq!7yS!dpyPOv(Vx;'S(V;'S;=`(h<%lO(Vq!8YP;=`<%l!5ka!8bX!b`Or!8]rs!6Vsv!8]vw!6Vw!a!8]!a!b!8}!b;'S!8];'S;=`!:V<%lO!8]a!9SX!b`Or!8]rs!6Vsv!8]vw!6Vw!`!8]!`!a!9o!a;'S!8];'S;=`!:V<%lO!8]a!9vT!b`yPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!:YP;=`<%l!8]!R!:dY!b`!dpOr!4trs!5ksv!4tvw!6Vwx!8]x!`!4t!`!a!;S!a;'S!4t;'S;=`!;r<%lO!4t!R!;]V!b`!dpyPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;uP;=`<%l!4t!V!<TXjSaP!b`!dpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[_g,Tg,Pg,Ag,Sg,Cg,0,1,2,3,4,5],topRules:{Document:[0,16]},dialects:{noMatch:0,selfClosing:515},tokenPrec:517});function Rg(e,t){let n=Object.create(null);for(let i of e.getChildren(24)){let e=i.getChild(25),r=i.getChild(27)||i.getChild(28);e&&(n[t.read(e.from,e.to)]=r?27==r.type.id?t.read(r.from+1,r.to-1):t.read(r.from,r.to):"")}return n}function Ng(e,t){let n=e.getChild(23);return n?t.read(n.from,n.to):" "}function Ig(e,t,n){let i;for(let r of n)if(!r.attrs||r.attrs(i||(i=Rg(e.node.parent.firstChild,t))))return{parser:r.parser,bracketed:!0};return null}function Bg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],i=[],r=[],s=[];for(let a of e){("script"==a.tag?n:"style"==a.tag?i:"textarea"==a.tag?r:s).push(a)}let o=t.length?Object.create(null):null;for(let a of t)(o[a.name]||(o[a.name]=[])).push(a);return gu((e,t)=>{let a=e.type.id;if(29==a)return Ig(e,t,n);if(32==a)return Ig(e,t,i);if(35==a)return Ig(e,t,r);if(21==a&&s.length){let n,i=e.node,r=i.firstChild,o=r&&Ng(r,t);if(o)for(let e of s)if(e.tag==o&&(!e.attrs||e.attrs(n||(n=Rg(r,t))))){let t=i.lastChild,n=38==t.type.id?t.from:i.to;if(n>r.to)return{parser:e.parser,overlay:[{from:r.to,to:n}]}}}if(o&&24==a){let n,i=e.node;if(n=i.firstChild){let e=o[t.read(n.from,n.to)];if(e)for(let n of e){if(n.tagName&&n.tagName!=Ng(i.parent,t))continue;let e=i.lastChild;if(27==e.type.id){let t=e.from+1,i=e.lastChild,r=e.to-(i&&i.isError?0:1);if(r>t)return{parser:n.parser,overlay:[{from:t,to:r}],bracketed:!0}}else if(28==e.type.id)return{parser:n.parser,overlay:[{from:e.from,to:e.to}]}}}}return null})}const Qg=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288];function Lg(e){return e>=65&&e<=90||e>=97&&e<=122||e>=161}function jg(e){return e>=48&&e<=57}function $g(e){return jg(e)||e>=97&&e<=102||e>=65&&e<=70}const zg=(e,t,n)=>(i,r)=>{for(let s=!1,o=0,a=0;;a++){let{next:l}=i;if(Lg(l)||45==l||95==l||s&&jg(l))!s&&(45!=l||a>0)&&(s=!0),o===a&&45==l&&o++,i.advance();else{if(92!=l||10==i.peek(1)){s&&i.acceptToken(2==o&&r.canShift(2)?t:40==l?n:e);break}if(i.advance(),$g(i.next)){do{i.advance()}while($g(i.next));32==i.next&&i.advance()}else i.next>-1&&i.advance();s=!0}}},Wg=new Hm(zg(123,2,124)),Vg=new Hm(zg(125,3,4)),Ug=new Hm(e=>{if(Qg.includes(e.peek(-1))){let{next:t}=e;(Lg(t)||95==t||35==t||46==t||42==t||91==t||58==t&&Lg(e.peek(1))||45==t||38==t)&&e.acceptToken(122)}}),Xg=new Hm(e=>{if(!Qg.includes(e.peek(-1))){let{next:t}=e;if(37==t&&(e.advance(),e.acceptToken(1)),Lg(t)){do{e.advance()}while(Lg(e.next)||jg(e.next));e.acceptToken(1)}}}),qg=Ru({"AtKeyword import charset namespace keyframes media supports":th.definitionKeyword,"from to selector":th.keyword,NamespaceName:th.namespace,KeyframeName:th.labelName,KeyframeRangeName:th.operatorKeyword,TagName:th.tagName,ClassName:th.className,PseudoClassName:th.constant(th.className),IdName:th.labelName,"FeatureName PropertyName":th.propertyName,AttributeName:th.attributeName,NumberLiteral:th.number,KeywordQuery:th.keyword,UnaryQueryOp:th.operatorKeyword,"CallTag ValueName":th.atom,VariableName:th.variableName,Callee:th.operatorKeyword,Unit:th.unit,"UniversalSelector NestingSelector":th.definitionOperator,"MatchOp CompareOp":th.compareOperator,"ChildOp SiblingOp, LogicOp":th.logicOperator,BinOp:th.arithmeticOperator,Important:th.modifier,Comment:th.blockComment,ColorLiteral:th.color,"ParenthesizedContent StringLiteral":th.string,":":th.punctuation,"PseudoOp #":th.derefOperator,"; ,":th.separator,"( )":th.paren,"[ ]":th.squareBracket,"{ }":th.brace}),Zg={__proto__:null,lang:38,"nth-child":38,"nth-last-child":38,"nth-of-type":38,"nth-last-of-type":38,dir:38,"host-context":38,if:84,url:124,"url-prefix":124,domain:124,regexp:124},Hg={__proto__:null,or:98,and:98,not:106,only:106,layer:170},Yg={__proto__:null,selector:112,layer:166},Gg={__proto__:null,"@import":162,"@media":174,"@charset":178,"@namespace":182,"@keyframes":188,"@supports":200,"@scope":204},Kg={__proto__:null,to:207},Jg=cg.deserialize({version:14,states:"EbQYQdOOO#qQdOOP#xO`OOOOQP'#Cf'#CfOOQP'#Ce'#CeO#}QdO'#ChO$nQaO'#CcO$xQdO'#CkO%TQdO'#DpO%YQdO'#DrO%_QdO'#DuO%_QdO'#DxOOQP'#FV'#FVO&eQhO'#EhOOQS'#FU'#FUOOQS'#Ek'#EkQYQdOOO&lQdO'#EOO&PQhO'#EUO&lQdO'#EWO'aQdO'#EYO'lQdO'#E]O'tQhO'#EcO(VQdO'#EeO(bQaO'#CfO)VQ`O'#D{O)[Q`O'#F`O)gQdO'#F`QOQ`OOP)qO&jO'#CaPOOO)C@t)C@tOOQP'#Cj'#CjOOQP,59S,59SO#}QdO,59SO)|QdO,59VO%TQdO,5:[O%YQdO,5:^O%_QdO,5:aO%_QdO,5:cO%_QdO,5:dO%_QdO'#ErO*XQ`O,58}O*aQdO'#DzOOQS,58},58}OOQP'#Cn'#CnOOQO'#Dn'#DnOOQP,59V,59VO*hQ`O,59VO*mQ`O,59VOOQP'#Dq'#DqOOQP,5:[,5:[OOQO'#Ds'#DsO*rQpO,5:^O+]QaO,5:aO+sQaO,5:dOOQW'#DZ'#DZO,ZQhO'#DdO,xQhO'#FaO'tQhO'#DbO-WQ`O'#DhOOQW'#F['#F[O-]Q`O,5;SO-eQ`O'#DeOOQS-E8i-E8iOOQ['#Cs'#CsO-jQdO'#CtO.QQdO'#CzO.hQdO'#C}O/OQ!pO'#DPO1RQ!jO,5:jOOQO'#DU'#DUO*mQ`O'#DTO1cQ!nO'#FXO3`Q`O'#DVO3eQ`O'#DkOOQ['#FX'#FXO-`Q`O,5:pO3jQ!bO,5:rOOQS'#E['#E[O3rQ`O,5:tO3wQdO,5:tOOQO'#E_'#E_O4PQ`O,5:wO4UQhO,5:}O%_QdO'#DgOOQS,5;P,5;PO-eQ`O,5;PO4^QdO,5;PO4fQdO,5:gO4vQdO'#EtO5TQ`O,5;zO5TQ`O,5;zPOOO'#Ej'#EjP5`O&jO,58{POOO,58{,58{OOQP1G.n1G.nOOQP1G.q1G.qO*hQ`O1G.qO*mQ`O1G.qOOQP1G/v1G/vO5kQpO1G/xO5sQaO1G/{O6ZQaO1G/}O6qQaO1G0OO7XQaO,5;^OOQO-E8p-E8pOOQS1G.i1G.iO7cQ`O,5:fO7hQdO'#DoO7oQdO'#CrOOQP1G/x1G/xO&lQdO1G/xO7vQ!jO'#DZO8UQ!bO,59vO8^QhO,5:OOOQO'#F]'#F]O8XQ!bO,59zO'tQhO,59xO8fQhO'#EvO8sQ`O,5;{O9OQhO,59|O9uQhO'#DiOOQW,5:S,5:SOOQS1G0n1G0nOOQW,5:P,5:PO9|Q!fO'#FYOOQS'#FY'#FYOOQS'#Em'#EmO;^QdO,59`OOQ[,59`,59`O;tQdO,59fOOQ[,59f,59fO<[QdO,59iOOQ[,59i,59iOOQ[,59k,59kO&lQdO,59mO<rQhO'#EQOOQW'#EQ'#EQO=WQ`O1G0UO1[QhO1G0UOOQ[,59o,59oO'tQhO'#DXOOQ[,59q,59qO=]Q#tO,5:VOOQS1G0[1G0[OOQS1G0^1G0^OOQS1G0`1G0`O=hQ`O1G0`O=mQdO'#E`OOQS1G0c1G0cOOQS1G0i1G0iO=xQaO,5:RO-`Q`O1G0kOOQS1G0k1G0kO-eQ`O1G0kO>PQ!fO1G0ROOQO1G0R1G0ROOQO,5;`,5;`O>gQdO,5;`OOQO-E8r-E8rO>tQ`O1G1fPOOO-E8h-E8hPOOO1G.g1G.gOOQP7+$]7+$]OOQP7+%d7+%dO&lQdO7+%dOOQS1G0Q1G0QO?PQaO'#F_O?ZQ`O,5:ZO?`Q!fO'#ElO@^QdO'#FWO@hQ`O,59^O@mQ!bO7+%dO&lQdO1G/bO@uQhO1G/fOOQW1G/j1G/jOOQW1G/d1G/dOAWQhO,5;bOOQO-E8t-E8tOAfQhO'#DZOAtQhO'#F^OBPQ`O'#F^OBUQ`O,5:TOOQS-E8k-E8kOOQ[1G.z1G.zOOQ[1G/Q1G/QOOQ[1G/T1G/TOOQ[1G/X1G/XOBZQdO,5:lOOQS7+%p7+%pOB`Q`O7+%pOBeQhO'#DYOBmQ`O,59sO'tQhO,59sOOQ[1G/q1G/qOBuQ`O1G/qOOQS7+%z7+%zOBzQbO'#DPOOQO'#Eb'#EbOCYQ`O'#EaOOQO'#Ea'#EaOCeQ`O'#EwOCmQdO,5:zOOQS,5:z,5:zOOQ[1G/m1G/mOOQS7+&V7+&VO-`Q`O7+&VOCxQ!fO'#EsO&lQdO'#EsOEPQdO7+%mOOQO7+%m7+%mOOQO1G0z1G0zOEdQ!bO<<IOOElQdO'#EqOEvQ`O,5;yOOQP1G/u1G/uOOQS-E8j-E8jOFOQdO'#EpOFYQ`O,5;rOOQ]1G.x1G.xOOQP<<IO<<IOOFbQdO7+$|OOQO'#D]'#D]OFiQ!bO7+%QOFqQhO'#EoOF{Q`O,5;xO&lQdO,5;xOOQW1G/o1G/oOOQO'#ES'#ESOGTQ`O1G0WOOQS<<I[<<I[O&lQdO,59tOGnQhO1G/_OOQ[1G/_1G/_OGuQ`O1G/_OOQW-E8l-E8lOOQ[7+%]7+%]OOQO,5:{,5:{O=pQdO'#ExOCeQ`O,5;cOOQS,5;c,5;cOOQS-E8u-E8uOOQS1G0f1G0fOOQS<<Iq<<IqOG}Q!fO,5;_OOQS-E8q-E8qOOQO<<IX<<IXOOQPAN>jAN>jOIUQaO,5;]OOQO-E8o-E8oOI`QdO,5;[OOQO-E8n-E8nOOQW<<Hh<<HhOOQW<<Hl<<HlOIjQhO<<HlOI{QhO,5;ZOJWQ`O,5;ZOOQO-E8m-E8mOJ]QdO1G1dOBZQdO'#EuOJgQ`O7+%rOOQW7+%r7+%rOJoQ!bO1G/`OOQ[7+$y7+$yOJzQhO7+$yPKRQ`O'#EnOOQO,5;d,5;dOOQO-E8v-E8vOOQS1G0}1G0}OKWQ`OAN>WO&lQdO1G0uOK]Q`O7+'OOOQO,5;a,5;aOOQO-E8s-E8sOOQW<<I^<<I^OOQ[<<He<<HePOQW,5;Y,5;YOOQWG23rG23rOKeQdO7+&a",stateData:"Kx~O#sOS#tQQ~OW[OZ[O]TO`VOaVOi]OjWOmXO!jYO!mZO!saO!ybO!{cO!}dO#QeO#WfO#YgO#oRO~OQiOW[OZ[O]TO`VOaVOi]OjWOmXO!jYO!mZO!saO!ybO!{cO!}dO#QeO#WfO#YgO#ohO~O#m$SP~P!dO#tmO~O#ooO~O]qO`rOarOjsOmtO!juO!mwO#nvO~OpzO!^xO~P$SOc!QO#o|O#p}O~O#o!RO~O#o!TO~OW[OZ[O]TO`VOaVOjWOmXO!jYO!mZO#oRO~OS!]Oe!YO!V![O!Y!`O#q!XOp$TP~Ok$TP~P&POQ!jOe!cOm!dOp!eOr!mOt!mOz!kO!`!lO#o!bO#p!hO#}!fO~Ot!qO!`!lO#o!pO~Ot!sO#o!sO~OS!]Oe!YO!V![O!Y!`O#q!XO~Oe!vOpzO#Z!xO~O]YX`YX`!pXaYXjYXmYXpYX!^YX!jYX!mYX#nYX~O`!zO~Ok!{O#m$SXo$SX~O#m$SXo$SX~P!dO#u#OO#v#OO#w#QO~Oc#UO#o|O#p}O~OpzO!^xO~Oo$SP~P!dOe#`O~Oe#aO~Ol#bO!h#cO~O]qO`rOarOjsOmtO~Op!ia!^!ia!j!ia!m!ia#n!iad!ia~P*zOp!la!^!la!j!la!m!la#n!lad!la~P*zOR#gOS!]Oe!YOr#gOt#gO!V![O!Y!`O#q#dO#}!fO~O!R#iO!^#jOk$TXp$TX~Oe#mO~Ok#oOpzO~Oe!vO~O]#rO`#rOd#uOi#rOj#rOk#rO~P&lO]#rO`#rOi#rOj#rOk#rOl#wO~P&lO]#rO`#rOi#rOj#rOk#rOo#yO~P&lOP#zOSsXesXksXvsX!VsX!YsX!usX!wsX#qsX!TsXQsX]sX`sXdsXisXjsXmsXpsXrsXtsXzsX!`sX#osX#psX#}sXlsXosX!^sX!qsX#msX~Ov#{O!u#|O!w#}Ok$TP~P'tOe#aOS#{Xk#{Xv#{X!V#{X!Y#{X!u#{X!w#{X#q#{XQ#{X]#{X`#{Xd#{Xi#{Xj#{Xm#{Xp#{Xr#{Xt#{Xz#{X!`#{X#o#{X#p#{X#}#{Xl#{Xo#{X!^#{X!q#{X#m#{X~Oe$RO~Oe$TO~Ok$VOv#{O~Ok$WO~Ot$XO!`!lO~Op$YO~OpzO!R#iO~OpzO#Z$`O~O!q$bOk!oa#m!oao!oa~P&lOk#hX#m#hXo#hX~P!dOk!{O#m$Sao$Sa~O#u#OO#v#OO#w$hO~Ol$jO!h$kO~Op!ii!^!ii!j!ii!m!ii#n!iid!ii~P*zOp!ki!^!ki!j!ki!m!ki#n!kid!ki~P*zOp!li!^!li!j!li!m!li#n!lid!li~P*zOp#fa!^#fa~P$SOo$lO~Od$RP~P%_Od#zP~P&lO`!PXd}X!R}X!T!PX~O`$sO!T$tO~Od$uO!R#iO~Ok#jXp#jX!^#jX~P'tO!^#jOk$Tap$Ta~O!R#iOk!Uap!Ua!^!Uad!Ua`!Ua~OS!]Oe!YO!V![O!Y!`O#q$yO~Od$QP~P9dOv#{OQ#|X]#|X`#|Xd#|Xe#|Xi#|Xj#|Xk#|Xm#|Xp#|Xr#|Xt#|Xz#|X!`#|X#o#|X#p#|X#}#|Xl#|Xo#|X~O]#rO`#rOd%OOi#rOj#rOk#rO~P&lO]#rO`#rOi#rOj#rOk#rOl%PO~P&lO]#rO`#rOi#rOj#rOk#rOo%QO~P&lOe%SOS!tXk!tX!V!tX!Y!tX#q!tX~Ok%TO~Od%YOt%ZO!a%ZO~Ok%[O~Oo%cO#o%^O#}%]O~Od%dO~P$SOv#{O!^%hO!q%jOk!oi#m!oio!oi~P&lOk#ha#m#hao#ha~P!dOk!{O#m$Sio$Si~O!^%mOd$RX~P$SOd%oO~Ov#{OQ#`Xd#`Xe#`Xm#`Xp#`Xr#`Xt#`Xz#`X!^#`X!`#`X#o#`X#p#`X#}#`X~O!^%qOd#zX~P&lOd%sO~Ol%tOv#{O~OR#gOr#gOt#gO#q%vO#}!fO~O!R#iOk#jap#ja!^#ja~O`!PXd}X!R}X!^}X~O!R#iO!^%xOd$QX~O`%zO~Od%{O~O#o%|O~Ok&OO~O`&PO!R#iO~Od&ROk&QO~Od&UO~OP#zOpsX!^sXdsX~O#}%]Op#TX!^#TX~OpzO!^&WO~Oo&[O#o%^O#}%]O~Ov#{OQ#gXe#gXk#gXm#gXp#gXr#gXt#gXz#gX!^#gX!`#gX!q#gX#m#gX#o#gX#p#gX#}#gXo#gX~O!^%hO!q&`Ok!oq#m!oqo!oq~P&lOl&aOv#{O~Od#eX!^#eX~P%_O!^%mOd$Ra~Od#dX!^#dX~P&lO!^%qOd#za~Od&fO~P&lOd&gO!T&hO~Od#cX!^#cX~P9dO!^%xOd$Qa~O]&mOd&oO~OS#bae#ba!V#ba!Y#ba#q#ba~Od&qO~PG]Od&qOk&rO~Ov#{OQ#gae#gak#gam#gap#gar#gat#gaz#ga!^#ga!`#ga!q#ga#m#ga#o#ga#p#ga#}#gao#ga~Od#ea!^#ea~P$SOd#da!^#da~P&lOR#gOr#gOt#gO#q%vO#}%]O~O!R#iOd#ca!^#ca~O`&xO~O!^%xOd$Qi~P&lO]&mOd&|O~Ov#{Od|ik|i~Od&}O~PG]Ok'OO~Od'PO~O!^%xOd$Qq~Od#cq!^#cq~P&lO#s!a#t#}]#}v!m~",goto:"2h$UPPPPP$VP$YP$c$uP$cP%X$cPP%_PPP%e%o%oPPPPP%oPP%oP&]P%oP%o'W%oP't'w'}'}(^'}P'}P'}P'}'}P(m'}(yP(|PP)p)v$c)|$c*SP$cP$c$cP*Y*{+YP$YP+aP+dP$YP$YP$YP+j$YP+m+p+s+z$YP$YPP$YP,P,V,f,|-[-b-l-r-x.O.U.`.f.l.rPPPPPPPPPPP.x/R/w/z0|P1U1u2O2R2U2[RnQ_^OP`kz!{$dq[OPYZ`kuvwxz!v!{#`$d%mqSOPYZ`kuvwxz!v!{#`$d%mQpTR#RqQ!OVR#SrQ#S!QS$Q!i!jR$i#U!V!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'Q!U!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QU#g!Y$t&hU%`$Y%b&WR&V%_!V!iac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QR$S!kQ%W$RR&S%Xk!^]bf!Y![!g#i#j#m$P$R%X%xQ#e!YQ${#mQ%w$tQ&j%xR&w&hQ!ygQ#p!`Q$^!xR%f$`R#n!]!U!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QQ!qdR$X!rQ!PVR#TrQ#S!PR$i#TQ!SWR#VsQ!UXR#WtQ{UQ!wgQ#^yQ#o!_Q$U!nQ$[!uQ$_!yQ%e$^Q&Y%aQ&]%fR&v&XSjPzQ!}kQ$c!{R%k$dZiPkz!{$dR$P!gQ%}%SR&z&mR!rdR!teR$Z!tS%a$Y%bR&t&WV%_$Y%b&WQ#PmR$g#PQ`OSkPzU!a`k$dR$d!{Q$p#aY%p$p%u&d&l'QQ%u$sQ&d%qQ&l%zR'Q&xQ#t!cQ#v!dQ#x!eV$}#t#v#xQ%X$RR&T%XQ%y$zS&k%y&yR&y&lQ%r$pR&e%rQ%n$mR&c%nQyUR#]yQ%i$aR&_%iQ!|jS$e!|$fR$f!}Q&n%}R&{&nQ#k!ZR$x#kQ%b$YR&Z%bQ&X%aR&u&X__OP`kz!{$d^UOP`kz!{$dQ!VYQ!WZQ#XuQ#YvQ#ZwQ#[xQ$]!vQ$m#`R&b%mR$q#aQ!gaQ!oc[#q!c!d!e#t#v#xQ$a!zd$o#a$p$s%q%u%z&d&l&x'QQ$r#cQ%R#{S%g$a%iQ%l$kQ&^%hR&p&P]#s!c!d!e#t#v#xW!Z]b!g$PQ!ufQ#f!YQ#l![Q$v#iQ$w#jQ$z#mS%V$R%XR&i%xQ#h!YQ%w$tR&w&hR$|#mR$n#`QlPR#_zQ!_]Q!nbQ$O!gR%U$P",nodeNames:"\u26a0 Unit VariableName VariableName QueryCallee Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector . ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue AtKeyword # ; ] [ BracketedValue } { BracedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee IfExpression if ArgList IfBranch KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp ComparisonQuery CompareOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector ParenthesizedSelector CallQuery ArgList , CallLiteral CallTag ParenthesizedContent PseudoClassName ArgList IdSelector IdName AttributeSelector AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp Block Declaration PropertyName Important ImportStatement import Layer layer LayerName layer MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports ScopeStatement scope to AtRule Styles",maxTerm:143,nodeProps:[["isolate",-2,5,36,""],["openedBy",20,"(",28,"[",31,"{"],["closedBy",21,")",29,"]",32,"}"]],propSources:[qg],skippedNodes:[0,5,106],repeatNodeCount:15,tokenData:"JQ~R!YOX$qX^%i^p$qpq%iqr({rs-ust/itu6Wuv$qvw7Qwx7cxy9Qyz9cz{9h{|:R|}>t}!O?V!O!P?t!P!Q@]!Q![AU![!]BP!]!^B{!^!_C^!_!`DY!`!aDm!a!b$q!b!cEn!c!}$q!}#OG{#O#P$q#P#QH^#Q#R6W#R#o$q#o#pHo#p#q6W#q#rIQ#r#sIc#s#y$q#y#z%i#z$f$q$f$g%i$g#BY$q#BY#BZ%i#BZ$IS$q$IS$I_%i$I_$I|$q$I|$JO%i$JO$JT$q$JT$JU%i$JU$KV$q$KV$KW%i$KW&FU$q&FU&FV%i&FV;'S$q;'S;=`Iz<%lO$q`$tSOy%Qz;'S%Q;'S;=`%c<%lO%Q`%VS!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Q`%fP;=`<%l%Q~%nh#s~OX%QX^'Y^p%Qpq'Yqy%Qz#y%Q#y#z'Y#z$f%Q$f$g'Y$g#BY%Q#BY#BZ'Y#BZ$IS%Q$IS$I_'Y$I_$I|%Q$I|$JO'Y$JO$JT%Q$JT$JU'Y$JU$KV%Q$KV$KW'Y$KW&FU%Q&FU&FV'Y&FV;'S%Q;'S;=`%c<%lO%Q~'ah#s~!a`OX%QX^'Y^p%Qpq'Yqy%Qz#y%Q#y#z'Y#z$f%Q$f$g'Y$g#BY%Q#BY#BZ'Y#BZ$IS%Q$IS$I_'Y$I_$I|%Q$I|$JO'Y$JO$JT%Q$JT$JU'Y$JU$KV%Q$KV$KW'Y$KW&FU%Q&FU&FV'Y&FV;'S%Q;'S;=`%c<%lO%Qj)OUOy%Qz#]%Q#]#^)b#^;'S%Q;'S;=`%c<%lO%Qj)gU!a`Oy%Qz#a%Q#a#b)y#b;'S%Q;'S;=`%c<%lO%Qj*OU!a`Oy%Qz#d%Q#d#e*b#e;'S%Q;'S;=`%c<%lO%Qj*gU!a`Oy%Qz#c%Q#c#d*y#d;'S%Q;'S;=`%c<%lO%Qj+OU!a`Oy%Qz#f%Q#f#g+b#g;'S%Q;'S;=`%c<%lO%Qj+gU!a`Oy%Qz#h%Q#h#i+y#i;'S%Q;'S;=`%c<%lO%Qj,OU!a`Oy%Qz#T%Q#T#U,b#U;'S%Q;'S;=`%c<%lO%Qj,gU!a`Oy%Qz#b%Q#b#c,y#c;'S%Q;'S;=`%c<%lO%Qj-OU!a`Oy%Qz#h%Q#h#i-b#i;'S%Q;'S;=`%c<%lO%Qj-iS!qY!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Q~-xWOY-uZr-urs.bs#O-u#O#P.g#P;'S-u;'S;=`/c<%lO-u~.gOt~~.jRO;'S-u;'S;=`.s;=`O-u~.vXOY-uZr-urs.bs#O-u#O#P.g#P;'S-u;'S;=`/c;=`<%l-u<%lO-u~/fP;=`<%l-uj/nYjYOy%Qz!Q%Q!Q![0^![!c%Q!c!i0^!i#T%Q#T#Z0^#Z;'S%Q;'S;=`%c<%lO%Qj0cY!a`Oy%Qz!Q%Q!Q![1R![!c%Q!c!i1R!i#T%Q#T#Z1R#Z;'S%Q;'S;=`%c<%lO%Qj1WY!a`Oy%Qz!Q%Q!Q![1v![!c%Q!c!i1v!i#T%Q#T#Z1v#Z;'S%Q;'S;=`%c<%lO%Qj1}YrY!a`Oy%Qz!Q%Q!Q![2m![!c%Q!c!i2m!i#T%Q#T#Z2m#Z;'S%Q;'S;=`%c<%lO%Qj2tYrY!a`Oy%Qz!Q%Q!Q![3d![!c%Q!c!i3d!i#T%Q#T#Z3d#Z;'S%Q;'S;=`%c<%lO%Qj3iY!a`Oy%Qz!Q%Q!Q![4X![!c%Q!c!i4X!i#T%Q#T#Z4X#Z;'S%Q;'S;=`%c<%lO%Qj4`YrY!a`Oy%Qz!Q%Q!Q![5O![!c%Q!c!i5O!i#T%Q#T#Z5O#Z;'S%Q;'S;=`%c<%lO%Qj5TY!a`Oy%Qz!Q%Q!Q![5s![!c%Q!c!i5s!i#T%Q#T#Z5s#Z;'S%Q;'S;=`%c<%lO%Qj5zSrY!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Qd6ZUOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Qd6tS!hS!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Qb7VSZQOy%Qz;'S%Q;'S;=`%c<%lO%Q~7fWOY7cZw7cwx.bx#O7c#O#P8O#P;'S7c;'S;=`8z<%lO7c~8RRO;'S7c;'S;=`8[;=`O7c~8_XOY7cZw7cwx.bx#O7c#O#P8O#P;'S7c;'S;=`8z;=`<%l7c<%lO7c~8}P;=`<%l7cj9VSeYOy%Qz;'S%Q;'S;=`%c<%lO%Q~9hOd~n9oUWQvWOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Qj:YWvW!mQOy%Qz!O%Q!O!P:r!P!Q%Q!Q![=w![;'S%Q;'S;=`%c<%lO%Qj:wU!a`Oy%Qz!Q%Q!Q![;Z![;'S%Q;'S;=`%c<%lO%Qj;bY!a`#}YOy%Qz!Q%Q!Q![;Z![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%Qj<VY!a`Oy%Qz{%Q{|<u|}%Q}!O<u!O!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj<zU!a`Oy%Qz!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj=eU!a`#}YOy%Qz!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj>O[!a`#}YOy%Qz!O%Q!O!P;Z!P!Q%Q!Q![=w![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%Qj>yS!^YOy%Qz;'S%Q;'S;=`%c<%lO%Qj?[WvWOy%Qz!O%Q!O!P:r!P!Q%Q!Q![=w![;'S%Q;'S;=`%c<%lO%Qj?yU]YOy%Qz!Q%Q!Q![;Z![;'S%Q;'S;=`%c<%lO%Q~@bTvWOy%Qz{@q{;'S%Q;'S;=`%c<%lO%Q~@xS!a`#t~Oy%Qz;'S%Q;'S;=`%c<%lO%QjAZ[#}YOy%Qz!O%Q!O!P;Z!P!Q%Q!Q![=w![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%QjBUU`YOy%Qz![%Q![!]Bh!];'S%Q;'S;=`%c<%lO%QbBoSaQ!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QjCQSkYOy%Qz;'S%Q;'S;=`%c<%lO%QhCcU!TWOy%Qz!_%Q!_!`Cu!`;'S%Q;'S;=`%c<%lO%QhC|S!TW!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QlDaS!TW!hSOy%Qz;'S%Q;'S;=`%c<%lO%QjDtV!jQ!TWOy%Qz!_%Q!_!`Cu!`!aEZ!a;'S%Q;'S;=`%c<%lO%QbEbS!jQ!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QjEqYOy%Qz}%Q}!OFa!O!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjFfW!a`Oy%Qz!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjGV[iY!a`Oy%Qz}%Q}!OGO!O!Q%Q!Q![GO![!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjHQSmYOy%Qz;'S%Q;'S;=`%c<%lO%QnHcSl^Oy%Qz;'S%Q;'S;=`%c<%lO%QjHtSpYOy%Qz;'S%Q;'S;=`%c<%lO%QjIVSoYOy%Qz;'S%Q;'S;=`%c<%lO%QfIhU!mQOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Q`I}P;=`<%l$q",tokenizers:[Ug,Xg,Wg,Vg,1,2,3,4,new Zm("m~RRYZ[z{a~~g~aO#v~~dP!P!Qg~lO#w~~",28,129)],topRules:{StyleSheet:[0,6],Styles:[1,105]},specialized:[{term:124,get:e=>Zg[e]||-1},{term:125,get:e=>Hg[e]||-1},{term:4,get:e=>Yg[e]||-1},{term:25,get:e=>Gg[e]||-1},{term:123,get:e=>Kg[e]||-1}],tokenPrec:1963});let ev=null;function tv(){if(!ev&&"object"==typeof document&&document.body){let{style:e}=document.body,t=[],n=new Set;for(let i in e)"cssText"!=i&&"cssFloat"!=i&&"string"==typeof e[i]&&(/[A-Z]/.test(i)&&(i=i.replace(/[A-Z]/g,e=>"-"+e.toLowerCase())),n.has(i)||(t.push(i),n.add(i)));ev=t.sort().map(e=>({type:"property",label:e,apply:e+": "}))}return ev||[]}const nv=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map(e=>({type:"class",label:e})),iv=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map(e=>({type:"keyword",label:e})).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map(e=>({type:"constant",label:e}))),rv=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map(e=>({type:"type",label:e})),sv=["@charset","@color-profile","@container","@counter-style","@font-face","@font-feature-values","@font-palette-values","@import","@keyframes","@layer","@media","@namespace","@page","@position-try","@property","@scope","@starting-style","@supports","@view-transition"].map(e=>({type:"keyword",label:e})),ov=/^(\w[\w-]*|-\w[\w-]*|)$/,av=/^-(-[\w-]*)?$/;const lv=new du,cv=["Declaration"];function uv(e){for(let t=e;;){if(t.type.isTop)return t;if(!(t=t.parent))return e}}function hv(e,t,n){if(t.to-t.from>4096){let i=lv.get(t);if(i)return i;let r=[],s=new Set,o=t.cursor(qc.IncludeAnonymous);if(o.firstChild())do{for(let t of hv(e,o.node,n))s.has(t.label)||(s.add(t.label),r.push(t))}while(o.nextSibling());return lv.set(t,r),r}{let i=[],r=new Set;return t.cursor().iterate(t=>{var s;if(n(t)&&t.matchContext(cv)&&":"==(null===(s=t.node.nextSibling)||void 0===s?void 0:s.name)){let n=e.sliceString(t.from,t.to);r.has(n)||(r.add(n),i.push({label:n,type:"variable"}))}}),i}}const dv=e=>t=>{let{state:n,pos:i}=t,r=ch(n).resolveInner(i,-1),s=r.type.isError&&r.from==r.to-1&&"-"==n.doc.sliceString(r.from,r.to);if("PropertyName"==r.name||(s||"TagName"==r.name)&&/^(Block|Styles)$/.test(r.resolve(r.to).name))return{from:r.from,options:tv(),validFor:ov};if("ValueName"==r.name)return{from:r.from,options:iv,validFor:ov};if("PseudoClassName"==r.name)return{from:r.from,options:nv,validFor:ov};if(e(r)||(t.explicit||s)&&function(e,t){var n;if(("("==e.name||e.type.isError)&&(e=e.parent||e),"ArgList"!=e.name)return!1;let i=null===(n=e.parent)||void 0===n?void 0:n.firstChild;return"Callee"==(null===i||void 0===i?void 0:i.name)&&"var"==t.sliceString(i.from,i.to)}(r,n.doc))return{from:e(r)||s?r.from:i,options:hv(n.doc,uv(r),e),validFor:av};if("TagName"==r.name){for(let{parent:e}=r;e;e=e.parent)if("Block"==e.name)return{from:r.from,options:tv(),validFor:ov};return{from:r.from,options:rv,validFor:ov}}if("AtKeyword"==r.name)return{from:r.from,options:sv,validFor:ov};if(!t.explicit)return null;let o=r.resolve(i),a=o.childBefore(i);return a&&":"==a.name&&"PseudoClassSelector"==o.name?{from:i,options:nv,validFor:ov}:a&&":"==a.name&&"Declaration"==o.name||"ArgList"==o.name?{from:i,options:iv,validFor:ov}:"Block"==o.name||"Styles"==o.name?{from:i,options:tv(),validFor:ov}:null},pv=dv(e=>"VariableName"==e.name),fv=lh.define({name:"css",parser:Jg.configure({props:[Ah.add({Declaration:Nh()}),Bh.add({"Block KeyframeList":Qh})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});const mv=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],gv=new lg({start:!1,shift:(e,t)=>5==t||6==t||320==t?e:321==t,strict:!1}),vv=new Hm((e,t)=>{let{next:n}=e;(125==n||-1==n||t.context)&&e.acceptToken(318)},{contextual:!0,fallback:!0}),yv=new Hm((e,t)=>{let n,{next:i}=e;mv.indexOf(i)>-1||(47!=i||47!=(n=e.peek(1))&&42!=n)&&(125==i||59==i||-1==i||t.context||e.acceptToken(316))},{contextual:!0}),Ov=new Hm((e,t)=>{91!=e.next||t.context||e.acceptToken(317)},{contextual:!0}),wv=new Hm((e,t)=>{let{next:n}=e;if(43==n||45==n){if(e.advance(),n==e.next){e.advance();let n=!t.context&&t.canShift(1);e.acceptToken(n?1:2)}}else 63==n&&46==e.peek(1)&&(e.advance(),e.advance(),(e.next<48||e.next>57)&&e.acceptToken(3))},{contextual:!0});function bv(e,t){return e>=65&&e<=90||e>=97&&e<=122||95==e||e>=192||!t&&e>=48&&e<=57}const kv=new Hm((e,t)=>{if(60!=e.next||!t.dialectEnabled(0))return;if(e.advance(),47==e.next)return;let n=0;for(;mv.indexOf(e.next)>-1;)e.advance(),n++;if(bv(e.next,!0)){for(e.advance(),n++;bv(e.next,!1);)e.advance(),n++;for(;mv.indexOf(e.next)>-1;)e.advance(),n++;if(44==e.next)return;for(let t=0;;t++){if(7==t){if(!bv(e.next,!0))return;break}if(e.next!="extends".charCodeAt(t))break;e.advance(),n++}}e.acceptToken(4,-n)}),xv=Ru({"get set async static":th.modifier,"for while do if else switch try catch finally return throw break continue default case defer":th.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":th.operatorKeyword,"let var const using function class extends":th.definitionKeyword,"import export from":th.moduleKeyword,"with debugger new":th.keyword,TemplateString:th.special(th.string),super:th.atom,BooleanLiteral:th.bool,this:th.self,null:th.null,Star:th.modifier,VariableName:th.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":th.function(th.variableName),VariableDefinition:th.definition(th.variableName),Label:th.labelName,PropertyName:th.propertyName,PrivatePropertyName:th.special(th.propertyName),"CallExpression/MemberExpression/PropertyName":th.function(th.propertyName),"FunctionDeclaration/VariableDefinition":th.function(th.definition(th.variableName)),"ClassDeclaration/VariableDefinition":th.definition(th.className),"NewExpression/VariableName":th.className,PropertyDefinition:th.definition(th.propertyName),PrivatePropertyDefinition:th.definition(th.special(th.propertyName)),UpdateOp:th.updateOperator,"LineComment Hashbang":th.lineComment,BlockComment:th.blockComment,Number:th.number,String:th.string,Escape:th.escape,ArithOp:th.arithmeticOperator,LogicOp:th.logicOperator,BitOp:th.bitwiseOperator,CompareOp:th.compareOperator,RegExp:th.regexp,Equals:th.definitionOperator,Arrow:th.function(th.punctuation),": Spread":th.punctuation,"( )":th.paren,"[ ]":th.squareBracket,"{ }":th.brace,"InterpolationStart InterpolationEnd":th.special(th.brace),".":th.derefOperator,", ;":th.separator,"@":th.meta,TypeName:th.typeName,TypeDefinition:th.definition(th.typeName),"type enum interface implements namespace module declare":th.definitionKeyword,"abstract global Privacy readonly override":th.modifier,"is keyof unique infer asserts":th.operatorKeyword,JSXAttributeValue:th.attributeValue,JSXText:th.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":th.angleBracket,"JSXIdentifier JSXNameSpacedName":th.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":th.attributeName,"JSXBuiltin/JSXIdentifier":th.standard(th.tagName)}),Dv={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,defer:471,for:476,of:485,while:488,with:492,do:496,if:500,else:502,switch:506,case:512,try:518,catch:522,finally:526,return:530,throw:534,break:538,continue:542,debugger:546},Sv={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},Cv={__proto__:null,"<":193},Av=cg.deserialize({version:14,states:"$F|Q%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Il'#IlO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JrO6[Q!0MxO'#JsO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO9XQMhO'#F|O9`Q`O'#F{OOQ!0Lf'#Js'#JsOOQ!0Lb'#Jr'#JrO9eQ`O'#GwOOQ['#K_'#K_O9pQ`O'#IYO9uQ!0LrO'#IZOOQ['#J`'#J`OOQ['#I_'#I_Q`QlOOQ`QlOOO9}Q!L^O'#DvO:UQlO'#EOO:]QlO'#EQO9kQ`O'#GsO:dQMhO'#CoO:rQ`O'#EnO:}Q`O'#EyO;hQMhO'#FeO;xQ`O'#GsOOQO'#K`'#K`O;}Q`O'#K`O<]Q`O'#G{O<]Q`O'#G|O<]Q`O'#HOO9kQ`O'#HRO=SQ`O'#HUO>kQ`O'#CeO>{Q`O'#HcO?TQ`O'#HiO?TQ`O'#HkO`QlO'#HmO?TQ`O'#HoO?TQ`O'#HrO?YQ`O'#HxO?_Q!0LsO'#IOO%[QlO'#IQO?jQ!0LsO'#ISO?uQ!0LsO'#IUO9uQ!0LrO'#IWO@QQ!0MxO'#CiOASQpO'#DlQOQ`OOO%[QlO'#EQOAjQ`O'#ETO:dQMhO'#EnOAuQ`O'#EnOBQQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Jv'#JvO%[QlO'#JvOOQO'#Jy'#JyOOQO'#Ih'#IhOCQQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J}'#J}OC|Q!0MSO'#EgODWQpO'#EWOOQO'#Jx'#JxODlQpO'#JyOEyQpO'#EWODWQpO'#EgPFWO&2DjO'#CbPOOO)CD})CD}OOOO'#I`'#I`OFcO#tO,59UOOQ!0Lh,59U,59UOOOO'#Ia'#IaOFqO&jO,59UOGPQ!L^O'#DcOOOO'#Ic'#IcOGWO#@ItO,59{OOQ!0Lf,59{,59{OGfQlO'#IdOGyQ`O'#JtOIxQ!fO'#JtO+}QlO'#JtOJPQ`O,5:ROJgQ`O'#EpOJtQ`O'#KTOKPQ`O'#KSOKPQ`O'#KSOKXQ`O,5;^OK^Q`O'#KROOQ!0Ln,5:^,5:^OKeQlO,5:^OMcQ!0MxO,5:fONSQ`O,5:nONmQ!0LrO'#KQONtQ`O'#KPO9eQ`O'#KPO! YQ`O'#KPO! bQ`O,5;]O! gQ`O'#KPO!#lQ!fO'#JsOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$[Q!fO,5:sOOQS'#Jz'#JzOOQO-E<j-E<jO9kQ`O,5=_O!$rQ`O,5=_O!$wQlO,5;ZO!&zQMhO'#EkO!(eQ`O,5;ZO!(jQlO'#DyO!(tQpO,5;dO!(|QpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)[QlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IpO!+_Q!0LrO,5<iO%[QlO,5;eO!&zQMhO,5;eO!+|QMhO,5;eO!-nQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-uQ,UO'#FjO!.rQ,UO'#KXO!.^Q,UO'#KXO!.yQ,UO'#KXOOQO'#KX'#KXO!/_Q,UO,5<SOOOW,5<`,5<`O!/pQlO'#FvOOOW'#Io'#IoO7VO7dO,5<QO!/wQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0hQ$IUO'#CyOOQ!0Lh'#C}'#C}O!0{O#@ItO'#DRO!1iQMjO,5<eO!1pQ`O,5<hO!3YQ(CWO'#GXO!3jQ`O'#GYO!3oQ`O'#GYO!5_Q(CWO'#G^O!6dQpO'#GbOOQO'#Gn'#GnO!,TQMhO'#GmOOQO'#Gp'#GpO!,TQMhO'#GoO!7VQ$IUO'#JlOOQ!0Lh'#Jl'#JlO!7aQ`O'#JkO!7oQ`O'#JjO!7wQ`O'#CuOOQ!0Lh'#C{'#C{O!8YQ`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO!8_Q`O,5<eO1SQ`O'#DZO!,TQMhO'#GPO!,TQMhO'#GRO!8gQ`O'#GTO!8lQ`O'#GUO!3oQ`O'#G[O!,TQMhO'#GaO<]Q`O'#JkO!8qQ`O'#EqO!9`Q`O,5<gOOQ!0Lb'#Cr'#CrO!9hQ`O'#ErO!:bQpO'#EsOOQ!0Lb'#KR'#KRO!:iQ!0LrO'#KaO9uQ!0LrO,5=cO`QlO,5>tOOQ['#Jh'#JhOOQ[,5>u,5>uOOQ[-E<]-E<]O!<hQ!0MxO,5:bO!:]QpO,5:`O!?RQ!0MxO,5:jO%[QlO,5:jO!AiQ!0MxO,5:lOOQO,5@z,5@zO!BYQMhO,5=_O!BhQ!0LrO'#JiO9`Q`O'#JiO!ByQ!0LrO,59ZO!CUQpO,59ZO!C^QMhO,59ZO:dQMhO,59ZO!CiQ`O,5;ZO!CqQ`O'#HbO!DVQ`O'#KdO%[QlO,5;}O!:]QpO,5<PO!D_Q`O,5=zO!DdQ`O,5=zO!DiQ`O,5=zO!DwQ`O,5=zO9uQ!0LrO,5=zO<]Q`O,5=jOOQO'#Cy'#CyO!EOQpO,5=gO!EWQMhO,5=hO!EcQ`O,5=jO!EhQ!bO,5=mO!EpQ`O'#K`O?YQ`O'#HWO9kQ`O'#HYO!EuQ`O'#HYO:dQMhO'#H[O!EzQ`O'#H[OOQ[,5=p,5=pO!FPQ`O'#H]O!FbQ`O'#CoO!FgQ`O,59PO!FqQ`O,59PO!HvQlO,59POOQ[,59P,59PO!IWQ!0LrO,59PO%[QlO,59PO!KcQlO'#HeOOQ['#Hf'#HfOOQ['#Hg'#HgO`QlO,5=}O!KyQ`O,5=}O`QlO,5>TO`QlO,5>VO!LOQ`O,5>XO`QlO,5>ZO!LTQ`O,5>^O!LYQlO,5>dOOQ[,5>j,5>jO%[QlO,5>jO9uQ!0LrO,5>lOOQ[,5>n,5>nO#!dQ`O,5>nOOQ[,5>p,5>pO#!dQ`O,5>pOOQ[,5>r,5>rO##QQpO'#D_O%[QlO'#JvO##sQpO'#JvO##}QpO'#DmO#$`QpO'#DmO#&qQlO'#DmO#&xQ`O'#JuO#'QQ`O,5:WO#'VQ`O'#EtO#'eQ`O'#KUO#'mQ`O,5;_O#'rQpO'#DmO#(PQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#(WQ`O,5:oO?YQ`O,5;YO!CUQpO,5;YO!C^QMhO,5;YO:dQMhO,5;YO#(`Q`O,5@bO#(eQ07dO,5:sOOQO-E<f-E<fO#)kQ!0MSO,5;RODWQpO,5:rO#)uQpO,5:rODWQpO,5;RO!ByQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#*SQ!0LrO,5;RO#*_Q!0LrO,5;RO!CUQpO,5:rOOQO,5;X,5;XO#*mQ!0LrO,5;RPOOO'#I^'#I^P#+RO&2DjO,58|POOO,58|,58|OOOO-E<^-E<^OOQ!0Lh1G.p1G.pOOOO-E<_-E<_OOOO,59},59}O#+^Q!bO,59}OOOO-E<a-E<aOOQ!0Lf1G/g1G/gO#+cQ!fO,5?OO+}QlO,5?OOOQO,5?U,5?UO#+mQlO'#IdOOQO-E<b-E<bO#+zQ`O,5@`O#,SQ!fO,5@`O#,ZQ`O,5@nOOQ!0Lf1G/m1G/mO%[QlO,5@oO#,cQ`O'#IjOOQO-E<h-E<hO#,ZQ`O,5@nOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@lO#,wQ!0LrO,5@lO#-YQ!0LrO,5@lO#-aQ`O,5@kO9eQ`O,5@kO#-iQ`O,5@kO#-wQ`O'#ImO#-aQ`O,5@kOOQ!0Lb1G0w1G0wO!(tQpO,5:uO!)PQpO,5:uOOQS,5:w,5:wO#.iQdO,5:wO#.qQMhO1G2yO9kQ`O1G2yOOQ!0Lf1G0u1G0uO#/PQ!0MxO1G0uO#0UQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0rQ!0MzO'#JlO!$wQlO1G0uO#2}Q!fO'#JwO%[QlO'#JwO#3XQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#3^Q`O1G1OO#5rQ!0MxO1G1PO#5yQ!0MxO1G1PO#8aQ!0MxO1G1PO#8hQ!0MxO1G1PO#;OQ!0MxO1G1PO#=fQ!0MxO1G1PO#=mQ!0MxO1G1PO#=tQ!0MxO1G1PO#@[Q!0MxO1G1PO#@cQ!0MxO1G1PO#BpQ?MtO'#CiO#DkQ?MtO1G1`O#DrQ?MtO'#JsO#EVQ!0MxO,5?[OOQ!0Lb-E<n-E<nO#GdQ!0MxO1G1PO#HaQ!0MzO1G1POOQ!0Lf1G1P1G1PO#IdQMjO'#J|O#InQ`O,5:xO#IsQ!0MxO1G1cO#JgQ,UO,5<WO#JoQ,UO,5<XO#JwQ,UO'#FoO#K`Q`O'#FnOOQO'#KY'#KYOOQO'#In'#InO#KeQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#KvQ?MtO'#JrO#LQQ`O,5<bO!)[QlO,5<bOOOW-E<m-E<mOOQ!0Lf1G1l1G1lO#LVQpO'#KXOOQ!0Lf,5<d,5<dO#L_QpO,5<dO#LdQMhO'#DTOOOO'#Ib'#IbO#LkO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8lQ`O'#IrO#LvQ`O,5<zOOQ!0Lh,5<w,5<wO!,TQMhO'#IuO#MdQMjO,5=XO!,TQMhO'#IwO#NVQMjO,5=ZO!&zQMhO,5=]OOQO1G2S1G2SO#NaQ!dO'#CrO#NtQ(CWO'#ErO$ |QpO'#GbO$!dQ!dO,5<sO$!kQ`O'#K[O9eQ`O'#K[O$!yQ`O,5<uO$#aQ!dO'#C{O!,TQMhO,5<tO$#kQ`O'#GZO$$PQ`O,5<tO$$UQ!dO'#GWO$$cQ!dO'#K]O$$mQ`O'#K]O!&zQMhO'#K]O$$rQ`O,5<xO$$wQlO'#JvO$%RQpO'#GcO#$`QpO'#GcO$%dQ`O'#GgO!3oQ`O'#GkO$%iQ!0LrO'#ItO$%tQpO,5<|OOQ!0Lp,5<|,5<|O$%{QpO'#GcO$&YQpO'#GdO$&kQpO'#GdO$&pQMjO,5=XO$'QQMjO,5=ZOOQ!0Lh,5=^,5=^O!,TQMhO,5@VO!,TQMhO,5@VO$'bQ`O'#IyO$'vQ`O,5@UO$(OQ`O,59aOOQ!0Lh,59i,59iO$(TQ`O,5@VO$)TQ$IYO,59uOOQ!0Lh'#Jp'#JpO$)vQMjO,5<kO$*iQMjO,5<mO@zQ`O,5<oOOQ!0Lh,5<p,5<pO$*sQ`O,5<vO$*xQMjO,5<{O$+YQ`O'#KPO!$wQlO1G2RO$+_Q`O1G2RO9eQ`O'#KSO9eQ`O'#EtO%[QlO'#EtO9eQ`O'#I{O$+dQ!0LrO,5@{OOQ[1G2}1G2}OOQ[1G4`1G4`OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$-fQ!0MxO1G0UOOQ[1G2y1G2yO!&zQMhO1G2yO%[QlO1G2yO#.tQ`O1G2yO$/jQMhO'#EkOOQ!0Lb,5@T,5@TO$/wQ!0LrO,5@TOOQ[1G.u1G.uO!ByQ!0LrO1G.uO!CUQpO1G.uO!C^QMhO1G.uO$0YQ`O1G0uO$0_Q`O'#CiO$0jQ`O'#KeO$0rQ`O,5=|O$0wQ`O'#KeO$0|Q`O'#KeO$1[Q`O'#JRO$1jQ`O,5AOO$1rQ!fO1G1iOOQ!0Lf1G1k1G1kO9kQ`O1G3fO@zQ`O1G3fO$1yQ`O1G3fO$2OQ`O1G3fO!DiQ`O1G3fO9uQ!0LrO1G3fOOQ[1G3f1G3fO!EcQ`O1G3UO!&zQMhO1G3RO$2TQ`O1G3ROOQ[1G3S1G3SO!&zQMhO1G3SO$2YQ`O1G3SO$2bQpO'#HQOOQ[1G3U1G3UO!6_QpO'#I}O!EhQ!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$2jQMhO,5=tO9kQ`O,5=tO$%dQ`O,5=vO9`Q`O,5=vO!CUQpO,5=vO!C^QMhO,5=vO:dQMhO,5=vO$2xQ`O'#KcO$3TQ`O,5=wOOQ[1G.k1G.kO$3YQ!0LrO1G.kO@zQ`O1G.kO$3eQ`O1G.kO9uQ!0LrO1G.kO$5mQ!fO,5AQO$5zQ`O,5AQO9eQ`O,5AQO$6VQlO,5>PO$6^Q`O,5>POOQ[1G3i1G3iO`QlO1G3iOOQ[1G3o1G3oOOQ[1G3q1G3qO?TQ`O1G3sO$6cQlO1G3uO$:gQlO'#HtOOQ[1G3x1G3xO$:tQ`O'#HzO?YQ`O'#H|OOQ[1G4O1G4OO$:|QlO1G4OO9uQ!0LrO1G4UOOQ[1G4W1G4WOOQ!0Lb'#G_'#G_O9uQ!0LrO1G4YO9uQ!0LrO1G4[O$?TQ`O,5@bO!)[QlO,5;`O9eQ`O,5;`O?YQ`O,5:XO!)[QlO,5:XO!CUQpO,5:XO$?YQ?MtO,5:XOOQO,5;`,5;`O$?dQpO'#IeO$?zQ`O,5@aOOQ!0Lf1G/r1G/rO$@SQpO'#IkO$@^Q`O,5@pOOQ!0Lb1G0y1G0yO#$`QpO,5:XOOQO'#Ig'#IgO$@fQpO,5:qOOQ!0Ln,5:q,5:qO#(ZQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO?YQ`O1G0tO!CUQpO1G0tO!C^QMhO1G0tOOQ!0Lb1G5|1G5|O!ByQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$@mQ!0LrO1G0mO$@xQ!0LrO1G0mO!CUQpO1G0^ODWQpO1G0^O$AWQ!0LrO1G0mOOQO1G0^1G0^O$AlQ!0MxO1G0mPOOO-E<[-E<[POOO1G.h1G.hOOOO1G/i1G/iO$AvQ!bO,5<iO$BOQ!fO1G4jOOQO1G4p1G4pO%[QlO,5?OO$BYQ`O1G5zO$BbQ`O1G6YO$BjQ!fO1G6ZO9eQ`O,5?UO$BtQ!0MxO1G6WO%[QlO1G6WO$CUQ!0LrO1G6WO$CgQ`O1G6VO$CgQ`O1G6VO9eQ`O1G6VO$CoQ`O,5?XO9eQ`O,5?XOOQO,5?X,5?XO$DTQ`O,5?XO$+YQ`O,5?XOOQO-E<k-E<kOOQS1G0a1G0aOOQS1G0c1G0cO#.lQ`O1G0cOOQ[7+(e7+(eO!&zQMhO7+(eO%[QlO7+(eO$DcQ`O7+(eO$DnQMhO7+(eO$D|Q!0MzO,5=XO$GXQ!0MzO,5=ZO$IdQ!0MzO,5=XO$KuQ!0MzO,5=ZO$NWQ!0MzO,59uO%!]Q!0MzO,5<kO%$hQ!0MzO,5<mO%&sQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%)UQ!0MxO7+&aO%)xQlO'#IfO%*VQ`O,5@cO%*_Q!fO,5@cOOQ!0Lf1G0P1G0PO%*iQ`O7+&jOOQ!0Lf7+&j7+&jO%*nQ?MtO,5:fO%[QlO7+&zO%*xQ?MtO,5:bO%+VQ?MtO,5:jO%+aQ?MtO,5:lO%+kQMhO'#IiO%+uQ`O,5@hOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%+}Q!jO,5<ZO!)[QlO,5<YOOQO-E<l-E<lOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%,YQ`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%,_Q!dO,59oOOOO-E<`-E<`OOQ!0Lh1G/X1G/XO%,fQ!0MxO7+'kOOQ!0Lh,5?^,5?^O%-YQMhO1G2fP%-aQ`O'#IrPOQ!0Lh-E<p-E<pO%-}QMjO,5?aOOQ!0Lh-E<s-E<sO%.pQMjO,5?cOOQ!0Lh-E<u-E<uO%.zQ!dO1G2wO%/RQ!dO'#CrO%/iQMhO'#KSO$$wQlO'#JvOOQ!0Lh1G2_1G2_O%/sQ`O'#IqO%0[Q`O,5@vO%0[Q`O,5@vO%0dQ`O,5@vO%0oQ`O,5@vOOQO1G2a1G2aO%0}QMjO1G2`O$+YQ`O'#K[O!,TQMhO1G2`O%1_Q(CWO'#IsO%1lQ`O,5@wO!&zQMhO,5@wO%1tQ!dO,5@wOOQ!0Lh1G2d1G2dO%4UQ!fO'#CiO%4`Q`O,5=POOQ!0Lb,5<},5<}O%4hQpO,5<}OOQ!0Lb,5=O,5=OOCwQ`O,5<}O%4sQpO,5<}OOQ!0Lb,5=R,5=RO$+YQ`O,5=VOOQO,5?`,5?`OOQO-E<r-E<rOOQ!0Lp1G2h1G2hO#$`QpO,5<}O$$wQlO,5=PO%5RQ`O,5=OO%5^QpO,5=OO!,TQMhO'#IuO%6WQMjO1G2sO!,TQMhO'#IwO%6yQMjO1G2uO%7TQMjO1G5qO%7_QMjO1G5qOOQO,5?e,5?eOOQO-E<w-E<wOOQO1G.{1G.{O!,TQMhO1G5qO!,TQMhO1G5qO!:]QpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%7lQ`O1G2ZO!,TQMhO1G2bO%7qQ!0MxO7+'mOOQ!0Lf7+'m7+'mO!$wQlO7+'mO%8eQ`O,5;`OOQ!0Lb,5?g,5?gOOQ!0Lb-E<y-E<yO%8jQ!dO'#K^O#(ZQ`O7+(eO4UQ!fO7+(eO$DfQ`O7+(eO%8tQ!0MvO'#CiO%9XQ!0MvO,5=SO%9lQ`O,5=SO%9tQ`O,5=SOOQ!0Lb1G5o1G5oOOQ[7+$a7+$aO!ByQ!0LrO7+$aO!CUQpO7+$aO!$wQlO7+&aO%9yQ`O'#JQO%:bQ`O,5APOOQO1G3h1G3hO9kQ`O,5APO%:bQ`O,5APO%:jQ`O,5APOOQO,5?m,5?mOOQO-E=P-E=POOQ!0Lf7+'T7+'TO%:oQ`O7+)QO9uQ!0LrO7+)QO9kQ`O7+)QO@zQ`O7+)QO%:tQ`O7+)QOOQ[7+)Q7+)QOOQ[7+(p7+(pO%:yQ!0MvO7+(mO!&zQMhO7+(mO!E^Q`O7+(nOOQ[7+(n7+(nO!&zQMhO7+(nO%;TQ`O'#KbO%;`Q`O,5=lOOQO,5?i,5?iOOQO-E<{-E<{OOQ[7+(s7+(sO%<rQpO'#HZOOQ[1G3`1G3`O!&zQMhO1G3`O%[QlO1G3`O%<yQ`O1G3`O%=UQMhO1G3`O9uQ!0LrO1G3bO$%dQ`O1G3bO9`Q`O1G3bO!CUQpO1G3bO!C^QMhO1G3bO%=dQ`O'#JPO%=xQ`O,5@}O%>QQpO,5@}OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@zQ`O7+$VO9uQ!0LrO7+$VO%>]Q`O7+$VO%[QlO1G6lO%[QlO1G6mO%>bQ!0LrO1G6lO%>lQlO1G3kO%>sQ`O1G3kO%>xQlO1G3kOOQ[7+)T7+)TO9uQ!0LrO7+)_O`QlO7+)aOOQ['#Kh'#KhOOQ['#JS'#JSO%?PQlO,5>`OOQ[,5>`,5>`O%[QlO'#HuO%?^Q`O'#HwOOQ[,5>f,5>fO9eQ`O,5>fOOQ[,5>h,5>hOOQ[7+)j7+)jOOQ[7+)p7+)pOOQ[7+)t7+)tOOQ[7+)v7+)vO%?cQpO1G5|O%?}Q?MtO1G0zO%@XQ`O1G0zOOQO1G/s1G/sO%@dQ?MtO1G/sO?YQ`O1G/sO!)[QlO'#DmOOQO,5?P,5?POOQO-E<c-E<cOOQO,5?V,5?VOOQO-E<i-E<iO!CUQpO1G/sOOQO-E<e-E<eOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#(ZQ`O7+%uOOQ!0Lf7+&`7+&`O?YQ`O7+&`O!CUQpO7+&`OOQO7+%x7+%xO$AlQ!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%@nQ!0LrO7+&XO!ByQ!0LrO7+%xO!CUQpO7+%xO%@yQ!0LrO7+&XO%AXQ!0MxO7++rO%[QlO7++rO%AiQ`O7++qO%AiQ`O7++qOOQO1G4s1G4sO9eQ`O1G4sO%AqQ`O1G4sOOQS7+%}7+%}O#(ZQ`O<<LPO4UQ!fO<<LPO%BPQ`O<<LPOOQ[<<LP<<LPO!&zQMhO<<LPO%[QlO<<LPO%BXQ`O<<LPO%BdQ!0MzO,5?aO%DoQ!0MzO,5?cO%FzQ!0MzO1G2`O%I]Q!0MzO1G2sO%KhQ!0MzO1G2uO%MsQ!fO,5?QO%[QlO,5?QOOQO-E<d-E<dO%M}Q`O1G5}OOQ!0Lf<<JU<<JUO%NVQ?MtO1G0uO&!^Q?MtO1G1PO&!eQ?MtO1G1PO&$fQ?MtO1G1PO&$mQ?MtO1G1PO&&nQ?MtO1G1PO&(oQ?MtO1G1PO&(vQ?MtO1G1PO&(}Q?MtO1G1PO&+OQ?MtO1G1PO&+VQ?MtO1G1PO&+^Q!0MxO<<JfO&-UQ?MtO1G1PO&.RQ?MvO1G1PO&/UQ?MvO'#JlO&1[Q?MtO1G1cO&1iQ?MtO1G0UO&1sQMjO,5?TOOQO-E<g-E<gO!)[QlO'#FqOOQO'#KZ'#KZOOQO1G1u1G1uO&1}Q`O1G1tO&2SQ?MtO,5?[OOOW7+'h7+'hOOOO1G/Z1G/ZO&2^Q!dO1G4xOOQ!0Lh7+(Q7+(QP!&zQMhO,5?^O!,TQMhO7+(cO&2eQ`O,5?]O9eQ`O,5?]O$+YQ`O,5?]OOQO-E<o-E<oO&2sQ`O1G6bO&2sQ`O1G6bO&2{Q`O1G6bO&3WQMjO7+'zO&3hQ!dO,5?_O&3rQ`O,5?_O!&zQMhO,5?_OOQO-E<q-E<qO&3wQ!dO1G6cO&4RQ`O1G6cO&4ZQ`O1G2kO!&zQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%4hQpO1G2iO!CUQpO1G2iOCwQ`O1G2iOOQ!0Lb1G2q1G2qO&4`QpO1G2iO&4nQ`O1G2kO$+YQ`O1G2jOCwQ`O1G2jO$$wQlO1G2kO&4vQ`O1G2jO&5jQMjO,5?aOOQ!0Lh-E<t-E<tO&6]QMjO,5?cOOQ!0Lh-E<v-E<vO!,TQMhO7++]O&6gQMjO7++]O&6qQMjO7++]OOQ!0Lh1G/c1G/cO&7OQ`O1G/cOOQ!0Lh7+'u7+'uO&7TQMjO7+'|O&7eQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&8XQ`O1G0zO!&zQMhO'#IzO&8^Q`O,5@xO&:`Q!fO<<LPO!&zQMhO1G2nO&:gQ!0LrO1G2nOOQ[<<G{<<G{O!ByQ!0LrO<<G{O&:xQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?l,5?lO&;lQ`O,5?lO&;qQ`O,5?lOOQO-E=O-E=OO&<PQ`O1G6kO&<PQ`O1G6kO9kQ`O1G6kO@zQ`O<<LlOOQ[<<Ll<<LlO&<XQ`O<<LlO9uQ!0LrO<<LlO9kQ`O<<LlOOQ[<<LX<<LXO%:yQ!0MvO<<LXOOQ[<<LY<<LYO!E^Q`O<<LYO&<^QpO'#I|O&<iQ`O,5@|O!)[QlO,5@|OOQ[1G3W1G3WOOQO'#JO'#JOO9uQ!0LrO'#JOO&<qQpO,5=uOOQ[,5=u,5=uO&<xQpO'#EgO&=PQpO'#GeO&=UQ`O7+(zO&=ZQ`O7+(zOOQ[7+(z7+(zO!&zQMhO7+(zO%[QlO7+(zO&=cQ`O7+(zOOQ[7+(|7+(|O9uQ!0LrO7+(|O$%dQ`O7+(|O9`Q`O7+(|O!CUQpO7+(|O&=nQ`O,5?kOOQO-E<}-E<}OOQO'#H^'#H^O&=yQ`O1G6iO9uQ!0LrO<<GqOOQ[<<Gq<<GqO@zQ`O<<GqO&>RQ`O7+,WO&>WQ`O7+,XO%[QlO7+,WO%[QlO7+,XOOQ[7+)V7+)VO&>]Q`O7+)VO&>bQlO7+)VO&>iQ`O7+)VOOQ[<<Ly<<LyOOQ[<<L{<<L{OOQ[-E=Q-E=QOOQ[1G3z1G3zO&>nQ`O,5>aOOQ[,5>c,5>cO&>sQ`O1G4QO9eQ`O7+&fO!)[QlO7+&fOOQO7+%_7+%_O&>xQ?MtO1G6ZO?YQ`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO?YQ`O<<IzOOQO<<Is<<IsO$AlQ!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!ByQ!0LrO<<IdO&?SQ!0LrO<<IsO&?_Q!0MxO<= ^O&?oQ`O<= ]OOQO7+*_7+*_O9eQ`O7+*_OOQ[ANAkANAkO&?wQ!fOANAkO!&zQMhOANAkO#(ZQ`OANAkO4UQ!fOANAkO&@OQ`OANAkO%[QlOANAkO&@WQ!0MzO7+'zO&BiQ!0MzO,5?aO&DtQ!0MzO,5?cO&GPQ!0MzO7+'|O&IbQ!fO1G4lO&IlQ?MtO7+&aO&KpQ?MvO,5=XO&MwQ?MvO,5=ZO&NXQ?MvO,5=XO&NiQ?MvO,5=ZO&NyQ?MvO,59uO'#PQ?MvO,5<kO'%SQ?MvO,5<mO''hQ?MvO,5<{O')^Q?MtO7+'kO')kQ?MtO7+'mO')xQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*d7+*dO')}QMjO<<K}OOQO1G4w1G4wO'*UQ`O1G4wO'*aQ`O1G4wO'*oQ`O7++|O'*oQ`O7++|O!&zQMhO1G4yO'*wQ!dO1G4yO'+RQ`O7++}O'+ZQ`O7+(VO'+fQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!CUQpO7+(TOCwQ`O7+(TO'+pQ`O7+(VO!&zQMhO7+(VO$+YQ`O7+(UO'+uQ`O7+(VOCwQ`O7+(UO'+}QMjO<<NwO!,TQMhO<<NwOOQ!0Lh7+$}7+$}O',XQ!dO,5?fOOQO-E<x-E<xO',cQ!0MvO7+(YO!&zQMhO7+(YOOQ[AN=gAN=gO9kQ`O1G5WOOQO1G5W1G5WO',sQ`O1G5WO',xQ`O7+,VO',xQ`O7+,VO9uQ!0LrOANBWO@zQ`OANBWOOQ[ANBWANBWO'-QQ`OANBWOOQ[ANAsANAsOOQ[ANAtANAtO'-VQ`O,5?hOOQO-E<z-E<zO'-bQ?MtO1G6hOOQO,5?j,5?jOOQO-E<|-E<|OOQ[1G3a1G3aO'-lQ`O,5=POOQ[<<Lf<<LfO!&zQMhO<<LfO&=UQ`O<<LfO'-qQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9uQ!0LrO<<LhO$%dQ`O<<LhO9`Q`O<<LhO'-yQpO1G5VO'.UQ`O7+,TOOQ[AN=]AN=]O9uQ!0LrOAN=]OOQ[<= r<= rOOQ[<= s<= sO'.^Q`O<= rO'.cQ`O<= sOOQ[<<Lq<<LqO'.hQ`O<<LqO'.mQlO<<LqOOQ[1G3{1G3{O?YQ`O7+)lO'.tQ`O<<JQO'/PQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$AlQ!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<My<<MyOOQ[G27VG27VO!&zQMhOG27VO#(ZQ`OG27VO'/ZQ!fOG27VO4UQ!fOG27VO'/bQ`OG27VO'/jQ?MtO<<JfO'/wQ?MvO1G2`O'1mQ?MvO,5?aO'3pQ?MvO,5?cO'5sQ?MvO1G2sO'7vQ?MvO1G2uO'9yQ?MtO<<KXO':WQ?MtO<<I{OOQO1G1w1G1wO!,TQMhOANAiOOQO7+*c7+*cO':eQ`O7+*cO':pQ`O<= hO':xQ!dO7+*eOOQ!0Lb<<Kq<<KqO$+YQ`O<<KqOCwQ`O<<KqO';SQ`O<<KqO!&zQMhO<<KqOOQ!0Lb<<Ko<<KoO!CUQpO<<KoO';_Q!dO<<KqOOQ!0Lb<<Kp<<KpO';iQ`O<<KqO!&zQMhO<<KqO$+YQ`O<<KpO';nQMjOANDcO';xQ!0MvO<<KtOOQO7+*r7+*rO9kQ`O7+*rO'<YQ`O<= qOOQ[G27rG27rO9uQ!0LrOG27rO@zQ`OG27rO!)[QlO1G5SO'<bQ`O7+,SO'<jQ`O1G2kO&=UQ`OANBQOOQ[ANBQANBQO!&zQMhOANBQO'<oQ`OANBQOOQ[ANBSANBSO9uQ!0LrOANBSO$%dQ`OANBSOOQO'#H_'#H_OOQO7+*q7+*qOOQ[G22wG22wOOQ[ANE^ANE^OOQ[ANE_ANE_OOQ[ANB]ANB]O'<wQ`OANB]OOQ[<<MW<<MWO!)[QlOAN?lOOQOG24yG24yO$AlQ!0MxOG24yO#(ZQ`OLD,qOOQ[LD,qLD,qO!&zQMhOLD,qO'<|Q!fOLD,qO'=TQ?MvO7+'zO'>yQ?MvO,5?aO'@|Q?MvO,5?cO'CPQ?MvO7+'|O'DuQMjOG27TOOQO<<M}<<M}OOQ!0LbANA]ANA]O$+YQ`OANA]OCwQ`OANA]O'EVQ!dOANA]OOQ!0LbANAZANAZO'E^Q`OANA]O!&zQMhOANA]O'EiQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N^<<N^OOQ[LD-^LD-^O9uQ!0LrOLD-^O'EsQ?MtO7+*nOOQO'#Gf'#GfOOQ[G27lG27lO&=UQ`OG27lO!&zQMhOG27lOOQ[G27nG27nO9uQ!0LrOG27nOOQ[G27wG27wO'E}Q?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#(ZQ`O!$(!]O!&zQMhO!$(!]O'FXQ!0MzOG27TOOQ!0LbG26wG26wO$+YQ`OG26wO'HjQ`OG26wOCwQ`OG26wO'HuQ!dOG26wO!&zQMhOG26wOOQ[!$(!x!$(!xOOQ[LD-WLD-WO&=UQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#(ZQ`O!)9EwOOQ!0LbLD,cLD,cO$+YQ`OLD,cOCwQ`OLD,cO'H|Q`OLD,cO'IXQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'I`Q?MvOG27TOOQ!0Lb!$( }!$( }O$+YQ`O!$( }OCwQ`O!$( }O'KUQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$+YQ`O!)9EiOCwQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$+YQ`O!.K;TOOQ!0Lb!4/0o!4/0oO!)[QlO'#DzO1PQ`O'#EXO'KaQ!fO'#JrO'KhQ!L^O'#DvO'KoQlO'#EOO'KvQ!fO'#CiO'N^Q!fO'#CiO!)[QlO'#EQO'NnQlO,5;ZO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO'#IpO(!qQ`O,5<iO!)[QlO,5;eO(!yQMhO,5;eO($dQMhO,5;eO!)[QlO,5;wO!&zQMhO'#GmO(!yQMhO'#GmO!&zQMhO'#GoO(!yQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&zQMhO'#GPO(!yQMhO'#GPO!&zQMhO'#GRO(!yQMhO'#GRO!&zQMhO'#GaO(!yQMhO'#GaO!)[QlO,5:jO($kQpO'#D_O($uQpO'#JvO!)[QlO,5@oO'NnQlO1G0uO(%PQ?MtO'#CiO!)[QlO1G2PO!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO(%ZQ!dO'#CrO!&zQMhO,5<tO(!yQMhO,5<tO'NnQlO1G2RO!)[QlO7+&zO!&zQMhO1G2`O(!yQMhO1G2`O!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO!&zQMhO1G2bO(!yQMhO1G2bO'NnQlO7+'mO'NnQlO7+&aO!&zQMhOANAiO(!yQMhOANAiO(%nQ`O'#EoO(%sQ`O'#EoO(%{Q`O'#F]O(&QQ`O'#EyO(&VQ`O'#KTO(&bQ`O'#KRO(&mQ`O,5;ZO(&rQMjO,5<eO(&yQ`O'#GYO('OQ`O'#GYO('TQ`O,5<eO(']Q`O,5<gO('eQ`O,5;ZO('mQ?MtO1G1`O('tQ`O,5<tO('yQ`O,5<tO((OQ`O,5<vO((TQ`O,5<vO((YQ`O1G2RO((_Q`O1G0uO((dQMjO<<K}O((kQMjO<<K}O((rQMhO'#F|O9`Q`O'#F{OAuQ`O'#EnO!)[QlO,5;tO!3oQ`O'#GYO!3oQ`O'#GYO!3oQ`O'#G[O!3oQ`O'#G[O!,TQMhO7+(cO!,TQMhO7+(cO%.zQ!dO1G2wO%.zQ!dO1G2wO!&zQMhO,5=]O!&zQMhO,5=]",stateData:"()x~O'|OS'}OSTOS(ORQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&W!WO&^!XO&`!YO&b!ZO&d![O&g!]O&m!^O&s!_O&u!`O&w!aO&y!bO&{!cO(TSO(VTO(YUO(aVO(o[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O(O!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'z]X(a]X(r]X(y]X(z]X~O!g%RX~P(qO_!}O(V#PO(W!}O(X#PO~O_#QO(X#PO(Y#PO(Z#QO~Ox#SO!U#TO(b#TO(c#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T<ZO(VTO(YUO(aVO(o[O~O![#ZO!]#WO!Y(hP!Y(vP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(VTO(YUO(aVO(o[O~Op#mO![#iO!|]O#i#lO#j#iO(T<[O!k(sP~P.iO!l#oO(T#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa(fX'z(fX'w(fX!k(fX!Y(fX!_(fX%i(fX!g(fX~P1qO#S$dO#`$eO$Q$eOP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX!_(gX%i(gX~Oa(gX'z(gX'w(gX!Y(gX!k(gXv(gX!g(gX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%dOk%dOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T$sO(VTO(YUO(a$uO(y$}O(z%POg(^P~Ol%[O~P7eO!l%eO~O!S%hO!_%iO(T%gO~O!g%mO~Oa%nO'z%nO~O!Q%rO~P%[O(U!lO~P%[O%n%vO~P%[Oh%VO!l%eO(T%gO(U!lO~Oe%}O!l%eO(T%gO~Oj$RO~O!_&PO(T%gO(U!lO(VTO(YUO`)WP~O!Q&SO!l&RO%j&VO&T&WO~P;SO!x#sO~O%s&YO!S)SX!_)SX(T)SX~O(T&ZO~Ol!PO!u&`O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&eOe&dO!x&bO%h&cO%{&aO~P<bOd&hOeyOl!PO!_&gO!u&`O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&kO#`&nO%j&iO(U!lO~P=gO!l&oO!u&sO~O!l#oO~O!_XO~Oa%nO'x&{O'z%nO~Oa%nO'x'OO'z%nO~Oa%nO'x'QO'z%nO~O'w]X!Y]Xv]X!k]X&[]X!_]X%i]X!g]X~P(qO!b'_O!c'WO!d'WO(U!lO(VTO(YUO~Os'UO!S'TO!['XO(e'SO!^(iP!^(xP~P@nOn'bO!_'`O(T%gO~Oe'gO!l%eO(T%gO~O!Q&SO!l&RO~Os!nO!S!oO!|<VO#T!pO#U!pO#W!pO#X!pO(U!lO(VTO(YUO(e!mO(o!sO~O!b'mO!c'lO!d'lO#V!pO#['nO#]'nO~PBYOa%nOh%VO!g#vO!l%eO'z%nO(r'pO~O!p'tO#`'rO~PChOs!nO!S!oO(VTO(YUO(e!mO(o!sO~O!_XOs(mX!S(mX!b(mX!c(mX!d(mX!|(mX#T(mX#U(mX#V(mX#W(mX#X(mX#[(mX#](mX(U(mX(V(mX(Y(mX(e(mX(o(mX~O!c'lO!d'lO(U!lO~PDWO(P'xO(Q'xO(R'zO~O_!}O(V'|O(W!}O(X'|O~O_#QO(X'|O(Y'|O(Z#QO~Ov(OO~P%[Ox#SO!U#TO(b#TO(c(RO~O![(TO!Y'WX!Y'^X!]'WX!]'^X~P+}O!](VO!Y(hX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](VO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~O!Y(hX~PHRO!Y([O~O!Y(uX!](uX!g(uX!k(uX(r(uX~O#`(uX#k#dX!^(uX~PJUO#`(]O!Y(wX!](wX~O!](^O!Y(vX~O!Y(aO~O#`$eO~PJUO!^(bO~P`OR#zO!Q#yO!S#{O!l#xO(aVOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(r!na(y!na(z!na~Oa!na'z!na'w!na!Y!na!k!nav!na!_!na%i!na!g!na~PKlO!k(cO~O!g#vO#`(dO(r'pO!](tXa(tX'z(tX~O!k(tX~PNXO!S%hO!_%iO!|]O#i(iO#j(hO(T%gO~O!](jO!k(sX~O!k(lO~O!S%hO!_%iO#j(hO(T%gO~OP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~O!g#vO!k(gX~P! uOR(nO!Q(mO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(T!{a~P!#vO!x(rO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~O#k(xO~O![(zO!k(kP~P%[O(e(|O(o[O~O!S)OO!l#xO(e(|O(o[O~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]$_Oa$qa'z$qa'w$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)dO~P!&zOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Og(pP~P!,TO!Q)iO!g)hO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)hO!_({X$Z({X$]({X$_({X$f({X~O!Q)iO~P!.^O!Q)iO!_({X$Z({X$]({X$_({X$f({X~O!_)kO$Z)oO$])jO$_)jO$f)pO~O![)sO~P!)[O$]$hO$_$gO$f)wO~On$zX!Q$zX#S$zX'y$zX(y$zX(z$zX~OgmXg$zXnmX!]mX#`mX~P!0SOx)yO(b)zO(c)|O~On*VO!Q*OO'y*PO(y$}O(z%PO~Og)}O~P!1WOg*WO~Oh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S*YO!_*ZO!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op*`O![*^O(T*XO!k)OP~P!1uO#k*aO~O!l*bO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T*dO(VTO(YUO(a$uO(y$}O(z%PO~O![*gO!Y)PP~P!3tOr*sOs!nO!S*iO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO(e!mO~O!^*pO~P!5iO#S$dOn(`X!Q(`X'y(`X(y(`X(z(`X!](`X#`(`X~Og(`X$O(`X~P!6kOn*xO#`*wOg(_X!](_X~O!]*yOg(^X~Oj%dOk%dOl%dO(T&ZOg(^P~Os*|O~Og)}O(T&ZO~O!l+SO~O(T(vO~Op+WO!S%hO![#iO!_%iO!|]O#i#lO#j#iO(T%gO!k(sP~O!g#vO#k+XO~O!S%hO![+ZO!](^O!_%iO(T%gO!Y(vP~Os'[O!S+]O![+[O(VTO(YUO(e(|O~O!^(xP~P!9|O!]+^Oa)TX'z)TX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa!ja!]!ja'z!ja'w!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:tOR#zO!Q#yO!S#{O!l#xO(aVOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(r!ra(y!ra(z!ra~Oa!ra'z!ra'w!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!=[OR#zO!Q#yO!S#{O!l#xO(aVOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(r!ta(y!ta(z!ta~Oa!ta'z!ta'w!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?rOh%VOn+gO!_'`O%i+fO~O!g+iOa(]X!_(]X'z(]X!](]X~Oa%nO!_XO'z%nO~Oh%VO!l%eO~Oh%VO!l%eO(T%gO~O!g#vO#k(xO~Ob+tO%j+uO(T+qO(VTO(YUO!^)XP~O!]+vO`)WX~O[+zO~O`+{O~O!_&PO(T%gO(U!lO`)WP~O%j,OO~P;SOh%VO#`,SO~Oh%VOn,VO!_$|O~O!_,XO~O!Q,ZO!_XO~O%n%vO~O!x,`O~Oe,eO~Ob,fO(T#nO(VTO(YUO!^)VP~Oe%}O~O%j!QO(T&ZO~P=gO[,kO`,jO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(VTO(YUO(aVO(o[O~O!_!eO!u!gO$W!kO(T!dO~P!FyO`,jOa%nO'z%nO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa,pOl!OO!uwO%l!OO%m!OO%n!OO~P!IcO!l&oO~O&^,vO~O!_,xO~O&o,zO&q,{OP&laQ&laS&laY&laa&lad&lae&lal&lap&lar&las&lat&laz&la|&la!O&la!S&la!W&la!X&la!_&la!i&la!l&la!o&la!p&la!q&la!s&la!u&la!x&la!|&la$W&la$n&la%h&la%j&la%l&la%m&la%n&la%q&la%s&la%v&la%w&la%y&la&W&la&^&la&`&la&b&la&d&la&g&la&m&la&s&la&u&la&w&la&y&la&{&la'w&la(T&la(V&la(Y&la(a&la(o&la!^&la&e&lab&la&j&la~O(T-QO~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P#!iO!g-VO#`-UOh(jX!]#hX!^#hX!g(jX!l(jX~O!](jX!^(jX~P##[Oh%VO!g-XO!l%eO!]!aX!^!aX~Os!nO!S!oO(VTO(YUO(e!mO~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(VTO(YUO(aVO(o[O~O(T=QO~P#$qO!]-]O!^(iX~O!^-_O~O!g-VO#`-UO!]#hX!^#hX~O!]-`O!^(xX~O!^-bO~O!c-cO!d-cO(U!lO~P#$`O!^-fO~P'_On-iO!_'`O~O!Y-nO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(U!{a(V!{a(Y!{a(e!{a(o!{a~P!#vO!p-sO#`-qO~PChO!c-uO!d-uO(U!lO~PDWOa%nO#`-qO'z%nO~Oa%nO!g#vO#`-qO'z%nO~Oa%nO!g#vO!p-sO#`-qO'z%nO(r'pO~O(P'xO(Q'xO(R-zO~Ov-{O~O!Y'Wa!]'Wa~P!:tO![.PO!Y'WX!]'WX~P%[O!](VO!Y(ha~O!Y(ha~PHRO!](^O!Y(va~O!S%hO![.TO!_%iO(T%gO!Y'^X!]'^X~O#`.VO!](ta!k(taa(ta'z(ta~O!g#vO~P#,wO!](jO!k(sa~O!S%hO!_%iO#j.ZO(T%gO~Op.`O!S%hO![.]O!_%iO!|]O#i._O#j.]O(T%gO!]'aX!k'aX~OR.dO!l#xO~Oh%VOn.gO!_'`O%i.fO~Oa#ci!]#ci'z#ci'w#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:tOn>]O!Q*OO'y*PO(y$}O(z%PO~O#k#_aa#_a#`#_a'z#_a!]#_a!k#_a!_#_a!Y#_a~P#/sO#k(`XP(`XR(`X[(`Xa(`Xj(`Xr(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X'z(`X(a(`X(r(`X!k(`X!Y(`X'w(`Xv(`X!_(`X%i(`X!g(`X~P!6kO!].tO!k(kX~P!:tO!k.wO~O!Y.yO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#3cO#n$OO~P#3cOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#6QO#r$QO~P#6QOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(aVOa#mi!]#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(aVO(z#}Oa#mi!]#mi#z#mi#{#mi'z#mi(r#mi(y#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#;VO#x#mi~P#;VO#v$SO~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(aVO(y#|O(z#}Oa#mi!]#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#={O#z$WO~P#={OP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X!]]X!^]X~O$O]X~P#@jOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO#z<gO#{<hO(aVO(r$YO(y#|O(z#}O~O$O.{O~P#BwO#S$dO#`<nO$Q<nO$O(gX!^(gX~P! uOa'da!]'da'z'da'w'da!k'da!Y'dav'da!_'da%i'da!g'da~P!:tO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO(y#mi(z#mi~P#EyOn>]O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P#EyO!]/POg(pX~P!1WOg/RO~Oa$Pi!]$Pi'z$Pi'w$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:tO$]/SO$_/SO~O$]/TO$_/TO~O!g)hO#`/UO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/VO~O!_)kO$Z/XO$])jO$_)jO$f/YO~O!]<iO!^(fX~P#BwO!^/ZO~O!g)hO$f({X~O$f/]O~Ov/^O~P!&zOx)yO(b)zO(c/aO~O!S/dO~O(y$}On%aa!Q%aa'y%aa(z%aa!]%aa#`%aa~Og%aa$O%aa~P#L{O(z%POn%ca!Q%ca'y%ca(y%ca!]%ca#`%ca~Og%ca$O%ca~P#MnO!]fX!gfX!kfX!k$zX(rfX~P!0SOp%WO![/mO!](^O(T/lO!Y(vP!Y)PP~P!1uOr*sO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO~Os<}O!S/nO![+[O!^*pO(e<|O!^(xP~P$ [O!k/oO~P#/sO!]/pO!g#vO(r'pO!k)OX~O!k/uO~OnoX!QoX'yoX(yoX(zoX~O!g#vO!koX~P$#OOp/wO!S%hO![*^O!_%iO(T%gO!k)OP~O#k/xO~O!Y$zX!]$zX!g%RX~P!0SO!]/yO!Y)PX~P#/sO!g/{O~O!Y/}O~OpkO(T0OO~P.iOh%VOr0TO!g#vO!l%eO(r'pO~O!g+iO~Oa%nO!]0XO'z%nO~O!^0ZO~P!5iO!c0[O!d0[O(U!lO~P#$`Os!nO!S0]O(VTO(YUO(e!mO~O#[0_O~Og%aa!]%aa#`%aa$O%aa~P!1WOg%ca!]%ca#`%ca$O%ca~P!1WOj%dOk%dOl%dO(T&ZOg'mX!]'mX~O!]*yOg(^a~Og0hO~On0jO#`0iOg(_a!](_a~OR0kO!Q0kO!S0lO#S$dOn}a'y}a(y}a(z}a!]}a#`}a~Og}a$O}a~P$(cO!Q*OO'y*POn$sa(y$sa(z$sa!]$sa#`$sa~Og$sa$O$sa~P$)_O!Q*OO'y*POn$ua(y$ua(z$ua!]$ua#`$ua~Og$ua$O$ua~P$*QO#k0oO~Og%Ta!]%Ta#`%Ta$O%Ta~P!1WO!g#vO~O#k0rO~O!]+^Oa)Ta'z)Ta~OR#zO!Q#yO!S#{O!l#xO(aVOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(r!ri(y!ri(z!ri~Oa!ri'z!ri'w!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$+oOh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op0{O%]0|O(T0zO~P$.VO!g+iOa(]a!_(]a'z(]a!](]a~O#k1SO~O[]X!]fX!^fX~O!]1TO!^)XX~O!^1VO~O[1WO~Ob1YO(T+qO(VTO(YUO~O!_&PO(T%gO`'uX!]'uX~O!]+vO`)Wa~O!k1]O~P!:tO[1`O~O`1aO~O#`1fO~On1iO!_$|O~O(e(|O!^)UP~Oh%VOn1rO!_1oO%i1qO~O[1|O!]1zO!^)VX~O!^1}O~O`2POa%nO'z%nO~O(T#nO(VTO(YUO~O#S$dO#`$eO$Q$eOP(gXR(gX[(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~Oj2SO&[2TOa(gX~P$3pOj2SO#`$eO&[2TO~Oa2VO~P%[Oa2XO~O&e2[OP&ciQ&ciS&ciY&cia&cid&cie&cil&cip&cir&cis&cit&ciz&ci|&ci!O&ci!S&ci!W&ci!X&ci!_&ci!i&ci!l&ci!o&ci!p&ci!q&ci!s&ci!u&ci!x&ci!|&ci$W&ci$n&ci%h&ci%j&ci%l&ci%m&ci%n&ci%q&ci%s&ci%v&ci%w&ci%y&ci&W&ci&^&ci&`&ci&b&ci&d&ci&g&ci&m&ci&s&ci&u&ci&w&ci&y&ci&{&ci'w&ci(T&ci(V&ci(Y&ci(a&ci(o&ci!^&cib&ci&j&ci~Ob2bO!^2`O&j2aO~P`O!_XO!l2dO~O&q,{OP&liQ&liS&liY&lia&lid&lie&lil&lip&lir&lis&lit&liz&li|&li!O&li!S&li!W&li!X&li!_&li!i&li!l&li!o&li!p&li!q&li!s&li!u&li!x&li!|&li$W&li$n&li%h&li%j&li%l&li%m&li%n&li%q&li%s&li%v&li%w&li%y&li&W&li&^&li&`&li&b&li&d&li&g&li&m&li&s&li&u&li&w&li&y&li&{&li'w&li(T&li(V&li(Y&li(a&li(o&li!^&li&e&lib&li&j&li~O!Y2jO~O!]!aa!^!aa~P#BwOs!nO!S!oO![2pO(e!mO!]'XX!^'XX~P@nO!]-]O!^(ia~O!]'_X!^'_X~P!9|O!]-`O!^(xa~O!^2wO~P'_Oa%nO#`3QO'z%nO~Oa%nO!g#vO#`3QO'z%nO~Oa%nO!g#vO!p3UO#`3QO'z%nO(r'pO~Oa%nO'z%nO~P!:tO!]$_Ov$qa~O!Y'Wi!]'Wi~P!:tO!](VO!Y(hi~O!](^O!Y(vi~O!Y(wi!](wi~P!:tO!](ti!k(tia(ti'z(ti~P!:tO#`3WO!](ti!k(tia(ti'z(ti~O!](jO!k(si~O!S%hO!_%iO!|]O#i3]O#j3[O(T%gO~O!S%hO!_%iO#j3[O(T%gO~On3dO!_'`O%i3cO~Oh%VOn3dO!_'`O%i3cO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aav%aa!_%aa%i%aa!g%aa~P#L{O#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%cav%ca!_%ca%i%ca!g%ca~P#MnO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/sO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/sO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'z}a(a}a(r}a!k}a!Y}a'w}av}a!_}a%i}a!g}a~P$(cO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'z$sa(a$sa(r$sa!k$sa!Y$sa'w$sav$sa!_$sa%i$sa!g$sa~P$)_O#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'z$ua(a$ua(r$ua!k$ua!Y$ua'w$uav$ua!_$ua%i$ua!g$ua~P$*QO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'z%Ta(a%Ta(r%Ta!k%Ta!Y%Ta'w%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/sOa#cq!]#cq'z#cq'w#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:tO![3lO!]'YX!k'YX~P%[O!].tO!k(ka~O!].tO!k(ka~P!:tO!Y3oO~O$O!na!^!na~PKlO$O!ja!]!ja!^!ja~P#BwO$O!ra!^!ra~P!=[O$O!ta!^!ta~P!?rOg']X!]']X~P!,TO!]/POg(pa~OSfO!_4TO$d4UO~O!^4YO~Ov4ZO~P#/sOa$mq!]$mq'z$mq'w$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:tO!Y4]O~P!&zO!S4^O~O!Q*OO'y*PO(z%POn'ia(y'ia!]'ia#`'ia~Og'ia$O'ia~P%-fO!Q*OO'y*POn'ka(y'ka(z'ka!]'ka#`'ka~Og'ka$O'ka~P%.XO(r$YO~P#/sO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!0SOp%WO(T=WO~P!1uOp4bO!S%hO![4aO!_%iO(T%gO!]'eX!k'eX~O!]/pO!k)Oa~O!]/pO!g#vO!k)Oa~O!]/pO!g#vO(r'pO!k)Oa~Og$|i!]$|i#`$|i$O$|i~P!1WO![4jO!Y'gX!]'gX~P!3tO!]/yO!Y)Pa~O!]/yO!Y)Pa~P#/sOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~Oj%YX!g%YX~P%2OOj4oO!g#vO~Oh%VO!g#vO!l%eO~Oh%VOr4tO!l%eO(r'pO~Or4yO!g#vO(r'pO~Os!nO!S4zO(VTO(YUO(e!mO~O(y$}On%ai!Q%ai'y%ai(z%ai!]%ai#`%ai~Og%ai$O%ai~P%5oO(z%POn%ci!Q%ci'y%ci(y%ci!]%ci#`%ci~Og%ci$O%ci~P%6bOg(_i!](_i~P!1WO#`5QOg(_i!](_i~P!1WO!k5VO~Oa$oq!]$oq'z$oq'w$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:tO!Y5ZO~O!]5[O!_)QX~P#/sOa$zX!_$zX%^]X'z$zX!]$zX~P!0SO%^5_OaoX!_oX'zoX!]oX~P$#OOp5`O(T#nO~O%^5_O~Ob5fO%j5gO(T+qO(VTO(YUO!]'tX!^'tX~O!]1TO!^)Xa~O[5kO~O`5lO~O[5pO~Oa%nO'z%nO~P#/sO!]5uO#`5wO!^)UX~O!^5xO~Or6OOs!nO!S*iO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!pO#W!pO#X!pO#[5}O#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O!^5|O~P%;eOn6TO!_1oO%i6SO~Oh%VOn6TO!_1oO%i6SO~Ob6[O(T#nO(VTO(YUO!]'sX!^'sX~O!]1zO!^)Va~O(VTO(YUO(e6^O~O`6bO~Oj6eO&[6fO~PNXO!k6gO~P%[Oa6iO~Oa6iO~P%[Ob2bO!^6nO&j2aO~P`O!g6pO~O!g6rOh(ji!](ji!^(ji!g(ji!l(jir(ji(r(ji~O!]#hi!^#hi~P#BwO#`6sO!]#hi!^#hi~O!]!ai!^!ai~P#BwOa%nO#`6|O'z%nO~Oa%nO!g#vO#`6|O'z%nO~O!](tq!k(tqa(tq'z(tq~P!:tO!](jO!k(sq~O!S%hO!_%iO#j7TO(T%gO~O!_'`O%i7WO~On7[O!_'`O%i7WO~O#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'z'ia(a'ia(r'ia!k'ia!Y'ia'w'iav'ia!_'ia%i'ia!g'ia~P%-fO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'z'ka(a'ka(r'ka!k'ka!Y'ka'w'kav'ka!_'ka%i'ka!g'ka~P%.XO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'z$|i(a$|i(r$|i!k$|i!Y$|i'w$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/sO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'z%ai(a%ai(r%ai!k%ai!Y%ai'w%aiv%ai!_%ai%i%ai!g%ai~P%5oO#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'z%ci(a%ci(r%ci!k%ci!Y%ci'w%civ%ci!_%ci%i%ci!g%ci~P%6bO!]'Ya!k'Ya~P!:tO!].tO!k(ki~O$O#ci!]#ci!^#ci~P#BwOP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#n#mi~P%NdO#n<_O~P%NdOP$[OR#zOr<kO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#r#mi~P&!lO#r<aO~P&!lOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO(aVO#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#v#mi~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO(aVO(z#}O#z#mi#{#mi$O#mi(r#mi(y#mi!]#mi!^#mi~O#x<eO~P&&uO#x#mi~P&&uO#v<cO~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO(aVO(y#|O(z#}O#{#mi$O#mi(r#mi!]#mi!^#mi~O#z#mi~P&)UO#z<gO~P&)UOa#|y!]#|y'z#|y'w#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:tO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO(y#mi(z#mi~P&,QOn>^O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P&,QO#S$dOP(`XR(`X[(`Xj(`Xn(`Xr(`X!Q(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X$O(`X'y(`X(a(`X(r(`X(y(`X(z(`X!](`X!^(`X~O$O$Pi!]$Pi!^$Pi~P#BwO$O!ri!^!ri~P$+oOg']a!]']a~P!1WO!^7nO~O!]'da!^'da~P#BwO!Y7oO~P#/sO!g#vO(r'pO!]'ea!k'ea~O!]/pO!k)Oi~O!]/pO!g#vO!k)Oi~Og$|q!]$|q#`$|q$O$|q~P!1WO!Y'ga!]'ga~P#/sO!g7vO~O!]/yO!Y)Pi~P#/sO!]/yO!Y)Pi~O!Y7yO~Oh%VOr8OO!l%eO(r'pO~Oj8QO!g#vO~Or8TO!g#vO(r'pO~O!Q*OO'y*PO(z%POn'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P&5RO!Q*OO'y*POn'la(y'la(z'la!]'la#`'la~Og'la$O'la~P&5tOg(_q!](_q~P!1WO#`8VOg(_q!](_q~P!1WO!Y8WO~Og%Oq!]%Oq#`%Oq$O%Oq~P!1WOa$oy!]$oy'z$oy'w$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:tO!g6rO~O!]5[O!_)Qa~O!_'`OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(a$Ta(r$Ta(y$Ta(z$Ta~O%i7WO~P&8fO%^8[Oa%[i!_%[i'z%[i!]%[i~Oa#cy!]#cy'z#cy'w#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:tO[8^O~Ob8`O(T+qO(VTO(YUO~O!]1TO!^)Xi~O`8dO~O(e(|O!]'pX!^'pX~O!]5uO!^)Ua~O!^8nO~P%;eO(o!sO~P$&YO#[8oO~O!_1oO~O!_1oO%i8qO~On8tO!_1oO%i8qO~O[8yO!]'sa!^'sa~O!]1zO!^)Vi~O!k8}O~O!k9OO~O!k9RO~O!k9RO~P%[Oa9TO~O!g9UO~O!k9VO~O!](wi!^(wi~P#BwOa%nO#`9_O'z%nO~O!](ty!k(tya(ty'z(ty~P!:tO!](jO!k(sy~O%i9bO~P&8fO!_'`O%i9bO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'z$|q(a$|q(r$|q!k$|q!Y$|q'w$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/sO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'z'ja(a'ja(r'ja!k'ja!Y'ja'w'jav'ja!_'ja%i'ja!g'ja~P&5RO#k'laP'laR'la['laa'laj'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la'z'la(a'la(r'la!k'la!Y'la'w'lav'la!_'la%i'la!g'la~P&5tO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'z%Oq(a%Oq(r%Oq!k%Oq!Y%Oq'w%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/sO!]'Yi!k'Yi~P!:tO$O#cq!]#cq!^#cq~P#BwO(y$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(a%aa(r%aa!]%aa!^%aa~On%aa!Q%aa'y%aa(z%aa~P&IyO(z%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(a%ca(r%ca!]%ca!^%ca~On%ca!Q%ca'y%ca(y%ca~P&LQOn>^O!Q*OO'y*PO(z%PO~P&IyOn>^O!Q*OO'y*PO(y$}O~P&LQOR0kO!Q0kO!S0lO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'y}a(a}a(r}a(y}a(z}a!]}a!^}a~O!Q*OO'y*POP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(a$sa(r$sa(y$sa(z$sa!]$sa!^$sa~O!Q*OO'y*POP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(a$ua(r$ua(y$ua(z$ua!]$ua!^$ua~On>^O!Q*OO'y*PO(y$}O(z%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(a%Ta(r%Ta!]%Ta!^%Ta~P''VO$O$mq!]$mq!^$mq~P#BwO$O$oq!]$oq!^$oq~P#BwO!^9oO~O$O9pO~P!1WO!g#vO!]'ei!k'ei~O!g#vO(r'pO!]'ei!k'ei~O!]/pO!k)Oq~O!Y'gi!]'gi~P#/sO!]/yO!Y)Pq~Or9wO!g#vO(r'pO~O[9yO!Y9xO~P#/sO!Y9xO~Oj:PO!g#vO~Og(_y!](_y~P!1WO!]'na!_'na~P#/sOa%[q!_%[q'z%[q!]%[q~P#/sO[:UO~O!]1TO!^)Xq~O`:YO~O#`:ZO!]'pa!^'pa~O!]5uO!^)Ui~P#BwO!S:]O~O!_1oO%i:`O~O(VTO(YUO(e:eO~O!]1zO!^)Vq~O!k:hO~O!k:iO~O!k:jO~O!k:jO~P%[O#`:mO!]#hy!^#hy~O!]#hy!^#hy~P#BwO%i:rO~P&8fO!_'`O%i:rO~O$O#|y!]#|y!^#|y~P#BwOP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(a$|i(r$|i!]$|i!^$|i~P''VO!Q*OO'y*PO(z%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(a'ia(r'ia(y'ia!]'ia!^'ia~O!Q*OO'y*POP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(a'ka(r'ka(y'ka(z'ka!]'ka!^'ka~O(y$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'y%ai(a%ai(r%ai(z%ai!]%ai!^%ai~O(z%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'y%ci(a%ci(r%ci(y%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#BwO$O#cy!]#cy!^#cy~P#BwO!g#vO!]'eq!k'eq~O!]/pO!k)Oy~O!Y'gq!]'gq~P#/sOr:|O!g#vO(r'pO~O[;QO!Y;PO~P#/sO!Y;PO~Og(_!R!](_!R~P!1WOa%[y!_%[y'z%[y!]%[y~P#/sO!]1TO!^)Xy~O!]5uO!^)Uq~O(T;XO~O!_1oO%i;[O~O!k;_O~O%i;dO~P&8fOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(a$|q(r$|q!]$|q!^$|q~P''VO!Q*OO'y*PO(z%POP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(a'ja(r'ja(y'ja!]'ja!^'ja~O!Q*OO'y*POP'laR'la['laj'lan'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la$O'la(a'la(r'la(y'la(z'la!]'la!^'la~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(a%Oq(r%Oq!]%Oq!^%Oq~P''VOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!1WO!Y;hO~P#/sOr;iO!g#vO(r'pO~O[;kO!Y;hO~P#/sO!]'pq!^'pq~P#BwO!]#h!Z!^#h!Z~P#BwO#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'z%e!Z(a%e!Z(r%e!Z!k%e!Z!Y%e!Z'w%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/sOr;tO!g#vO(r'pO~O!Y;uO~P#/sOr;|O!g#vO(r'pO~O!Y;}O~P#/sOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(a%e!Z(r%e!Z!]%e!Z!^%e!Z~P''VOr<QO!g#vO(r'pO~Ov(fX~P1qO!Q%rO~P!)[O(U!lO~P!)[O!YfX!]fX#`fX~P%2OOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~O!gfX!k]X!kfX(rfX~P'LTOP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_XO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]<iO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<tO!S${O!_$|O!i>WO!l$xO#j<zO$W%`O$t<vO$v<xO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Ol)dO~P(!yOr!eX(r!eX~P#!iOr(jX(r(jX~P##[O!^]X!^fX~P'LTO!YfX!Y$zX!]fX!]$zX#`fX~P!0SO#k<^O~O!g#vO#k<^O~O#`<nO~Oj<bO~O#`=OO!](wX!^(wX~O#`<nO!](uX!^(uX~O#k=PO~Og=RO~P!1WO#k=XO~O#k=YO~Og=RO(T&ZO~O!g#vO#k=ZO~O!g#vO#k=PO~O$O=[O~P#BwO#k=]O~O#k=^O~O#k=cO~O#k=dO~O#k=eO~O#k=fO~O$O=gO~P!1WO$O=hO~P!1WOl=sO~P7eOk#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~(OT#o!X'|(U#ps#n#qr!Q'}$]'}(T$_(e~",goto:"$9Y)]PPPPPP)^PP)aP)rP+W/]PPPP6mPP7TPP=QPPP@tPA^PA^PPPA^PCfPA^PA^PA^PCjPCoPD^PIWPPPI[PPPPI[L_PPPLeMVPI[PI[PP! eI[PPPI[PI[P!#lI[P!'S!(X!(bP!)U!)Y!)U!,gPPPPPPP!-W!(XPP!-h!/YP!2iI[I[!2n!5z!:h!:h!>gPPP!>oI[PPPPPPPPP!BOP!C]PPI[!DnPI[PI[I[I[I[I[PI[!FQP!I[P!LbP!Lf!Lp!Lt!LtP!IXP!Lx!LxP#!OP#!SI[PI[#!Y#%_CjA^PA^PA^A^P#&lA^A^#)OA^#+vA^#.SA^A^#.r#1W#1W#1]#1f#1W#1qPP#1WPA^#2ZA^#6YA^A^6mPPP#:_PPP#:x#:xP#:xP#;`#:xPP#;fP#;]P#;]#;y#;]#<e#<k#<n)aP#<q)aP#<z#<z#<zP)aP)aP)aP)aPP)aP#=Q#=TP#=T)aP#=XP#=[P)aP)aP)aP)aP)aP)a)aPP#=b#=h#=s#=y#>P#>V#>]#>k#>q#>{#?R#?]#?c#?s#?y#@k#@}#AT#AZ#Ai#BO#Cs#DR#DY#Et#FS#Gt#HS#HY#H`#Hf#Hp#Hv#H|#IW#Ij#IpPPPPPPPPPPP#IvPPPPPPP#Jk#Mx$ b$ i$ qPPP$']P$'f$*_$0x$0{$1O$1}$2Q$2X$2aP$2g$2jP$3W$3[$4S$5b$5g$5}PP$6S$6Y$6^$6a$6e$6i$7e$7|$8e$8i$8l$8o$8y$8|$9Q$9UR!|RoqOXst!Z#d%m&r&t&u&w,s,x2[2_Y!vQ'`-e1o5{Q%tvQ%|yQ&T|Q&j!VS'W!e-]Q'f!iS'l!r!yU*k$|*Z*oQ+o%}S+|&V&WQ,d&dQ-c'_Q-m'gQ-u'mQ0[*qQ1b,OQ1y,eR<{<Y%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_S#q]<V!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU+P%]<s<tQ+t&PQ,f&gQ,m&oQ0x+gQ0}+iQ1Y+uQ2R,kQ3`.gQ5`0|Q5f1TQ6[1zQ7Y3dQ8`5gR9e7['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S!S!nQ!r!v!y!z$|'W'_'`'l'm'n*k*o*q*r-]-c-e-u0[0_1o5{5}%[$ti#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q&X|Q'U!eS'[%i-`Q+t&PQ,P&WQ,f&gQ0n+SQ1Y+uQ1_+{Q2Q,jQ2R,kQ5f1TQ5o1aQ6[1zQ6_1|Q6`2PQ8`5gQ8c5lQ8|6bQ:X8dQ:f8yQ;V:YR<}*ZrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R,h&k&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'b'r(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>R>S[#]WZ#W#Z'X(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ%wxQ%{yW&Q|&V&W,OQ&_!TQ'c!hQ'e!iQ(q#sS+n%|%}Q+r&PQ,_&bQ,c&dS-l'f'gQ.i(rQ1R+oQ1X+uQ1Z+vQ1^+zQ1t,`S1x,d,eQ2|-mQ5e1TQ5i1WQ5n1`Q6Z1yQ8_5gQ8b5kQ8f5pQ:T8^R;T:U!U$zi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y!^%yy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{Q+h%wQ,T&[Q,W&]Q,b&dQ.h(qQ1s,_U1w,c,d,eQ3e.iQ6U1tS6Y1x1yQ8x6Z#f>T#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o>U<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hW%Ti%V*y>PS&[!Q&iQ&]!RQ&^!SU*}%[%d=sR,R&Y%]%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^T)z$u){V+P%]<s<tW'[!e%i*Z-`S(}#y#zQ+c%rQ+y&SS.b(m(nQ1j,XQ5T0kR8i5u'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S$i$^c#Y#e%q%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.|.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ'Y!eR2q-]!W!nQ!e!r!v!y!z$|'W'_'`'l'm'n*Z*k*o*q*r-]-c-e-u0[0_1o5{5}R1l,ZnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&y!^Q'v!xS(s#u<^Q+l%zQ,]&_Q,^&aQ-j'dQ-w'oS.r(x=PS0q+X=ZQ1P+mQ1n,[Q2c,zQ2e,{Q2m-WQ2z-kQ2}-oS5Y0r=eQ5a1QS5d1S=fQ6t2oQ6x2{Q6}3SQ8]5bQ9Y6vQ9Z6yQ9^7OR:l9V$d$]c#Y#e%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vS(o#p'iQ)P#zS+b%q.|S.c(n(pR3^.d'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS#q]<VQ&t!XQ&u!YQ&w![Q&x!]R2Z,vQ'a!hQ+e%wQ-h'cS.e(q+hQ2x-gW3b.h.i0w0yQ6w2yW7U3_3a3e5^U9a7V7X7ZU:q9c9d9fS;b:p:sQ;p;cR;x;qU!wQ'`-eT5y1o5{!Q_OXZ`st!V!Z#d#h%e%m&i&k&r&t&u&w(j,s,x.[2[2_]!pQ!r'`-e1o5{T#q]<V%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S(}#y#zS.b(m(n!s=l$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU$fd)_,mS(p#p'iU*v%R(w4OU0m+O.n7gQ5^0xQ7V3`Q9d7YR:s9em!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}Q't!uS(f#g2US-s'k'wQ/s*]Q0R*jQ3U-vQ4f/tQ4r0TQ4s0UQ4x0^Q7r4`S7}4t4vS8R4y4{Q9r7sQ9v7yQ9{8OQ:Q8TS:{9w9xS;g:|;PS;s;h;iS;{;t;uS<P;|;}R<S<QQ#wbQ's!uS(e#g2US(g#m+WQ+Y%fQ+j%xQ+p&OU-r'k't'wQ.W(fU/r*]*`/wQ0S*jQ0V*lQ1O+kQ1u,aS3R-s-vQ3Z.`S4e/s/tQ4n0PS4q0R0^Q4u0WQ6W1vQ7P3US7q4`4bQ7u4fU7|4r4x4{Q8P4wQ8v6XS9q7r7sQ9u7yQ9}8RQ:O8SQ:c8wQ:y9rS:z9v9xQ;S:QQ;^:dS;f:{;PS;r;g;hS;z;s;uS<O;{;}Q<R<PQ<T<SQ=o=jQ={=tR=|=uV!wQ'`-e%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S#wz!j!r=i$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=o>R%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Q%fj!^%xy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{S&Oz!jQ+k%yQ,a&dW1v,b,c,d,eU6X1w1x1yS8w6Y6ZQ:d8x!r=j$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ=t>QR=u>R%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Y#bWZ#W#Z(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ,n&o!p=k$Z$n)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=n'XU']!e%i*ZR2s-`%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ,m&oQ0x+gQ3`.gQ7Y3dR9e7[!b$Tc#Y%q(S(Y(t(y)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!P<d)^)q-Z.|2k2n3p3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!f$Vc#Y%q(S(Y(t(y)W)X)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!T<f)^)q-Z.|2k2n3p3v3w3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!^$Zc#Y%q(S(Y(t(y)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<WQ4_/kz>S)^)q-Z.|2k2n3p4P4X6u7b7k7l8k9X9g9m9n;W;`=vQ>X>ZR>Y>['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS$oh$pR4U/U'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$kf$qQ$ifS)j$l)nR)v$qT$jf$qT)l$l)n'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$oh$pQ$rhR)u$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_!s>Q$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S#glOPXZst!Z!`!o#S#d#o#{$n%m&k&n&o&r&t&u&w&{'T'b)O)s*i+]+g,p,s,x-i.g/V/n0]0l1r2S2T2V2X2[2_2a3d4T4z6T6e6f6i7[8t9T!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^Q+T%aQ/c*Oo4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!U$yi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>YQ*c$zU*l$|*Z*oQ+U%bQ0W*m#f=q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n=r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hQ=w>TQ=x>UQ=y>VR=z>W!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hnoOXst!Z#d%m&r&t&u&w,s,x2[2_S*f${*YQ-R'OQ-S'QR4i/y%[%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q,U&]Q1h,WQ5s1gR8h5tV*n$|*Z*oU*n$|*Z*oT5z1o5{S0P*i/nQ4w0]T8S4z:]Q+j%xQ0V*lQ1O+kQ1u,aQ6W1vQ8v6XQ:c8wR;^:d!U%Oi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Yx*R$v)e*S*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>OS0`*t0a#f<o#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<p<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!d=S(u)c*[*e.j.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[`=T3}7c7f7j9h:t:w;yS=_.l3iT=`7e9k!U%Qi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y|*T$v)e*U*t+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>OS0b*u0c#f<q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!h=U(u)c*[*e.k.l.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[d=V3}7d7e7j9h9i:t:u:w;yS=a.m3jT=b7f9lrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q&f!UR,p&ornOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R&f!UQ,Y&^R1d,RsnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q1p,_S6R1s1tU8p6P6Q6US:_8r8sS;Y:^:aQ;m;ZR;w;nQ&m!VR,i&iR6_1|R:f8yW&Q|&V&W,OR1Z+vQ&r!WR,s&sR,y&xT2],x2_R,}&yQ,|&yR2f,}Q'y!{R-y'ySsOtQ#dXT%ps#dQ#OTR'{#OQ#RUR'}#RQ){$uR/`){Q#UVR(Q#UQ#XWU(W#X(X.QQ(X#YR.Q(YQ-^'YR2r-^Q.u(yS3m.u3nR3n.vQ-e'`R2v-eY!rQ'`-e1o5{R'j!rQ/Q)eR4S/QU#_W%h*YU(_#_(`.RQ(`#`R.R(ZQ-a']R2t-at`OXst!V!Z#d%m&i&k&r&t&u&w,s,x2[2_S#hZ%eU#r`#h.[R.[(jQ(k#jQ.X(gW.a(k.X3X7RQ3X.YR7R3YQ)n$lR/W)nQ$phR)t$pQ$`cU)a$`-|<jQ-|<WR<j)qQ/q*]W4c/q4d7t9sU4d/r/s/tS7t4e4fR9s7u$e*Q$v(u)c)e*[*e*t*u+Q+R+V.l.m.o.p.q/_/g/i/k/v/|0d0e0v1e3f3g3h3}4R4[4g4h4l4|5O5R5S5W5r7]7^7_7`7e7f7h7i7j7p7w7z8U8X8Z9h9i9j9t9|:R:S:t:u:v:w:x:};R;e;j;v;y=p=}>O>Z>[Q/z*eU4k/z4m7xQ4m/|R7x4lS*o$|*ZR0Y*ox*S$v)e*t*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>O!d.j(u)c*[*e.l.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/h*S.j7ca7c3}7e7f7j9h:t:w;yQ0a*tQ3i.lU4}0a3i9kR9k7e|*U$v)e*t*u+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>O!h.k(u)c*[*e.l.m.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/j*U.k7de7d3}7e7f7j9h9i:t:u:w;yQ0c*uQ3j.mU5P0c3j9lR9l7fQ*z%UR0g*zQ5]0vR8Y5]Q+_%kR0u+_Q5v1jS8j5v:[R:[8kQ,[&_R1m,[Q5{1oR8m5{Q1{,fS6]1{8zR8z6_Q1U+rW5h1U5j8a:VQ5j1XQ8a5iR:V8bQ+w&QR1[+wQ2_,xR6m2_YrOXst#dQ&v!ZQ+a%mQ,r&rQ,t&tQ,u&uQ,w&wQ2Y,sS2],x2_R6l2[Q%opQ&z!_Q&}!aQ'P!bQ'R!cQ'q!uQ+`%lQ+l%zQ,Q&XQ,h&mQ-P&|W-p'k's't'wQ-w'oQ0X*nQ1P+mQ1c,PS2O,i,lQ2g-OQ2h-RQ2i-SQ2}-oW3P-r-s-v-xQ5a1QQ5m1_Q5q1eQ6V1uQ6a2QQ6k2ZU6z3O3R3UQ6}3SQ8]5bQ8e5oQ8g5rQ8l5zQ8u6WQ8{6`S9[6{7PQ9^7OQ:W8cQ:b8vQ:g8|Q:n9]Q;U:XQ;]:cQ;a:oQ;l;VR;o;^Q%zyQ'd!iQ'o!uU+m%{%|%}Q-W'VU-k'e'f'gS-o'k'uQ0Q*jS1Q+n+oQ2o-YS2{-l-mQ3S-tS4p0R0UQ5b1RQ6v2uQ6y2|Q7O3TU7{4r4s4vQ9z7}R;O9{S$wi>PR*{%VU%Ui%V>PR0f*yQ$viS(u#v+iS)c$b$cQ)e$dQ*[$xS*e${*YQ*t%OQ*u%QQ+Q%^Q+R%_Q+V%cQ.l<oQ.m<qQ.o<uQ.p<wQ.q<yQ/_)yQ/g*RQ/i*TQ/k*VQ/v*aS/|*g/mQ0d*wQ0e*xl0v+f,V.f1i1q3c6S7W8q9b:`:r;[;dQ1e,SQ3f=SQ3g=UQ3h=XS3}<l<mQ4R/PS4[/d4^Q4g/xQ4h/yQ4l/{Q4|0`Q5O0bQ5R0iQ5S0jQ5W0oQ5r1fQ7]=]Q7^=_Q7_=aQ7`=cQ7e<pQ7f<rQ7h<vQ7i<xQ7j<zQ7p4_Q7w4jQ7z4oQ8U5QQ8X5[Q8Z5_Q9h=YQ9i=TQ9j=VQ9t7vQ9|8QQ:R8VQ:S8[Q:t=^Q:u=`Q:v=bQ:w=dQ:x9pQ:}9yQ;R:PQ;e=gQ;j;QQ;v;kQ;y=hQ=p>PQ=}>XQ>O>YQ>Z>]R>[>^Q+O%]Q.n<sR7g<tnpOXst!Z#d%m&r&t&u&w,s,x2[2_Q!fPS#fZ#oQ&|!`W'h!o*i0]4zQ(P#SQ)Q#{Q)r$nS,l&k&nQ,q&oQ-O&{S-T'T/nQ-g'bQ.x)OQ/[)sQ0s+]Q0y+gQ2W,pQ2y-iQ3a.gQ4W/VQ5U0lQ6Q1rQ6c2SQ6d2TQ6h2VQ6j2XQ6o2aQ7Z3dQ7m4TQ8s6TQ9P6eQ9Q6fQ9S6iQ9f7[Q:a8tR:k9T#[cOPXZst!Z!`!o#d#o#{%m&k&n&o&r&t&u&w&{'T'b)O*i+]+g,p,s,x-i.g/n0]0l1r2S2T2V2X2[2_2a3d4z6T6e6f6i7[8t9TQ#YWQ#eYQ%quQ%svS%uw!gS(S#W(VQ(Y#ZQ(t#uQ(y#xQ)R$OQ)S$PQ)T$QQ)U$RQ)V$SQ)W$TQ)X$UQ)Y$VQ)Z$WQ)[$XQ)^$ZQ)`$_Q)b$aQ)g$eW)q$n)s/V4TQ+d%tQ+x&RS-Z'X2pQ-x'rS-}(T.PQ.S(]Q.U(dQ.s(xQ.v(zQ.z<UQ.|<XQ.}<YQ/O<]Q/b)}Q0p+XQ2k-UQ2n-XQ3O-qQ3V.VQ3k.tQ3p<^Q3q<_Q3r<`Q3s<aQ3t<bQ3u<cQ3v<dQ3w<eQ3x<fQ3y<gQ3z<hQ3{.{Q3|<kQ4P<nQ4Q<{Q4X<iQ5X0rQ5c1SQ6u=OQ6{3QQ7Q3WQ7a3lQ7b=PQ7k=RQ7l=ZQ8k5wQ9X6sQ9]6|Q9g=[Q9m=eQ9n=fQ:o9_Q;W:ZQ;`:mQ<W#SR=v>SR#[WR'Z!el!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}S'V!e-]U*j$|*Z*oS-Y'W'_S0U*k*qQ0^*rQ2u-cQ4v0[R4{0_R({#xQ!fQT-d'`-e]!qQ!r'`-e1o5{Q#p]R'i<VR)f$dY!uQ'`-e1o5{Q'k!rS'u!v!yS'w!z5}S-t'l'mQ-v'nR3T-uT#kZ%eS#jZ%eS%km,oU(g#h#i#lS.Y(h(iQ.^(jQ0t+^Q3Y.ZU3Z.[.]._S7S3[3]R9`7Td#^W#W#Z%h(T(^*Y+Z.T/mr#gZm#h#i#l%e(h(i(j+^.Z.[.]._3[3]7TS*]$x*bQ/t*^Q2U,oQ2l-VQ4`/pQ6q2dQ7s4aQ9W6rT=m'X+[V#aW%h*YU#`W%h*YS(U#W(^U(Z#Z+Z/mS-['X+[T.O(T.TV'^!e%i*ZQ$lfR)x$qT)m$l)nR4V/UT*_$x*bT*h${*YQ0w+fQ1g,VQ3_.fQ5t1iQ6P1qQ7X3cQ8r6SQ9c7WQ:^8qQ:p9bQ;Z:`Q;c:rQ;n;[R;q;dnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&l!VR,h&itmOXst!U!V!Z#d%m&i&r&t&u&w,s,x2[2_R,o&oT%lm,oR1k,XR,g&gQ&U|S+}&V&WR1^,OR+s&PT&p!W&sT&q!W&sT2^,x2_",nodeNames:"\u26a0 ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration defer ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:380,context:gv,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,237,243,245,247,249,252,258,264,266,268,270,272,274,275,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[xv],skippedNodes:[0,5,6,278],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Wp(Z!b'|0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(X#S$i&j'}0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Wp(Z!b'}0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(V':f$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Z!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Wp(Z!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Wp(Z!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Z!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Z!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(WpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(WpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Wp(Z!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(o%1l(Wp(Z!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Wp(Z!b$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Wp(Z!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Wp(Z!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(z+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(Y';W$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(WpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Wp(Z!b(U%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Wp(Z!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Wp(Z!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Wp(Z!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Wp(Z!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Z!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Z!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Z!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Z!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Z!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Z!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Wp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Wp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Wp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Wp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(WpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(WpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Wp(Z!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Wp(Z!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Wp(Z!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Wp(Z!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Wp(Z!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Wp(Z!b(O0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Wp(Z!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Z!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Z!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(WpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(WpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Wp(Z!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Wp(Z!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(r(Ct$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Wp(Z!b(a+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Wp(Z!b(T,2j$_#t(e$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Wp(Z!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(y+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Wp(Z!b'|0/l$]#t(T,2j(e$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Wp(Z!b'}0/l$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[yv,Ov,wv,kv,2,3,4,5,6,7,8,9,10,11,12,13,14,vv,new Zm("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(c~~",141,340),new Zm("j~RQYZXz{^~^O(Q~~aP!P!Qd~iO(R~~",25,323)],topRules:{Script:[0,7],SingleExpression:[1,276],SingleClassItem:[2,277]},dialects:{jsx:0,ts:15175},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:327,get:e=>Dv[e]||-1},{term:343,get:e=>Sv[e]||-1},{term:95,get:e=>Cv[e]||-1}],tokenPrec:15201}),Ev=[Lp("function ${name}(${params}) {\n\t${}\n}",{label:"function",detail:"definition",type:"keyword"}),Lp("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n\t${}\n}",{label:"for",detail:"loop",type:"keyword"}),Lp("for (let ${name} of ${collection}) {\n\t${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Lp("do {\n\t${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Lp("while (${}) {\n\t${}\n}",{label:"while",detail:"loop",type:"keyword"}),Lp("try {\n\t${}\n} catch (${error}) {\n\t${}\n}",{label:"try",detail:"/ catch block",type:"keyword"}),Lp("if (${}) {\n\t${}\n}",{label:"if",detail:"block",type:"keyword"}),Lp("if (${}) {\n\t${}\n} else {\n\t${}\n}",{label:"if",detail:"/ else block",type:"keyword"}),Lp("class ${name} {\n\tconstructor(${params}) {\n\t\t${}\n\t}\n}",{label:"class",detail:"definition",type:"keyword"}),Lp('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Lp('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],_v=Ev.concat([Lp("interface ${name} {\n\t${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Lp("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Lp("enum ${name} {\n\t${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),Tv=new du,Pv=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Mv(e){return(t,n)=>{let i=t.node.getChild("VariableDefinition");return i&&n(i,e),!0}}const Fv=["FunctionDeclaration"],Rv={FunctionDeclaration:Mv("function"),ClassDeclaration:Mv("class"),ClassExpression:()=>!0,EnumDeclaration:Mv("constant"),TypeAliasDeclaration:Mv("type"),NamespaceDeclaration:Mv("namespace"),VariableDefinition(e,t){e.matchContext(Fv)||t(e,"variable")},TypeDefinition(e,t){t(e,"type")},__proto__:null};function Nv(e,t){let n=Tv.get(t);if(n)return n;let i=[],r=!0;function s(t,n){let r=e.sliceString(t.from,t.to);i.push({label:r,type:n})}return t.cursor(qc.IncludeAnonymous).iterate(t=>{if(r)r=!1;else if(t.name){let e=Rv[t.name];if(e&&e(t,s)||Pv.has(t.name))return!1}else if(t.to-t.from>8192){for(let n of Nv(e,t.node))i.push(n);return!1}}),Tv.set(t,i),i}const Iv=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,Bv=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function Qv(e){let t=ch(e.state).resolveInner(e.pos,-1);if(Bv.indexOf(t.name)>-1)return null;let n="VariableName"==t.name||t.to-t.from<20&&Iv.test(e.state.sliceDoc(t.from,t.to));if(!n&&!e.explicit)return null;let i=[];for(let r=t;r;r=r.parent)Pv.has(r.name)&&(i=i.concat(Nv(e.state.doc,r)));return{options:i,from:n?t.from:e.pos,validFor:Iv}}const Lv=lh.define({name:"javascript",parser:Av.configure({props:[Ah.add({IfStatement:Nh({except:/^\s*({|else\b)/}),TryStatement:Nh({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:e=>e.baseIndent,SwitchBody:e=>{let t=e.textAfter,n=/^\s*\}/.test(t),i=/^\s*(case|default)\b/.test(t);return e.baseIndent+(n?0:i?1:2)*e.unit},Block:Fh({closing:"}"}),ArrowFunction:e=>e.baseIndent+e.unit,"TemplateString BlockComment":()=>null,"Statement Property":Nh({except:/^\s*{/}),JSXElement(e){let t=/^\s*<\//.test(e.textAfter);return e.lineIndent(e.node.from)+(t?0:e.unit)},JSXEscape(e){let t=/\s*\}/.test(e.textAfter);return e.lineIndent(e.node.from)+(t?0:e.unit)},"JSXOpenTag JSXSelfClosingTag":e=>e.column(e.node.from)+e.unit}),Bh.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":Qh,BlockComment:e=>({from:e.from+2,to:e.to-2})})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),jv={test:e=>/^JSX/.test(e.name),facet:rh({commentTokens:{block:{open:"{/*",close:"*/}"}}})},$v=Lv.configure({dialect:"ts"},"typescript"),zv=Lv.configure({dialect:"jsx",props:[sh.add(e=>e.isTop?[jv]:void 0)]}),Wv=Lv.configure({dialect:"jsx ts",props:[sh.add(e=>e.isTop?[jv]:void 0)]},"typescript");let Vv=e=>({label:e,type:"keyword"});const Uv="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(Vv),Xv=Uv.concat(["declare","implements","private","protected","public"].map(Vv));function qv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.jsx?e.typescript?Wv:zv:e.typescript?$v:Lv,n=e.typescript?_v.concat(Xv):Ev.concat(Uv);return new Oh(t,[Lv.data.of({autocomplete:(i=Bv,r=Ld(n),e=>{for(let t=ch(e.state).resolveInner(e.pos,-1);t;t=t.parent){if(i.indexOf(t.name)>-1)return null;if(t.type.isTop)break}return r(e)})}),Lv.data.of({autocomplete:Qv}),e.jsx?Yv:[]]);var i,r}function Zv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;for(let i=null===t||void 0===t?void 0:t.firstChild;i;i=i.nextSibling)if("JSXIdentifier"==i.name||"JSXBuiltin"==i.name||"JSXNamespacedName"==i.name||"JSXMemberExpression"==i.name)return e.sliceString(i.from,Math.min(i.to,n));return""}const Hv="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),Yv=sl.inputHandler.of((e,t,n,i,r)=>{if((Hv?e.composing:e.compositionStarted)||e.state.readOnly||t!=n||">"!=i&&"/"!=i||!Lv.isActiveAt(e.state,t,-1))return!1;let s=r(),{state:o}=s,a=o.changeByRange(e=>{var t;let n,{head:r}=e,s=ch(o).resolveInner(r-1,-1);if("JSXStartTag"==s.name&&(s=s.parent),o.doc.sliceString(r-1,r)!=i||"JSXAttributeValue"==s.name&&s.to>r);else{if(">"==i&&"JSXFragmentTag"==s.name)return{range:e,changes:{from:r,insert:"</>"}};if("/"==i&&"JSXStartCloseTag"==s.name){let e=s.parent,i=e.parent;if(i&&e.from==r-2&&((n=Zv(o.doc,i.firstChild,r))||"JSXFragmentTag"==(null===(t=i.firstChild)||void 0===t?void 0:t.name))){let e="".concat(n,">");return{range:An.cursor(r+e.length,-1),changes:{from:r,insert:e}}}}else if(">"==i){let t=function(e){for(;;){if("JSXOpenTag"==e.name||"JSXSelfClosingTag"==e.name||"JSXFragmentTag"==e.name)return e;if("JSXEscape"==e.name||!e.parent)return null;e=e.parent}}(s);if(t&&"JSXOpenTag"==t.name&&!/^\/?>|^<\//.test(o.doc.sliceString(r,r+2))&&(n=Zv(o.doc,t,r)))return{range:e,changes:{from:r,insert:"</".concat(n,">")}}}}return{range:e}});return!a.changes.empty&&(e.dispatch([s,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)});const Gv=["_blank","_self","_top","_parent"],Kv=["ascii","utf-8","utf-16","latin1","latin1"],Jv=["get","post","put","delete"],ey=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],ty=["true","false"],ny={},iy={a:{attrs:{href:null,ping:null,type:null,media:null,target:Gv,hreflang:null}},abbr:ny,address:ny,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:ny,aside:ny,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:ny,base:{attrs:{href:null,target:Gv}},bdi:ny,bdo:ny,blockquote:{attrs:{cite:null}},body:ny,br:ny,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:ey,formmethod:Jv,formnovalidate:["novalidate"],formtarget:Gv,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:ny,center:ny,cite:ny,code:ny,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:ny,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:ny,div:ny,dl:ny,dt:ny,em:ny,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:ny,figure:ny,footer:ny,form:{attrs:{action:null,name:null,"accept-charset":Kv,autocomplete:["on","off"],enctype:ey,method:Jv,novalidate:["novalidate"],target:Gv}},h1:ny,h2:ny,h3:ny,h4:ny,h5:ny,h6:ny,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:ny,hgroup:ny,hr:ny,html:{attrs:{manifest:null}},i:ny,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:ey,formmethod:Jv,formnovalidate:["novalidate"],formtarget:Gv,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:ny,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:ny,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:ny,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:Kv,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:ny,noscript:ny,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:ny,param:{attrs:{name:null,value:null}},pre:ny,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:ny,rt:ny,ruby:ny,samp:ny,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:Kv}},section:ny,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:ny,source:{attrs:{src:null,type:null,media:null}},span:ny,strong:ny,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:ny,summary:ny,sup:ny,table:ny,tbody:ny,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:ny,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:ny,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:ny,time:{attrs:{datetime:null}},title:ny,tr:ny,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},var:ny,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:ny},ry={accesskey:null,class:null,contenteditable:ty,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:ty,autocorrect:ty,autocapitalize:ty,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":ty,"aria-autocomplete":["inline","list","both","none"],"aria-busy":ty,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":ty,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":ty,"aria-hidden":ty,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":ty,"aria-multiselectable":ty,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":ty,"aria-relevant":null,"aria-required":ty,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},sy="beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map(e=>"on"+e);for(let os of sy)ry[os]=null;class oy{constructor(e,t){this.tags=p(p({},iy),e),this.globalAttrs=p(p({},ry),t),this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}}function ay(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;if(!t)return"";let i=t.firstChild,r=i&&i.getChild("TagName");return r?e.sliceString(r.from,Math.min(r.to,n)):""}function ly(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(;e;e=e.parent)if("Element"==e.name){if(!t)return e;t=!1}return null}function cy(e,t,n){let i=n.tags[ay(e,ly(t))];return(null===i||void 0===i?void 0:i.children)||n.allTags}function uy(e,t){let n=[];for(let i=ly(t);i&&!i.type.isTop;i=ly(i.parent)){let r=ay(e,i);if(r&&"CloseTag"==i.lastChild.name)break;r&&n.indexOf(r)<0&&("EndTag"==t.name||t.from>=i.firstChild.to)&&n.push(r)}return n}oy.default=new oy;const hy=/^[:\-\.\w\u00b7-\uffff]*$/;function dy(e,t,n,i,r){let s=/\s*>/.test(e.sliceDoc(r,r+5))?"":">",o=ly(n,"StartTag"==n.name||"TagName"==n.name);return{from:i,to:r,options:cy(e.doc,o,t).map(e=>({label:e,type:"type"})).concat(uy(e.doc,n).map((e,t)=>({label:"/"+e,apply:"/"+e+s,type:"type",boost:99-t}))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function py(e,t,n,i){let r=/\s*>/.test(e.sliceDoc(i,i+5))?"":">";return{from:n,to:i,options:uy(e.doc,t).map((e,t)=>({label:e,apply:e+r,type:"type",boost:99-t})),validFor:hy}}function fy(e,t){let{state:n,pos:i}=t,r=ch(n).resolveInner(i,-1),s=r.resolve(i);for(let o,a=i;s==r&&(o=r.childBefore(a));){let e=o.lastChild;if(!e||!e.type.isError||e.from<e.to)break;s=r=o,a=e.from}return"TagName"==r.name?r.parent&&/CloseTag$/.test(r.parent.name)?py(n,r,r.from,i):dy(n,e,r,r.from,i):"StartTag"==r.name||"IncompleteTag"==r.name?dy(n,e,r,i,i):"StartCloseTag"==r.name||"IncompleteCloseTag"==r.name?py(n,r,i,i):"OpenTag"==r.name||"SelfClosingTag"==r.name||"AttributeName"==r.name?function(e,t,n,i,r){let s=ly(n),o=s?t.tags[ay(e.doc,s)]:null,a=o&&o.attrs?Object.keys(o.attrs):[];return{from:i,to:r,options:(o&&!1===o.globalAttrs?a:a.length?a.concat(t.globalAttrNames):t.globalAttrNames).map(e=>({label:e,type:"property"})),validFor:hy}}(n,e,r,"AttributeName"==r.name?r.from:i,i):"Is"==r.name||"AttributeValue"==r.name||"UnquotedAttributeValue"==r.name?function(e,t,n,i,r){var s;let o,a=null===(s=n.parent)||void 0===s?void 0:s.getChild("AttributeName"),l=[];if(a){let s=e.sliceDoc(a.from,a.to),c=t.globalAttrs[s];if(!c){let i=ly(n),r=i?t.tags[ay(e.doc,i)]:null;c=(null===r||void 0===r?void 0:r.attrs)&&r.attrs[s]}if(c){let t=e.sliceDoc(i,r).toLowerCase(),n='"',s='"';/^['"]/.test(t)?(o='"'==t[0]?/^[^"]*$/:/^[^']*$/,n="",s=e.sliceDoc(r,r+1)==t[0]?"":t[0],t=t.slice(1),i++):o=/^[^\s<>='"]*$/;for(let e of c)l.push({label:e,apply:n+e+s,type:"constant"})}}return{from:i,to:r,options:l,validFor:o}}(n,e,r,"Is"==r.name?i:r.from,i):!t.explicit||"Element"!=s.name&&"Text"!=s.name&&"Document"!=s.name?null:function(e,t,n,i){let r=[],s=0;for(let o of cy(e.doc,n,t))r.push({label:"<"+o,type:"type"});for(let o of uy(e.doc,n))r.push({label:"</"+o+">",type:"type",boost:99-s++});return{from:i,to:i,options:r,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}(n,e,r,i)}function my(e){let{extraTags:t,extraGlobalAttributes:n}=e,i=n||t?new oy(t,n):oy.default;return e=>fy(i,e)}const gy=Lv.parser.configure({top:"SingleExpression"}),vy=[{tag:"script",attrs:e=>"text/typescript"==e.type||"ts"==e.lang,parser:$v.parser},{tag:"script",attrs:e=>"text/babel"==e.type||"text/jsx"==e.type,parser:zv.parser},{tag:"script",attrs:e=>"text/typescript-jsx"==e.type,parser:Wv.parser},{tag:"script",attrs:e=>/^(importmap|speculationrules|application\/(.+\+)?json)$/i.test(e.type),parser:gy},{tag:"script",attrs:e=>!e.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(e.type),parser:Lv.parser},{tag:"style",attrs:e=>(!e.lang||"css"==e.lang)&&(!e.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(e.type)),parser:fv.parser}],yy=[{name:"style",parser:fv.parser.configure({top:"Styles"})}].concat(sy.map(e=>({name:e,parser:Lv.parser}))),Oy=lh.define({name:"html",parser:Fg.configure({props:[Ah.add({Element(e){let t=/^(\s*)(<\/)?/.exec(e.textAfter);return e.node.to<=e.pos+t[0].length?e.continue():e.lineIndent(e.node.from)+(t[2]?0:e.unit)},"OpenTag CloseTag SelfClosingTag":e=>e.column(e.node.from)+e.unit,Document(e){if(e.pos+/\s*/.exec(e.textAfter)[0].length<e.node.to)return e.continue();let t,n=null;for(let i=e.node;;){let e=i.lastChild;if(!e||"Element"!=e.name||e.to!=i.to)break;n=i=e}return n&&(!(t=n.lastChild)||"CloseTag"!=t.name&&"SelfClosingTag"!=t.name)?e.lineIndent(n.from)+e.unit:null}}),Bh.add({Element(e){let t=e.firstChild,n=e.lastChild;return t&&"OpenTag"==t.name?{from:t.to,to:"CloseTag"==n.name?n.from:e.to}:null}}),Sd.add({"OpenTag CloseTag":e=>e.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-_"}}),wy=Oy.configure({wrap:Bg(vy,yy)});function by(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n="";!1===t.matchClosingTags&&(n="noMatch"),!0===t.selfClosingTags&&(n=(n?n+" ":"")+"selfClosing"),(t.nestedLanguages&&t.nestedLanguages.length||t.nestedAttributes&&t.nestedAttributes.length)&&(e=Bg((t.nestedLanguages||[]).concat(vy),(t.nestedAttributes||[]).concat(yy)));let i=e?Oy.configure({wrap:e,dialect:n}):n?wy.configure({dialect:n}):wy;return new Oh(i,[wy.data.of({autocomplete:my(t)}),!1!==t.autoCloseTags?xy:[],qv().support,new Oh(fv,fv.data.of({autocomplete:pv})).support])}const ky=new Set("area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" ")),xy=sl.inputHandler.of((e,t,n,i,r)=>{if(e.composing||e.state.readOnly||t!=n||">"!=i&&"/"!=i||!wy.isActiveAt(e.state,t,-1))return!1;let s=r(),{state:o}=s,a=o.changeByRange(e=>{var t,n,r;let s,a=o.doc.sliceString(e.from-1,e.to)==i,{head:l}=e,c=ch(o).resolveInner(l,-1);if(a&&">"==i&&"EndTag"==c.name){let i=c.parent;if("CloseTag"!=(null===(n=null===(t=i.parent)||void 0===t?void 0:t.lastChild)||void 0===n?void 0:n.name)&&(s=ay(o.doc,i.parent,l))&&!ky.has(s)){return{range:e,changes:{from:l,to:l+(">"===o.doc.sliceString(l,l+1)?1:0),insert:"</".concat(s,">")}}}}else if(a&&"/"==i&&"IncompleteCloseTag"==c.name){let e=c.parent;if(c.from==l-2&&"CloseTag"!=(null===(r=e.lastChild)||void 0===r?void 0:r.name)&&(s=ay(o.doc,e,l))&&!ky.has(s)){let e=l+(">"===o.doc.sliceString(l,l+1)?1:0),t="".concat(s,">");return{range:An.cursor(l+t.length,-1),changes:{from:l,to:e,insert:t}}}}return{range:e}});return!a.changes.empty&&(e.dispatch([s,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),Dy=rh({commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}}}),Sy=new jc,Cy=mm.configure({props:[Bh.add(e=>!e.is("Block")||e.is("Document")||null!=Ay(e)||function(e){return"OrderedList"==e.name||"BulletList"==e.name}(e)?void 0:(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to})),Sy.add(Ay),Ah.add({Document:()=>null}),ih.add({Document:Dy})]});function Ay(e){let t=/^(?:ATX|Setext)Heading(\d)$/.exec(e.name);return t?+t[1]:void 0}function Ey(e,t){let n=e;for(;;){let e,i=n.nextSibling;if(!i||null!=(e=Ay(i.type))&&e<=t)break;n=i}return n.to}const _y=Ih.of((e,t,n)=>{for(let i=ch(e).resolveInner(n,-1);i&&!(i.from<t);i=i.parent){let e=i.type.prop(Sy);if(null==e)continue;let t=Ey(i,e);if(t>n)return{from:n,to:t}}return null});function Ty(e){return new oh(Dy,e,[],"markdown")}const Py=Ty(Cy),My=Cy.configure([Rm,Bm,Im,Qm,{props:[Bh.add({Table:(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to})})]}]),Fy=Ty(My);class Ry{constructor(e,t,n,i,r,s,o){this.node=e,this.from=t,this.to=n,this.spaceBefore=i,this.spaceAfter=r,this.type=s,this.item=o}blank(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.spaceBefore+("Blockquote"==this.node.name?">":"");if(null!=e){for(;n.length<e;)n+=" ";return n}for(let i=this.to-this.from-n.length-this.spaceAfter.length;i>0;i--)n+=" ";return n+(t?this.spaceAfter:"")}marker(e,t){let n="OrderedList"==this.node.name?String(+Iy(this.item,e)[2]+t):"";return this.spaceBefore+n+this.type+this.spaceAfter}}function Ny(e,t){let n=[],i=[];for(let r=e;r;r=r.parent){if("FencedCode"==r.name)return i;"ListItem"!=r.name&&"Blockquote"!=r.name||n.push(r)}for(let r=n.length-1;r>=0;r--){let e,s=n[r],o=t.lineAt(s.from),a=s.from-o.from;if("Blockquote"==s.name&&(e=/^ *>( ?)/.exec(o.text.slice(a))))i.push(new Ry(s,a,a+e[0].length,"",e[1],">",null));else if("ListItem"==s.name&&"OrderedList"==s.parent.name&&(e=/^( *)\d+([.)])( *)/.exec(o.text.slice(a)))){let t=e[3],n=e[0].length;t.length>=4&&(t=t.slice(0,t.length-4),n-=4),i.push(new Ry(s.parent,a,a+n,e[1],t,e[2],s))}else if("ListItem"==s.name&&"BulletList"==s.parent.name&&(e=/^( *)([-+*])( {1,4}\[[ xX]\])?( +)/.exec(o.text.slice(a)))){let t=e[4],n=e[0].length;t.length>4&&(t=t.slice(0,t.length-4),n-=4);let r=e[2];e[3]&&(r+=e[3].replace(/[xX]/," ")),i.push(new Ry(s.parent,a,a+n,e[1],t,r,s))}}return i}function Iy(e,t){return/^(\s*)(\d+)(?=[.)])/.exec(t.sliceString(e.from,e.from+10))}function By(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(let r=-1,s=e;;){if("ListItem"==s.name){let e=Iy(s,t),o=+e[2];if(r>=0){if(o!=r+1)return;n.push({from:s.from+e[1].length,to:s.from+e[0].length,insert:String(r+2+i)})}r=o}let e=s.nextSibling;if(!e)break;s=e}}function Qy(e,t){let n=/^[ \t]*/.exec(e)[0].length;if(!n||"\t"!=t.facet(kh))return e;let i="";for(let r=Bi(e,4,n);r>0;)r>=4?(i+="\t",r-=4):(i+=" ",r--);return i+e.slice(n)}const Ly=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>{let{state:n,dispatch:i}=t,r=ch(n),{doc:s}=n,o=null,a=n.changeByRange(t=>{if(!t.empty||!Fy.isActiveAt(n,t.from,-1)&&!Fy.isActiveAt(n,t.from,1))return o={range:t};let i=t.from,a=s.lineAt(i),l=Ny(r.resolveInner(i,-1),s);for(;l.length&&l[l.length-1].from>i-a.from;)l.pop();if(!l.length)return o={range:t};let c=l[l.length-1];if(c.to-c.spaceAfter.length>i-a.from)return o={range:t};let u=i>=c.to-c.spaceAfter.length&&!/\S/.test(a.text.slice(c.to));if(c.item&&u){let t=c.node.firstChild,r=c.node.getChild("ListItem","ListItem");if(t.to>=i||r&&r.to<i||a.from>0&&!/[^\s>]/.test(s.lineAt(a.from-1).text)||!1===e.nonTightLists){let e,t=l.length>1?l[l.length-2]:null,n="";t&&t.item?(e=a.from+t.from,n=t.marker(s,1)):e=a.from+(t?t.to:0);let r=[{from:e,to:i,insert:n}];return"OrderedList"==c.node.name&&By(c.item,s,r,-2),t&&"OrderedList"==t.node.name&&By(t.item,s,r),{range:An.cursor(e+n.length),changes:r}}{let e=$y(l,n,a);return{range:An.cursor(i+e.length+1),changes:{from:a.from,insert:e+n.lineBreak}}}}if("Blockquote"==c.node.name&&u&&a.from){let e=s.lineAt(a.from-1),i=/>\s*$/.exec(e.text);if(i&&i.index==c.from){let r=n.changes([{from:e.from+i.index,to:e.to},{from:a.from+c.from,to:a.to}]);return{range:t.map(r),changes:r}}}let h=[];"OrderedList"==c.node.name&&By(c.item,s,h);let d=c.item&&c.item.from<a.from,p="";if(!d||/^[\s\d.)\-+*>]*/.exec(a.text)[0].length>=c.to)for(let e=0,n=l.length-1;e<=n;e++)p+=e!=n||d?l[e].blank(e<n?Bi(a.text,4,l[e+1].from)-p.length:null):l[e].marker(s,1);let f=i;for(;f>a.from&&/\s/.test(a.text.charAt(f-a.from-1));)f--;return p=Qy(p,n),function(e,t){if("OrderedList"!=e.name&&"BulletList"!=e.name)return!1;let n=e.firstChild,i=e.getChild("ListItem","ListItem");if(!i)return!1;let r=t.lineAt(n.to),s=t.lineAt(i.from),o=/^[\s>]*$/.test(r.text);return r.number+(o?0:1)<s.number}(c.node,n.doc)&&(p=$y(l,n,a)+n.lineBreak+p),h.push({from:f,to:i,insert:n.lineBreak+p}),{range:An.cursor(f+p.length+1),changes:h}});return!o&&(i(n.update(a,{scrollIntoView:!0,userEvent:"input"})),!0)}};function jy(e){return"QuoteMark"==e.name||"ListMark"==e.name}function $y(e,t,n){let i="";for(let r=0,s=e.length-2;r<=s;r++)i+=e[r].blank(r<s?Bi(n.text,4,e[r+1].from)-i.length:null,r<s);return Qy(i,t)}const zy=[{key:"Enter",run:Ly()},{key:"Backspace",run:e=>{let{state:t,dispatch:n}=e,i=ch(t),r=null,s=t.changeByRange(e=>{let n=e.from,{doc:s}=t;if(e.empty&&Fy.isActiveAt(t,e.from)){let e=s.lineAt(n),r=Ny(function(e,t){let n=e.resolveInner(t,-1),i=t;jy(n)&&(i=n.from,n=n.parent);for(let r;r=n.childBefore(i);)if(jy(r))i=r.from;else{if("OrderedList"!=r.name&&"BulletList"!=r.name)break;n=r.lastChild,i=n.to}return n}(i,n),s);if(r.length){let i=r[r.length-1],s=i.to-i.spaceAfter.length+(i.spaceAfter?1:0);if(n-e.from>s&&!/\S/.test(e.text.slice(s,n-e.from)))return{range:An.cursor(e.from+s),changes:{from:e.from+s,to:n}};if(n-e.from==s&&(!i.item||e.from<=i.item.from||!/\S/.test(e.text.slice(0,i.to)))){let r=e.from+i.from;if(i.item&&i.node.from<i.item.from&&/\S/.test(e.text.slice(i.from,i.to))){let n=i.blank(Bi(e.text,4,i.to)-Bi(e.text,4,i.from));return r==e.from&&(n=Qy(n,t)),{range:An.cursor(r+n.length),changes:{from:r,to:e.from+i.to,insert:n}}}if(r<n)return{range:An.cursor(r),changes:{from:r,to:n}}}}}return r={range:e}});return!r&&(n(t.update(s,{scrollIntoView:!0,userEvent:"delete"})),!0)}}],Wy=by({matchClosingTags:!1});function Vy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{codeLanguages:t,defaultCodeLanguage:n,addKeymap:i=!0,base:{parser:r}=Py,completeHTMLTags:s=!0,pasteURLAsLink:o=!0,htmlTagLanguage:a=Wy}=e;if(!(r instanceof $f))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let l,c=e.extensions?[e.extensions]:[],u=[a.support,_y];o&&u.push(Hy),n instanceof Oh?(u.push(n.support),l=n.language):n&&(l=n);let h=t||l?(d=t,p=l,e=>{if(e&&d){let t=null;if(e=/\S*/.exec(e)[0],t="function"==typeof d?d(e):wh.matchLanguageName(d,e,!0),t instanceof wh)return t.support?t.support.language.parser:dh.getSkippingParser(t.load());if(t)return t.parser}return p?p.parser:null}):void 0;var d,p;c.push(function(e){let{codeParser:t,htmlParser:n}=e,i=gu((e,i)=>{let r=e.type.id;if(!t||r!=cf.CodeBlock&&r!=cf.FencedCode){if(n&&(r==cf.HTMLBlock||r==cf.HTMLTag||r==cf.CommentBlock))return{parser:n,overlay:gm(e.node,e.from,e.to)}}else{let n="";if(r==cf.FencedCode){let t=e.node.getChild(cf.CodeInfo);t&&(n=i.read(t.from,t.to))}let s=t(n);if(s)return{parser:s,overlay:e=>e.type.id==cf.CodeText,bracketed:r==cf.FencedCode}}return null});return{wrap:i}}({codeParser:h,htmlParser:a.language.parser})),i&&u.push(Wn.high(pl.of(zy)));let f=Ty(r.configure(c));return s&&u.push(f.data.of({autocomplete:Uy})),new Oh(f,u)}function Uy(e){let{state:t,pos:n}=e,i=/<[:\-\.\w\u00b7-\uffff]*$/.exec(t.sliceDoc(n-25,n));if(!i)return null;let r=ch(t).resolveInner(n,-1);for(;r&&!r.type.isTop;){if("CodeBlock"==r.name||"FencedCode"==r.name||"ProcessingInstructionBlock"==r.name||"CommentBlock"==r.name||"Link"==r.name||"Image"==r.name)return null;r=r.parent}return{from:n-i[0].length,to:n,options:qy(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/}}let Xy=null;function qy(){if(Xy)return Xy;let e=(t=new Bd(yi.create({extensions:Wy}),0,!0),fy(oy.default,t));var t;return Xy=e?e.options:[]}const Zy=/code|horizontalrule|html|link|comment|processing|escape|entity|image|mark|url/i,Hy=sl.domEventHandlers({paste:(e,t)=>{var n;let{main:i}=t.state.selection;if(i.empty)return!1;let r=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/plain");if(!r||!/^(https?:\/\/|mailto:|xmpp:|www\.)/.test(r))return!1;if(/^www\./.test(r)&&(r="https://"+r),!Fy.isActiveAt(t.state,i.from,1))return!1;let s=ch(t.state),o=!1;return s.iterate({from:i.from,to:i.to,enter:e=>{(e.from>i.from||Zy.test(e.name))&&(o=!0)},leave:e=>{e.to<i.to&&(o=!0)}}),!o&&(t.dispatch({changes:[{from:i.from,insert:"["},{from:i.to,insert:"](".concat(r,")")}],userEvent:"input.paste",scrollIntoView:!0}),!0)}}),Yy=()=>new Map,Gy=e=>{const t=Yy();return e.forEach((e,n)=>{t.set(n,e)}),t},Ky=(e,t,n)=>{let i=e.get(t);return void 0===i&&e.set(t,i=n()),i},Jy=()=>new Set,eO=e=>e[e.length-1],tO=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},nO=Array.from,iO=(e,t)=>{for(let n=0;n<e.length;n++)if(!t(e[n],n,e))return!1;return!0},rO=(e,t)=>{for(let n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1},sO=Array.isArray;class oO{constructor(){this._observers=Yy()}on(e,t){return Ky(this._observers,e,Jy).add(t),t}once(e,t){var n=this;const i=function(){n.off(e,i),t(...arguments)};this.on(e,i)}off(e,t){const n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}emit(e,t){return nO((this._observers.get(e)||Yy()).values()).forEach(e=>e(...t))}destroy(){this._observers=Yy()}}class aO{constructor(){this._observers=Yy()}on(e,t){Ky(this._observers,e,Jy).add(t)}once(e,t){var n=this;const i=function(){n.off(e,i),t(...arguments)};this.on(e,i)}off(e,t){const n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}emit(e,t){return nO((this._observers.get(e)||Yy()).values()).forEach(e=>e(...t))}destroy(){this._observers=Yy()}}const lO=Math.floor,cO=(Math.ceil,Math.abs),uO=(Math.imul,Math.round,Math.log10,Math.log2,Math.log,Math.sqrt,(e,t)=>e<t?e:t),hO=(e,t)=>e>t?e:t,dO=(Number.isNaN,Math.pow,Math.sign,e=>0!==e?e<0:1/e<0),pO=64,fO=128,mO=1<<29,gO=127,vO=2147483647,yO=Number.MAX_SAFE_INTEGER,OO=Number.MIN_SAFE_INTEGER,wO=Number.isInteger||(e=>"number"===typeof e&&isFinite(e)&&lO(e)===e),bO=(Number.isNaN,Number.parseInt,String.fromCharCode),kO=(String.fromCodePoint,bO(65535),/^\s*/g),xO=/([A-Z])/g,DO=(e,t)=>(e=>e.replace(kO,""))(e.replace(xO,e=>"".concat(t).concat((e=>e.toLowerCase())(e)))),SO="undefined"!==typeof TextEncoder?new TextEncoder:null,CO=SO?e=>SO.encode(e):e=>{const t=unescape(encodeURIComponent(e)),n=t.length,i=new Uint8Array(n);for(let r=0;r<n;r++)i[r]=t.codePointAt(r);return i};let AO="undefined"===typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});AO&&1===AO.decode(new Uint8Array).length&&(AO=null);const EO=(e,t)=>((e,t)=>{const n=new Array(e);for(let i=0;i<e;i++)n[i]=t(i,n);return n})(t,()=>e).join("");class _O{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const TO=()=>new _O,PO=e=>{const t=new Uint8Array((e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t})(e));let n=0;for(let i=0;i<e.bufs.length;i++){const r=e.bufs[i];t.set(r,n),n+=r.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},MO=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},FO=MO,RO=(e,t)=>{for(;t>gO;)MO(e,fO|gO&t),t=lO(t/128);MO(e,gO&t)},NO=(e,t)=>{const n=dO(t);for(n&&(t=-t),MO(e,(t>63?fO:0)|(n?pO:0)|63&t),t=lO(t/64);t>0;)MO(e,(t>gO?fO:0)|gO&t),t=lO(t/128)},IO=new Uint8Array(3e4),BO=IO.length/3,QO=SO&&SO.encodeInto?(e,t)=>{if(t.length<BO){const n=SO.encodeInto(t,IO).written||0;RO(e,n);for(let t=0;t<n;t++)MO(e,IO[t])}else jO(e,CO(t))}:(e,t)=>{const n=unescape(encodeURIComponent(t)),i=n.length;RO(e,i);for(let r=0;r<i;r++)MO(e,n.codePointAt(r))},LO=(e,t)=>{const n=e.cbuf.length,i=e.cpos,r=uO(n-i,t.length),s=t.length-r;e.cbuf.set(t.subarray(0,r),i),e.cpos+=r,s>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(hO(2*n,s)),e.cbuf.set(t.subarray(r)),e.cpos=s)},jO=(e,t)=>{RO(e,t.byteLength),LO(e,t)},$O=(e,t)=>{((e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*hO(n,t)),e.cpos=0)})(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},zO=new DataView(new ArrayBuffer(4)),WO=(e,t)=>{switch(typeof t){case"string":MO(e,119),QO(e,t);break;case"number":wO(t)&&cO(t)<=vO?(MO(e,125),NO(e,t)):(n=t,zO.setFloat32(0,n),zO.getFloat32(0)===n?(MO(e,124),((e,t)=>{$O(e,4).setFloat32(0,t,!1)})(e,t)):(MO(e,123),((e,t)=>{$O(e,8).setFloat64(0,t,!1)})(e,t)));break;case"bigint":MO(e,122),((e,t)=>{$O(e,8).setBigInt64(0,t,!1)})(e,t);break;case"object":if(null===t)MO(e,126);else if(sO(t)){MO(e,117),RO(e,t.length);for(let n=0;n<t.length;n++)WO(e,t[n])}else if(t instanceof Uint8Array)MO(e,116),jO(e,t);else{MO(e,118);const n=Object.keys(t);RO(e,n.length);for(let i=0;i<n.length;i++){const r=n[i];QO(e,r),WO(e,t[r])}}break;case"boolean":MO(e,t?120:121);break;default:MO(e,127)}var n};class VO extends _O{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&RO(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const UO=e=>{e.count>0&&(NO(e.encoder,1===e.count?e.s:-e.s),e.count>1&&RO(e.encoder,e.count-2))};class XO{constructor(){this.encoder=new _O,this.s=0,this.count=0}write(e){this.s===e?this.count++:(UO(this),this.count=1,this.s=e)}toUint8Array(){return UO(this),PO(this.encoder)}}const qO=e=>{if(e.count>0){const t=2*e.diff+(1===e.count?0:1);NO(e.encoder,t),e.count>1&&RO(e.encoder,e.count-2)}};class ZO{constructor(){this.encoder=new _O,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(qO(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return qO(this),PO(this.encoder)}}class HO{constructor(){this.sarr=[],this.s="",this.lensE=new XO}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new _O;return this.sarr.push(this.s),this.s="",QO(e,this.sarr.join("")),LO(e,this.lensE.toUint8Array()),PO(e)}}const YO=e=>new Error(e),GO=()=>{throw YO("Method unimplemented")},KO=()=>{throw YO("Unexpected case")},JO=YO("Unexpected end of array"),ew=YO("Integer out of Range");class tw{constructor(e){this.arr=e,this.pos=0}}const nw=e=>new tw(e),iw=e=>e.pos!==e.arr.length,rw=(e,t)=>{const n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},sw=e=>rw(e,aw(e)),ow=e=>e.arr[e.pos++],aw=e=>{let t=0,n=1;const i=e.arr.length;for(;e.pos<i;){const i=e.arr[e.pos++];if(t+=(i&gO)*n,n*=128,i<fO)return t;if(t>yO)throw ew}throw JO},lw=e=>{let t=e.arr[e.pos++],n=63&t,i=64;const r=(t&pO)>0?-1:1;if(0===(t&fO))return r*n;const s=e.arr.length;for(;e.pos<s;){if(t=e.arr[e.pos++],n+=(t&gO)*i,i*=128,t<fO)return r*n;if(n>yO)throw ew}throw JO},cw=AO?e=>AO.decode(sw(e)):e=>{let t=aw(e);if(0===t)return"";{let n=String.fromCodePoint(ow(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(ow(e));else for(;t>0;){const i=t<1e4?t:1e4,r=e.arr.subarray(e.pos,e.pos+i);e.pos+=i,n+=String.fromCodePoint.apply(null,r),t-=i}return decodeURIComponent(escape(n))}},uw=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},hw=[e=>{},e=>null,lw,e=>uw(e,4).getFloat32(0,!1),e=>uw(e,8).getFloat64(0,!1),e=>uw(e,8).getBigInt64(0,!1),e=>!1,e=>!0,cw,e=>{const t=aw(e),n={};for(let i=0;i<t;i++){n[cw(e)]=dw(e)}return n},e=>{const t=aw(e),n=[];for(let i=0;i<t;i++)n.push(dw(e));return n},sw],dw=e=>hw[127-ow(e)](e);class pw extends tw{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),iw(this)?this.count=aw(this)+1:this.count=-1),this.count--,this.s}}class fw extends tw{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=lw(this);const e=dO(this.s);this.count=1,e&&(this.s=-this.s,this.count=aw(this)+2)}return this.count--,this.s}}class mw extends tw{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){const e=lw(this),t=1&e;this.diff=lO(e/2),this.count=1,t&&(this.count=aw(this)+2)}return this.s+=this.diff,this.count--,this.s}}class gw{constructor(e){this.decoder=new fw(e),this.str=cw(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}crypto.subtle;const vw=crypto.getRandomValues.bind(crypto),yw=Math.random,Ow=()=>vw(new Uint32Array(1))[0],ww=[1e7]+-1e3+-4e3+-8e3+-1e11,bw=()=>ww.replace(/[018]/g,e=>(e^Ow()&15>>e/4).toString(16)),kw=e=>new Promise(e),xw=(Promise.all.bind(Promise),e=>void 0===e?null:e);let Dw=new class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}},Sw=!0;try{"undefined"!==typeof localStorage&&localStorage&&(Dw=localStorage,Sw=!1)}catch(Kre){}const Cw=Dw,Aw=Symbol("Equality"),Ew=(e,t)=>{var n;return e===t||!(null===e||void 0===e||null===(n=e[Aw])||void 0===n||!n.call(e,t))||!1},_w=Object.assign,Tw=Object.keys,Pw=(Object.values,e=>Tw(e).length),Mw=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},Fw=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Rw=Object.freeze,Nw=e=>{for(const t in e){const n=e[t];"object"!==typeof n&&"function"!==typeof n||Nw(e[t])}return Rw(e)},Iw=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&Iw(e,t,n+1)}},Bw=e=>e,Qw=(e,t)=>{if(e===t)return!0;if(null==e||null==t||e.constructor!==t.constructor&&(e.constructor||Object)!==(t.constructor||Object))return!1;if(null!=e[Aw])return e[Aw](t);switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break;case Set:if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;break;case Map:if(e.size!==t.size)return!1;for(const n of e.keys())if(!t.has(n)||!Qw(e.get(n),t.get(n)))return!1;break;case void 0:case Object:if(Pw(e)!==Pw(t))return!1;for(const n in e)if(!Fw(e,n)||!Qw(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Qw(e[n],t[n]))return!1;break;default:return!1}return!0},Lw="undefined"!==typeof process&&process.release&&/node|io\.js/.test(process.release.name)&&"[object process]"===Object.prototype.toString.call("undefined"!==typeof process?process:0),jw="undefined"!==typeof window&&"undefined"!==typeof document&&!Lw;"undefined"!==typeof navigator&&/Mac/.test(navigator.platform);let $w;const zw=[],Ww=()=>{if(void 0===$w)if(Lw){$w=Yy();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const i=e[n];"-"===i[0]?(null!==t&&$w.set(t,""),t=i):null!==t?($w.set(t,i),t=null):zw.push(i)}null!==t&&$w.set(t,"")}else"object"===typeof location?($w=Yy(),(location.search||"?").slice(1).split("&").forEach(e=>{if(0!==e.length){const[t,n]=e.split("=");$w.set("--".concat(DO(t,"-")),n),$w.set("-".concat(DO(t,"-")),n)}})):$w=Yy();return $w},Vw=e=>Ww().has(e),Uw=e=>xw(Lw?{NODE_ENV:"production",PUBLIC_URL:"/flashy",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production",REACT_APP_SUPABASE_URL:"https://juberlfvyedrbiixrkxt.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp1YmVybGZ2eWVkcmJpaXhya3h0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwNTcyMTcsImV4cCI6MjA4NTYzMzIxN30.Xom-I23EyDMIq_skpdF4lmLNDEg8NZQ9498QfVI6siA",REACT_APP_SHARED_PASSWORD:"password"}[e.toUpperCase().replaceAll("-","_")]:Cw.getItem(e)),Xw=e=>Vw("--"+e)||null!==Uw(e),qw=Xw("production");const Zw=Lw&&["true","1","2"].includes({NODE_ENV:"production",PUBLIC_URL:"/flashy",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production",REACT_APP_SUPABASE_URL:"https://juberlfvyedrbiixrkxt.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp1YmVybGZ2eWVkcmJpaXhya3h0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwNTcyMTcsImV4cCI6MjA4NTYzMzIxN30.Xom-I23EyDMIq_skpdF4lmLNDEg8NZQ9498QfVI6siA",REACT_APP_SHARED_PASSWORD:"password"}.FORCE_COLOR)||!Vw("--no-colors")&&!Xw("no-color")&&(!Lw||process.stdout.isTTY)&&(!Lw||Vw("--color")||null!==Uw("COLORTERM")||(Uw("TERM")||"").includes("color")),Hw=e=>new Uint8Array(e),Yw=jw?e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=bO(e[n]);return btoa(t)}:e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),Gw=e=>(e=>{const t=TO();return e(t),PO(t)})(t=>WO(t,e));class Kw{constructor(e,t){this.left=e,this.right=t}}const Jw=(e,t)=>new Kw(e,t),eb=e=>e.next()>=.5,tb=(e,t,n)=>lO(e.next()*(n+1-t)+t),nb=(e,t,n)=>lO(e.next()*(n+1-t)+t),ib=(e,t,n)=>nb(e,t,n),rb=e=>bO(ib(e,97,122)),sb=(e,t)=>t[ib(e,0,t.length-1)];let ob;const ab=Symbol("0schema");class lb{constructor(){this._rerrs=[]}extend(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._rerrs.push({path:e,expected:t,has:n,message:i})}toString(){const e=[];for(let t=this._rerrs.length-1;t>0;t--){const n=this._rerrs[t];e.push(EO(" ",2*(this._rerrs.length-t))+"".concat(null!=n.path?"[".concat(n.path,"] "):"").concat(n.has," doesn't match ").concat(n.expected,". ").concat(n.message))}return e.join("\n")}}const cb=(e,t)=>e===t||null!=e&&null!=t&&e.constructor===t.constructor&&(e[Aw]?Ew(e,t):sO(e)?iO(e,e=>rO(t,t=>cb(e,t))):"object"===typeof e&&Mw(e,(e,n)=>cb(e,t[n])));ob=Aw;class ub{extends(e){let[t,n]=[this.shape,e.shape];return this.constructor._dilutes&&([n,t]=[t,n]),cb(t,n)}equals(e){return this.constructor===e.constructor&&Qw(this.shape,e.shape)}[ab](){return!0}[ob](e){return this.equals(e)}validate(e){return this.check(e)}check(e,t){GO()}get nullable(){return Wb(this,rk)}get optional(){return new kb(this)}cast(e){return lk(e,this),e}expect(e){return lk(e,this),e}}h(ub,"_dilutes",!1);class hb extends ub{constructor(e,t){super(),this.shape=e,this._c=t}check(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const n=(null===e||void 0===e?void 0:e.constructor)===this.shape&&(null==this._c||this._c(e));return!n&&(null===t||void 0===t||t.extend(null,this.shape.name,null===e||void 0===e?void 0:e.constructor.name,(null===e||void 0===e?void 0:e.constructor)!==this.shape?"Constructor match failed":"Check failed")),n}}const db=function(e){return new hb(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)};db(hb);class pb extends ub{constructor(e){super(),this.shape=e}check(e,t){const n=this.shape(e);return!n&&(null===t||void 0===t||t.extend(null,"custom prop",null===e||void 0===e?void 0:e.constructor.name,"failed to check custom prop")),n}}const fb=e=>new pb(e);db(pb);class mb extends ub{constructor(e){super(),this.shape=e}check(e,t){const n=this.shape.some(t=>t===e);return!n&&(null===t||void 0===t||t.extend(null,this.shape.join(" | "),e.toString())),n}}const gb=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new mb(t)},vb=db(mb),yb=RegExp.escape||(e=>e.replace(/[().|&,$^[\]]/g,e=>"\\"+e)),Ob=e=>Jb.check(e)?[yb(e)]:vb.check(e)?e.shape.map(e=>e+""):Kb.check(e)?["[+-]?\\d+.?\\d*"]:ek.check(e)?[".*"]:Vb.check(e)?e.shape.map(Ob).flat(1):void KO();class wb extends ub{constructor(e){super(),this.shape=e,this._r=new RegExp("^"+e.map(Ob).map(e=>"(".concat(e.join("|"),")")).join("")+"$")}check(e,t){const n=null!=this._r.exec(e);return!n&&(null===t||void 0===t||t.extend(null,this._r.toString(),e.toString(),"String doesn't match string template.")),n}}db(wb);const bb=Symbol("optional");class kb extends ub{constructor(e){super(),this.shape=e}check(e,t){const n=void 0===e||this.shape.check(e);return!n&&(null===t||void 0===t||t.extend(null,"undefined (optional)","()")),n}get[bb](){return!0}}const xb=db(kb);class Db extends ub{check(e,t){return null===t||void 0===t||t.extend(null,"never",typeof e),!1}}new Db,db(Db);class Sb extends ub{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.shape=e,this._isPartial=t}get partial(){return new Sb(this.shape,!0)}check(e,t){return null==e?(null===t||void 0===t||t.extend(null,"object","null"),!1):Mw(this.shape,(n,i)=>{const r=this._isPartial&&!Fw(e,i)||n.check(e[i],t);return!r&&(null===t||void 0===t||t.extend(i.toString(),n.toString(),typeof e[i],"Object property does not match")),r})}}h(Sb,"_dilutes",!0);const Cb=db(Sb),Ab=fb(e=>null!=e&&(e.constructor===Object||null==e.constructor));class Eb extends ub{constructor(e,t){super(),this.shape={keys:e,values:t}}check(e,t){return null!=e&&Mw(e,(n,i)=>{const r=this.shape.keys.check(i,t);return!r&&(null===t||void 0===t||t.extend(i+"","Record",typeof e,r?"Key doesn't match schema":"Value doesn't match value")),r&&this.shape.values.check(n,t)})}}const _b=(e,t)=>new Eb(e,t),Tb=db(Eb);class Pb extends ub{constructor(e){super(),this.shape=e}check(e,t){return null!=e&&Mw(this.shape,(n,i)=>{const r=n.check(e[i],t);return!r&&(null===t||void 0===t||t.extend(i.toString(),"Tuple",typeof n)),r})}}db(Pb);class Mb extends ub{constructor(e){super(),this.shape=1===e.length?e[0]:new zb(e)}check(e,t){const n=sO(e)&&iO(e,e=>this.shape.check(e));return!n&&(null===t||void 0===t||t.extend(null,"Array","")),n}}const Fb=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Mb(t)},Rb=db(Mb),Nb=fb(e=>sO(e));class Ib extends ub{constructor(e,t){super(),this.shape=e,this._c=t}check(e,t){const n=e instanceof this.shape&&(null==this._c||this._c(e));return!n&&(null===t||void 0===t||t.extend(null,this.shape.name,null===e||void 0===e?void 0:e.constructor.name)),n}}db(Ib);const Bb=function(e){return new Ib(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}(ub);class Qb extends ub{constructor(e){super(),this.len=e.length-1,this.args=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Pb(t)}(...e.slice(-1)),this.res=e[this.len]}check(e,t){const n=e.constructor===Function&&e.length<=this.len;return!n&&(null===t||void 0===t||t.extend(null,"function",typeof e)),n}}const Lb=db(Qb),jb=fb(e=>"function"===typeof e);class $b extends ub{constructor(e){super(),this.shape=e}check(e,t){const n=iO(this.shape,n=>n.check(e,t));return!n&&(null===t||void 0===t||t.extend(null,"Intersectinon",typeof e)),n}}db($b,e=>e.shape.length>0);class zb extends ub{constructor(e){super(),this.shape=e}check(e,t){const n=rO(this.shape,n=>n.check(e,t));return null===t||void 0===t||t.extend(null,"Union",typeof e),n}}h(zb,"_dilutes",!0);const Wb=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.findIndex(e=>Vb.check(e))>=0?Wb(...t.map(e=>ak(e)).map(e=>Vb.check(e)?e.shape:[e]).flat(1)):1===t.length?t[0]:new zb(t)},Vb=db(zb),Ub=()=>!0,Xb=fb(Ub),qb=db(pb,e=>e.shape===Ub),Zb=fb(e=>"bigint"===typeof e),Hb=fb(e=>e===Zb),Yb=fb(e=>"symbol"===typeof e),Gb=(fb(e=>e===Yb),fb(e=>"number"===typeof e)),Kb=fb(e=>e===Gb),Jb=fb(e=>"string"===typeof e),ek=fb(e=>e===Jb),tk=fb(e=>"boolean"===typeof e),nk=fb(e=>e===tk),ik=gb(void 0),rk=(db(mb,e=>1===e.shape.length&&void 0===e.shape[0]),gb(void 0),gb(null)),sk=db(mb,e=>1===e.shape.length&&null===e.shape[0]),ok=(db(Uint8Array),db(hb,e=>e.shape===Uint8Array),Wb(Gb,Jb,rk,ik,Zb,tk,Yb)),ak=((()=>{const e=Fb(Xb),t=_b(Jb,Xb),n=Wb(Gb,Jb,rk,tk,e,t);e.shape=n,t.shape.values=n})(),e=>{if(Bb.check(e))return e;if(Ab.check(e)){const t={};for(const n in e)t[n]=ak(e[n]);return new Sb(t)}return Nb.check(e)?Wb(...e.map(ak)):ok.check(e)?gb(e):jb.check(e)?db(e):void KO()}),lk=qw?()=>{}:(e,t)=>{const n=new lb;if(!t.check(e,n))throw YO("Expected value to be of type ".concat(t.constructor.name,".\n").concat(n.toString()))};class ck{constructor(e){this.patterns=[],this.$state=e}if(e,t){return this.patterns.push({if:ak(e),h:t}),this}else(e){return this.if(Xb,e)}done(){return(e,t)=>{for(let n=0;n<this.patterns.length;n++){const i=this.patterns[n];if(i.if.check(e))return i.h(e,t)}throw YO("Unhandled pattern")}}}const uk=(hk=Xb,new ck(hk)).if(Kb,(e,t)=>tb(t,OO,yO)).if(ek,(e,t)=>function(e){const t=ib(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:20);let n="";for(let i=0;i<t;i++)n+=rb(e);return n}(t)).if(nk,(e,t)=>eb(t)).if(Hb,(e,t)=>BigInt(tb(t,OO,yO))).if(Vb,(e,t)=>dk(t,sb(t,e.shape))).if(Cb,(e,t)=>{const n={};for(const i in e.shape){let r=e.shape[i];if(xb.check(r)){if(eb(t))continue;r=r.shape}n[i]=uk(r,t)}return n}).if(Rb,(e,t)=>{const n=[],i=nb(t,0,42);for(let r=0;r<i;r++)n.push(dk(t,e.shape));return n}).if(vb,(e,t)=>sb(t,e.shape)).if(sk,(e,t)=>null).if(Lb,(e,t)=>{const n=dk(t,e.res);return()=>n}).if(qb,(e,t)=>dk(t,sb(t,[Gb,Jb,rk,ik,Zb,tk,Fb(Gb),_b(Wb("a","b","c"),Gb)]))).if(Tb,(e,t)=>{const n={},i=tb(t,0,3);for(let r=0;r<i;r++){const i=dk(t,e.shape.keys),r=dk(t,e.shape.values);n[i]=r}return n}).done();var hk;const dk=(e,t)=>uk(ak(t),e),pk="undefined"!==typeof document?document:{},fk=(fb(e=>e.nodeType===yk),"undefined"!==typeof DOMParser&&new DOMParser,fb(e=>e.nodeType===mk),fb(e=>e.nodeType===gk),e=>((e,t)=>{const n=[];for(const[i,r]of e)n.push(t(r,i));return n})(e,(e,t)=>"".concat(t,":").concat(e,";")).join("")),mk=pk.ELEMENT_NODE,gk=pk.TEXT_NODE,vk=(pk.CDATA_SECTION_NODE,pk.COMMENT_NODE,pk.DOCUMENT_NODE),yk=(pk.DOCUMENT_TYPE_NODE,pk.DOCUMENT_FRAGMENT_NODE),Ok=(fb(e=>e.nodeType===vk),Symbol),wk=Date.now,bk=Ok(),kk=Ok(),xk=Ok(),Dk=Ok(),Sk=Ok(),Ck=Ok(),Ak=Ok(),Ek=Ok(),_k=Ok();wk();const Tk={[bk]:Jw("font-weight","bold"),[kk]:Jw("font-weight","normal"),[xk]:Jw("color","blue"),[Sk]:Jw("color","green"),[Dk]:Jw("color","grey"),[Ck]:Jw("color","red"),[Ak]:Jw("color","purple"),[Ek]:Jw("color","orange"),[_k]:Jw("color","black")},Pk=Zw?e=>{var t;1===e.length&&(null===(t=e[0])||void 0===t?void 0:t.constructor)===Function&&(e=e[0]());const n=[],i=[],r=Yy();let s=[],o=0;for(;o<e.length;o++){const t=e[o],s=Tk[t];if(void 0!==s)r.set(s.left,s.right);else{if(void 0===t)break;if(t.constructor!==String&&t.constructor!==Number)break;{const e=fk(r);o>0||e.length>0?(n.push("%c"+t),i.push(e)):n.push(t)}}}for(o>0&&(s=i,s.unshift(n.join("")));o<e.length;o++){const t=e[o];t instanceof Symbol||s.push(t)}return s}:e=>{var t;1===e.length&&(null===(t=e[0])||void 0===t?void 0:t.constructor)===Function&&(e=e[0]());const n=[],i=[];let r=0;for(;r<e.length;r++){const t=e[r];if(void 0===t)break;if(t.constructor===String||t.constructor===Number)n.push(t);else if(t.constructor===Object)break}for(r>0&&i.push(n.join(""));r<e.length;r++){const t=e[r];t instanceof Symbol||i.push(t)}return i},Mk=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log(...Pk(t)),Rk.forEach(e=>e.print(t))},Fk=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.warn(...Pk(t)),t.unshift(Ek),Rk.forEach(e=>e.print(t))},Rk=Jy();const Nk=e=>({[Symbol.iterator](){return this},next:e}),Ik=(e,t)=>Nk(()=>{const{done:n,value:i}=e.next();return{done:n,value:n?void 0:t(i)}});class Bk{constructor(e,t){this.clock=e,this.len=t}}class Qk{constructor(){this.clients=new Map}}const Lk=(e,t,n)=>t.clients.forEach((t,i)=>{const r=e.doc.store.clients.get(i);if(null!=r){const i=r[r.length-1],s=i.id.clock+i.length;for(let o=0,a=t[o];o<t.length&&a.clock<s;a=t[++o])Xx(e,r,a.clock,a.len,n)}}),jk=(e,t)=>{const n=e.clients.get(t.client);return void 0!==n&&null!==((e,t)=>{let n=0,i=e.length-1;for(;n<=i;){const r=lO((n+i)/2),s=e[r],o=s.clock;if(o<=t){if(t<o+s.len)return r;n=r+1}else i=r-1}return null})(n,t.clock)},$k=e=>{e.clients.forEach(e=>{let t,n;for(e.sort((e,t)=>e.clock-t.clock),t=1,n=1;t<e.length;t++){const i=e[n-1],r=e[t];i.clock+i.len>=r.clock?i.len=hO(i.len,r.clock+r.len-i.clock):(n<t&&(e[n]=r),n++)}e.length=n})},zk=e=>{const t=new Qk;for(let n=0;n<e.length;n++)e[n].clients.forEach((i,r)=>{if(!t.clients.has(r)){const s=i.slice();for(let t=n+1;t<e.length;t++)tO(s,e[t].clients.get(r)||[]);t.clients.set(r,s)}});return $k(t),t},Wk=(e,t,n,i)=>{Ky(e.clients,t,()=>[]).push(new Bk(n,i))},Vk=()=>new Qk,Uk=e=>{const t=Vk();return e.clients.forEach((e,n)=>{const i=[];for(let t=0;t<e.length;t++){const n=e[t];if(n.deleted){const r=n.id.clock;let s=n.length;if(t+1<e.length)for(let n=e[t+1];t+1<e.length&&n.deleted;n=e[1+ ++t])s+=n.length;i.push(new Bk(r,s))}}i.length>0&&t.clients.set(n,i)}),t},Xk=(e,t)=>{RO(e.restEncoder,t.clients.size),nO(t.clients.entries()).sort((e,t)=>t[0]-e[0]).forEach(t=>{let[n,i]=t;e.resetDsCurVal(),RO(e.restEncoder,n);const r=i.length;RO(e.restEncoder,r);for(let s=0;s<r;s++){const t=i[s];e.writeDsClock(t.clock),e.writeDsLen(t.len)}})},qk=e=>{const t=new Qk,n=aw(e.restDecoder);for(let i=0;i<n;i++){e.resetDsCurVal();const n=aw(e.restDecoder),i=aw(e.restDecoder);if(i>0){const r=Ky(t.clients,n,()=>[]);for(let t=0;t<i;t++)r.push(new Bk(e.readDsClock(),e.readDsLen()))}}return t},Zk=(e,t,n)=>{const i=new Qk,r=aw(e.restDecoder);for(let s=0;s<r;s++){e.resetDsCurVal();const r=aw(e.restDecoder),s=aw(e.restDecoder),o=n.clients.get(r)||[],a=Lx(n,r);for(let n=0;n<s;n++){const n=e.readDsClock(),s=n+e.readDsLen();if(n<a){a<s&&Wk(i,r,a,s-a);let e=$x(o,n),l=o[e];for(!l.deleted&&l.id.clock<n&&(o.splice(e+1,0,LS(t,l,n-l.id.clock)),e++);e<o.length&&(l=o[e++],l.id.clock<s);)l.deleted||(s<l.id.clock+l.length&&o.splice(e,0,LS(t,l,s-l.id.clock)),l.delete(t))}else Wk(i,r,n,s-n)}}if(i.clients.size>0){const e=new rx;return RO(e.restEncoder,0),Xk(e,i),e.toUint8Array()}return null},Hk=Ow;class Yk extends oO{constructor(){let{guid:e=bw(),collectionid:t=null,gc:n=!0,gcFilter:i=()=>!0,meta:r=null,autoLoad:s=!1,shouldLoad:o=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.gc=n,this.gcFilter=i,this.clientID=Hk(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new Bx,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=s,this.meta=r,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=kw(e=>{this.on("load",()=>{this.isLoaded=!0,e(this)})});const a=()=>kw(e=>{const t=n=>{void 0!==n&&!0!==n||(this.off("sync",t),e())};this.on("sync",t)});this.on("sync",e=>{!1===e&&this.isSynced&&(this.whenSynced=a()),this.isSynced=void 0===e||!0===e,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=a()}load(){const e=this._item;null===e||this.shouldLoad||eD(e.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(nO(this.subdocs).map(e=>e.guid))}transact(e){return eD(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:CD;const n=Ky(this.share,e,()=>{const e=new t;return e._integrate(this,null),e}),i=n.constructor;if(t!==CD&&i!==t){if(i===CD){const i=new t;i._map=n._map,n._map.forEach(e=>{for(;null!==e;e=e.left)e.parent=i}),i._start=n._start;for(let e=i._start;null!==e;e=e.right)e.parent=i;return i._length=n._length,this.share.set(e,i),i._integrate(this,null),i}throw new Error("Type with the name ".concat(e," has already been defined with a different constructor"))}return n}getArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,UD)}getText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,cS)}getMap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,qD)}getXmlElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,dS)}getXmlFragment(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,hS)}toJSON(){const e={};return this.share.forEach((t,n)=>{e[n]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,nO(this.subdocs).forEach(e=>e.destroy());const e=this._item;if(null!==e){this._item=null;const t=e.content;t.doc=new Yk(p(p({guid:this.guid},t.opts),{},{shouldLoad:!1})),t.doc._item=e,eD(e.parent.doc,n=>{const i=t.doc;e.deleted||n.subdocsAdded.add(i),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class Gk{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return aw(this.restDecoder)}readDsLen(){return aw(this.restDecoder)}}class Kk extends Gk{readLeftID(){return kx(aw(this.restDecoder),aw(this.restDecoder))}readRightID(){return kx(aw(this.restDecoder),aw(this.restDecoder))}readClient(){return aw(this.restDecoder)}readInfo(){return ow(this.restDecoder)}readString(){return cw(this.restDecoder)}readParentInfo(){return 1===aw(this.restDecoder)}readTypeRef(){return aw(this.restDecoder)}readLen(){return aw(this.restDecoder)}readAny(){return dw(this.restDecoder)}readBuf(){return(e=>{const t=Hw(e.byteLength);return t.set(e),t})(sw(this.restDecoder))}readJSON(){return JSON.parse(cw(this.restDecoder))}readKey(){return cw(this.restDecoder)}}class Jk{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=aw(this.restDecoder),this.dsCurrVal}readDsLen(){const e=aw(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class ex extends Jk{constructor(e){super(e),this.keys=[],aw(e),this.keyClockDecoder=new mw(sw(e)),this.clientDecoder=new fw(sw(e)),this.leftClockDecoder=new mw(sw(e)),this.rightClockDecoder=new mw(sw(e)),this.infoDecoder=new pw(sw(e),ow),this.stringDecoder=new gw(sw(e)),this.parentInfoDecoder=new pw(sw(e),ow),this.typeRefDecoder=new fw(sw(e)),this.lenDecoder=new fw(sw(e))}readLeftID(){return new wx(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new wx(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return dw(this.restDecoder)}readBuf(){return sw(this.restDecoder)}readJSON(){return dw(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class tx{constructor(){this.restEncoder=TO()}toUint8Array(){return PO(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){RO(this.restEncoder,e)}writeDsLen(e){RO(this.restEncoder,e)}}class nx extends tx{writeLeftID(e){RO(this.restEncoder,e.client),RO(this.restEncoder,e.clock)}writeRightID(e){RO(this.restEncoder,e.client),RO(this.restEncoder,e.clock)}writeClient(e){RO(this.restEncoder,e)}writeInfo(e){FO(this.restEncoder,e)}writeString(e){QO(this.restEncoder,e)}writeParentInfo(e){RO(this.restEncoder,e?1:0)}writeTypeRef(e){RO(this.restEncoder,e)}writeLen(e){RO(this.restEncoder,e)}writeAny(e){WO(this.restEncoder,e)}writeBuf(e){jO(this.restEncoder,e)}writeJSON(e){QO(this.restEncoder,JSON.stringify(e))}writeKey(e){QO(this.restEncoder,e)}}class ix{constructor(){this.restEncoder=TO(),this.dsCurrVal=0}toUint8Array(){return PO(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,RO(this.restEncoder,t)}writeDsLen(e){0===e&&KO(),RO(this.restEncoder,e-1),this.dsCurrVal+=e}}class rx extends ix{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new ZO,this.clientEncoder=new XO,this.leftClockEncoder=new ZO,this.rightClockEncoder=new ZO,this.infoEncoder=new VO(FO),this.stringEncoder=new HO,this.parentInfoEncoder=new VO(FO),this.typeRefEncoder=new XO,this.lenEncoder=new XO}toUint8Array(){const e=TO();return RO(e,0),jO(e,this.keyClockEncoder.toUint8Array()),jO(e,this.clientEncoder.toUint8Array()),jO(e,this.leftClockEncoder.toUint8Array()),jO(e,this.rightClockEncoder.toUint8Array()),jO(e,PO(this.infoEncoder)),jO(e,this.stringEncoder.toUint8Array()),jO(e,PO(this.parentInfoEncoder)),jO(e,this.typeRefEncoder.toUint8Array()),jO(e,this.lenEncoder.toUint8Array()),LO(e,PO(this.restEncoder)),PO(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){WO(this.restEncoder,e)}writeBuf(e){jO(this.restEncoder,e)}writeJSON(e){WO(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);void 0===t?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const sx=(e,t,n)=>{const i=new Map;n.forEach((e,n)=>{Lx(t,n)>e&&i.set(n,e)}),Qx(t).forEach((e,t)=>{n.has(t)||i.set(t,0)}),RO(e.restEncoder,i.size),nO(i.entries()).sort((e,t)=>t[0]-e[0]).forEach(n=>{let[i,r]=n;((e,t,n,i)=>{i=hO(i,t[0].id.clock);const r=$x(t,i);RO(e.restEncoder,t.length-r),e.writeClient(n),RO(e.restEncoder,i);const s=t[r];s.write(e,i-s.id.clock);for(let o=r+1;o<t.length;o++)t[o].write(e,0)})(e,t.clients.get(i),i,r)})},ox=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ex(e);return eD(t,e=>{e.local=!1;let t=!1;const n=e.doc,r=n.store,s=((e,t)=>{const n=Yy(),i=aw(e.restDecoder);for(let r=0;r<i;r++){const i=aw(e.restDecoder),r=new Array(i),s=e.readClient();let o=aw(e.restDecoder);n.set(s,{i:0,refs:r});for(let n=0;n<i;n++){const i=e.readInfo();switch(31&i){case 0:{const t=e.readLen();r[n]=new vS(kx(s,o),t),o+=t;break}case 10:{const t=aw(e.restDecoder);r[n]=new US(kx(s,o),t),o+=t;break}default:{const a=0===(192&i),l=new zS(kx(s,o),null,(i&fO)===fO?e.readLeftID():null,null,(i&pO)===pO?e.readRightID():null,a?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,a&&32===(32&i)?e.readString():null,WS(e,i));r[n]=l,o+=l.length}}}}return n})(i,n),o=((e,t,n)=>{const i=[];let r=nO(n.keys()).sort((e,t)=>e-t);if(0===r.length)return null;const s=()=>{if(0===r.length)return null;let e=n.get(r[r.length-1]);for(;e.refs.length===e.i;){if(r.pop(),!(r.length>0))return null;e=n.get(r[r.length-1])}return e};let o=s();if(null===o)return null;const a=new Bx,l=new Map,c=(e,t)=>{const n=l.get(e);(null==n||n>t)&&l.set(e,t)};let u=o.refs[o.i++];const h=new Map,d=()=>{for(const e of i){const t=e.id.client,i=n.get(t);i?(i.i--,a.clients.set(t,i.refs.slice(i.i)),n.delete(t),i.i=0,i.refs=[]):a.clients.set(t,[e]),r=r.filter(e=>e!==t)}i.length=0};for(;;){if(u.constructor!==US){const r=Ky(h,u.id.client,()=>Lx(t,u.id.client))-u.id.clock;if(r<0)i.push(u),c(u.id.client,u.id.clock-1),d();else{const s=u.getMissing(e,t);if(null!==s){i.push(u);const e=n.get(s)||{refs:[],i:0};if(e.refs.length!==e.i){u=e.refs[e.i++];continue}c(s,Lx(t,s)),d()}else(0===r||r<u.length)&&(u.integrate(e,r),h.set(u.id.client,u.id.clock+u.length))}}if(i.length>0)u=i.pop();else if(null!==o&&o.i<o.refs.length)u=o.refs[o.i++];else{if(o=s(),null===o)break;u=o.refs[o.i++]}}if(a.clients.size>0){const e=new rx;return sx(e,a,new Map),RO(e.restEncoder,0),{missing:l,update:e.toUint8Array()}}return null})(e,r,s),a=r.pendingStructs;if(a){for(const[e,n]of a.missing)if(n<Lx(r,e)){t=!0;break}if(o){for(const[e,t]of o.missing){const n=a.missing.get(e);(null==n||n>t)&&a.missing.set(e,t)}a.update=cD([a.update,o.update])}}else r.pendingStructs=o;const l=Zk(i,e,r);if(r.pendingDs){const t=new ex(nw(r.pendingDs));aw(t.restDecoder);const n=Zk(t,e,r);r.pendingDs=l&&n?cD([l,n]):l||n}else r.pendingDs=l;if(t){const t=r.pendingStructs.update;r.pendingStructs=null,ax(e.doc,t)}},n,!1)},ax=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ex;const r=nw(t);ox(r,e,n,new i(r))},lx=(e,t,n)=>ax(e,t,n,Kk),cx=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint8Array([0]),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new rx;!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;sx(e,t.store,n),Xk(e,Uk(t.store))}(n,e,dx(t));const i=[n.toUint8Array()];if(e.store.pendingDs&&i.push(e.store.pendingDs),e.store.pendingStructs&&i.push(uD(e.store.pendingStructs.update,t)),i.length>1){if(n.constructor===nx)return aD(i.map((e,t)=>0===t?e:mD(e)));if(n.constructor===rx)return cD(i)}return i[0]},ux=(e,t)=>cx(e,t,new nx),hx=e=>{const t=new Map,n=aw(e.restDecoder);for(let i=0;i<n;i++){const n=aw(e.restDecoder),i=aw(e.restDecoder);t.set(n,i)}return t},dx=e=>hx(new Gk(nw(e))),px=(e,t)=>(RO(e.restEncoder,t.size),nO(t.entries()).sort((e,t)=>t[0]-e[0]).forEach(t=>{let[n,i]=t;RO(e.restEncoder,n),RO(e.restEncoder,i)}),e),fx=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ix;return e instanceof Map?px(t,e):((e,t)=>{px(e,Qx(t.store))})(t,e),t.toUint8Array()};class mx{constructor(){this.l=[]}}const gx=()=>new mx,vx=(e,t)=>e.l.push(t),yx=(e,t)=>{const n=e.l,i=n.length;e.l=n.filter(e=>t!==e),i===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Ox=(e,t,n)=>Iw(e.l,[t,n]);class wx{constructor(e,t){this.client=e,this.clock=t}}const bx=(e,t)=>e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock,kx=(e,t)=>new wx(e,t),xx=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw KO()},Dx=(e,t)=>{for(;null!==t;){if(t.parent===e)return!0;t=t.parent._item}return!1};class Sx{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.type=e,this.tname=t,this.item=n,this.assoc=i}}const Cx=e=>{var t;return new Sx(null==e.type?null:kx(e.type.client,e.type.clock),null!==(t=e.tname)&&void 0!==t?t:null,null==e.item?null:kx(e.item.client,e.item.clock),null==e.assoc?0:e.assoc)};class Ax{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.type=e,this.index=t,this.assoc=n}}const Ex=(e,t,n)=>{let i=null,r=null;return null===e._item?r=xx(e):i=kx(e._item.id.client,e._item.id.clock),new Sx(i,r,t,n)},_x=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=e._start;if(n<0){if(0===t)return Ex(e,null,n);t--}for(;null!==i;){if(!i.deleted&&i.countable){if(i.length>t)return Ex(e,kx(i.id.client,i.id.clock+t),n);t-=i.length}if(null===i.right&&n<0)return Ex(e,i.lastId,n);i=i.right}return Ex(e,null,n)},Tx=function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=t.store,r=e.item,s=e.type,o=e.tname,a=e.assoc;let l=null,c=0;if(null!==r){if(Lx(i,r.client)<=r.clock)return null;const e=n?BS(i,r):((e,t)=>{const n=zx(e,t);return{item:n,diff:t.clock-n.id.clock}})(i,r),t=e.item;if(!(t instanceof zS))return null;if(l=t.parent,null===l._item||!l._item.deleted){c=t.deleted||!t.countable?0:e.diff+(a>=0?0:1);let n=t.left;for(;null!==n;)!n.deleted&&n.countable&&(c+=n.length),n=n.left}}else{if(null!==o)l=t.get(o);else{if(null===s)throw KO();{if(Lx(i,s.client)<=s.clock)return null;const{item:e}=n?BS(i,s):{item:zx(i,s)};if(!(e instanceof zS&&e.content instanceof IS))return null;l=e.content.type}}c=a>=0?l._length:0}return function(e,t){return new Ax(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)}(l,c,e.assoc)},Px=(e,t)=>e===t||null!==e&&null!==t&&e.tname===t.tname&&bx(e.item,t.item)&&bx(e.type,t.type)&&e.assoc===t.assoc;class Mx{constructor(e,t){this.ds=e,this.sv=t}}const Fx=(e,t)=>new Mx(e,t),Rx=(Fx(Vk(),new Map),e=>Fx(Uk(e.store),Qx(e.store))),Nx=(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!jk(t.ds,e.id),Ix=(e,t)=>{const n=Ky(e.meta,Ix,Jy),i=e.doc.store;n.has(t)||(t.sv.forEach((t,n)=>{t<Lx(i,n)&&Vx(e,kx(n,t))}),Lk(e,t.ds,e=>{}),n.add(t))};class Bx{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Qx=e=>{const t=new Map;return e.clients.forEach((e,n)=>{const i=e[e.length-1];t.set(n,i.id.clock+i.length)}),t},Lx=(e,t)=>{const n=e.clients.get(t);if(void 0===n)return 0;const i=n[n.length-1];return i.id.clock+i.length},jx=(e,t)=>{let n=e.clients.get(t.id.client);if(void 0===n)n=[],e.clients.set(t.id.client,n);else{const e=n[n.length-1];if(e.id.clock+e.length!==t.id.clock)throw KO()}n.push(t)},$x=(e,t)=>{let n=0,i=e.length-1,r=e[i],s=r.id.clock;if(s===t)return i;let o=lO(t/(s+r.length-1)*i);for(;n<=i;){if(r=e[o],s=r.id.clock,s<=t){if(t<s+r.length)return o;n=o+1}else i=o-1;o=lO((n+i)/2)}throw KO()},zx=(e,t)=>{const n=e.clients.get(t.client);return n[$x(n,t.clock)]},Wx=(e,t,n)=>{const i=$x(t,n),r=t[i];return r.id.clock<n&&r instanceof zS?(t.splice(i+1,0,LS(e,r,n-r.id.clock)),i+1):i},Vx=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[Wx(e,n,t.clock)]},Ux=(e,t,n)=>{const i=t.clients.get(n.client),r=$x(i,n.clock),s=i[r];return n.clock!==s.id.clock+s.length-1&&s.constructor!==vS&&i.splice(r+1,0,LS(e,s,n.clock-s.id.clock+1)),s},Xx=(e,t,n,i,r)=>{if(0===i)return;const s=n+i;let o,a=Wx(e,t,n);do{o=t[a++],s<o.id.clock+o.length&&Wx(e,t,s),r(o)}while(a<t.length&&t[a].id.clock<s)};class qx{constructor(e,t,n){this.doc=e,this.deleteSet=new Qk,this.beforeState=Qx(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Zx=(e,t)=>!(0===t.deleteSet.clients.size&&!((e,t)=>{for(const[n,i]of e)if(t(i,n))return!0;return!1})(t.afterState,(e,n)=>t.beforeState.get(n)!==e))&&($k(t.deleteSet),((e,t)=>{sx(e,t.doc.store,t.beforeState)})(e,t),Xk(e,t.deleteSet),!0),Hx=(e,t,n)=>{const i=t._item;(null===i||i.id.clock<(e.beforeState.get(i.id.client)||0)&&!i.deleted)&&Ky(e.changed,t,Jy).add(n)},Yx=(e,t)=>{let n=e[t],i=e[t-1],r=t;for(;r>0&&(i.deleted===n.deleted&&i.constructor===n.constructor&&i.mergeWith(n));n=i,i=e[--r-1])n instanceof zS&&null!==n.parentSub&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,i);const s=t-r;return s&&e.splice(t+1-s,s),s},Gx=(e,t,n)=>{for(const[i,r]of e.clients.entries()){const e=t.clients.get(i);for(let i=r.length-1;i>=0;i--){const s=r[i],o=s.clock+s.len;for(let i=$x(e,s.clock),r=e[i];i<e.length&&r.id.clock<o;r=e[++i]){const r=e[i];if(s.clock+s.len<=r.id.clock)break;r instanceof zS&&r.deleted&&!r.keep&&n(r)&&r.gc(t,!1)}}}},Kx=(e,t)=>{e.clients.forEach((e,n)=>{const i=t.clients.get(n);for(let t=e.length-1;t>=0;t--){const n=e[t];for(let e=uO(i.length-1,1+$x(i,n.clock+n.len-1)),t=i[e];e>0&&t.id.clock>=n.clock;t=i[e])e-=1+Yx(i,e)}})},Jx=(e,t)=>{if(t<e.length){const n=e[t],i=n.doc,r=i.store,s=n.deleteSet,o=n._mergeStructs;try{$k(s),n.afterState=Qx(n.doc.store),i.emit("beforeObserverCalls",[n,i]);const e=[];n.changed.forEach((t,i)=>e.push(()=>{null!==i._item&&i._item.deleted||i._callObserver(n,t)})),e.push(()=>{n.changedParentTypes.forEach((t,i)=>{i._dEH.l.length>0&&(null===i._item||!i._item.deleted)&&((t=t.filter(e=>null===e.target._item||!e.target._item.deleted)).forEach(e=>{e.currentTarget=i,e._path=null}),t.sort((e,t)=>e.path.length-t.path.length),e.push(()=>{Ox(i._dEH,t,n)}))}),e.push(()=>i.emit("afterTransaction",[n,i])),e.push(()=>{n._needFormattingCleanup&&oS(n)})}),Iw(e,[])}finally{i.gc&&Gx(s,r,i.gcFilter),Kx(s,r),n.afterState.forEach((e,t)=>{const i=n.beforeState.get(t)||0;if(i!==e){const e=r.clients.get(t),n=hO($x(e,i),1);for(let t=e.length-1;t>=n;)t-=1+Yx(e,t)}});for(let e=o.length-1;e>=0;e--){const{client:t,clock:n}=o[e].id,i=r.clients.get(t),s=$x(i,n);s+1<i.length&&Yx(i,s+1)>1||s>0&&Yx(i,s)}if(n.local||n.afterState.get(i.clientID)===n.beforeState.get(i.clientID)||(Mk(Ek,bk,"[yjs] ",kk,Ck,"Changed the client-id because another client seems to be using it."),i.clientID=Hk()),i.emit("afterTransactionCleanup",[n,i]),i._observers.has("update")){const e=new nx;Zx(e,n)&&i.emit("update",[e.toUint8Array(),n.origin,i,n])}if(i._observers.has("updateV2")){const e=new rx;Zx(e,n)&&i.emit("updateV2",[e.toUint8Array(),n.origin,i,n])}const{subdocsAdded:a,subdocsLoaded:l,subdocsRemoved:c}=n;(a.size>0||c.size>0||l.size>0)&&(a.forEach(e=>{e.clientID=i.clientID,null==e.collectionid&&(e.collectionid=i.collectionid),i.subdocs.add(e)}),c.forEach(e=>i.subdocs.delete(e)),i.emit("subdocs",[{loaded:l,added:a,removed:c},i,n]),c.forEach(e=>e.destroy())),e.length<=t+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,e])):Jx(e,t+1)}}},eD=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=e._transactionCleanups;let s=!1,o=null;null===e._transaction&&(s=!0,e._transaction=new qx(e,n,i),r.push(e._transaction),1===r.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{o=t(e._transaction)}finally{if(s){const t=e._transaction===r[0];e._transaction=null,t&&Jx(r,0)}}return o};class tD{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}const nD=(e,t,n)=>{Lk(e,n.deletions,n=>{n instanceof zS&&t.scope.some(t=>t===e.doc||Dx(t,n))&&QS(n,!1)})},iD=(e,t,n)=>{let i=null;const r=e.doc,s=e.scope;eD(r,n=>{for(;t.length>0&&null===e.currStackItem;){const i=r.store,o=t.pop(),a=new Set,l=[];let c=!1;Lk(n,o.insertions,e=>{if(e instanceof zS){if(null!==e.redone){let{item:t,diff:r}=BS(i,e.id);r>0&&(t=Vx(n,kx(t.id.client,t.id.clock+r))),e=t}!e.deleted&&s.some(t=>t===n.doc||Dx(t,e))&&l.push(e)}}),Lk(n,o.deletions,e=>{e instanceof zS&&s.some(t=>t===n.doc||Dx(t,e))&&!jk(o.insertions,e.id)&&a.add(e)}),a.forEach(t=>{c=null!==$S(n,t,a,o.insertions,e.ignoreRemoteMapChanges,e)||c});for(let t=l.length-1;t>=0;t--){const i=l[t];e.deleteFilter(i)&&(i.delete(n),c=!0)}e.currStackItem=c?o:null}n.changed.forEach((e,t)=>{e.has(null)&&t._searchMarker&&(t._searchMarker.length=0)}),i=n},e);const o=e.currStackItem;if(null!=o){const t=i.changedParentTypes;e.emit("stack-item-popped",[{stackItem:o,type:n,changedParentTypes:t,origin:e},e]),e.currStackItem=null}return o};class rD extends oO{constructor(e){let{captureTimeout:t=500,captureTransaction:n=e=>!0,deleteFilter:i=()=>!0,trackedOrigins:r=new Set([null]),ignoreRemoteMapChanges:s=!1,doc:o=(sO(e)?e[0].doc:e instanceof Yk?e:e.doc)}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.scope=[],this.doc=o,this.addToScope(e),this.deleteFilter=i,r.add(this),this.trackedOrigins=r,this.captureTransaction=n,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=s,this.captureTimeout=t,this.afterTransactionHandler=e=>{if(!this.captureTransaction(e)||!this.scope.some(t=>e.changedParentTypes.has(t)||t===this.doc)||!this.trackedOrigins.has(e.origin)&&(!e.origin||!this.trackedOrigins.has(e.origin.constructor)))return;const t=this.undoing,n=this.redoing,i=t?this.redoStack:this.undoStack;t?this.stopCapturing():n||this.clear(!1,!0);const r=new Qk;e.afterState.forEach((t,n)=>{const i=e.beforeState.get(n)||0,s=t-i;s>0&&Wk(r,n,i,s)});const s=wk();let o=!1;if(this.lastChange>0&&s-this.lastChange<this.captureTimeout&&i.length>0&&!t&&!n){const t=i[i.length-1];t.deletions=zk([t.deletions,e.deleteSet]),t.insertions=zk([t.insertions,r])}else i.push(new tD(e.deleteSet,r)),o=!0;t||n||(this.lastChange=s),Lk(e,e.deleteSet,t=>{t instanceof zS&&this.scope.some(n=>n===e.doc||Dx(n,t))&&QS(t,!0)});const a=[{stackItem:i[i.length-1],origin:e.origin,type:t?"redo":"undo",changedParentTypes:e.changedParentTypes},this];o?this.emit("stack-item-added",a):this.emit("stack-item-updated",a)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){const t=new Set(this.scope);(e=sO(e)?e:[e]).forEach(e=>{t.has(e)||(t.add(e),(e instanceof CD?e.doc!==this.doc:e!==this.doc)&&Fk("[yjs#509] Not same Y.Doc"),this.scope.push(e))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(e&&this.canUndo()||t&&this.canRedo())&&this.doc.transact(n=>{e&&(this.undoStack.forEach(e=>nD(n,this,e)),this.undoStack=[]),t&&(this.redoStack.forEach(e=>nD(n,this,e)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:t}])})}stopCapturing(){this.lastChange=0}undo(){let e;this.undoing=!0;try{e=iD(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){let e;this.redoing=!0;try{e=iD(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}class sD{constructor(e,t){this.gen=function*(e){const t=aw(e.restDecoder);for(let n=0;n<t;n++){const t=aw(e.restDecoder),n=e.readClient();let i=aw(e.restDecoder);for(let r=0;r<t;r++){const t=e.readInfo();if(10===t){const t=aw(e.restDecoder);yield new US(kx(n,i),t),i+=t}else if(0!==(31&t)){const r=0===(192&t),s=new zS(kx(n,i),null,(t&fO)===fO?e.readLeftID():null,null,(t&pO)===pO?e.readRightID():null,r?e.readParentInfo()?e.readString():e.readLeftID():null,r&&32===(32&t)?e.readString():null,WS(e,t));yield s,i+=s.length}else{const t=e.readLen();yield new vS(kx(n,i),t),i+=t}}}}(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===US);return this.curr}}class oD{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const aD=e=>cD(e,Kk,nx),lD=(e,t)=>{if(e.constructor===vS){const{client:n,clock:i}=e.id;return new vS(kx(n,i+t),e.length-t)}if(e.constructor===US){const{client:n,clock:i}=e.id;return new US(kx(n,i+t),e.length-t)}{const n=e,{client:i,clock:r}=n.id;return new zS(kx(i,r+t),null,kx(i,r+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},cD=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ex,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rx;if(1===e.length)return e[0];const i=e.map(e=>new t(nw(e)));let r=i.map(e=>new sD(e,!0)),s=null;const o=new n,a=new oD(o);for(;r=r.filter(e=>null!==e.curr),r.sort((e,t)=>{if(e.curr.id.client===t.curr.id.client){const n=e.curr.id.clock-t.curr.id.clock;return 0===n?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===US?1:-1:n}return t.curr.id.client-e.curr.id.client}),0!==r.length;){const e=r[0],t=e.curr.id.client;if(null!==s){let n=e.curr,i=!1;for(;null!==n&&n.id.clock+n.length<=s.struct.id.clock+s.struct.length&&n.id.client>=s.struct.id.client;)n=e.next(),i=!0;if(null===n||n.id.client!==t||i&&n.id.clock>s.struct.id.clock+s.struct.length)continue;if(t!==s.struct.id.client)dD(a,s.struct,s.offset),s={struct:n,offset:0},e.next();else if(s.struct.id.clock+s.struct.length<n.id.clock)if(s.struct.constructor===US)s.struct.length=n.id.clock+n.length-s.struct.id.clock;else{dD(a,s.struct,s.offset);const e=n.id.clock-s.struct.id.clock-s.struct.length;s={struct:new US(kx(t,s.struct.id.clock+s.struct.length),e),offset:0}}else{const t=s.struct.id.clock+s.struct.length-n.id.clock;t>0&&(s.struct.constructor===US?s.struct.length-=t:n=lD(n,t)),s.struct.mergeWith(n)||(dD(a,s.struct,s.offset),s={struct:n,offset:0},e.next())}}else s={struct:e.curr,offset:0},e.next();for(let n=e.curr;null!==n&&n.id.client===t&&n.id.clock===s.struct.id.clock+s.struct.length&&n.constructor!==US;n=e.next())dD(a,s.struct,s.offset),s={struct:n,offset:0}}null!==s&&(dD(a,s.struct,s.offset),s=null),pD(a);const l=i.map(e=>qk(e)),c=zk(l);return Xk(o,c),o.toUint8Array()},uD=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ex,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rx;const r=dx(t),s=new i,o=new oD(s),a=new n(nw(e)),l=new sD(a,!1);for(;l.curr;){const e=l.curr,t=e.id.client,n=r.get(t)||0;if(l.curr.constructor!==US)if(e.id.clock+e.length>n)for(dD(o,e,hO(n-e.id.clock,0)),l.next();l.curr&&l.curr.id.client===t;)dD(o,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===t&&l.curr.id.clock+l.curr.length<=n;)l.next();else l.next()}pD(o);const c=qk(a);return Xk(s,c),s.toUint8Array()},hD=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:PO(e.encoder.restEncoder)}),e.encoder.restEncoder=TO(),e.written=0)},dD=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&hD(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),RO(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},pD=e=>{hD(e);const t=e.encoder.restEncoder;RO(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const i=e.clientStructs[n];RO(t,i.written),LO(t,i.restEncoder)}},fD=(e,t,n,i)=>{const r=new n(nw(e)),s=new sD(r,!1),o=new i,a=new oD(o);for(let c=s.curr;null!==c;c=s.next())dD(a,t(c),0);pD(a);const l=qk(r);return Xk(o,l),o.toUint8Array()},mD=e=>fD(e,Bw,ex,nx),gD="You must not compute changes after the event-handler fired.";class vD{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=yD(this.currentTarget,this.target))}deletes(e){return jk(this.transaction.deleteSet,e.id)}get keys(){if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw YO(gD);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(n=>{if(null!==n){const i=t._map.get(n);let r,s;if(this.adds(i)){let e=i.left;for(;null!==e&&this.adds(e);)e=e.left;if(this.deletes(i)){if(null===e||!this.deletes(e))return;r="delete",s=eO(e.content.getContent())}else null!==e&&this.deletes(e)?(r="update",s=eO(e.content.getContent())):(r="add",s=void 0)}else{if(!this.deletes(i))return;r="delete",s=eO(i.content.getContent())}e.set(n,{action:r,oldValue:s})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(null===e){if(0===this.transaction.doc._transactionCleanups.length)throw YO(gD);const t=this.target,n=Jy(),i=Jy(),r=[];e={added:n,deleted:i,delta:r,keys:this.keys};if(this.transaction.changed.get(t).has(null)){let e=null;const s=()=>{e&&r.push(e)};for(let r=t._start;null!==r;r=r.right)r.deleted?this.deletes(r)&&!this.adds(r)&&(null!==e&&void 0!==e.delete||(s(),e={delete:0}),e.delete+=r.length,i.add(r)):this.adds(r)?(null!==e&&void 0!==e.insert||(s(),e={insert:[]}),e.insert=e.insert.concat(r.content.getContent()),n.add(r)):(null!==e&&void 0!==e.retain||(s(),e={retain:0}),e.retain+=r.length);null!==e&&void 0===e.retain&&s()}this._changes=e}return e}}const yD=(e,t)=>{const n=[];for(;null!==t._item&&t!==e;){if(null!==t._item.parentSub)n.unshift(t._item.parentSub);else{let e=0,i=t._item.parent._start;for(;i!==t._item&&null!==i;)!i.deleted&&i.countable&&(e+=i.length),i=i.right;n.unshift(e)}t=t._item.parent}return n},OD=()=>{Fk("Invalid access: Add Yjs type to a document before reading data.")};let wD=0;class bD{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=wD++}}const kD=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=wD++},xD=(e,t)=>{if(null===e._start||0===t||null===e._searchMarker)return null;const n=0===e._searchMarker.length?null:e._searchMarker.reduce((e,n)=>cO(t-e.index)<cO(t-n.index)?e:n);let i=e._start,r=0;for(null!==n&&(i=n.p,r=n.index,(e=>{e.timestamp=wD++})(n));null!==i.right&&r<t;){if(!i.deleted&&i.countable){if(t<r+i.length)break;r+=i.length}i=i.right}for(;null!==i.left&&r>t;)i=i.left,!i.deleted&&i.countable&&(r-=i.length);for(;null!==i.left&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)i=i.left,!i.deleted&&i.countable&&(r-=i.length);return null!==n&&cO(n.index-r)<i.parent.length/80?(kD(n,i,r),n):((e,t,n)=>{if(e.length>=80){const i=e.reduce((e,t)=>e.timestamp<t.timestamp?e:t);return kD(i,t,n),i}{const i=new bD(t,n);return e.push(i),i}})(e._searchMarker,i,r)},DD=(e,t,n)=>{for(let i=e.length-1;i>=0;i--){const r=e[i];if(n>0){let t=r.p;for(t.marker=!1;t&&(t.deleted||!t.countable);)t=t.left,t&&!t.deleted&&t.countable&&(r.index-=t.length);if(null===t||!0===t.marker){e.splice(i,1);continue}r.p=t,t.marker=!0}(t<r.index||n>0&&t===r.index)&&(r.index=hO(t,r.index+n))}},SD=(e,t,n)=>{const i=e,r=t.changedParentTypes;for(;Ky(r,e,()=>[]).push(n),null!==e._item;)e=e._item.parent;Ox(i._eH,n,t)};class CD{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=gx(),this._dEH=gx(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw GO()}clone(){throw GO()}_write(e){}get _first(){let e=this._start;for(;null!==e&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){vx(this._eH,e)}observeDeep(e){vx(this._dEH,e)}unobserve(e){yx(this._eH,e)}unobserveDeep(e){yx(this._dEH,e)}toJSON(){}}const AD=(e,t,n)=>{var i;null!==(i=e.doc)&&void 0!==i||OD(),t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const s=[];let o=e._start;for(;null!==o&&r>0;){if(o.countable&&!o.deleted){const e=o.content.getContent();if(e.length<=t)t-=e.length;else{for(let n=t;n<e.length&&r>0;n++)s.push(e[n]),r--;t=0}}o=o.right}return s},ED=e=>{var t;null!==(t=e.doc)&&void 0!==t||OD();const n=[];let i=e._start;for(;null!==i;){if(i.countable&&!i.deleted){const e=i.content.getContent();for(let t=0;t<e.length;t++)n.push(e[t])}i=i.right}return n},_D=(e,t)=>{const n=[];let i=e._start;for(;null!==i;){if(i.countable&&Nx(i,t)){const e=i.content.getContent();for(let t=0;t<e.length;t++)n.push(e[t])}i=i.right}return n},TD=(e,t)=>{var n;let i=0,r=e._start;for(null!==(n=e.doc)&&void 0!==n||OD();null!==r;){if(r.countable&&!r.deleted){const n=r.content.getContent();for(let r=0;r<n.length;r++)t(n[r],i++,e)}r=r.right}},PD=(e,t)=>{const n=[];return TD(e,(i,r)=>{n.push(t(i,r,e))}),n},MD=e=>{let t=e._start,n=null,i=0;return{[Symbol.iterator](){return this},next:()=>{if(null===n){for(;null!==t&&t.deleted;)t=t.right;if(null===t)return{done:!0,value:void 0};n=t.content.getContent(),i=0,t=t.right}const e=n[i++];return n.length<=i&&(n=null),{done:!1,value:e}}}},FD=(e,t)=>{var n;null!==(n=e.doc)&&void 0!==n||OD();const i=xD(e,t);let r=e._start;for(null!==i&&(r=i.p,t-=i.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},RD=(e,t,n,i)=>{let r=n;const s=e.doc,o=s.clientID,a=s.store,l=null===n?t._start:n.right;let c=[];const u=()=>{c.length>0&&(r=new zS(kx(o,Lx(a,o)),r,r&&r.lastId,l,l&&l.id,t,null,new CS(c)),r.integrate(e,0),c=[])};i.forEach(n=>{if(null===n)c.push(n);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(n);break;default:switch(u(),n.constructor){case Uint8Array:case ArrayBuffer:r=new zS(kx(o,Lx(a,o)),r,r&&r.lastId,l,l&&l.id,t,null,new yS(new Uint8Array(n))),r.integrate(e,0);break;case Yk:r=new zS(kx(o,Lx(a,o)),r,r&&r.lastId,l,l&&l.id,t,null,new bS(n)),r.integrate(e,0);break;default:if(!(n instanceof CD))throw new Error("Unexpected content type in insert operation");r=new zS(kx(o,Lx(a,o)),r,r&&r.lastId,l,l&&l.id,t,null,new IS(n)),r.integrate(e,0)}}}),u()},ND=()=>YO("Length exceeded!"),ID=(e,t,n,i)=>{if(n>t._length)throw ND();if(0===n)return t._searchMarker&&DD(t._searchMarker,n,i.length),RD(e,t,null,i);const r=n,s=xD(t,n);let o=t._start;for(null!==s&&(o=s.p,0===(n-=s.index)&&(o=o.prev,n+=o&&o.countable&&!o.deleted?o.length:0));null!==o;o=o.right)if(!o.deleted&&o.countable){if(n<=o.length){n<o.length&&Vx(e,kx(o.id.client,o.id.clock+n));break}n-=o.length}return t._searchMarker&&DD(t._searchMarker,r,i.length),RD(e,t,o,i)},BD=(e,t,n,i)=>{if(0===i)return;const r=n,s=i,o=xD(t,n);let a=t._start;for(null!==o&&(a=o.p,n-=o.index);null!==a&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&Vx(e,kx(a.id.client,a.id.clock+n)),n-=a.length);for(;i>0&&null!==a;)a.deleted||(i<a.length&&Vx(e,kx(a.id.client,a.id.clock+i)),a.delete(e),i-=a.length),a=a.right;if(i>0)throw ND();t._searchMarker&&DD(t._searchMarker,r,-s+i)},QD=(e,t,n)=>{const i=t._map.get(n);void 0!==i&&i.delete(e)},LD=(e,t,n,i)=>{const r=t._map.get(n)||null,s=e.doc,o=s.clientID;let a;if(null==i)a=new CS([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:a=new CS([i]);break;case Uint8Array:a=new yS(i);break;case Yk:a=new bS(i);break;default:if(!(i instanceof CD))throw new Error("Unexpected content type");a=new IS(i)}new zS(kx(o,Lx(s.store,o)),r,r&&r.lastId,null,null,t,n,a).integrate(e,0)},jD=(e,t)=>{var n;null!==(n=e.doc)&&void 0!==n||OD();const i=e._map.get(t);return void 0===i||i.deleted?void 0:i.content.getContent()[i.length-1]},$D=e=>{var t;const n={};return null!==(t=e.doc)&&void 0!==t||OD(),e._map.forEach((e,t)=>{e.deleted||(n[t]=e.content.getContent()[e.length-1])}),n},zD=(e,t)=>{var n;null!==(n=e.doc)&&void 0!==n||OD();const i=e._map.get(t);return void 0!==i&&!i.deleted},WD=e=>{var t,n,i;return null!==(t=e.doc)&&void 0!==t||OD(),n=e._map.entries(),i=e=>!e[1].deleted,Nk(()=>{let e;do{e=n.next()}while(!e.done&&!i(e.value));return e})};class VD extends vD{}class UD extends CD{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new UD;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new UD}clone(){const e=new UD;return e.insert(0,this.toArray().map(e=>e instanceof CD?e.clone():e)),e}get length(){var e;return null!==(e=this.doc)&&void 0!==e||OD(),this._length}_callObserver(e,t){super._callObserver(e,t),SD(this,e,new VD(this,e))}insert(e,t){null!==this.doc?eD(this.doc,n=>{ID(n,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){null!==this.doc?eD(this.doc,t=>{((e,t,n)=>{let i=(t._searchMarker||[]).reduce((e,t)=>t.index>e.index?t:e,{index:0,p:t._start}).p;if(i)for(;i.right;)i=i.right;RD(e,t,i,n)})(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;null!==this.doc?eD(this.doc,n=>{BD(n,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return FD(this,e)}toArray(){return ED(this)}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return AD(this,e,t)}toJSON(){return this.map(e=>e instanceof CD?e.toJSON():e)}map(e){return PD(this,e)}forEach(e){TD(this,e)}[Symbol.iterator](){return MD(this)}_write(e){e.writeTypeRef(_S)}}class XD extends vD{constructor(e,t,n){super(e,t),this.keysChanged=n}}class qD extends CD{constructor(e){super(),this._prelimContent=null,this._prelimContent=void 0===e?new Map:new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((e,t)=>{this.set(t,e)}),this._prelimContent=null}_copy(){return new qD}clone(){const e=new qD;return this.forEach((t,n)=>{e.set(n,t instanceof CD?t.clone():t)}),e}_callObserver(e,t){SD(this,e,new XD(this,e,t))}toJSON(){var e;null!==(e=this.doc)&&void 0!==e||OD();const t={};return this._map.forEach((e,n)=>{if(!e.deleted){const i=e.content.getContent()[e.length-1];t[n]=i instanceof CD?i.toJSON():i}}),t}get size(){return[...WD(this)].length}keys(){return Ik(WD(this),e=>e[0])}values(){return Ik(WD(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return Ik(WD(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){var t;null!==(t=this.doc)&&void 0!==t||OD(),this._map.forEach((t,n)=>{t.deleted||e(t.content.getContent()[t.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(e){null!==this.doc?eD(this.doc,t=>{QD(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return null!==this.doc?eD(this.doc,n=>{LD(n,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return jD(this,e)}has(e){return zD(this,e)}clear(){null!==this.doc?eD(this.doc,e=>{this.forEach(function(t,n,i){QD(e,i,n)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(TS)}}const ZD=(e,t)=>e===t||"object"===typeof e&&"object"===typeof t&&e&&t&&((e,t)=>e===t||Pw(e)===Pw(t)&&Mw(e,(e,n)=>(void 0!==e||Fw(t,n))&&Ew(t[n],e)))(e,t);class HD{constructor(e,t,n,i){this.left=e,this.right=t,this.index=n,this.currentAttributes=i}forward(){if(null===this.right&&KO(),this.right.content.constructor===xS)this.right.deleted||JD(this.currentAttributes,this.right.content);else this.right.deleted||(this.index+=this.right.length);this.left=this.right,this.right=this.right.right}}const YD=(e,t,n)=>{for(;null!==t.right&&n>0;){if(t.right.content.constructor===xS)t.right.deleted||JD(t.currentAttributes,t.right.content);else t.right.deleted||(n<t.right.length&&Vx(e,kx(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);t.left=t.right,t.right=t.right.right}return t},GD=(e,t,n,i)=>{const r=new Map,s=i?xD(t,n):null;if(s){const t=new HD(s.p.left,s.p,s.index,r);return YD(e,t,n-s.index)}{const i=new HD(null,t._start,0,r);return YD(e,i,n)}},KD=(e,t,n,i)=>{for(;null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===xS&&ZD(i.get(n.right.content.key),n.right.content.value));)n.right.deleted||i.delete(n.right.content.key),n.forward();const r=e.doc,s=r.clientID;i.forEach((i,o)=>{const a=n.left,l=n.right,c=new zS(kx(s,Lx(r.store,s)),a,a&&a.lastId,l,l&&l.id,t,null,new xS(o,i));c.integrate(e,0),n.right=c,n.forward()})},JD=(e,t)=>{const{key:n,value:i}=t;null===i?e.delete(n):e.set(n,i)},eS=(e,t)=>{for(;;){var n;if(null===e.right)break;if(!(e.right.deleted||e.right.content.constructor===xS&&ZD(null!==(n=t[e.right.content.key])&&void 0!==n?n:null,e.right.content.value)))break;e.forward()}},tS=(e,t,n,i)=>{const r=e.doc,s=r.clientID,o=new Map;for(const l in i){var a;const c=i[l],u=null!==(a=n.currentAttributes.get(l))&&void 0!==a?a:null;if(!ZD(u,c)){o.set(l,u);const{left:i,right:a}=n;n.right=new zS(kx(s,Lx(r.store,s)),i,i&&i.lastId,a,a&&a.id,t,null,new xS(l,c)),n.right.integrate(e,0),n.forward()}}return o},nS=(e,t,n,i,r)=>{n.currentAttributes.forEach((e,t)=>{void 0===r[t]&&(r[t]=null)});const s=e.doc,o=s.clientID;eS(n,r);const a=tS(e,t,n,r),l=i.constructor===String?new AS(i):i instanceof CD?new IS(i):new kS(i);let{left:c,right:u,index:h}=n;t._searchMarker&&DD(t._searchMarker,n.index,l.getLength()),u=new zS(kx(o,Lx(s.store,o)),c,c&&c.lastId,u,u&&u.id,t,null,l),u.integrate(e,0),n.right=u,n.index=h,n.forward(),KD(e,t,n,a)},iS=(e,t,n,i,r)=>{const s=e.doc,o=s.clientID;eS(n,r);const a=tS(e,t,n,r);e:for(;null!==n.right&&(i>0||a.size>0&&(n.right.deleted||n.right.content.constructor===xS));){if(!n.right.deleted)switch(n.right.content.constructor){case xS:{const{key:t,value:s}=n.right.content,o=r[t];if(void 0!==o){if(ZD(o,s))a.delete(t);else{if(0===i)break e;a.set(t,s)}n.right.delete(e)}else n.currentAttributes.set(t,s);break}default:i<n.right.length&&Vx(e,kx(n.right.id.client,n.right.id.clock+i)),i-=n.right.length}n.forward()}if(i>0){let r="";for(;i>0;i--)r+="\n";n.right=new zS(kx(o,Lx(s.store,o)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new AS(r)),n.right.integrate(e,0),n.forward()}KD(e,t,n,a)},rS=(e,t,n,i,r)=>{let s=t;const o=Yy();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===xS){const e=s.content;o.set(e.key,e)}s=s.right}let a=0,l=!1;for(;t!==s;){if(n===t&&(l=!0),!t.deleted){const n=t.content;switch(n.constructor){case xS:{var c;const{key:s,value:h}=n,d=null!==(c=i.get(s))&&void 0!==c?c:null;var u;if(o.get(s)!==n||d===h)t.delete(e),a++,l||(null!==(u=r.get(s))&&void 0!==u?u:null)!==h||d===h||(null===d?r.delete(s):r.set(s,d));l||t.deleted||JD(r,n);break}}}t=t.right}return a},sS=e=>{let t=0;return eD(e.doc,n=>{let i=e._start,r=e._start,s=Yy();const o=Gy(s);for(;r;){if(!1===r.deleted)if(r.content.constructor===xS)JD(o,r.content);else t+=rS(n,i,r,s,o),s=Gy(o),i=r;r=r.right}}),t},oS=e=>{const t=new Set,n=e.doc;for(const[i,r]of e.afterState.entries()){const s=e.beforeState.get(i)||0;r!==s&&Xx(e,n.store.clients.get(i),s,r,e=>{e.deleted||e.content.constructor!==xS||e.constructor===vS||t.add(e.parent)})}eD(n,n=>{Lk(e,e.deleteSet,e=>{if(e instanceof vS||!e.parent._hasFormatting||t.has(e.parent))return;const i=e.parent;e.content.constructor===xS?t.add(i):((e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===xS){const i=t.content.key;n.has(i)?t.delete(e):n.add(i)}t=t.left}})(n,e)});for(const e of t)sS(e)})},aS=(e,t,n)=>{const i=n,r=Gy(t.currentAttributes),s=t.right;for(;n>0&&null!==t.right;){if(!1===t.right.deleted)switch(t.right.content.constructor){case IS:case kS:case AS:n<t.right.length&&Vx(e,kx(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e)}t.forward()}s&&rS(e,s,t.right,r,t.currentAttributes);const o=(t.left||t.right).parent;return o._searchMarker&&DD(o._searchMarker,t.index,-i+n),t};class lS extends vD{constructor(e,t,n){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(e=>{null===e?this.childListChanged=!0:this.keysChanged.add(e)})}get changes(){if(null===this._changes){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(null===this._delta){const e=this.target.doc,t=[];eD(e,e=>{const n=new Map,i=new Map;let r=this.target._start,s=null;const o={};let a="",l=0,c=0;const u=()=>{if(null!==s){let e=null;switch(s){case"delete":c>0&&(e={delete:c}),c=0;break;case"insert":("object"===typeof a||a.length>0)&&(e={insert:a},n.size>0&&(e.attributes={},n.forEach((t,n)=>{null!==t&&(e.attributes[n]=t)}))),a="";break;case"retain":l>0&&(e={retain:l},(e=>{for(const t in e)return!1;return!0})(o)||(e.attributes=_w({},o))),l=0}e&&t.push(e),s=null}};for(;null!==r;){switch(r.content.constructor){case IS:case kS:this.adds(r)?this.deletes(r)||(u(),s="insert",a=r.content.getContent()[0],u()):this.deletes(r)?("delete"!==s&&(u(),s="delete"),c+=1):r.deleted||("retain"!==s&&(u(),s="retain"),l+=1);break;case AS:this.adds(r)?this.deletes(r)||("insert"!==s&&(u(),s="insert"),a+=r.content.str):this.deletes(r)?("delete"!==s&&(u(),s="delete"),c+=r.length):r.deleted||("retain"!==s&&(u(),s="retain"),l+=r.length);break;case xS:{const{key:t,value:a}=r.content;if(this.adds(r)){if(!this.deletes(r)){var h;const l=null!==(h=n.get(t))&&void 0!==h?h:null;var d;if(ZD(l,a))null!==a&&r.delete(e);else"retain"===s&&u(),ZD(a,null!==(d=i.get(t))&&void 0!==d?d:null)?delete o[t]:o[t]=a}}else if(this.deletes(r)){var p;i.set(t,a);const e=null!==(p=n.get(t))&&void 0!==p?p:null;ZD(e,a)||("retain"===s&&u(),o[t]=e)}else if(!r.deleted){i.set(t,a);const n=o[t];void 0!==n&&(ZD(n,a)?null!==n&&r.delete(e):("retain"===s&&u(),null===a?delete o[t]:o[t]=a))}r.deleted||("insert"===s&&u(),JD(n,r.content));break}}r=r.right}for(u();t.length>0;){const e=t[t.length-1];if(void 0===e.retain||void 0!==e.attributes)break;t.pop()}}),this._delta=t}return this._delta}}class cS extends CD{constructor(e){super(),this._pending=void 0!==e?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){var e;return null!==(e=this.doc)&&void 0!==e||OD(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(e=>e())}catch(Kre){console.error(Kre)}this._pending=null}_copy(){return new cS}clone(){const e=new cS;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const n=new lS(this,e,t);SD(this,e,n),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){var e;null!==(e=this.doc)&&void 0!==e||OD();let t="",n=this._start;for(;null!==n;)!n.deleted&&n.countable&&n.content.constructor===AS&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(e){let{sanitize:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!==this.doc?eD(this.doc,n=>{const i=new HD(null,this._start,0,new Map);for(let r=0;r<e.length;r++){const s=e[r];if(void 0!==s.insert){const o=t||"string"!==typeof s.insert||r!==e.length-1||null!==i.right||"\n"!==s.insert.slice(-1)?s.insert:s.insert.slice(0,-1);("string"!==typeof o||o.length>0)&&nS(n,this,i,o,s.attributes||{})}else void 0!==s.retain?iS(n,this,i,s.retain,s.attributes||{}):void 0!==s.delete&&aS(n,i,s.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,n){var i;null!==(i=this.doc)&&void 0!==i||OD();const r=[],s=new Map,o=this.doc;let a="",l=this._start;function c(){if(a.length>0){const e={};let t=!1;s.forEach((n,i)=>{t=!0,e[i]=n});const n={insert:a};t&&(n.attributes=e),r.push(n),a=""}}const u=()=>{for(;null!==l;){if(Nx(l,e)||void 0!==t&&Nx(l,t))switch(l.content.constructor){case AS:{const i=s.get("ychange");void 0===e||Nx(l,e)?void 0===t||Nx(l,t)?void 0!==i&&(c(),s.delete("ychange")):void 0!==i&&i.user===l.id.client&&"added"===i.type||(c(),s.set("ychange",n?n("added",l.id):{type:"added"})):void 0!==i&&i.user===l.id.client&&"removed"===i.type||(c(),s.set("ychange",n?n("removed",l.id):{type:"removed"})),a+=l.content.str;break}case IS:case kS:{c();const e={insert:l.content.getContent()[0]};if(s.size>0){const t={};e.attributes=t,s.forEach((e,n)=>{t[n]=e})}r.push(e);break}case xS:Nx(l,e)&&(c(),JD(s,l.content))}l=l.right}c()};return e||t?eD(o,n=>{e&&Ix(n,e),t&&Ix(n,t),u()},"cleanup"):u(),r}insert(e,t,n){if(t.length<=0)return;const i=this.doc;null!==i?eD(i,i=>{const r=GD(i,this,e,!n);n||(n={},r.currentAttributes.forEach((e,t)=>{n[t]=e})),nS(i,this,r,t,n)}):this._pending.push(()=>this.insert(e,t,n))}insertEmbed(e,t,n){const i=this.doc;null!==i?eD(i,i=>{const r=GD(i,this,e,!n);nS(i,this,r,t,n||{})}):this._pending.push(()=>this.insertEmbed(e,t,n||{}))}delete(e,t){if(0===t)return;const n=this.doc;null!==n?eD(n,n=>{aS(n,GD(n,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,n){if(0===t)return;const i=this.doc;null!==i?eD(i,i=>{const r=GD(i,this,e,!1);null!==r.right&&iS(i,this,r,t,n)}):this._pending.push(()=>this.format(e,t,n))}removeAttribute(e){null!==this.doc?eD(this.doc,t=>{QD(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){null!==this.doc?eD(this.doc,n=>{LD(n,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return jD(this,e)}getAttributes(){return $D(this)}_write(e){e.writeTypeRef(PS)}}class uS{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0,null!==(t=e.doc)&&void 0!==t||OD()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do{if(t=e.content.type,e.deleted||t.constructor!==dS&&t.constructor!==hS||null===t._start)for(;null!==e;){const t=e.next;if(null!==t){e=t;break}e=e.parent===this._root?null:e.parent._item}else e=t._start}while(null!==e&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,null===e?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class hS extends CD{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new hS}clone(){const e=new hS;return e.insert(0,this.toArray().map(e=>e instanceof CD?e.clone():e)),e}get length(){var e;return null!==(e=this.doc)&&void 0!==e||OD(),null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(e){return new uS(this,e)}querySelector(e){e=e.toUpperCase();const t=new uS(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e).next();return t.done?null:t.value}querySelectorAll(e){return e=e.toUpperCase(),nO(new uS(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){SD(this,e,new pS(this,t,e))}toString(){return PD(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const i=e.createDocumentFragment();return void 0!==n&&n._createAssociation(i,this),TD(this,r=>{i.insertBefore(r.toDOM(e,t,n),null)}),i}insert(e,t){null!==this.doc?eD(this.doc,n=>{ID(n,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(null!==this.doc)eD(this.doc,n=>{const i=e&&e instanceof CD?e._item:e;RD(n,this,i,t)});else{const n=this._prelimContent,i=null===e?0:n.findIndex(t=>t===e)+1;if(0===i&&null!==e)throw YO("Reference item not found");n.splice(i,0,...t)}}delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;null!==this.doc?eD(this.doc,n=>{BD(n,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return ED(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return FD(this,e)}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return AD(this,e,t)}forEach(e){TD(this,e)}_write(e){e.writeTypeRef(FS)}}class dS extends hS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"UNDEFINED";super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((e,t)=>{this.setAttribute(t,e)}),this._prelimAttrs=null}_copy(){return new dS(this.nodeName)}clone(){const e=new dS(this.nodeName);return((e,t)=>{for(const n in e)t(e[n],n)})(this.getAttributes(),(t,n)=>{e.setAttribute(n,t)}),e.insert(0,this.toArray().map(e=>e instanceof CD?e.clone():e)),e}toString(){const e=this.getAttributes(),t=[],n=[];for(const o in e)n.push(o);n.sort();const i=n.length;for(let o=0;o<i;o++){const i=n[o];t.push(i+'="'+e[i]+'"')}const r=this.nodeName.toLocaleLowerCase(),s=t.length>0?" "+t.join(" "):"";return"<".concat(r).concat(s,">").concat(super.toString(),"</").concat(r,">")}removeAttribute(e){null!==this.doc?eD(this.doc,t=>{QD(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){null!==this.doc?eD(this.doc,n=>{LD(n,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return jD(this,e)}hasAttribute(e){return zD(this,e)}getAttributes(e){return e?((e,t)=>{const n={};return e._map.forEach((e,i)=>{let r=e;for(;null!==r&&(!t.sv.has(r.id.client)||r.id.clock>=(t.sv.get(r.id.client)||0));)r=r.left;null!==r&&Nx(r,t)&&(n[i]=r.content.getContent()[r.length-1])}),n})(this,e):$D(this)}toDOM(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const i=e.createElement(this.nodeName),r=this.getAttributes();for(const s in r){const e=r[s];"string"===typeof e&&i.setAttribute(s,e)}return TD(this,r=>{i.appendChild(r.toDOM(e,t,n))}),void 0!==n&&n._createAssociation(i,this),i}_write(e){e.writeTypeRef(MS),e.writeKey(this.nodeName)}}class pS extends vD{constructor(e,t,n){super(e,n),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(e=>{null===e?this.childListChanged=!0:this.attributesChanged.add(e)})}}class fS extends qD{constructor(e){super(),this.hookName=e}_copy(){return new fS(this.hookName)}clone(){const e=new fS(this.hookName);return this.forEach((t,n)=>{e.set(n,t)}),e}toDOM(){arguments.length>0&&void 0!==arguments[0]||document;let e=arguments.length>2?arguments[2]:void 0;const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})[this.hookName];let n;return n=void 0!==t?t.createDom(this):document.createElement(this.hookName),n.setAttribute("data-yjs-hook",this.hookName),void 0!==e&&e._createAssociation(n,this),n}_write(e){e.writeTypeRef(RS),e.writeKey(this.hookName)}}class mS extends cS{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new mS}clone(){const e=new mS;return e.applyDelta(this.toDelta()),e}toDOM(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>2?arguments[2]:void 0;const n=e.createTextNode(this.toString());return void 0!==t&&t._createAssociation(n,this),n}toString(){return this.toDelta().map(e=>{const t=[];for(const i in e.attributes){const n=[];for(const t in e.attributes[i])n.push({key:t,value:e.attributes[i][t]});n.sort((e,t)=>e.key<t.key?-1:1),t.push({nodeName:i,attrs:n})}t.sort((e,t)=>e.nodeName<t.nodeName?-1:1);let n="";for(let i=0;i<t.length;i++){const e=t[i];n+="<".concat(e.nodeName);for(let t=0;t<e.attrs.length;t++){const i=e.attrs[t];n+=" ".concat(i.key,'="').concat(i.value,'"')}n+=">"}n+=e.insert;for(let i=t.length-1;i>=0;i--)n+="</".concat(t[i].nodeName,">");return n}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(NS)}}class gS{constructor(e,t){this.id=e,this.length=t}get deleted(){throw GO()}mergeWith(e){return!1}write(e,t,n){throw GO()}integrate(e,t){throw GO()}}class vS extends gS{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),jx(e.doc.store,this)}write(e,t){e.writeInfo(0),e.writeLen(this.length-t)}getMissing(e,t){return null}}class yS{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new yS(this.content)}splice(e){throw GO()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}class OS{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new OS(this.len)}splice(e){const t=new OS(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){Wk(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const wS=(e,t)=>new Yk(p(p({guid:e},t),{},{shouldLoad:t.shouldLoad||t.autoLoad||!1}));class bS{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),null!==e.meta&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new bS(wS(this.doc.guid,this.opts))}splice(e){throw GO()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}class kS{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new kS(this.embed)}splice(e){throw GO()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}class xS{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new xS(this.key,this.value)}splice(e){throw GO()}mergeWith(e){return!1}integrate(e,t){const n=t.parent;n._searchMarker=null,n._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}class DS{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new DS(this.arr)}splice(e){const t=new DS(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const n=this.arr.length;e.writeLen(n-t);for(let i=t;i<n;i++){const t=this.arr[i];e.writeString(void 0===t?"undefined":JSON.stringify(t))}}getRef(){return 2}}const SS="development"===Uw("node_env");class CS{constructor(e){this.arr=e,SS&&Nw(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new CS(this.arr)}splice(e){const t=new CS(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const n=this.arr.length;e.writeLen(n-t);for(let i=t;i<n;i++){const t=this.arr[i];e.writeAny(t)}}getRef(){return 8}}class AS{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new AS(this.str)}splice(e){const t=new AS(this.str.slice(e));this.str=this.str.slice(0,e);const n=this.str.charCodeAt(e-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,e-1)+"\ufffd",t.str="\ufffd"+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(0===t?this.str:this.str.slice(t))}getRef(){return 4}}const ES=[e=>new UD,e=>new qD,e=>new cS,e=>new dS(e.readKey()),e=>new hS,e=>new fS(e.readKey()),e=>new mS],_S=0,TS=1,PS=2,MS=3,FS=4,RS=5,NS=6;class IS{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new IS(this.type._copy())}splice(e){throw GO()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;null!==t;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(t=>{t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;null!==t;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(t=>{for(;null!==t;)t.gc(e,!0),t=t.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const BS=(e,t)=>{let n,i=t,r=0;do{r>0&&(i=kx(i.client,i.clock+r)),n=zx(e,i),r=i.clock-n.id.clock,i=n.redone}while(null!==i&&n instanceof zS);return{item:n,diff:r}},QS=(e,t)=>{for(;null!==e&&e.keep!==t;)e.keep=t,e=e.parent._item},LS=(e,t,n)=>{const{client:i,clock:r}=t.id,s=new zS(kx(i,r+n),t,kx(i,r+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&s.markDeleted(),t.keep&&(s.keep=!0),null!==t.redone&&(s.redone=kx(t.redone.client,t.redone.clock+n)),t.right=s,null!==s.right&&(s.right.left=s),e._mergeStructs.push(s),null!==s.parentSub&&null===s.right&&s.parent._map.set(s.parentSub,s),t.length=n,s},jS=(e,t)=>rO(e,e=>jk(e.deletions,t)),$S=(e,t,n,i,r,s)=>{const o=e.doc,a=o.store,l=o.clientID,c=t.redone;if(null!==c)return Vx(e,c);let u,h=t.parent._item,d=null;if(null!==h&&!0===h.deleted){if(null===h.redone&&(!n.has(h)||null===$S(e,h,n,i,r,s)))return null;for(;null!==h.redone;)h=Vx(e,h.redone)}const p=null===h?t.parent:h.content.type;if(null===t.parentSub){for(d=t.left,u=t;null!==d;){let t=d;for(;null!==t&&t.parent._item!==h;)t=null===t.redone?null:Vx(e,t.redone);if(null!==t&&t.parent._item===h){d=t;break}d=d.left}for(;null!==u;){let t=u;for(;null!==t&&t.parent._item!==h;)t=null===t.redone?null:Vx(e,t.redone);if(null!==t&&t.parent._item===h){u=t;break}u=u.right}}else if(u=null,t.right&&!r){for(d=t;null!==d&&null!==d.right&&(d.right.redone||jk(i,d.right.id)||jS(s.undoStack,d.right.id)||jS(s.redoStack,d.right.id));)for(d=d.right;d.redone;)d=Vx(e,d.redone);if(d&&null!==d.right)return null}else d=p._map.get(t.parentSub)||null;const f=Lx(a,l),m=kx(l,f),g=new zS(m,d,d&&d.lastId,u,u&&u.id,p,t.parentSub,t.content.copy());return t.redone=m,QS(g,!0),g.integrate(e,0),g};class zS extends gS{constructor(e,t,n,i,r,s,o,a){super(e,a.getLength()),this.origin=n,this.left=t,this.right=i,this.rightOrigin=r,this.parent=s,this.parentSub=o,this.redone=null,this.content=a,this.info=this.content.isCountable()?2:0}set marker(e){(8&this.info)>0!==e&&(this.info^=8)}get marker(){return(8&this.info)>0}get keep(){return(1&this.info)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(2&this.info)>0}get deleted(){return(4&this.info)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Lx(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Lx(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===wx&&this.id.client!==this.parent.client&&this.parent.clock>=Lx(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Ux(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Vx(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===vS||this.right&&this.right.constructor===vS)this.parent=null;else if(this.parent){if(this.parent.constructor===wx){const e=zx(t,this.parent);e.constructor===vS?this.parent=null:this.parent=e.content.type}}else this.left&&this.left.constructor===zS?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===zS&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=Ux(e,e.doc.store,kx(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let t,n=this.left;if(null!==n)t=n.right;else if(null!==this.parentSub)for(t=this.parent._map.get(this.parentSub)||null;null!==t&&null!==t.left;)t=t.left;else t=this.parent._start;const i=new Set,r=new Set;for(;null!==t&&t!==this.right;){if(r.add(t),i.add(t),bx(this.origin,t.origin)){if(t.id.client<this.id.client)n=t,i.clear();else if(bx(this.rightOrigin,t.rightOrigin))break}else{if(null===t.origin||!r.has(zx(e.doc.store,t.origin)))break;i.has(zx(e.doc.store,t.origin))||(n=t,i.clear())}t=t.right}this.left=n}if(null!==this.left){const e=this.left.right;this.right=e,this.left.right=this}else{let e;if(null!==this.parentSub)for(e=this.parent._map.get(this.parentSub)||null;null!==e&&null!==e.left;)e=e.left;else e=this.parent._start,this.parent._start=this;this.right=e}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),jx(e.doc.store,this),this.content.integrate(e,this),Hx(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new vS(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;null!==e&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;null!==e&&e.deleted;)e=e.left;return e}get lastId(){return 1===this.length?this.id:kx(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&bx(e.origin,this.lastId)&&this.right===e&&bx(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(t=>{t.p===e&&(t.p=this,!this.deleted&&this.countable&&(t.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),Wk(e.deleteSet,this.id.client,this.id.clock,this.length),Hx(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw KO();this.content.gc(e),t?((e,t,n)=>{const i=e.clients.get(t.id.client);i[$x(i,t.id.clock)]=n})(e,this,new vS(this.id,this.length)):this.content=new OS(this.length)}write(e,t){const n=t>0?kx(this.id.client,this.id.clock+t-1):this.origin,i=this.rightOrigin,r=this.parentSub,s=31&this.content.getRef()|(null===n?0:fO)|(null===i?0:pO)|(null===r?0:32);if(e.writeInfo(s),null!==n&&e.writeLeftID(n),null!==i&&e.writeRightID(i),null===n&&null===i){const t=this.parent;if(void 0!==t._item){const n=t._item;if(null===n){const n=xx(t);e.writeParentInfo(!0),e.writeString(n)}else e.writeParentInfo(!1),e.writeLeftID(n.id)}else t.constructor===String?(e.writeParentInfo(!0),e.writeString(t)):t.constructor===wx?(e.writeParentInfo(!1),e.writeLeftID(t)):KO();null!==r&&e.writeString(r)}this.content.write(e,t)}}const WS=(e,t)=>VS[31&t](e),VS=[()=>{KO()},e=>new OS(e.readLen()),e=>{const t=e.readLen(),n=[];for(let i=0;i<t;i++){const t=e.readString();"undefined"===t?n.push(void 0):n.push(JSON.parse(t))}return new DS(n)},e=>new yS(e.readBuf()),e=>new AS(e.readString()),e=>new kS(e.readJSON()),e=>new xS(e.readKey(),e.readJSON()),e=>new IS(ES[e.readTypeRef()](e)),e=>{const t=e.readLen(),n=[];for(let i=0;i<t;i++)n.push(e.readAny());return new CS(n)},e=>new bS(wS(e.readString(),e.readAny())),()=>{KO()}];class US extends gS{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){KO()}write(e,t){e.writeInfo(10),RO(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const XS="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{},qS="__ $YJS$ __";!0===XS[qS]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),XS[qS]=!0;const ZS=3e4;class HS extends aO{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const e=wk();null!==this.getLocalState()&&15e3<=e-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const t=[];this.meta.forEach((n,i)=>{i!==this.clientID&&ZS<=e-n.lastUpdated&&this.states.has(i)&&t.push(i)}),t.length>0&&YS(this,t,"timeout")},lO(3e3)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,n=this.meta.get(t),i=void 0===n?0:n.clock+1,r=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:i,lastUpdated:wk()});const s=[],o=[],a=[],l=[];null===e?l.push(t):null==r?null!=e&&s.push(t):(o.push(t),Qw(r,e)||a.push(t)),(s.length>0||a.length>0||l.length>0)&&this.emit("change",[{added:s,updated:a,removed:l},"local"]),this.emit("update",[{added:s,updated:o,removed:l},"local"])}setLocalStateField(e,t){const n=this.getLocalState();null!==n&&this.setLocalState(p(p({},n),{},{[e]:t}))}getStates(){return this.states}}const YS=(e,t,n)=>{const i=[];for(let r=0;r<t.length;r++){const n=t[r];if(e.states.has(n)){if(e.states.delete(n),n===e.clientID){const t=e.meta.get(n);e.meta.set(n,{clock:t.clock+1,lastUpdated:wk()})}i.push(n)}}i.length>0&&(e.emit("change",[{added:[],updated:[],removed:i},n]),e.emit("update",[{added:[],updated:[],removed:i},n]))},GS=()=>{},KS={log:GS,info:GS,warn:GS,error:console.error.bind(console),debug:GS};class JS{constructor(e,t,n){this.doc=void 0,this.awareness=void 0,this.supabase=void 0,this.channelName=void 0,this.channel=void 0,this.connected=!1,this.broadcastingSetup=!1,this.eventHandlers=new Map,this.reconnectAttempts=0,this.reconnectTimer=null,this.isDestroyed=!1,this.lastConnectedAt=0,this.pendingUpdates=[],this.maxPendingUpdates=100,this.updateBatch=[],this.batchTimer=null,this.BATCH_INTERVAL=50,this.visibilityHandler=null,this.resyncTimer=null,this.doc=e,this.supabase=t,this.channelName=n,this.awareness=new HS(e),KS.log("SimpleProvider: Creating channel:",n)}on(e,t){this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),this.eventHandlers.get(e).add(t)}off(e,t){const n=this.eventHandlers.get(e);n&&n.delete(t)}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=this.eventHandlers.get(e);r&&r.forEach(e=>e(...n))}connect(){if(this.isDestroyed)KS.log("SimpleProvider: Destroyed, not connecting");else if(this.connected&&this.channel)KS.log("SimpleProvider: Already connected, skipping");else{if(KS.log("SimpleProvider: Connecting..."),this.channel){KS.log("SimpleProvider: Cleaning up old channel...");try{this.supabase.removeChannel(this.channel)}catch(e){}this.channel=null}this.channel=this.supabase.channel(this.channelName,{config:{broadcast:{self:!1,ack:!1}}}),this.channel.on("broadcast",{event:"doc-update"},e=>{let{payload:t}=e;try{KS.log("SimpleProvider: Received doc update",t.update.length,"bytes");const e=new Uint8Array(t.update);lx(this.doc,e,this)}catch(n){KS.error("SimpleProvider: Failed to apply doc update",n)}}),this.channel.on("broadcast",{event:"sync-request"},e=>{let{payload:t}=e;try{if(t.clientId===this.doc.clientID)return;KS.log("SimpleProvider: Received sync request from",t.clientId);const e=ux(this.doc);this.channel.send({type:"broadcast",event:"sync-response",payload:{update:Array.from(e),targetClientId:t.clientId}})}catch(n){KS.error("SimpleProvider: Failed to handle sync request",n)}}),this.channel.on("broadcast",{event:"sync-response"},e=>{let{payload:t}=e;try{if(t.targetClientId!==this.doc.clientID)return;KS.log("SimpleProvider: Received sync response",t.update.length,"bytes");const e=new Uint8Array(t.update);lx(this.doc,e,this)}catch(n){KS.error("SimpleProvider: Failed to apply sync response",n)}}),this.channel.on("broadcast",{event:"state-vector"},e=>{let{payload:t}=e;try{if(t.clientId===this.doc.clientID)return;const e=new Uint8Array(t.sv),n=ux(this.doc,e);n.length>2&&(KS.log("SimpleProvider: Peer missing",n.length,"bytes, sending catch-up"),this.channel.send({type:"broadcast",event:"sync-response",payload:{update:Array.from(n),targetClientId:t.clientId}}))}catch(n){KS.error("SimpleProvider: Failed to handle state-vector",n)}}),this.channel.on("broadcast",{event:"awareness"},e=>{let{payload:t}=e;try{const e=new Uint8Array(t.update);((e,t,n)=>{const i=nw(t),r=wk(),s=[],o=[],a=[],l=[],c=aw(i);for(let u=0;u<c;u++){const t=aw(i);let n=aw(i);const c=JSON.parse(cw(i)),u=e.meta.get(t),h=e.states.get(t),d=void 0===u?0:u.clock;(d<n||d===n&&null===c&&e.states.has(t))&&(null===c?t===e.clientID&&null!=e.getLocalState()?n++:e.states.delete(t):e.states.set(t,c),e.meta.set(t,{clock:n,lastUpdated:r}),void 0===u&&null!==c?s.push(t):void 0!==u&&null===c?l.push(t):null!==c&&(Qw(c,h)||a.push(t),o.push(t)))}(s.length>0||a.length>0||l.length>0)&&e.emit("change",[{added:s,updated:a,removed:l},n]),(s.length>0||o.length>0||l.length>0)&&e.emit("update",[{added:s,updated:o,removed:l},n])})(this.awareness,e,this)}catch(n){KS.error("SimpleProvider: Failed to apply awareness update",n)}}),this.channel.subscribe(e=>{try{KS.log("SimpleProvider: Status:",e),"SUBSCRIBED"===e?(this.connected=!0,this.lastConnectedAt=Date.now(),this.reconnectAttempts>0?setTimeout(()=>{this.connected&&(this.reconnectAttempts=0)},3e4):this.reconnectAttempts=0,KS.log("SimpleProvider: Connected!"),this.emit("status",{status:"connected"}),this.setupLocalBroadcasting(),this.channel.send({type:"broadcast",event:"sync-request",payload:{clientId:this.doc.clientID}}),this.flushPendingUpdates(),this.startVisibilityResync(),this.startPeriodicResync()):"CHANNEL_ERROR"===e||"TIMED_OUT"===e?(0===this.reconnectAttempts&&KS.warn("SimpleProvider:",e,"\u2014 channel:",this.channelName,"attempt:",this.reconnectAttempts+1,"(falling back to database sync)"),this.connected=!1,this.emit("status",{status:"disconnected"}),this.stopVisibilityResync(),this.stopPeriodicResync(),this.scheduleReconnect()):"CLOSED"===e&&(this.connected=!1,this.emit("status",{status:"disconnected"}),this.stopVisibilityResync(),this.stopPeriodicResync(),this.isDestroyed||this.scheduleReconnect())}catch(t){KS.error("SimpleProvider: Error in subscription handler",t),this.connected=!1,this.emit("status",{status:"disconnected"}),this.stopVisibilityResync(),this.stopPeriodicResync(),this.scheduleReconnect()}})}}sendStateVector(){if(this.connected&&!this.isDestroyed&&this.channel)try{const e=(e=>fx(e,new tx))(this.doc);this.channel.send({type:"broadcast",event:"state-vector",payload:{sv:Array.from(e),clientId:this.doc.clientID}}),KS.log("SimpleProvider: State vector sent (visibility resync)")}catch(e){}}startVisibilityResync(){this.stopVisibilityResync(),this.visibilityHandler=()=>{"visible"===document.visibilityState&&this.connected&&!this.isDestroyed&&(KS.log("SimpleProvider: Tab became visible \u2014 resyncing"),this.sendStateVector())},document.addEventListener("visibilitychange",this.visibilityHandler)}stopVisibilityResync(){this.visibilityHandler&&(document.removeEventListener("visibilitychange",this.visibilityHandler),this.visibilityHandler=null)}startPeriodicResync(){this.stopPeriodicResync(),this.resyncTimer=setInterval(()=>{this.connected&&!this.isDestroyed&&this.sendStateVector()},3e4)}stopPeriodicResync(){this.resyncTimer&&(clearInterval(this.resyncTimer),this.resyncTimer=null)}scheduleReconnect(){if(this.isDestroyed)return;if(this.reconnectTimer)return;if(this.reconnectAttempts>=10)return KS.error("SimpleProvider: Max reconnect attempts reached"),void this.emit("status",{status:"failed"});const e=Math.min(1e3*Math.pow(2,this.reconnectAttempts),3e4);this.reconnectAttempts++,KS.log("SimpleProvider: Reconnecting in ".concat(e,"ms (attempt ").concat(this.reconnectAttempts,"/").concat(10,")")),this.reconnectTimer=setTimeout(()=>{this.reconnectTimer=null,this.isDestroyed||this.connect()},e)}flushPendingUpdates(){if(0!==this.pendingUpdates.length){KS.log("SimpleProvider: Flushing ".concat(this.pendingUpdates.length," pending updates"));for(const t of this.pendingUpdates)try{this.channel.send({type:"broadcast",event:"doc-update",payload:{update:Array.from(t)}})}catch(e){KS.error("SimpleProvider: Failed to flush update",e)}this.pendingUpdates=[]}}setupLocalBroadcasting(){this.broadcastingSetup||(KS.log("SimpleProvider: Setting up local broadcasting..."),this.broadcastingSetup=!0,this.doc.on("update",(e,t)=>{t!==this&&(this.connected?(this.updateBatch.push(e),this.batchTimer||(this.batchTimer=setTimeout(()=>{if(this.batchTimer=null,0===this.updateBatch.length)return;const e=aD(this.updateBatch);this.updateBatch=[];try{this.channel.send({type:"broadcast",event:"doc-update",payload:{update:Array.from(e)}})}catch(t){this.pendingUpdates.length<this.maxPendingUpdates&&this.pendingUpdates.push(e)}},this.BATCH_INTERVAL))):this.pendingUpdates.length<this.maxPendingUpdates?this.pendingUpdates.push(e):KS.warn("SimpleProvider: Offline queue full, update dropped. Edits exist in memory \u2014 they will sync when connection recovers via state-vector exchange."))}),this.awareness.on("update",e=>{let{added:t,updated:n,removed:i}=e;if(this.connected)try{const e=t.concat(n).concat(i),r=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.states;const i=t.length,r=TO();RO(r,i);for(let s=0;s<i;s++){const i=t[s],o=n.get(i)||null,a=e.meta.get(i).clock;RO(r,i),RO(r,a),QO(r,JSON.stringify(o))}return PO(r)}(this.awareness,e);this.channel.send({type:"broadcast",event:"awareness",payload:{update:Array.from(r)}})}catch(r){}}))}disconnect(){if(KS.log("SimpleProvider: Disconnecting..."),this.stopVisibilityResync(),this.stopPeriodicResync(),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.channel)try{this.channel.unsubscribe()}catch(e){}this.connected=!1,this.emit("status",{status:"disconnected"})}destroy(){KS.log("SimpleProvider: Destroying..."),this.isDestroyed=!0,this.disconnect(),this.awareness.destroy(),this.pendingUpdates=[]}}function eC(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function tC(e,t,n,i){return new(n||(n=Promise))(function(r,s){function o(e){try{l(i.next(e))}catch(Kre){s(Kre)}}function a(e){try{l(i.throw(e))}catch(Kre){s(Kre)}}function l(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,a)}l((i=i.apply(e,t||[])).next())})}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;class nC extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",n=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=n}}class iC extends nC{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class rC extends nC{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class sC extends nC{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var oC;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(oC||(oC={}));class aC{constructor(e){let{headers:t={},customFetch:n,region:i=oC.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=i,this.fetch=(e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)})(n)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){return tC(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var i;let r,s;try{const{headers:o,method:a,body:l,signal:c,timeout:u}=n;let h={},{region:d}=n;d||(d=t.region);const p=new URL("".concat(t.url,"/").concat(e));let f;d&&"any"!==d&&(h["x-region"]=d,p.searchParams.set("forceFunctionRegion",d)),l&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?"undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",f=l):"string"===typeof l?(h["Content-Type"]="text/plain",f=l):"undefined"!==typeof FormData&&l instanceof FormData?f=l:(h["Content-Type"]="application/json",f=JSON.stringify(l)):f=!l||"string"===typeof l||"undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer||"undefined"!==typeof FormData&&l instanceof FormData?l:JSON.stringify(l);let m=c;u&&(s=new AbortController,r=setTimeout(()=>s.abort(),u),c?(m=s.signal,c.addEventListener("abort",()=>s.abort())):m=s.signal);const g=yield t.fetch(p.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},h),t.headers),o),body:f,signal:m}).catch(e=>{throw new iC(e)}),v=g.headers.get("x-relay-error");if(v&&"true"===v)throw new rC(g);if(!g.ok)throw new sC(g);let y,O=(null!==(i=g.headers.get("Content-Type"))&&void 0!==i?i:"text/plain").split(";")[0].trim();return y="application/json"===O?yield g.json():"application/octet-stream"===O||"application/pdf"===O?yield g.blob():"text/event-stream"===O?g:"multipart/form-data"===O?yield g.formData():yield g.text(),{data:y,error:null,response:g}}catch(o){return{data:null,error:o,response:o instanceof sC||o instanceof rC?o.context:void 0}}finally{r&&clearTimeout(r)}}()})}}var lC=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},cC=class{constructor(e){var t,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(n=e.isMaybeSingle)&&void 0!==n&&n,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var n=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let i=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{let t=null,i=null,r=null,s=e.status,o=e.statusText;if(e.ok){var a,l;if("HEAD"!==n.method){var c;const t=await e.text();""===t||(i="text/csv"===n.headers.get("Accept")||n.headers.get("Accept")&&(null===(c=n.headers.get("Accept"))||void 0===c?void 0:c.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}const u=null===(a=n.headers.get("Prefer"))||void 0===a?void 0:a.match(/count=(exact|planned|estimated)/),h=null===(l=e.headers.get("content-range"))||void 0===l?void 0:l.split("/");u&&h&&h.length>1&&(r=parseInt(h[1])),n.isMaybeSingle&&"GET"===n.method&&Array.isArray(i)&&(i.length>1?(t={code:"PGRST116",details:"Results contain ".concat(i.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,r=null,s=406,o="Not Acceptable"):i=1===i.length?i[0]:null)}else{var u;const r=await e.text();try{t=JSON.parse(r),Array.isArray(t)&&404===e.status&&(i=[],t=null,s=200,o="OK")}catch(h){404===e.status&&""===r?(s=204,o="No Content"):t={message:r}}if(t&&n.isMaybeSingle&&(null===t||void 0===t||null===(u=t.details)||void 0===u?void 0:u.includes("0 rows"))&&(t=null,s=200,o="OK"),t&&n.shouldThrowOnError)throw new lC(t)}return{error:t,data:i,count:r,status:s,statusText:o}});return this.shouldThrowOnError||(i=i.catch(e=>{var t;let n="";const i=null===e||void 0===e?void 0:e.cause;if(i){var r,s,o,a;const t=null!==(r=null===i||void 0===i?void 0:i.message)&&void 0!==r?r:"",l=null!==(s=null===i||void 0===i?void 0:i.code)&&void 0!==s?s:"";n="".concat(null!==(o=null===e||void 0===e?void 0:e.name)&&void 0!==o?o:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),n+="\n\nCaused by: ".concat(null!==(a=null===i||void 0===i?void 0:i.name)&&void 0!==a?a:"Error",": ").concat(t),l&&(n+=" (".concat(l,")")),(null===i||void 0===i?void 0:i.stack)&&(n+="\n".concat(i.stack))}else{var l;n=null!==(l=null===e||void 0===e?void 0:e.stack)&&void 0!==l?l:""}return{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:n,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},uC=class extends cC{select(e){let t=!1;const n=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:n,foreignTable:i,referencedTable:r=i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=r?"".concat(r,".order"):"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,"".concat(o?"".concat(o,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===n?"":n?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i="undefined"===typeof n?"limit":"".concat(n,".limit");return this.url.searchParams.set(i,"".concat(e)),this}range(e,t){let{foreignTable:n,referencedTable:i=n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r="undefined"===typeof i?"offset":"".concat(i,".offset"),s="undefined"===typeof i?"limit":"".concat(i,".limit");return this.url.searchParams.set(r,"".concat(e)),this.url.searchParams.set(s,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){let{analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:i=!1,wal:r=!1,format:s="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var o;const a=[e?"analyze":null,t?"verbose":null,n?"settings":null,i?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.get("Accept"))&&void 0!==o?o:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(s,'; for="').concat(l,'"; options=').concat(a,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}};const hC=new RegExp("[,()]");var dC=class extends uC{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}regexMatch(e,t){return this.url.searchParams.append(e,"match.".concat(t)),this}regexIMatch(e,t){return this.url.searchParams.append(e,"imatch.".concat(t)),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}isDistinct(e,t){return this.url.searchParams.append(e,"isdistinct.".concat(t)),this}in(e,t){const n=Array.from(new Set(t)).map(e=>"string"===typeof e&&hC.test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(n,")")),this}notIn(e,t){const n=Array.from(new Set(t)).map(e=>"string"===typeof e&&hC.test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"not.in.(".concat(n,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:n,type:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="";"plain"===i?r="pl":"phrase"===i?r="ph":"websearch"===i&&(r="w");const s=void 0===n?"":"(".concat(n,")");return this.url.searchParams.append(e,"".concat(r,"fts").concat(s,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,n]=e;this.url.searchParams.append(t,"eq.".concat(n))}),this}not(e,t,n){return this.url.searchParams.append(e,"not.".concat(t,".").concat(n)),this}or(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=n?"".concat(n,".or"):"or";return this.url.searchParams.append(i,"(".concat(e,")")),this}filter(e,t,n){return this.url.searchParams.append(e,"".concat(t,".").concat(n)),this}},pC=class{constructor(e,t){let{headers:n={},schema:i,fetch:r}=t;this.url=e,this.headers=new Headers(n),this.schema=i,this.fetch=r}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:n=!1,count:i}=null!==t&&void 0!==t?t:{},r=n?"HEAD":"GET";let s=!1;const o=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join(""),{url:a,headers:l}=this.cloneRequestState();return a.searchParams.set("select",o),i&&l.append("Prefer","count=".concat(i)),new dC({method:r,url:a,headers:l,schema:this.schema,fetch:this.fetch})}insert(e){let{count:t,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;const{url:r,headers:s}=this.cloneRequestState();if(t&&s.append("Prefer","count=".concat(t)),n||s.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));r.searchParams.set("columns",e.join(","))}}return new dC({method:"POST",url:r,headers:s,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}upsert(e){let{onConflict:t,ignoreDuplicates:n=!1,count:i,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s;const{url:o,headers:a}=this.cloneRequestState();if(a.append("Prefer","resolution=".concat(n?"ignore":"merge","-duplicates")),void 0!==t&&o.searchParams.set("on_conflict",t),i&&a.append("Prefer","count=".concat(i)),r||a.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));o.searchParams.set("columns",e.join(","))}}return new dC({method:"POST",url:o,headers:a,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const{url:i,headers:r}=this.cloneRequestState();return t&&r.append("Prefer","count=".concat(t)),new dC({method:"PATCH",url:i,headers:r,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer","count=".concat(e)),new dC({method:"DELETE",url:n,headers:i,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}},fC=class e{constructor(e){let{headers:t={},schema:n,fetch:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=new Headers(t),this.schemaName=n,this.fetch=i}from(e){if(!e||"string"!==typeof e||""===e.trim())throw new Error("Invalid relation name: relation must be a non-empty string.");return new pC(new URL("".concat(this.url,"/").concat(e)),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:n=!1,get:i=!1,count:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var s;let o;const a=new URL("".concat(this.url,"/rpc/").concat(e));let l;const c=e=>null!==e&&"object"===typeof e&&(!Array.isArray(e)||e.some(c)),u=n&&Object.values(t).some(c);u?(o="POST",l=t):n||i?(o=n?"HEAD":"GET",Object.entries(t).filter(e=>{let[t,n]=e;return void 0!==n}).map(e=>{let[t,n]=e;return[t,Array.isArray(n)?"{".concat(n.join(","),"}"):"".concat(n)]}).forEach(e=>{let[t,n]=e;a.searchParams.append(t,n)})):(o="POST",l=t);const h=new Headers(this.headers);return u?h.set("Prefer",r?"count=".concat(r,",return=minimal"):"return=minimal"):r&&h.set("Prefer","count=".concat(r)),new dC({method:o,url:a,headers:h,schema:this.schemaName,body:l,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}};const mC=class{constructor(){}static detectEnvironment(){var e;if("undefined"!==typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!==typeof n.g&&"undefined"!==typeof n.g.WebSocket)return{type:"native",constructor:n.g.WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocketPair&&"undefined"===typeof globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!==typeof globalThis&&globalThis.EdgeRuntime||"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const e=t.versions;if(e&&e.node){const t=e.node,n=parseInt(t.replace(/^v/,"").split(".")[0]);return n>=22?"undefined"!==typeof globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(n," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(n," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(nh){return!1}}},gC="realtime-js/".concat("2.93.3"),vC="2.0.0",yC=vC,OC=1e4;var wC,bC,kC,xC,DC,SC;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(wC||(wC={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(bC||(bC={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(kC||(kC={})),function(e){e.websocket="websocket"}(xC||(xC={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(DC||(DC={}));class CC{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!==e&&void 0!==e?e:[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&"string"===typeof e.payload.event)return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const i=null!==(n=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==n?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(e){var t,n;const i=null!==(n=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==n?n:{},r=(new TextEncoder).encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,r)}_encodeUserBroadcastPush(e,t,n){var i,r;const s=e.topic,o=null!==(i=e.ref)&&void 0!==i?i:"",a=null!==(r=e.join_ref)&&void 0!==r?r:"",l=e.payload.event,c=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},u=0===Object.keys(c).length?"":JSON.stringify(c);if(a.length>255)throw new Error("joinRef length ".concat(a.length," exceeds maximum of 255"));if(o.length>255)throw new Error("ref length ".concat(o.length," exceeds maximum of 255"));if(s.length>255)throw new Error("topic length ".concat(s.length," exceeds maximum of 255"));if(l.length>255)throw new Error("userEvent length ".concat(l.length," exceeds maximum of 255"));if(u.length>255)throw new Error("metadata length ".concat(u.length," exceeds maximum of 255"));const h=this.USER_BROADCAST_PUSH_META_LENGTH+a.length+o.length+s.length+l.length+u.length,d=new ArrayBuffer(this.HEADER_LENGTH+h);let p=new DataView(d),f=0;p.setUint8(f++,this.KINDS.userBroadcastPush),p.setUint8(f++,a.length),p.setUint8(f++,o.length),p.setUint8(f++,s.length),p.setUint8(f++,l.length),p.setUint8(f++,u.length),p.setUint8(f++,t),Array.from(a,e=>p.setUint8(f++,e.charCodeAt(0))),Array.from(o,e=>p.setUint8(f++,e.charCodeAt(0))),Array.from(s,e=>p.setUint8(f++,e.charCodeAt(0))),Array.from(l,e=>p.setUint8(f++,e.charCodeAt(0))),Array.from(u,e=>p.setUint8(f++,e.charCodeAt(0)));var m=new Uint8Array(d.byteLength+n.byteLength);return m.set(new Uint8Array(d),0),m.set(new Uint8Array(n),d.byteLength),m.buffer}decode(e,t){if(this._isArrayBuffer(e)){return t(this._binaryDecode(e))}if("string"===typeof e){const n=JSON.parse(e),[i,r,s,o,a]=n;return t({join_ref:i,ref:r,topic:s,event:o,payload:a})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),i=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,i)}_decodeUserBroadcast(e,t,n){const i=t.getUint8(1),r=t.getUint8(2),s=t.getUint8(3),o=t.getUint8(4);let a=this.HEADER_LENGTH+4;const l=n.decode(e.slice(a,a+i));a+=i;const c=n.decode(e.slice(a,a+r));a+=r;const u=n.decode(e.slice(a,a+s));a+=s;const h=e.slice(a,e.byteLength),d=o===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,p={type:this.BROADCAST_EVENT,event:c,payload:d};return s>0&&(p.meta=JSON.parse(u)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name)}_pick(e,t){return e&&"object"===typeof e?Object.fromEntries(Object.entries(e).filter(e=>{let[n]=e;return t.includes(n)})):{}}}class AC{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(SC||(SC={}));const EC=function(e,t){var n;const i=null!==(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==n?n:[];return t?Object.keys(t).reduce((n,r)=>(n[r]=_C(r,e,t,i),n),{}):{}},_C=(e,t,n,i)=>{const r=t.find(t=>t.name===e),s=null===r||void 0===r?void 0:r.type,o=n[e];return s&&!i.includes(s)?TC(s,o):PC(o)},TC=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return NC(t,n)}switch(e){case SC.bool:return MC(t);case SC.float4:case SC.float8:case SC.int2:case SC.int4:case SC.int8:case SC.numeric:case SC.oid:return FC(t);case SC.json:case SC.jsonb:return RC(t);case SC.timestamp:return IC(t);case SC.abstime:case SC.date:case SC.daterange:case SC.int4range:case SC.int8range:case SC.money:case SC.reltime:case SC.text:case SC.time:case SC.timestamptz:case SC.timetz:case SC.tsrange:case SC.tstzrange:default:return PC(t)}},PC=e=>e,MC=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},FC=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},RC=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(nh){return e}return e},NC=(e,t)=>{if("string"!==typeof e)return e;const n=e.length-1,i=e[n];if("{"===e[0]&&"}"===i){let i;const r=e.slice(1,n);try{i=JSON.parse("["+r+"]")}catch(Jre){i=r?r.split(","):[]}return i.map(e=>TC(t,e))}return e},IC=e=>"string"===typeof e?e.replace(" ","T"):e,BC=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class QC{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:OC;this.channel=e,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:n}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var LC,jC,$C,zC;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(LC||(LC={}));class WC{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},e=>{const{onJoin:t,onLeave:n,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=WC.syncState(this.state,e,t,n),this.pendingDiffs.forEach(e=>{this.state=WC.syncDiff(this.state,e,t,n)}),this.pendingDiffs=[],i()}),this.channel._on(n.diff,{},e=>{const{onJoin:t,onLeave:n,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=WC.syncDiff(this.state,e,t,n),i())}),this.onJoin((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})}),this.onLeave((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,i){const r=this.cloneDeep(e),s=this.transformState(t),o={},a={};return this.map(r,(e,t)=>{s[e]||(a[e]=t)}),this.map(s,(e,t)=>{const n=r[e];if(n){const i=t.map(e=>e.presence_ref),r=n.map(e=>e.presence_ref),s=t.filter(e=>r.indexOf(e.presence_ref)<0),l=n.filter(e=>i.indexOf(e.presence_ref)<0);s.length>0&&(o[e]=s),l.length>0&&(a[e]=l)}else o[e]=t}),this.syncDiff(r,{joins:o,leaves:a},n,i)}static syncDiff(e,t,n,i){const{joins:r,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(r,(t,i)=>{var r;const s=null!==(r=e[t])&&void 0!==r?r:[];if(e[t]=this.cloneDeep(i),s.length>0){const n=e[t].map(e=>e.presence_ref),i=s.filter(e=>n.indexOf(e.presence_ref)<0);e[t].unshift(...i)}n(t,s,i)}),this.map(s,(t,n)=>{let r=e[t];if(!r)return;const s=n.map(e=>e.presence_ref);r=r.filter(e=>s.indexOf(e.presence_ref)<0),e[t]=r,i(t,r,n),0===r.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const i=e[n];return t[n]="metas"in i?i.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(jC||(jC={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}($C||($C={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(zC||(zC={}));class VC{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},n=arguments.length>2?arguments[2]:void 0;var i,r;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=bC.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new QC(this,kC.join,this.params,this.timeout),this.rejoinTimer=new AC(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=bC.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=bC.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=bC.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=bC.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=bC.errored,this.rejoinTimer.scheduleTimeout())}),this._on(kC.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new WC(this),this.broadcastEndpointURL=BC(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(r=null===(i=this.params.config)||void 0===i?void 0:i.broadcast)||void 0===r?void 0:r.replay))throw"tried to use replay on public channel '".concat(this.topic,"'. It must be a private channel.")}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var n,i,r;if(this.socket.isConnected()||this.socket.connect(),this.state==bC.closed){const{config:{broadcast:s,presence:o,private:a}}=this.params,l=null!==(i=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map(e=>e.filter))&&void 0!==i?i:[],c=!!this.bindings[$C.PRESENCE]&&this.bindings[$C.PRESENCE].length>0||!0===(null===(r=this.params.config.presence)||void 0===r?void 0:r.enabled),u={},h={broadcast:s,presence:Object.assign(Object.assign({},o),{enabled:c}),postgres_changes:l,private:a};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(t=>null===e||void 0===e?void 0:e(zC.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(zC.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:n}=t;var i;if(this.socket._isManualToken()||this.socket.setAuth(),void 0!==n){const t=this.bindings.postgres_changes,r=null!==(i=null===t||void 0===t?void 0:t.length)&&void 0!==i?i:0,s=[];for(let i=0;i<r;i++){const r=t[i],{filter:{event:o,schema:a,table:l,filter:c}}=r,u=n&&n[i];if(!(u&&u.event===o&&VC.isFilterValueEqual(u.schema,a)&&VC.isFilterValueEqual(u.table,l)&&VC.isFilterValueEqual(u.filter,c)))return this.unsubscribe(),this.state=bC.errored,void(null===e||void 0===e||e(zC.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},r),{id:u.id}))}return this.bindings.postgres_changes=s,void(e&&e(zC.SUBSCRIBED))}null===e||void 0===e||e(zC.SUBSCRIBED)}).receive("error",t=>{this.state=bC.errored,null===e||void 0===e||e(zC.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(zC.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===bC.joined&&e===$C.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,n)}async httpSend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;if(void 0===t||null===t)return Promise.reject("Payload is required for httpSend()");const r={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(r.Authorization="Bearer ".concat(this.socket.accessTokenValue));const s={method:"POST",headers:r,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(i=n.timeout)&&void 0!==i?i:this.timeout);if(202===o.status)return{success:!0};let a=o.statusText;try{const e=await o.json();a=e.error||e.message||a}catch(l){}return Promise.reject(new Error(a))}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i;if(this._canPush()||"broadcast"!==e.type)return new Promise(n=>{var i,r,s;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(r=null===(i=this.params)||void 0===i?void 0:i.config)||void 0===r?void 0:r.broadcast)||void 0===s?void 0:s.ack)||n("ok"),o.receive("ok",()=>n("ok")),o.receive("error",()=>n("error")),o.receive("timeout",()=>n("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:o}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization="Bearer ".concat(this.socket.accessTokenValue));const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,l,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(i=e.body)||void 0===i?void 0:i.cancel()),e.ok?"ok":"error"}catch(r){return"AbortError"===r.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=bC.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(kC.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new QC(this,kC.leave,{},e),n.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{null===n||void 0===n||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=bC.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const i=new AbortController,r=setTimeout(()=>i.abort(),n),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(r),s}_push(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let i=new QC(this,e,t,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var i,r;const s=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=kC;if(n&&[o,a,l,c].indexOf(s)>=0&&n!==this._joinRef())return;let u=this._onMessage(s,t,n);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(i=this.bindings.postgres_changes)||void 0===i||i.filter(e=>{var t,n,i;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(i=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===i?void 0:i.toLocaleLowerCase())===s}).map(e=>e.callback(u,n)):null===(r=this.bindings[s])||void 0===r||r.filter(e=>{var n,i,r,o,a,l;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,o=null===(n=e.filter)||void 0===n?void 0:n.event;return s&&(null===(i=t.ids)||void 0===i?void 0:i.includes(s))&&("*"===o||(null===o||void 0===o?void 0:o.toLocaleLowerCase())===(null===(r=t.data)||void 0===r?void 0:r.type.toLocaleLowerCase()))}{const n=null===(a=null===(o=null===e||void 0===e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===n||n===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s}).map(e=>{if("object"===typeof u&&"ids"in u){const e=u.data,{schema:t,table:n,commit_timestamp:i,type:r,errors:s}=e,o={schema:t,table:n,commit_timestamp:i,eventType:r,new:{},old:{},errors:s};u=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(u,n)})}_isClosed(){return this.state===bC.closed}_isJoined(){return this.state===bC.joined}_isJoining(){return this.state===bC.joining}_isLeaving(){return this.state===bC.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,n){const i=e.toLocaleLowerCase(),r={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(r):this.bindings[i]=[r],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(e=>{var i;return!((null===(i=e.type)||void 0===i?void 0:i.toLocaleLowerCase())===n&&VC.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static isFilterValueEqual(e,t){return(null!==e&&void 0!==e?e:void 0)===(null!==t&&void 0!==t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(kC.close,{},e)}_onError(e){this._on(kC.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=bC.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=EC(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=EC(e.columns,e.old_record)),t}}const UC=()=>{},XC=25e3,qC=10,ZC=100,HC=[1e3,2e3,5e3,1e4];class YC{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=OC,this.transport=null,this.heartbeatIntervalMs=XC,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=UC,this.ref=0,this.reconnectTimer=null,this.vsn=yC,this.logger=UC,this.conn=null,this.sendBuffer=[],this.serializer=new CC,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},!(null===(n=null===t||void 0===t?void 0:t.params)||void 0===n?void 0:n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(xC.websocket),this.httpEndpoint=BC(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=mC.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},"function"===typeof this.conn.close&&(e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case wC.connecting:return DC.Connecting;case wC.open:return DC.Open;case wC.closing:return DC.Closing;default:return DC.Closed}}isConnected(){return this.connectionState()===DC.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const n="realtime:".concat(e),i=this.getChannels().find(e=>e.topic===n);if(i)return i;{const n=new VC("realtime:".concat(e),t,this);return this.channels.push(n),n}}push(e){const{topic:t,event:n,payload:i,ref:r}=e,s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(n," (").concat(r,")"),i),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(Kre){this.log("error","error in heartbeat callback",Kre)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},ZC)}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(Kre){this.log("error","error in heartbeat callback",Kre)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(Kre){this.log("error","error in heartbeat callback",Kre)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){const t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(Kre){this.log("error","error in heartbeat callback",Kre)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:t,event:n,payload:i,ref:r}=e,s=r?"(".concat(r,")"):"",o=i.status||"";this.log("receive","".concat(o," ").concat(t," ").concat(n," ").concat(s).trim(),i),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(n,i,r)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===wC.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===wC.open||this.conn.readyState===wC.connecting)try{this.conn.close()}catch(Kre){this.log("error","Error closing connection",Kre)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL()));(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(Kre){this.log("error","error in heartbeat callback",Kre)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(kC.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return"".concat(e).concat(n).concat(i)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=!1;if(t)e=t,n=!0;else if(this.accessToken)try{e=await this.accessToken()}catch(Kre){this.log("error","Error fetching access token from callback",Kre),e=this.accessTokenValue}else e=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const n={access_token:e,version:gC};e&&t.updateJoinPayload(n),t.joinedOnce&&t._isJoined()&&t._push(kC.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this._isManualToken()||this.setAuth().catch(t=>{this.log("error","Error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(Kre){this.log("error","error in ".concat(e," callback"),Kre)}})}catch(Kre){this.log("error","error triggering ".concat(e," callbacks"),Kre)}}_setupReconnectionTimer(){this.reconnectTimer=new AC(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},qC)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,i,r,s,o,a,l,c,u,h,d;switch(this.transport=null!==(t=null===e||void 0===e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(n=null===e||void 0===e?void 0:e.timeout)&&void 0!==n?n:OC,this.heartbeatIntervalMs=null!==(i=null===e||void 0===e?void 0:e.heartbeatIntervalMs)&&void 0!==i?i:XC,this.worker=null!==(r=null===e||void 0===e?void 0:e.worker)&&void 0!==r&&r,this.accessToken=null!==(s=null===e||void 0===e?void 0:e.accessToken)&&void 0!==s?s:null,this.heartbeatCallback=null!==(o=null===e||void 0===e?void 0:e.heartbeatCallback)&&void 0!==o?o:UC,this.vsn=null!==(a=null===e||void 0===e?void 0:e.vsn)&&void 0!==a?a:yC,(null===e||void 0===e?void 0:e.params)&&(this.params=e.params),(null===e||void 0===e?void 0:e.logger)&&(this.logger=e.logger),((null===e||void 0===e?void 0:e.logLevel)||(null===e||void 0===e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null===e||void 0===e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>HC[e-1]||1e4,this.vsn){case"1.0.0":this.encode=null!==(c=null===e||void 0===e?void 0:e.encode)&&void 0!==c?c:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(u=null===e||void 0===e?void 0:e.decode)&&void 0!==u?u:(e,t)=>t(JSON.parse(e));break;case vC:this.encode=null!==(h=null===e||void 0===e?void 0:e.encode)&&void 0!==h?h:this.serializer.encode.bind(this.serializer),this.decode=null!==(d=null===e||void 0===e?void 0:e.decode)&&void 0!==d?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error("Unsupported serializer version: ".concat(this.vsn))}if(this.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null===e||void 0===e?void 0:e.workerUrl}}}var GC=class extends Error{constructor(e,t){var n;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&!0===(null===(n=t.icebergType)||void 0===n?void 0:n.includes("CommitState"))}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};function KC(e){var t;const n=null!==(t=e.fetchImpl)&&void 0!==t?t:globalThis.fetch;return{async request(t){let{method:i,path:r,query:s,body:o,headers:a}=t;const l=function(e,t,n){const i=new URL(t,e);if(n)for(const[r,s]of Object.entries(n))void 0!==s&&i.searchParams.set(r,s);return i.toString()}(e.baseUrl,r,s),c=await async function(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:"Bearer ".concat(e.token)}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}(e.auth),u=await n(l,{method:i,headers:p(p(p({},o?{"Content-Type":"application/json"}:{}),c),a),body:o?JSON.stringify(o):void 0}),h=await u.text(),d=(u.headers.get("content-type")||"").includes("application/json"),f=d&&h?JSON.parse(h):h;if(!u.ok){var m;const e=d?f:void 0,t=null===e||void 0===e?void 0:e.error;throw new GC(null!==(m=null===t||void 0===t?void 0:t.message)&&void 0!==m?m:"Request failed with status ".concat(u.status),{status:u.status,icebergType:null===t||void 0===t?void 0:t.type,icebergCode:null===t||void 0===t?void 0:t.code,details:e})}return{status:u.status,headers:u.headers,data:f}}}}function JC(e){return e.join("\x1f")}var eA=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:JC(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces"),query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){const n={namespace:e.namespace,properties:null===t||void 0===t?void 0:t.properties};return(await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces"),body:n})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:"".concat(this.prefix,"/namespaces/").concat(JC(e.namespace))})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(JC(e.namespace))})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:"".concat(this.prefix,"/namespaces/").concat(JC(e.namespace))}),!0}catch(t){if(t instanceof GC&&404===t.status)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(n){if(n instanceof GC&&409===n.status)return;throw n}}};function tA(e){return e.join("\x1f")}var nA=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;this.client=e,this.prefix=t,this.accessDelegation=n}async listTables(e){return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(tA(e.namespace),"/tables")})).data.identifiers}async createTable(e,t){const n={};this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces/").concat(tA(e.namespace),"/tables"),body:t,headers:n})).data.metadata}async updateTable(e,t){const n=await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces/").concat(tA(e.namespace),"/tables/").concat(e.name),body:t});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(e,t){var n;await this.client.request({method:"DELETE",path:"".concat(this.prefix,"/namespaces/").concat(tA(e.namespace),"/tables/").concat(e.name),query:{purgeRequested:String(null!==(n=null===t||void 0===t?void 0:t.purge)&&void 0!==n&&n)}})}async loadTable(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(tA(e.namespace),"/tables/").concat(e.name),headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:"".concat(this.prefix,"/namespaces/").concat(tA(e.namespace),"/tables/").concat(e.name),headers:t}),!0}catch(n){if(n instanceof GC&&404===n.status)return!1;throw n}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(n){if(n instanceof GC&&409===n.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw n}}},iA=class{constructor(e){var t;let n="v1";e.catalogName&&(n+="/".concat(e.catalogName));const i=e.baseUrl.endsWith("/")?e.baseUrl:"".concat(e.baseUrl,"/");this.client=KC({baseUrl:i,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=null===(t=e.accessDelegation)||void 0===t?void 0:t.join(","),this.namespaceOps=new eA(this.client,n),this.tableOps=new nA(this.client,n,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};var rA=class extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"storage",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;super(e),this.__isStorageError=!0,this.namespace=t,this.name="vectors"===t?"StorageVectorsError":"StorageError",this.status=n,this.statusCode=i}};function sA(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}var oA=class extends rA{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"storage";super(e,i,t,n),this.name="vectors"===i?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},aA=class extends rA{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"storage";super(e,n),this.name="vectors"===n?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const lA=e=>{if(Array.isArray(e))return e.map(e=>lA(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[n,i]=e;const r=n.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[r]=lA(i)}),t};function cA(e){return(cA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uA(e){var t=function(e,t){if("object"!=cA(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=cA(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==cA(t)?t:t+""}function hA(e,t,n){return(t=uA(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function pA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dA(Object(n),!0).forEach(function(t){hA(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const fA=e=>{var t;return e.msg||e.message||e.error_description||("string"===typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},mA=(e,t,n,i)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&"HEAD"!==e&&i?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(i)?(r.headers=pA({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),r.body=JSON.stringify(i)):r.body=i,(null===t||void 0===t?void 0:t.duplex)&&(r.duplex=t.duplex),pA(pA({},r),n)):pA(pA({},r),n)};async function gA(e,t,n,i,r,s,o){return new Promise((a,l)=>{e(n,mA(t,i,r,s)).then(e=>{if(!e.ok)throw e;if(null===i||void 0===i?void 0:i.noResolveJson)return e;if("vectors"===o){const t=e.headers.get("content-type");if("0"===e.headers.get("content-length")||204===e.status)return{};if(!t||!t.includes("application/json"))return{}}return e.json()}).then(e=>a(e)).catch(e=>(async(e,t,n,i)=>{if(e&&"object"===typeof e&&"status"in e&&"ok"in e&&"number"===typeof e.status&&!(null===n||void 0===n?void 0:n.noResolveJson)){const n=e,r=n.status||500;if("function"===typeof n.json)n.json().then(e=>{const n=(null===e||void 0===e?void 0:e.statusCode)||(null===e||void 0===e?void 0:e.code)||r+"";t(new oA(fA(e),r,n,i))}).catch(()=>{if("vectors"===i){const e=r+"";t(new oA(n.statusText||"HTTP ".concat(r," error"),r,e,i))}else{const e=r+"";t(new oA(n.statusText||"HTTP ".concat(r," error"),r,e,i))}});else{const e=r+"";t(new oA(n.statusText||"HTTP ".concat(r," error"),r,e,i))}}else t(new aA(fA(e),e,i))})(e,l,i,o))})}function vA(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"storage";return{get:async(t,n,i,r)=>gA(t,"GET",n,i,r,void 0,e),post:async(t,n,i,r,s)=>gA(t,"POST",n,r,s,i,e),put:async(t,n,i,r,s)=>gA(t,"PUT",n,r,s,i,e),head:async(t,n,i,r)=>gA(t,"HEAD",n,pA(pA({},i),{},{noResolveJson:!0}),r,void 0,e),remove:async(t,n,i,r,s)=>gA(t,"DELETE",n,r,s,i,e)}}const yA=vA("storage"),{get:OA,post:wA,put:bA,head:kA,remove:xA}=yA,DA=vA("vectors");var SA=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"storage";var r;this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=(r=n)?function(){return r(...arguments)}:function(){return fetch(...arguments)},this.namespace=i}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){try{return{data:await e(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(sA(t))return{data:null,error:t};throw t}}},CA=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(sA(e))return{data:null,error:e};throw e}}};let AA;AA=Symbol.toStringTag;var EA=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[AA]="BlobDownloadBuilder",this.promise=null}asStream(){return new CA(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await(await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(sA(e))return{data:null,error:e};throw e}}};const _A={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},TA={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var PA=class extends SA{constructor(e){let t=arguments.length>2?arguments[2]:void 0;super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>3?arguments[3]:void 0,"storage"),this.bucketId=t}async uploadOrUpdate(e,t,n,i){var r=this;return r.handleOperation(async()=>{let s;const o=pA(pA({},TA),i);let a=pA(pA({},r.headers),"POST"===e&&{"x-upsert":String(o.upsert)});const l=o.metadata;"undefined"!==typeof Blob&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",r.encodeMetadata(l)),s.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",o.cacheControl),l&&!s.has("metadata")&&s.append("metadata",r.encodeMetadata(l))):(s=n,a["cache-control"]="max-age=".concat(o.cacheControl),a["content-type"]=o.contentType,l&&(a["x-metadata"]=r.toBase64(r.encodeMetadata(l))),("undefined"!==typeof ReadableStream&&s instanceof ReadableStream||s&&"object"===typeof s&&"pipe"in s&&"function"===typeof s.pipe)&&!o.duplex&&(o.duplex="half")),(null===i||void 0===i?void 0:i.headers)&&(a=pA(pA({},a),i.headers));const c=r._removeEmptyFolders(t),u=r._getFinalPath(c),h=await("PUT"==e?bA:wA)(r.fetch,"".concat(r.url,"/object/").concat(u),s,pA({headers:a},(null===o||void 0===o?void 0:o.duplex)?{duplex:o.duplex}:{}));return{path:c,id:h.Id,fullPath:h.Key}})}async upload(e,t,n){return this.uploadOrUpdate("POST",e,t,n)}async uploadToSignedUrl(e,t,n,i){var r=this;const s=r._removeEmptyFolders(e),o=r._getFinalPath(s),a=new URL(r.url+"/object/upload/sign/".concat(o));return a.searchParams.set("token",t),r.handleOperation(async()=>{let e;const t=pA({upsert:TA.upsert},i),o=pA(pA({},r.headers),{"x-upsert":String(t.upsert)});return"undefined"!==typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,o["cache-control"]="max-age=".concat(t.cacheControl),o["content-type"]=t.contentType),{path:s,fullPath:(await bA(r.fetch,a.toString(),e,{headers:o})).Key}})}async createSignedUploadUrl(e,t){var n=this;return n.handleOperation(async()=>{let i=n._getFinalPath(e);const r=pA({},n.headers);(null===t||void 0===t?void 0:t.upsert)&&(r["x-upsert"]="true");const s=await wA(n.fetch,"".concat(n.url,"/object/upload/sign/").concat(i),{},{headers:r}),o=new URL(n.url+s.url),a=o.searchParams.get("token");if(!a)throw new rA("No token returned by API");return{signedUrl:o.toString(),path:e,token:a}})}async update(e,t,n){return this.uploadOrUpdate("PUT",e,t,n)}async move(e,t,n){var i=this;return i.handleOperation(async()=>await wA(i.fetch,"".concat(i.url,"/object/move"),{bucketId:i.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:i.headers}))}async copy(e,t,n){var i=this;return i.handleOperation(async()=>({path:(await wA(i.fetch,"".concat(i.url,"/object/copy"),{bucketId:i.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:i.headers})).Key}))}async createSignedUrl(e,t,n){var i=this;return i.handleOperation(async()=>{let r=i._getFinalPath(e),s=await wA(i.fetch,"".concat(i.url,"/object/sign/").concat(r),pA({expiresIn:t},(null===n||void 0===n?void 0:n.transform)?{transform:n.transform}:{}),{headers:i.headers});const o=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return{signedUrl:encodeURI("".concat(i.url).concat(s.signedURL).concat(o))}})}async createSignedUrls(e,t,n){var i=this;return i.handleOperation(async()=>{const r=await wA(i.fetch,"".concat(i.url,"/object/sign/").concat(i.bucketId),{expiresIn:t,paths:e},{headers:i.headers}),s=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return r.map(e=>pA(pA({},e),{},{signedUrl:e.signedURL?encodeURI("".concat(i.url).concat(e.signedURL).concat(s)):null}))})}download(e,t){const n="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",i=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),r=i?"?".concat(i):"",s=this._getFinalPath(e);return new EA(()=>OA(this.fetch,"".concat(this.url,"/").concat(n,"/").concat(s).concat(r),{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(e){var t=this;const n=t._getFinalPath(e);return t.handleOperation(async()=>lA(await OA(t.fetch,"".concat(t.url,"/object/info/").concat(n),{headers:t.headers})))}async exists(e){var t=this;const n=t._getFinalPath(e);try{return await kA(t.fetch,"".concat(t.url,"/object/").concat(n),{headers:t.headers}),{data:!0,error:null}}catch(i){if(t.shouldThrowOnError)throw i;if(sA(i)&&i instanceof aA){const e=i.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:i}}throw i}}getPublicUrl(e,t){const n=this._getFinalPath(e),i=[],r=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==r&&i.push(r);const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==o&&i.push(o);let a=i.join("&");return""!==a&&(a="?".concat(a)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(s,"/public/").concat(n).concat(a))}}}async remove(e){var t=this;return t.handleOperation(async()=>await xA(t.fetch,"".concat(t.url,"/object/").concat(t.bucketId),{prefixes:e},{headers:t.headers}))}async list(e,t,n){var i=this;return i.handleOperation(async()=>{const r=pA(pA(pA({},_A),t),{},{prefix:e||""});return await wA(i.fetch,"".concat(i.url,"/object/list/").concat(i.bucketId),r,{headers:i.headers},n)})}async listV2(e,t){var n=this;return n.handleOperation(async()=>{const i=pA({},e);return await wA(n.fetch,"".concat(n.url,"/object/list-v2/").concat(n.bucketId),i,{headers:n.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}};const MA={"X-Client-Info":"storage-js/".concat("2.93.3")};var FA=class extends SA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;const r=new URL(e);(null===i||void 0===i?void 0:i.useNewHostname)&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase."));super(r.href.replace(/\/$/,""),pA(pA({},MA),t),n,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const n=t.listBucketOptionsToQueryString(e);return await OA(t.fetch,"".concat(t.url,"/bucket").concat(n),{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await OA(t.fetch,"".concat(t.url,"/bucket/").concat(e),{headers:t.headers}))}async createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};var n=this;return n.handleOperation(async()=>await wA(n.fetch,"".concat(n.url,"/bucket"),{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:n.headers}))}async updateBucket(e,t){var n=this;return n.handleOperation(async()=>await bA(n.fetch,"".concat(n.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:n.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await wA(t.fetch,"".concat(t.url,"/bucket/").concat(e,"/empty"),{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await xA(t.fetch,"".concat(t.url,"/bucket/").concat(e),{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},RA=class extends SA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),pA(pA({},MA),t),n,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await wA(t.fetch,"".concat(t.url,"/bucket"),{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const n=new URLSearchParams;void 0!==(null===e||void 0===e?void 0:e.limit)&&n.set("limit",e.limit.toString()),void 0!==(null===e||void 0===e?void 0:e.offset)&&n.set("offset",e.offset.toString()),(null===e||void 0===e?void 0:e.sortColumn)&&n.set("sortColumn",e.sortColumn),(null===e||void 0===e?void 0:e.sortOrder)&&n.set("sortOrder",e.sortOrder),(null===e||void 0===e?void 0:e.search)&&n.set("search",e.search);const i=n.toString(),r=i?"".concat(t.url,"/bucket?").concat(i):"".concat(t.url,"/bucket");return await OA(t.fetch,r,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await xA(t.fetch,"".concat(t.url,"/bucket/").concat(e),{},{headers:t.headers}))}from(e){var t=this;if(!(e=>!(!e||"string"!==typeof e)&&!(0===e.length||e.length>100)&&e.trim()===e&&!e.includes("/")&&!e.includes("\\")&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e))(e))throw new rA("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new iA({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(n,{get(e,t){const n=e[t];return"function"!==typeof n?n:async function(){try{for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return{data:await n.apply(e,r),error:null}}catch(o){if(i)throw o;return{data:null,error:o}}}}})}},NA=class extends SA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),pA(pA({},MA),{},{"Content-Type":"application/json"},t),n,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/CreateIndex"),e,{headers:t.headers})||{})}async getIndex(e,t){var n=this;return n.handleOperation(async()=>await DA.post(n.fetch,"".concat(n.url,"/GetIndex"),{vectorBucketName:e,indexName:t},{headers:n.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/ListIndexes"),e,{headers:t.headers}))}async deleteIndex(e,t){var n=this;return n.handleOperation(async()=>await DA.post(n.fetch,"".concat(n.url,"/DeleteIndex"),{vectorBucketName:e,indexName:t},{headers:n.headers})||{})}},IA=class extends SA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),pA(pA({},MA),{},{"Content-Type":"application/json"},t),n,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/PutVectors"),e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/GetVectors"),e,{headers:t.headers}))}async listVectors(e){var t=this;if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error("segmentIndex must be between 0 and ".concat(e.segmentCount-1))}return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/ListVectors"),e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/QueryVectors"),e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/DeleteVectors"),e,{headers:t.headers})||{})}},BA=class extends SA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),pA(pA({},MA),{},{"Content-Type":"application/json"},t),n,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/CreateVectorBucket"),{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/GetVectorBucket"),{vectorBucketName:e},{headers:t.headers}))}async listBuckets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=this;return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/ListVectorBuckets"),e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await DA.post(t.fetch,"".concat(t.url,"/DeleteVectorBucket"),{vectorBucketName:e},{headers:t.headers})||{})}},QA=class extends BA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t.headers||{},t.fetch)}from(e){return new LA(this.url,this.headers,e,this.fetch)}async createBucket(e){return(()=>super.createBucket)().call(this,e)}async getBucket(e){return(()=>super.getBucket)().call(this,e)}async listBuckets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(()=>super.listBuckets)().call(this,e)}async deleteBucket(e){return(()=>super.deleteBucket)().call(this,e)}},LA=class extends NA{constructor(e,t,n,i){super(e,t,i),this.vectorBucketName=n}async createIndex(e){return(()=>super.createIndex)().call(this,pA(pA({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(()=>super.listIndexes)().call(this,pA(pA({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return(()=>super.getIndex)().call(this,this.vectorBucketName,e)}async deleteIndex(e){return(()=>super.deleteIndex)().call(this,this.vectorBucketName,e)}index(e){return new jA(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},jA=class extends IA{constructor(e,t,n,i,r){super(e,t,r),this.vectorBucketName=n,this.indexName=i}async putVectors(e){var t=this;return(()=>super.putVectors)().call(t,pA(pA({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(e){var t=this;return(()=>super.getVectors)().call(t,pA(pA({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=this;return(()=>super.listVectors)().call(t,pA(pA({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(e){var t=this;return(()=>super.queryVectors)().call(t,pA(pA({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(e){var t=this;return(()=>super.deleteVectors)().call(t,pA(pA({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},$A=class extends FA{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)}from(e){return new PA(this.url,this.headers,e,this.fetch)}get vectors(){return new QA(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new RA(this.url+"/iceberg",this.headers,this.fetch)}};const zA="2.93.3",WA=3e4,VA=9e4,UA={"X-Client-Info":"gotrue-js/".concat(zA)},XA="X-Supabase-Api-Version",qA={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},ZA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class HA extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function YA(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class GA extends HA{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class KA extends HA{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class JA extends HA{constructor(e,t,n,i){super(e,n,i),this.name=t,this.status=n}}class eE extends JA{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function tE(e){return YA(e)&&"AuthSessionMissingError"===e.name}class nE extends JA{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class iE extends JA{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class rE extends JA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class sE extends JA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class oE extends JA{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class aE extends JA{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function lE(e){return YA(e)&&"AuthRetryableFetchError"===e.name}class cE extends JA{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class uE extends JA{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const hE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),dE=" \t\n\r=".split(""),pE=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<dE.length;t+=1)e[dE[t].charCodeAt(0)]=-2;for(let t=0;t<hE.length;t+=1)e[hE[t].charCodeAt(0)]=t;return e})();function fE(e,t,n){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;n(hE[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;n(hE[e]),t.queuedBits-=6}}function mE(e,t,n){const i=pE[e];if(!(i>-1)){if(-2===i)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function gE(e){const t=[],n=e=>{t.push(String.fromCodePoint(e))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},s=e=>{!function(e,t,n){if(0===t.utf8seq){if(e<=127)return void n(e);for(let n=1;n<6;n+=1)if(0===(e>>7-n&1)){t.utf8seq=n;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&n(t.codepoint)}}(e,i,n)};for(let o=0;o<e.length;o+=1)mE(e.charCodeAt(o),r,s);return t.join("")}function vE(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function yE(e,t){for(let n=0;n<e.length;n+=1){let i=e.charCodeAt(n);if(i>55295&&i<=56319){const t=1024*(i-55296)&65535;i=65536+(e.charCodeAt(n+1)-56320&65535|t),n+=1}vE(i,t)}}function OE(e){const t=[],n={queue:0,queuedBits:0},i=e=>{t.push(e)};for(let r=0;r<e.length;r+=1)mE(e.charCodeAt(r),n,i);return new Uint8Array(t)}function wE(e){const t=[],n={queue:0,queuedBits:0},i=e=>{t.push(e)};return e.forEach(e=>fE(e,n,i)),fE(null,n,i),t.join("")}const bE=()=>"undefined"!==typeof window&&"undefined"!==typeof document,kE={tested:!1,writable:!1},xE=()=>{if(!bE())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(Kre){return!1}if(kE.tested)return kE.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),kE.tested=!0,kE.writable=!0}catch(Kre){kE.tested=!0,kE.writable=!1}return kE.writable};const DE=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},SE=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},CE=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(nh){return n}},AE=async(e,t)=>{await e.removeItem(t)};class EE{constructor(){this.promise=new EE.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function _E(e){const t=e.split(".");if(3!==t.length)throw new uE("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!ZA.test(t[n]))throw new uE("JWT not in base64url format");return{header:JSON.parse(gE(t[0])),payload:JSON.parse(gE(t[1])),signature:OE(t[2]),raw:{header:t[0],payload:t[1]}}}function TE(e){return("0"+e.toString(16)).substr(-2)}async function PE(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ME(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let i=0;i<56;i++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,TE).join("")}();let r=i;n&&(r+="/PASSWORD_RECOVERY"),await SE(e,"".concat(t,"-code-verifier"),r);const s=await PE(i);return[s,i===s?"plain":"s256"]}EE.promiseConstructor=Promise;const FE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const RE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function NE(e){if(!RE.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function IE(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"===typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function BE(e){return JSON.parse(JSON.stringify(e))}const QE=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),LE=[502,503,504];async function jE(e){var t,n;if(!("object"===typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"===typeof n.json))throw new aE(QE(e),0);if(LE.includes(e.status))throw new aE(QE(e),e.status);let i,r;try{i=await e.json()}catch(Kre){throw new KA(QE(Kre),Kre)}const s=function(e){const t=e.headers.get(XA);if(!t)return null;if(!t.match(FE))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(Kre){return null}}(e);if(s&&s.getTime()>=qA.timestamp&&"object"===typeof i&&i&&"string"===typeof i.code?r=i.code:"object"===typeof i&&i&&"string"===typeof i.error_code&&(r=i.error_code),r){if("weak_password"===r)throw new cE(QE(i),e.status,(null===(t=i.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===r)throw new eE}else if("object"===typeof i&&i&&"object"===typeof i.weak_password&&i.weak_password&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new cE(QE(i),e.status,i.weak_password.reasons);throw new GA(QE(i),e.status||500,r)}async function $E(e,t,n,i){var r;const s=Object.assign({},null===i||void 0===i?void 0:i.headers);s[XA]||(s[XA]=qA.name),(null===i||void 0===i?void 0:i.jwt)&&(s.Authorization="Bearer ".concat(i.jwt));const o=null!==(r=null===i||void 0===i?void 0:i.query)&&void 0!==r?r:{};(null===i||void 0===i?void 0:i.redirectTo)&&(o.redirect_to=i.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await async function(e,t,n,i,r,s){const o=((e,t,n,i)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),n))})(t,i,r,s);let a;try{a=await e(n,Object.assign({},o))}catch(Kre){throw console.error(Kre),new aE(QE(Kre),0)}a.ok||await jE(a);if(null===i||void 0===i?void 0:i.noResolveJson)return a;try{return await a.json()}catch(Kre){await jE(Kre)}}(e,t,n+a,{headers:s,noResolveJson:null===i||void 0===i?void 0:i.noResolveJson},{},null===i||void 0===i?void 0:i.body);return(null===i||void 0===i?void 0:i.xform)?null===i||void 0===i?void 0:i.xform(l):{data:Object.assign({},l),error:null}}function zE(e){var t;let n=null;var i;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(i=e.expires_in,Math.round(Date.now()/1e3)+i)));return{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function WE(e){const t=zE(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function VE(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function UE(e){return{data:e,error:null}}function XE(e){const{action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:s}=e,o=eC(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:s},user:Object.assign({},o)},error:null}}function qE(e){return e}const ZE=["global","local","others"];class HE{constructor(e){let{url:t="",headers:n={},fetch:i}=e;this.url=t,this.headers=n,this.fetch=DE(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ZE[0];if(ZE.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(ZE.join(", ")));try{return await $E(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(YA(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await $E(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:VE})}catch(n){if(YA(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=eC(e,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=null===n||void 0===n?void 0:n.newEmail,delete i.newEmail),await $E(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:i,headers:this.headers,xform:XE,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(YA(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await $E(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:VE})}catch(t){if(YA(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,i,r,s,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=await $E(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(r=null===(i=null===e||void 0===e?void 0:e.perPage)||void 0===i?void 0:i.toString())&&void 0!==r?r:""},xform:qE});if(c.error)throw c.error;const u=await c.json(),h=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,d=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(n,"Page")]=t}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(YA(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){NE(e);try{return await $E(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:VE})}catch(t){if(YA(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){NE(e);try{return await $E(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:VE})}catch(n){if(YA(n))return{data:{user:null},error:n};throw n}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];NE(e);try{return await $E(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:VE})}catch(n){if(YA(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){NE(e.userId);try{const{data:t,error:n}=await $E(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(t){if(YA(t))return{data:null,error:t};throw t}}async _deleteFactor(e){NE(e.userId),NE(e.id);try{return{data:await $E(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(YA(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,i,r,s,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=await $E(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(r=null===(i=null===e||void 0===e?void 0:e.perPage)||void 0===i?void 0:i.toString())&&void 0!==r?r:""},xform:qE});if(c.error)throw c.error;const u=await c.json(),h=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,d=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(n,"Page")]=t}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(YA(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(e){try{return await $E(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients"),{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(YA(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await $E(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(YA(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await $E(this.fetch,"PUT","".concat(this.url,"/admin/oauth/clients/").concat(e),{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(n){if(YA(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await $E(this.fetch,"DELETE","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(YA(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await $E(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients/").concat(e,"/regenerate_secret"),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(YA(t))return{data:null,error:t};throw t}}}function YE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const GE=!!(globalThis&&xE()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class KE extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class JE extends KE{}async function e_(e,t,n){GE&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),GE&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async i=>{if(!i){if(0===t)throw GE&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new JE('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(GE)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(Kre){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",Kre)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}GE&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await n()}finally{GE&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}))}function t_(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error('@supabase/auth-js: Address "'.concat(e,'" is invalid.'));return e.toLowerCase()}function n_(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class i_ extends Error{constructor(e){let{message:t,code:n,cause:i,name:r}=e;var s;super(t,{cause:i}),this.__isWebAuthnError=!0,this.name=null!==(s=null!==r&&void 0!==r?r:i instanceof Error?i.name:void 0)&&void 0!==s?s:"Unknown Error",this.code=n}}class r_ extends i_{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function s_(e){let{error:t,options:n}=e;var i,r,s;const{publicKey:o}=n;if(!o)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(n.signal instanceof AbortSignal)return new i_({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("ConstraintError"===t.name){if(!0===(null===(i=o.authenticatorSelection)||void 0===i?void 0:i.requireResidentKey))return new i_({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if("conditional"===n.mediation&&"required"===(null===(r=o.authenticatorSelection)||void 0===r?void 0:r.userVerification))return new i_({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if("required"===(null===(s=o.authenticatorSelection)||void 0===s?void 0:s.userVerification))return new i_({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if("InvalidStateError"===t.name)return new i_({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if("NotAllowedError"===t.name)return new i_({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("NotSupportedError"===t.name){return 0===o.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new i_({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new i_({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t})}if("SecurityError"===t.name){const e=window.location.hostname;if(!d_(e))return new i_({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(o.rp.id!==e)return new i_({message:'The RP ID "'.concat(o.rp.id,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("TypeError"===t.name){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new i_({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if("UnknownError"===t.name)return new i_({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new i_({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function o_(e){let{error:t,options:n}=e;const{publicKey:i}=n;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(n.signal instanceof AbortSignal)return new i_({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if("NotAllowedError"===t.name)return new i_({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("SecurityError"===t.name){const e=window.location.hostname;if(!d_(e))return new i_({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(i.rpId!==e)return new i_({message:'The RP ID "'.concat(i.rpId,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new i_({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new i_({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}const a_=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function l_(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!==typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:n,excludeCredentials:i}=e,r=eC(e,["challenge","user","excludeCredentials"]),s=OE(t).buffer,o=Object.assign(Object.assign({},n),{id:OE(n.id).buffer}),a=Object.assign(Object.assign({},r),{challenge:s,user:o});if(i&&i.length>0){a.excludeCredentials=new Array(i.length);for(let e=0;e<i.length;e++){const t=i[e];a.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:OE(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return a}function c_(e){if(!e)throw new Error("Credential request options are required");if("undefined"!==typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:n}=e,i=eC(e,["challenge","allowCredentials"]),r=OE(t).buffer,s=Object.assign(Object.assign({},i),{challenge:r});if(n&&n.length>0){s.allowCredentials=new Array(n.length);for(let e=0;e<n.length;e++){const t=n[e];s.allowCredentials[e]=Object.assign(Object.assign({},t),{id:OE(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return s}function u_(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const n=e;return{id:e.id,rawId:e.id,response:{attestationObject:wE(new Uint8Array(e.response.attestationObject)),clientDataJSON:wE(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=n.authenticatorAttachment)&&void 0!==t?t:void 0}}function h_(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const n=e,i=e.getClientExtensionResults(),r=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:wE(new Uint8Array(r.authenticatorData)),clientDataJSON:wE(new Uint8Array(r.clientDataJSON)),signature:wE(new Uint8Array(r.signature)),userHandle:r.userHandle?wE(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:null!==(t=n.authenticatorAttachment)&&void 0!==t?t:void 0}}function d_(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function p_(){var e,t;return!!(bE()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"===typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"===typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const f_={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},m_={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function g_(){const e=e=>null!==e&&"object"===typeof e&&!Array.isArray(e),t=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),n={};for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];for(const o of r)if(o)for(const i in o){const r=o[i];if(void 0!==r)if(Array.isArray(r))n[i]=r;else if(t(r))n[i]=r;else if(e(r)){const t=n[i];e(t)?n[i]=g_(t,r):n[i]=g_(r)}else n[i]=r}return n}class v_{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge(e,t){let{factorId:n,webauthn:i,friendlyName:r,signal:s}=e;var o;try{const{data:e,error:a}=await this.client.mfa.challenge({factorId:n,webauthn:i});if(!e)return{data:null,error:a};const l=null!==s&&void 0!==s?s:a_.createNewAbortSignal();if("create"===e.webauthn.type){const{user:t}=e.webauthn.credential_options.publicKey;if(!t.name){const e=r;if(e)t.name="".concat(t.id,":").concat(e);else{const e=(await this.client.getUser()).data.user,n=(null===(o=null===e||void 0===e?void 0:e.user_metadata)||void 0===o?void 0:o.name)||(null===e||void 0===e?void 0:e.email)||(null===e||void 0===e?void 0:e.id)||"User";t.name="".concat(t.id,":").concat(n)}}t.displayName||(t.displayName=t.name)}switch(e.webauthn.type){case"create":{const i=function(e,t){return g_(f_,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.create),{data:r,error:s}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new r_("Browser returned unexpected credential type",t)}:{data:null,error:new r_("Empty credential response",t)}}catch(t){return{data:null,error:s_({error:t,options:e})}}}({publicKey:i,signal:l});return r?{data:{factorId:n,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:r}},error:null}:{data:null,error:s}}case"request":{const i=function(e,t){return g_(m_,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.request),{data:r,error:s}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new r_("Browser returned unexpected credential type",t)}:{data:null,error:new r_("Empty credential response",t)}}catch(t){return{data:null,error:o_({error:t,options:e})}}}(Object.assign(Object.assign({},e.webauthn.credential_options),{publicKey:i,signal:l}));return r?{data:{factorId:n,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:r}},error:null}:{data:null,error:s}}}}catch(a){return YA(a)?{data:null,error:a}:{data:null,error:new KA("Unexpected error in challenge",a)}}}async _verify(e){let{challengeId:t,factorId:n,webauthn:i}=e;return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:i})}async _authenticate(e,t){let{factorId:n,webauthn:{rpId:i=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!==typeof window?[window.location.origin]:void 0),signal:s}={}}=e;if(!i)return{data:null,error:new HA("rpId is required for WebAuthn authentication")};try{if(!p_())return{data:null,error:new KA("Browser does not support WebAuthn",null)};const{data:e,error:o}=await this.challenge({factorId:n,webauthn:{rpId:i,rpOrigins:r},signal:s},{request:t});if(!e)return{data:null,error:o};const{webauthn:a}=e;return this._verify({factorId:n,challengeId:e.challengeId,webauthn:{type:a.type,rpId:i,rpOrigins:r,credential_response:a.credential_response}})}catch(o){return YA(o)?{data:null,error:o}:{data:null,error:new KA("Unexpected error in authenticate",o)}}}async _register(e,t){let{friendlyName:n,webauthn:{rpId:i=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!==typeof window?[window.location.origin]:void 0),signal:s}={}}=e;if(!i)return{data:null,error:new HA("rpId is required for WebAuthn registration")};try{if(!p_())return{data:null,error:new KA("Browser does not support WebAuthn",null)};const{data:e,error:o}=await this._enroll({friendlyName:n});if(!e)return await this.client.mfa.listFactors().then(e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.all.find(e=>"webauthn"===e.factor_type&&e.friendly_name===n&&"unverified"!==e.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null===e||void 0===e?void 0:e.id}):void 0),{data:null,error:o};const{data:a,error:l}=await this._challenge({factorId:e.id,friendlyName:e.friendly_name,webauthn:{rpId:i,rpOrigins:r},signal:s},{create:t});return a?this._verify({factorId:e.id,challengeId:a.challengeId,webauthn:{rpId:i,rpOrigins:r,type:a.webauthn.type,credential_response:a.webauthn.credential_response}}):{data:null,error:l}}catch(o){return YA(o)?{data:null,error:o}:{data:null,error:new KA("Unexpected error in register",o)}}}}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(Kre){"undefined"!==typeof self&&(self.globalThis=self)}}();const y_={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:UA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function O_(e,t,n){return await n()}const w_={};class b_{get jwks(){var e,t;return null!==(t=null===(e=w_[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){w_[this.storageKey]=Object.assign(Object.assign({},w_[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=w_[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){w_[this.storageKey]=Object.assign(Object.assign({},w_[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const r=Object.assign(Object.assign({},y_),e);if(this.storageKey=r.storageKey,this.instanceID=null!==(t=b_.nextInstanceID[this.storageKey])&&void 0!==t?t:0,b_.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!r.debug,"function"===typeof r.debug&&(this.logger=r.debug),this.instanceID>0&&bE()){const e="".concat(this._logPrefix()," Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=r.persistSession,this.autoRefreshToken=r.autoRefreshToken,this.admin=new HE({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=DE(r.fetch),this.lock=r.lock||O_,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,this.throwOnError=r.throwOnError,this.lockAcquireTimeout=r.lockAcquireTimeout,r.lock?this.lock=r.lock:this.persistSession&&bE()&&(null===(n=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===n?void 0:n.locks)?this.lock=e_:this.lock=O_,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new v_(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:xE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=YE(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=YE(this.memoryStorage)),bE()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(Kre){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",Kre)}null===(i=this.broadcastChannel)||void 0===i||i.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e);try{await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}catch(t){this._debug("#broadcastChannel","error",t)}})}this.initialize().catch(e=>{this._debug("#initialize()","error",e)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return"GoTrueClient@"+"".concat(this.storageKey,":").concat(this.instanceID," (").concat(zA,") ").concat((new Date).toISOString())}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger(this._logPrefix(),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},n="none";if(bE()&&(t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach((e,n)=>{t[n]=e})}catch(Kre){}return n.searchParams.forEach((e,n)=>{t[n]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),bE()&&this.detectSessionInUrl&&"none"!==n){const{data:i,error:r}=await this._getSessionFromURL(t,n);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),function(e){return YA(e)&&"AuthImplicitGrantRedirectError"===e.name}(r)){const t=null===(e=r.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:r}}return{error:r}}const{session:s,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return YA(t)?this._returnResult({error:t}):this._returnResult({error:new KA("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,i;try{const r=await $E(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(n=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(i=null===e||void 0===e?void 0:e.options)||void 0===i?void 0:i.captchaToken}},xform:zE}),{data:s,error:o}=r;if(o||!s)return this._returnResult({data:{user:null,session:null},error:o});const a=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:l,session:a},error:null})}catch(r){if(YA(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signUp(e){var t,n,i;try{let r;if("email"in e){const{email:n,password:i,options:s}=e;let o=null,a=null;"pkce"===this.flowType&&([o,a]=await ME(this.storage,this.storageKey)),r=await $E(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo,body:{email:n,password:i,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:o,code_challenge_method:a},xform:zE})}else{if(!("phone"in e))throw new iE("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:o}=e;r=await $E(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:s,data:null!==(n=null===o||void 0===o?void 0:o.data)&&void 0!==n?n:{},channel:null!==(i=null===o||void 0===o?void 0:o.channel)&&void 0!==i?i:"sms",gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken}},xform:zE})}}const{data:s,error:o}=r;if(o||!s)return await AE(this.storage,"".concat(this.storageKey,"-code-verifier")),this._returnResult({data:{user:null,session:null},error:o});const a=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:l,session:a},error:null})}catch(r){if(await AE(this.storage,"".concat(this.storageKey,"-code-verifier")),YA(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:i,options:r}=e;t=await $E(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:n,password:i,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:WE})}else{if(!("phone"in e))throw new iE("You must provide either an email or phone number and a password");{const{phone:n,password:i,options:r}=e;t=await $E(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:n,password:i,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:WE})}}const{data:n,error:i}=t;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const e=new nE;return this._returnResult({data:{user:null,session:null},error:e})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(YA(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,i,r;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:null===(r=e.options)||void 0===r?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}}async signInWithEthereum(e){var t,n,i,r,s,o,a,l,c,u,h;let d,p;if("message"in e)d=e.message,p=e.signature;else{const{chain:u,wallet:h,statement:f,options:m}=e;let g;if(bE())if("object"===typeof h)g=h;else{const e=window;if(!("ethereum"in e)||"object"!==typeof e.ethereum||!("request"in e.ethereum)||"function"!==typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");g=e.ethereum}else{if("object"!==typeof h||!(null===m||void 0===m?void 0:m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=h}const v=new URL(null!==(t=null===m||void 0===m?void 0:m.url)&&void 0!==t?t:window.location.href),y=await g.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!y||0===y.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const O=t_(y[0]);let w=null===(n=null===m||void 0===m?void 0:m.signInWithEthereum)||void 0===n?void 0:n.chainId;if(!w){const e=await g.request({method:"eth_chainId"});w=parseInt(e,16)}d=function(e){var t;const{chainId:n,domain:i,expirationTime:r,issuedAt:s=new Date,nonce:o,notBefore:a,requestId:l,resources:c,scheme:u,uri:h,version:d}=e;if(!Number.isInteger(n))throw new Error('@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: '.concat(n));if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error('@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: '.concat(o));if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==d)throw new Error("@supabase/auth-js: Invalid SIWE message field \"version\". Version must be '1'. Provided value: ".concat(d));if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error("@supabase/auth-js: Invalid SIWE message field \"statement\". Statement must not include '\\n'. Provided value: ".concat(e.statement));const p=t_(e.address),f=u?"".concat(u,"://").concat(i):i,m=e.statement?"".concat(e.statement,"\n"):"",g="".concat(f," wants you to sign in with your Ethereum account:\n").concat(p,"\n\n").concat(m);let v="URI: ".concat(h,"\nVersion: ").concat(d,"\nChain ID: ").concat(n).concat(o?"\nNonce: ".concat(o):"","\nIssued At: ").concat(s.toISOString());if(r&&(v+="\nExpiration Time: ".concat(r.toISOString())),a&&(v+="\nNot Before: ".concat(a.toISOString())),l&&(v+="\nRequest ID: ".concat(l)),c){let e="\nResources:";for(const t of c){if(!t||"string"!==typeof t)throw new Error('@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: '.concat(t));e+="\n- ".concat(t)}v+=e}return"".concat(g,"\n").concat(v)}({domain:v.host,address:O,statement:f,uri:v.href,version:"1",chainId:w,nonce:null===(i=null===m||void 0===m?void 0:m.signInWithEthereum)||void 0===i?void 0:i.nonce,issuedAt:null!==(s=null===(r=null===m||void 0===m?void 0:m.signInWithEthereum)||void 0===r?void 0:r.issuedAt)&&void 0!==s?s:new Date,expirationTime:null===(o=null===m||void 0===m?void 0:m.signInWithEthereum)||void 0===o?void 0:o.expirationTime,notBefore:null===(a=null===m||void 0===m?void 0:m.signInWithEthereum)||void 0===a?void 0:a.notBefore,requestId:null===(l=null===m||void 0===m?void 0:m.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(c=null===m||void 0===m?void 0:m.signInWithEthereum)||void 0===c?void 0:c.resources}),p=await g.request({method:"personal_sign",params:[n_(d),O]})}try{const{data:t,error:n}=await $E(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:p},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:zE});if(n)throw n;if(!t||!t.session||!t.user){const e=new nE;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:n})}catch(f){if(YA(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async signInWithSolana(e){var t,n,i,r,s,o,a,l,c,u,h,d;let p,f;if("message"in e)p=e.message,f=e.signature;else{const{chain:h,wallet:d,statement:m,options:g}=e;let v;if(bE())if("object"===typeof d)v=d;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");v=e.solana}else{if("object"!==typeof d||!(null===g||void 0===g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=d}const y=new URL(null!==(t=null===g||void 0===g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in v&&v.signIn){const e=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===g||void 0===g?void 0:g.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),m?{statement:m}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");p="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),f=t.signature}else{if(!("signMessage"in v)||"function"!==typeof v.signMessage||!("publicKey"in v)||"object"!==typeof v||!v.publicKey||!("toBase58"in v.publicKey)||"function"!==typeof v.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=["".concat(y.host," wants you to sign in with your Solana account:"),v.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1","URI: ".concat(y.href),"Issued At: ".concat(null!==(i=null===(n=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===n?void 0:n.issuedAt)&&void 0!==i?i:(new Date).toISOString()),...(null===(r=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===r?void 0:r.notBefore)?["Not Before: ".concat(g.signInWithSolana.notBefore)]:[],...(null===(s=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===s?void 0:s.expirationTime)?["Expiration Time: ".concat(g.signInWithSolana.expirationTime)]:[],...(null===(o=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===o?void 0:o.chainId)?["Chain ID: ".concat(g.signInWithSolana.chainId)]:[],...(null===(a=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===a?void 0:a.nonce)?["Nonce: ".concat(g.signInWithSolana.nonce)]:[],...(null===(l=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?["Request ID: ".concat(g.signInWithSolana.requestId)]:[],...(null===(u=null===(c=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===u?void 0:u.length)?["Resources",...g.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await v.signMessage((new TextEncoder).encode(p),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");f=e}}try{const{data:t,error:n}=await $E(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:wE(f)},(null===(h=e.options)||void 0===h?void 0:h.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:zE});if(n)throw n;if(!t||!t.session||!t.user){const e=new nE;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:n})}catch(m){if(YA(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async _exchangeCodeForSession(e){const t=await CE(this.storage,"".concat(this.storageKey,"-code-verifier")),[n,i]=(null!==t&&void 0!==t?t:"").split("/");try{if(!n&&"pkce"===this.flowType)throw new oE;const{data:t,error:r}=await $E(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:zE});if(await AE(this.storage,"".concat(this.storageKey,"-code-verifier")),r)throw r;if(!t||!t.session||!t.user){const e=new nE;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!==i&&void 0!==i?i:null}),error:r})}catch(r){if(await AE(this.storage,"".concat(this.storageKey,"-code-verifier")),YA(r))return this._returnResult({data:{user:null,session:null,redirectType:null},error:r});throw r}}async signInWithIdToken(e){try{const{options:t,provider:n,token:i,access_token:r,nonce:s}=e,o=await $E(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:n,id_token:i,access_token:r,nonce:s,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:zE}),{data:a,error:l}=o;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a||!a.session||!a.user){const e=new nE;return this._returnResult({data:{user:null,session:null},error:e})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:a,error:l})}catch(t){if(YA(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,i,r,s;try{if("email"in e){const{email:i,options:r}=e;let s=null,o=null;"pkce"===this.flowType&&([s,o]=await ME(this.storage,this.storageKey));const{error:a}=await $E(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:i,data:null!==(t=null===r||void 0===r?void 0:r.data)&&void 0!==t?t:{},create_user:null===(n=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},code_challenge:s,code_challenge_method:o},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}if("phone"in e){const{phone:t,options:n}=e,{data:o,error:a}=await $E(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(i=null===n||void 0===n?void 0:n.data)&&void 0!==i?i:{},create_user:null===(r=null===n||void 0===n?void 0:n.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},channel:null!==(s=null===n||void 0===n?void 0:n.channel)&&void 0!==s?s:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null===o||void 0===o?void 0:o.message_id},error:a})}throw new iE("You must provide either an email or phone number.")}catch(o){if(await AE(this.storage,"".concat(this.storageKey,"-code-verifier")),YA(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var t,n;try{let i,r;"options"in e&&(i=null===(t=e.options)||void 0===t?void 0:t.redirectTo,r=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:s,error:o}=await $E(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:i,xform:zE});if(o)throw o;if(!s){throw new Error("An error occurred on token verification.")}const a=s.session,l=s.user;return(null===a||void 0===a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),this._returnResult({data:{user:l,session:a},error:null})}catch(i){if(YA(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(e){var t,n,i,r,s;try{let o=null,a=null;"pkce"===this.flowType&&([o,a]=await ME(this.storage,this.storageKey));const l=await $E(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(i=null===e||void 0===e?void 0:e.options)||void 0===i?void 0:i.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:UE});return(null===(r=l.data)||void 0===r?void 0:r.url)&&bE()&&!(null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(o){if(await AE(this.storage,"".concat(this.storageKey,"-code-verifier")),YA(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new eE;const{error:i}=await $E(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(YA(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:n,type:i,options:r}=e,{error:s}=await $E(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}if("phone"in e){const{phone:n,type:i,options:r}=e,{data:s,error:o}=await $E(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null===s||void 0===s?void 0:s.message_id},error:o})}throw new iE("You must provide either an email or phone number and a type")}catch(t){if(YA(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(Kre){}})()),n}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(Kre){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await CE(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<VA;if(this._debug("#__loadSession()","session has".concat(n?"":" not"," expired"),"expires_at",e.expires_at),!n){if(this.userStorage){const t=await CE(this.userStorage,this.storageKey+"-user");(null===t||void 0===t?void 0:t.user)?e.user=t.user:e.user=IE()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const t={value:this.suppressGetSessionWarning};e.user=function(e,t){return new Proxy(e,{get:(e,n,i)=>{if("__isInsecureUserWarningProxy"===n)return!0;if("symbol"===typeof n){const t=n.toString();if("Symbol(Symbol.toPrimitive)"===t||"Symbol(Symbol.toStringTag)"===t||"Symbol(util.inspect.custom)"===t||"Symbol(nodejs.util.inspect.custom)"===t)return Reflect.get(e,n,i)}return t.value||"string"!==typeof n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(e,n,i)}})}(e.user,t),t.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{session:null},error:r}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await $E(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:VE}):await this._useSession(async e=>{var t,n,i;const{data:r,error:s}=e;if(s)throw s;return(null===(t=r.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await $E(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(i=null===(n=r.session)||void 0===n?void 0:n.access_token)&&void 0!==i?i:void 0,xform:VE}):{data:{user:null},error:new eE}})}catch(t){if(YA(t))return tE(t)&&(await this._removeSession(),await AE(this.storage,"".concat(this.storageKey,"-code-verifier"))),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async n=>{const{data:i,error:r}=n;if(r)throw r;if(!i.session)throw new eE;const s=i.session;let o=null,a=null;"pkce"===this.flowType&&null!=e.email&&([o,a]=await ME(this.storage,this.storageKey));const{data:l,error:c}=await $E(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:s.access_token,xform:VE});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),this._returnResult({data:{user:s.user},error:null})})}catch(n){if(await AE(this.storage,"".concat(this.storageKey,"-code-verifier")),YA(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new eE;const t=Date.now()/1e3;let n=t,i=!0,r=null;const{payload:s}=_E(e.access_token);if(s.exp&&(n=s.exp,i=n<=t),i){const{data:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!t)return{data:{user:null,session:null},error:null};r=t}else{const{data:i,error:s}=await this._getUser(e.access_token);if(s)return this._returnResult({data:{user:null,session:null},error:s});r={access_token:e.access_token,refresh_token:e.refresh_token,user:i.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return this._returnResult({data:{user:r.user,session:r},error:null})}catch(t){if(YA(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:i,error:r}=t;if(r)throw r;e=null!==(n=i.session)&&void 0!==n?n:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new eE;const{data:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{user:null,session:null},error:r}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(YA(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!bE())throw new rE("No browser detected.");if(e.error||e.error_description||e.error_code)throw new rE(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new sE("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new rE("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new sE("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const i=new URL(window.location.href);return i.searchParams.delete("code"),window.history.replaceState(window.history.state,"",i.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:r,refresh_token:s,expires_in:o,expires_at:a,token_type:l}=e;if(!r||!o||!s||!l)throw new rE("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(o);let h=c+u;a&&(h=parseInt(a));const d=h-c;1e3*d<=WA&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(d,"s, should have been closer to ").concat(u,"s"));const p=h-u;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,c);const{data:f,error:m}=await this._getUser(r);if(m)throw m;const g={provider_token:n,provider_refresh_token:i,access_token:r,expires_in:u,expires_at:h,refresh_token:s,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(n){if(YA(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return"function"===typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await CE(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var n;const{data:i,error:r}=t;if(r&&!tE(r))return this._returnResult({error:r});const s=null===(n=i.session)||void 0===n?void 0:n.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return YA(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status)&&!tE(t))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await AE(this.storage,"".concat(this.storageKey,"-code-verifier"))),this._returnResult({error:null})})}onAuthStateChange(e){const t=Symbol("auth-callback"),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,i;try{const{data:{session:i},error:r}=t;if(r)throw r;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(r){await(null===(i=this.stateChangeEmitters.get(e))||void 0===i?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=null;"pkce"===this.flowType&&([n,i]=await ME(this.storage,this.storageKey,!0));try{return await $E(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(await AE(this.storage,"".concat(this.storageKey,"-code-verifier")),YA(r))return this._returnResult({data:null,error:r});throw r}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(t){if(YA(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:i}=await this._useSession(async t=>{var n,i,r,s,o;const{data:a,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(i=e.options)||void 0===i?void 0:i.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:!0});return await $E(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(o=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==o?o:void 0})});if(i)throw i;return bE()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===n||void 0===n?void 0:n.url),this._returnResult({data:{provider:e.provider,url:null===n||void 0===n?void 0:n.url},error:null})}catch(n){if(YA(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:i,data:{session:r}}=t;if(i)throw i;const{options:s,provider:o,token:a,access_token:l,nonce:c}=e,u=await $E(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,jwt:null!==(n=null===r||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,body:{provider:o,id_token:a,access_token:l,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},xform:zE}),{data:h,error:d}=u;return d?this._returnResult({data:{user:null,session:null},error:d}):h&&h.session&&h.user?(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:d})):this._returnResult({data:{user:null,session:null},error:new nE})}catch(i){if(await AE(this.storage,"".concat(this.storageKey,"-code-verifier")),YA(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,i;const{data:r,error:s}=t;if(s)throw s;return await $E(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(i=null===(n=r.session)||void 0===n?void 0:n.access_token)&&void 0!==i?i:void 0})})}catch(t){if(YA(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const n=Date.now();return await function(e,t){const n=new Promise((n,i)=>{(async()=>{for(let r=0;r<1/0;r++)try{const i=await e(r);if(!t(r,null,i))return void n(i)}catch(Kre){if(!t(r,Kre))return void i(Kre)}})()});return n}(async n=>(n>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await $E(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:zE})),(e,t)=>{const i=200*Math.pow(2,e);return t&&lE(t)&&Date.now()+i-n<WA})}catch(n){if(this._debug(t,"error",n),YA(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(t,"end")}}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),bE()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await CE(this.storage,this.storageKey);if(r&&this.userStorage){let t=await CE(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:r.user},await SE(this.userStorage,this.storageKey+"-user",t)),r.user=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:IE()}else if(r&&!r.user&&!r.user){const e=await CE(this.storage,this.storageKey+"-user");e&&(null===e||void 0===e?void 0:e.user)?(r.user=e.user,await AE(this.storage,this.storageKey+"-user"),await SE(this.storage,this.storageKey,r)):r.user=IE()}if(this._debug(n,"session from storage",r),!this._isValidSession(r))return this._debug(n,"session is not valid"),void(null!==r&&await this._removeSession());const s=1e3*(null!==(t=r.expires_at)&&void 0!==t?t:1/0)-Date.now()<VA;if(this._debug(n,"session has".concat(s?"":" not"," expired with margin of ").concat(VA,"s")),s){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),lE(e)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(r.user&&!0===r.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(r.access_token);!t&&(null===e||void 0===e?void 0:e.user)?(r.user=e.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return this._debug(n,"error",r),void console.error(r)}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new eE;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(i,"begin");try{this.refreshingDeferred=new EE;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new eE;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const i={data:t.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(r){if(this._debug(i,"error",r),YA(r)){const e={data:null,error:r};return lE(r)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(r),r}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i="#_notifyAllSubscribers(".concat(e,")");this._debug(i,"begin",t,"broadcast = ".concat(n));try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],r=Array.from(this.stateChangeEmitters.values()).map(async n=>{try{await n.callback(e,t)}catch(Kre){i.push(Kre)}});if(await Promise.all(r),i.length>0){for(let e=0;e<i.length;e+=1)console.error(i[e]);throw i[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await AE(this.storage,"".concat(this.storageKey,"-code-verifier"));const t=Object.assign({},e),n=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!n&&t.user&&await SE(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const i=BE(e);await SE(this.storage,this.storageKey,i)}else{const e=BE(t);await SE(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await AE(this.storage,this.storageKey),await AE(this.storage,this.storageKey+"-code-verifier"),await AE(this.storage,this.storageKey+"-user"),this.userStorage&&await AE(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&bE()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(Kre){console.error("removing visibilitychange callback failed",Kre)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),WA);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"===typeof t&&"function"===typeof t.unref?t.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const i=Math.floor((1e3*n.expires_at-e)/WA);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(i," ticks, a tick lasts ").concat(WA,"ms, refresh threshold is ").concat(3," ticks")),i<=3&&await this._callRefreshToken(n.refresh_token)})}catch(Kre){console.error("Auto refresh tick failed with error. This is likely a transient error.",Kre)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(Kre){if(!(Kre.isAcquireTimeout||Kre instanceof KE))throw Kre;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!bE()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const i=["provider=".concat(encodeURIComponent(t))];if((null===n||void 0===n?void 0:n.redirectTo)&&i.push("redirect_to=".concat(encodeURIComponent(n.redirectTo))),(null===n||void 0===n?void 0:n.scopes)&&i.push("scopes=".concat(encodeURIComponent(n.scopes))),"pkce"===this.flowType){const[e,t]=await ME(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});i.push(n.toString())}if(null===n||void 0===n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);i.push(e.toString())}return(null===n||void 0===n?void 0:n.skipBrowserRedirect)&&i.push("skip_http_redirect=".concat(n.skipBrowserRedirect)),"".concat(e,"?").concat(i.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:i,error:r}=t;return r?this._returnResult({data:null,error:r}):await $E(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(n=null===i||void 0===i?void 0:i.session)||void 0===n?void 0:n.access_token})})}catch(t){if(YA(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,i;const{data:r,error:s}=t;if(s)return this._returnResult({data:null,error:s});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:a,error:l}=await $E(this.fetch,"POST","".concat(this.url,"/factors"),{body:o,headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===a.type&&(null===(i=null===a||void 0===a?void 0:a.totp)||void 0===i?void 0:i.qr_code)&&(a.totp.qr_code="data:image/svg+xml;utf-8,".concat(a.totp.qr_code)),this._returnResult({data:a,error:null}))})}catch(t){if(YA(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:r}=t;if(r)return this._returnResult({data:null,error:r});const s=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?u_(e.webauthn.credential_response):h_(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:a}=await $E(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:s,headers:this.headers,jwt:null===(n=null===i||void 0===i?void 0:i.session)||void 0===n?void 0:n.access_token});return a?this._returnResult({data:null,error:a}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:a}))})}catch(t){if(YA(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:r}=t;if(r)return this._returnResult({data:null,error:r});const s=await $E(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:e,headers:this.headers,jwt:null===(n=null===i||void 0===i?void 0:i.session)||void 0===n?void 0:n.access_token});if(s.error)return s;const{data:o}=s;if("webauthn"!==o.type)return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:l_(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:c_(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(YA(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const r of null!==(e=null===t||void 0===t?void 0:t.factors)&&void 0!==e?e:[])i.all.push(r),"verified"===r.status&&i[r.factor_type].push(r);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,n,i,r;if(e)try{const{payload:i}=_E(e);let r=null;i.aal&&(r=i.aal);let s=r;const{data:{user:o},error:a}=await this.getUser(e);if(a)return this._returnResult({data:null,error:a});(null!==(n=null===(t=null===o||void 0===o?void 0:o.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==n?n:[]).length>0&&(s="aal2");return{data:{currentLevel:r,nextLevel:s,currentAuthenticationMethods:i.amr||[]},error:null}}catch(u){if(YA(u))return this._returnResult({data:null,error:u});throw u}const{data:{session:s},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=_E(s.access_token);let l=null;a.aal&&(l=a.aal);let c=l;(null!==(r=null===(i=s.user.factors)||void 0===i?void 0:i.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(c="aal2");return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:a.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;return i?this._returnResult({data:null,error:i}):n?await $E(this.fetch,"GET","".concat(this.url,"/oauth/authorizations/").concat(e),{headers:this.headers,jwt:n.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new eE})})}catch(t){if(YA(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:i},error:r}=n;if(r)return this._returnResult({data:null,error:r});if(!i)return this._returnResult({data:null,error:new eE});const s=await $E(this.fetch,"POST","".concat(this.url,"/oauth/authorizations/").concat(e,"/consent"),{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return s.data&&s.data.redirect_url&&bE()&&!(null===t||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(YA(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:i},error:r}=n;if(r)return this._returnResult({data:null,error:r});if(!i)return this._returnResult({data:null,error:new eE});const s=await $E(this.fetch,"POST","".concat(this.url,"/oauth/authorizations/").concat(e,"/consent"),{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return s.data&&s.data.redirect_url&&bE()&&!(null===t||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(YA(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;return n?this._returnResult({data:null,error:n}):t?await $E(this.fetch,"GET","".concat(this.url,"/user/oauth/grants"),{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new eE})})}catch(e){if(YA(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;return i?this._returnResult({data:null,error:i}):n?(await $E(this.fetch,"DELETE","".concat(this.url,"/user/oauth/grants"),{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new eE})})}catch(t){if(YA(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;const n=Date.now();if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>n)return t;const{data:i,error:r}=await $E(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(r)throw r;return i.keys&&0!==i.keys.length?(this.jwks=i,this.jwks_cached_at=n,t=i.keys.find(t=>t.kid===e),t||null):null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let n=e;if(!n){const{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});n=e.session.access_token}const{header:i,payload:r,signature:s,raw:{header:o,payload:a}}=_E(n);(null===t||void 0===t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(r.exp);const l=i.alg&&!i.alg.startsWith("HS")&&i.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(i.kid,(null===t||void 0===t?void 0:t.keys)?{keys:t.keys}:null===t||void 0===t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(n);if(e)throw e;return{data:{claims:r,header:i,signature:s},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(i.alg),u=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,u,s,function(e){const t=[];return yE(e,e=>t.push(e)),new Uint8Array(t)}("".concat(o,".").concat(a))))throw new uE("Invalid JWT signature");return{data:{claims:r,header:i,signature:s},error:null}}catch(n){if(YA(n))return this._returnResult({data:null,error:n});throw n}}}b_.nextInstanceID={};const k_=b_;let x_="";x_="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const D_={headers:{"X-Client-Info":"supabase-js-".concat(x_,"/").concat("2.93.3")}},S_={schema:"public"},C_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},A_={};function E_(e){return(E_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function __(e){var t=function(e,t){if("object"!=E_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=E_(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==E_(t)?t:t+""}function T_(e,t,n){return(t=__(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function M_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P_(Object(n),!0).forEach(function(t){T_(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const F_=(e,t,n)=>{const i=(e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)})(n),r=Headers;return async(n,s)=>{var o;const a=null!==(o=await t())&&void 0!==o?o:e;let l=new r(null===s||void 0===s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization","Bearer ".concat(a)),i(n,M_(M_({},s),{},{headers:l}))}};var R_=class extends k_{constructor(e){super(e)}},N_=class{constructor(e,t,n){var i,r;this.supabaseUrl=e,this.supabaseKey=t;const s=function(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((n=t).endsWith("/")?n:n+"/")}catch(i){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var n}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const o="sb-".concat(s.hostname.split(".")[0],"-auth-token"),a=function(e,t){var n,i;const{db:r,auth:s,realtime:o,global:a}=e,{db:l,auth:c,realtime:u,global:h}=t,d={db:M_(M_({},l),r),auth:M_(M_({},c),s),realtime:M_(M_({},u),o),storage:{},global:M_(M_(M_({},h),a),{},{headers:M_(M_({},null!==(n=null===h||void 0===h?void 0:h.headers)&&void 0!==n?n:{}),null!==(i=null===a||void 0===a?void 0:a.headers)&&void 0!==i?i:{})}),accessToken:async()=>""};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!==n&&void 0!==n?n:{},{db:S_,realtime:A_,auth:M_(M_({},C_),{},{storageKey:o}),global:D_});var l;(this.storageKey=null!==(i=a.auth.storageKey)&&void 0!==i?i:"",this.headers=null!==(r=a.global.headers)&&void 0!==r?r:{},a.accessToken)?(this.accessToken=a.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(l=a.auth)&&void 0!==l?l:{},this.headers,a.global.fetch);this.fetch=F_(t,this._getAccessToken.bind(this),a.global.fetch),this.realtime=this._initRealtimeClient(M_({headers:this.headers,accessToken:this._getAccessToken.bind(this)},a.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new fC(new URL("rest/v1",s).href,{headers:this.headers,schema:a.db.schema,fetch:this.fetch}),this.storage=new $A(this.storageUrl.href,this.headers,this.fetch,null===n||void 0===n?void 0:n.storage),a.accessToken||this._listenForAuthEvents()}get functions(){return new aC(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{head:!1,get:!1,count:void 0};return this.rest.rpc(e,t,n)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t,n=this;if(n.accessToken)return await n.accessToken();const{data:i}=await n.auth.getSession();return null!==(e=null===(t=i.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:n.supabaseKey}_initSupabaseAuthClient(e,t,n){let{autoRefreshToken:i,persistSession:r,detectSessionInUrl:s,storage:o,userStorage:a,storageKey:l,flowType:c,lock:u,debug:h,throwOnError:d}=e;const p={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new R_({url:this.authUrl.href,headers:M_(M_({},p),t),storageKey:l,autoRefreshToken:i,persistSession:r,detectSessionInUrl:s,storage:o,userStorage:a,flowType:c,lock:u,debug:h,throwOnError:d,fetch:n,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new YC(this.realtimeUrl.href,M_(M_({},e),{},{params:M_(M_({},{apikey:this.supabaseKey}),null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=n,this.realtime.setAuth(n))}};(function(){if("undefined"!==typeof window)return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(void 0===t||null===t)return!1;const n=t.match(/^v(\d+)\./);return!!n&&parseInt(n[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const I_="https://juberlfvyedrbiixrkxt.supabase.co",B_="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp1YmVybGZ2eWVkcmJpaXhya3h0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwNTcyMTcsImV4cCI6MjA4NTYzMzIxN30.Xom-I23EyDMIq_skpdF4lmLNDEg8NZQ9498QfVI6siA";const Q_=((e,t,n)=>new N_(e,t,n))(I_,B_,{auth:{persistSession:!0,autoRefreshToken:!0},realtime:{params:{eventsPerSecond:100}},global:{headers:{"x-client-info":"flashy-collab"}}});function L_(e){try{return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}catch(t){return null}}class j_{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";this.doc=void 0,this.documentId=void 0,this.saveTimeout=null,this.isSaving=!1,this.saveCount=0,this.lastKnownVersion=0,this.pendingSave=!1,this.lastSaveAttempt=0,this.pollTimer=null,this.eventHandlers=new Map,this.retryCount=0,this.retryTimer=null,this.lastErrorMessage=null,this.doc=e,this.documentId="room-".concat(t)}on(e,t){this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),this.eventHandlers.get(e).add(t)}off(e,t){const n=this.eventHandlers.get(e);n&&n.delete(t)}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=this.eventHandlers.get(e);r&&r.forEach(e=>e(...n))}async loadFromDatabase(){try{KS.log("\ud83d\udcbe Loading document from Supabase...");const{data:e,error:t}=await Q_.rpc("get_document",{p_document_id:this.documentId});if(t)return KS.error("\u274c RPC error:",t),!1;if(!e||!Array.isArray(e)||0===e.length)return KS.log("\ud83d\udcc4 No saved document found, starting fresh"),!1;const n=e[0];if(n.yjs_state){const e=L_(n.yjs_state);return e?(lx(this.doc,e,this),n.version&&(this.lastKnownVersion=n.version),KS.log("\u2705 Loaded document from database"),KS.log("   Last updated:",n.updated_at,"| Version:",n.version||"unknown"),KS.log("   Content length:",this.doc.getText("content").length,"chars"),!0):(KS.error("\u274c Corrupted base64 state in database"),!1)}return!1}catch(e){return KS.error("\u274c Error loading document:",e),!1}}scheduleSave(){this.saveTimeout&&clearTimeout(this.saveTimeout),this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null),this.saveTimeout=setTimeout(()=>{this.saveNow()},2e3)}async saveNow(){if(this.isSaving)return void(this.pendingSave=!0);const e=Date.now();if(e-this.lastSaveAttempt<5e3)this.scheduleSave();else{this.lastSaveAttempt=e,this.isSaving=!0,this.emit("save-status",{status:"saving"});try{const e=this.doc.getXmlFragment("prosemirror"),n=this.doc.getText("content").toString();if(0===e.length&&0===n.length)return KS.warn("\ud83d\udee1\ufe0f BLOCKED: Refusing to save empty document \u2014 would overwrite server data"),void this.emit("save-status",{status:"saved"});const i=function(e){let t="";for(let n=0;n<e.length;n+=8192){const i=e.subarray(n,n+8192);t+=String.fromCharCode.apply(null,Array.from(i))}return btoa(t)}(ux(this.doc));KS.log("\ud83d\udcbe Saving document to Supabase...",n.length,"characters"),KS.log("   Content preview:",n.substring(0,100)+(n.length>100?"...":"")),this.saveCount++;const{data:r,error:s}=await Q_.rpc("upsert_document_rpc",{p_id:this.documentId,p_title:"Main Document",p_owner_id:sessionStorage.getItem("flashy_user_id")||null,p_yjs_state_base64:i,p_content_text:n,p_last_edited_by:sessionStorage.getItem("flashy_username")||"anonymous",p_min_version:this.lastKnownVersion,p_snapshot_every_n:5,p_snapshot_every_seconds:120});if(s)return KS.error("\u274c Save failed (RPC error):",s),void this.handleSaveError(s.message||"Save failed");if(r&&!1===r.success)return KS.warn("\u26a0\ufe0f Save rejected by server:",r.message),r.server_version&&(this.lastKnownVersion=r.server_version),void this.scheduleSave();var t;if(r)KS.log("\u2705 Document saved successfully"),KS.log("   Status:",r.message),r.server_version&&(this.lastKnownVersion=r.server_version),null!==(t=r.message)&&void 0!==t&&t.includes("snapshot")&&KS.log("\ud83d\udcf8 Version snapshot created!");this.retryCount=0,this.lastErrorMessage=null,this.emit("save-status",{status:"saved"})}catch(n){KS.error("\u274c Error saving document:",n),this.handleSaveError((null===n||void 0===n?void 0:n.message)||"Network error")}finally{this.isSaving=!1,this.pendingSave&&(this.pendingSave=!1,this.scheduleSave())}}}handleSaveError(e){if(this.lastErrorMessage=e,this.emit("save-status",{status:"error",message:e}),this.retryCount<5){const e=Math.min(2e3*Math.pow(2,this.retryCount),3e4);this.retryCount++,KS.log("\ud83d\udd04 Retrying save in ".concat(e,"ms (attempt ").concat(this.retryCount,"/").concat(5,")")),this.retryTimer=setTimeout(()=>{this.retryTimer=null,this.saveNow()},e)}else KS.error("\u274c Max save retries reached \u2014 giving up until next edit")}enableAutoSave(e){KS.log("\ud83d\udd04 Auto-save enabled (saves on LOCAL changes only)"),this.doc.on("update",(t,n)=>{null!=n&&(n===this||e&&e.includes(n))||this.scheduleSave()})}async getVersionHistory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{const{data:t,error:n}=await Q_.from("document_versions").select("version, created_at, last_edited_by").eq("document_id",this.documentId).order("created_at",{ascending:!1}).limit(e);if(n)throw n;return t||[]}catch(t){return KS.error("\u274c Error fetching version history:",t),[]}}async restoreVersion(e){try{KS.log("\ud83d\udd04 Restoring to version:",e);const{data:t,error:n}=await Q_.from("document_versions").select("yjs_state").eq("document_id",this.documentId).eq("version",e).single();if(n)throw n;if(t&&t.yjs_state){const e=L_(t.yjs_state);if(!e)return KS.error("\u274c Corrupted version snapshot"),!1;const n=t.yjs_state,i=new Yk;lx(i,e);const r=i.getText("content").toString();i.destroy();const{error:s}=await Q_.rpc("upsert_document_rpc",{p_id:this.documentId,p_title:"Main Document",p_owner_id:sessionStorage.getItem("flashy_user_id")||null,p_yjs_state_base64:n,p_content_text:r,p_last_edited_by:sessionStorage.getItem("flashy_username")||"anonymous",p_min_version:this.lastKnownVersion,p_snapshot_every_n:1,p_snapshot_every_seconds:0});if(s)throw s;return KS.log("\u2705 Restored version pushed to DB \u2014 reloading..."),window.location.reload(),!0}return!1}catch(t){return KS.error("\u274c Error restoring version:",t),!1}}startPolling(){}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null,KS.log("\ud83d\udce1 Database polling stopped (channel recovered)"))}destroy(){this.saveTimeout&&clearTimeout(this.saveTimeout),this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null),this.stopPolling()}}var $_=n(295);class z_{getYDoc(){return this.ydoc}constructor(){this.ydoc=null,this.provider=null,this.persistence=null,this.refCount=0,this.cleanupTimer=null,this.dbLoaded=!1,this.dbLoadPromise=null,this.userInfo=null,this.currentRoomId=null,this.connectPromise=null,this.colorChangeListeners=new Set,this.introAborted=!1,this.beforeUnloadRegistered=!1,this.beforeUnloadHandler=null}static getInstance(){return z_.instance||(z_.instance=new z_),z_.instance}getRoomId(){return this.currentRoomId}getProvider(){return this.provider}onProviderStatus(e){var t;const n=t=>{let{status:n}=t;return e(n)};return null===(t=this.provider)||void 0===t||t.on("status",n),()=>{var e;null===(e=this.provider)||void 0===e||e.off("status",n)}}async resetRoom(e,t){if(KS.log("\ud83d\udd04 Resetting room ".concat(e," (mode: ").concat(t,")")),this.provider&&(this.provider.destroy(),this.provider=null),this.persistence&&(this.persistence.destroy(),this.persistence=null),this.ydoc=null,this.dbLoaded=!1,this.dbLoadPromise=null,this.connectPromise=null,this.currentRoomId=null,"full"===t){const t="room-".concat(e);try{await Q_.from("documents").delete().eq("id",t),await Q_.from("document_versions").delete().eq("document_id",t),KS.log("\ud83d\uddd1\ufe0f Deleted document from Supabase")}catch(n){KS.error("Failed to delete from Supabase:",n)}}KS.log("\u2705 Room reset complete \u2014 reconnecting..."),this.refCount=0,await this.connect(e)}async connect(e){if(!e&&this.currentRoomId&&this.ydoc&&this.provider&&(e=this.currentRoomId),e||(e="default"),this.refCount++,KS.log("\ud83d\udcca CollaborationManager.connect(".concat(e,") - refCount:"),this.refCount),this.cleanupTimer&&(KS.log("\u23f8\ufe0f  Canceling scheduled cleanup (component remounted)"),clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.currentRoomId&&this.currentRoomId!==e&&this.ydoc&&(KS.log("\ud83d\udd04 Switching rooms: ".concat(this.currentRoomId," \u2192 ").concat(e)),await this.forceCleanup(),this.connectPromise=null),this.ydoc&&this.provider&&this.userInfo&&this.currentRoomId===e)return KS.log("\u267b\ufe0f  Reusing existing Yjs doc and provider"),this.provider.connected||(KS.log("\ud83d\udd0c Reconnecting provider..."),this.provider.connect()),{ydoc:this.ydoc,provider:this.provider,userInfo:this.userInfo};if(this.connectPromise)return KS.log("\u23f3 Connection in progress, waiting..."),this.connectPromise;this.connectPromise=this.doConnect(e);try{return await this.connectPromise}finally{}}async doConnect(e){if(!this.ydoc||!this.provider){KS.log("\ud83c\udd95 Creating new Yjs doc and provider for room: ".concat(e)),this.currentRoomId=e,this.ydoc=new Yk;const t="room-".concat(e);this.provider=new JS(this.ydoc,Q_,t),this.persistence=new j_(this.ydoc,e),this.dbLoadPromise=this.loadFromDatabase(),await this.dbLoadPromise,this.provider.connect(),await this.checkRoomCapacity(),this.userInfo=(0,$_.R)();const i=this.getUsedColors();if(i.includes(this.userInfo.color.toUpperCase())){const{USER_COLORS:e}=await Promise.resolve().then(n.bind(n,295)),t=e.find(e=>!i.includes(e.toUpperCase()));t&&(this.userInfo.color=t,sessionStorage.setItem("flashy_user_color",t),KS.log("\ud83c\udfa8 Assigned available color:",t))}KS.log("\ud83d\udc64 User info:",this.userInfo),this.provider.awareness.setLocalStateField("user",{name:this.userInfo.name,color:this.userInfo.color,colorLight:this.userInfo.color+"40"})}return{ydoc:this.ydoc,provider:this.provider,userInfo:this.userInfo}}async forceCleanup(){var e;if(KS.log("\ud83e\uddf9 Force cleanup for room switch"),this.persistence){try{await this.persistence.saveNow()}catch(t){}this.persistence.destroy()}null===(e=this.provider)||void 0===e||e.destroy(),this.provider=null,this.persistence=null,this.ydoc=null,this.dbLoaded=!1,this.dbLoadPromise=null,this.currentRoomId=null}async waitForDatabaseSync(){this.dbLoadPromise&&await this.dbLoadPromise}async checkRoomCapacity(){if(!this.provider)return;await new Promise(e=>setTimeout(e,500));const e=this.provider.awareness.getStates().size;if(KS.log("\ud83d\udc65 Current users in room: ".concat(e,"/").concat(4)),e>=4)throw KS.error("\u274c Room is full! Cannot join."),this.provider.disconnect(),this.provider.destroy(),this.provider=null,this.ydoc=null,new Error("ROOM_FULL")}async loadFromDatabase(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.dbLoaded||!this.persistence||!this.ydoc)return;const t=2e3;try{KS.log("\ud83d\udd04 Loading document from Supabase...");const n=await this.persistence.loadFromDatabase();this.dbLoaded=!0;const i=this.ydoc.getXmlFragment("prosemirror");if(n){const e=this.ydoc.getText("content").length;KS.log("\u2705 Document loaded from Supabase:",e,"chars")}else KS.log("\ud83d\udcdd No database content \u2014 starting fresh");const r=sessionStorage.getItem("flashy_new_room")===this.currentRoomId;if(!r&&0===i.length&&e<3)return KS.log("\u26a0\ufe0f Document is empty for existing room \u2014 retrying in ".concat(t,"ms (attempt ").concat(e+1,"/").concat(3,")")),this.dbLoaded=!1,await new Promise(e=>setTimeout(e,t)),this.loadFromDatabase(e+1);r&&0===i.length&&(sessionStorage.removeItem("flashy_new_room"),KS.log("\ud83d\udcdd New room created - starting intro typewriter"),this.introAborted=!1,this.typeIntro(i)),r||i.length>0?this.persistence.enableAutoSave([this.provider]):KS.warn("\u26a0\ufe0f Document is empty for existing room after retries \u2014 auto-save disabled to prevent data loss"),this.addBeforeUnloadHandler()}catch(n){if(KS.error("\u274c Failed to load from database:",n),e<3)return KS.log("\ud83d\udd04 Retrying load in ".concat(t,"ms (attempt ").concat(e+1,"/").concat(3,")")),await new Promise(e=>setTimeout(e,t)),this.loadFromDatabase(e+1);KS.warn("\u26a0\ufe0f Database load failed after retries \u2014 auto-save disabled to prevent data loss")}}addBeforeUnloadHandler(){this.beforeUnloadRegistered||(this.beforeUnloadRegistered=!0,this.beforeUnloadHandler=()=>{if(KS.log("\u26a0\ufe0f Browser closing - forcing final save and cleanup..."),this.provider&&this.provider.awareness.setLocalState(null),this.persistence&&this.ydoc)try{this.persistence.saveNow()}catch(e){}},window.addEventListener("beforeunload",this.beforeUnloadHandler))}getChatPrompt(){return this.ydoc?this.ydoc.getText("chat-prompt"):null}getChatMessages(){return this.ydoc?this.ydoc.getArray("chat-messages"):null}getChatAttachmentsMeta(){return this.ydoc?this.ydoc.getArray("chat-attachments-meta"):null}getSendRequest(){return this.ydoc?this.ydoc.getMap("chat-send-request"):null}getChatThreads(){return this.ydoc?this.ydoc.getMap("chat-threads"):null}getChatThreadMessages(e){return this.ydoc?this.ydoc.getArray("chat-messages-".concat(e)):null}getChatThreadPrompt(e){return this.ydoc?this.ydoc.getText("chat-prompt-".concat(e)):null}getThreadSendRequest(e){return this.ydoc?this.ydoc.getMap("chat-send-request-".concat(e)):null}getUserInfo(){return this.userInfo}setUserColor(e){this.userInfo&&this.provider&&(this.userInfo.color=e,sessionStorage.setItem("flashy_user_color",e),this.provider.awareness.setLocalStateField("user",{name:this.userInfo.name,color:e,colorLight:e+"40"}),this.colorChangeListeners.forEach(t=>t(e)),KS.log("\ud83c\udfa8 User color updated:",e))}onColorChange(e){return this.colorChangeListeners.add(e),()=>this.colorChangeListeners.delete(e)}getUsedColors(){if(!this.provider)return[];const e=[],t=this.provider.awareness.doc.clientID;return this.provider.awareness.getStates().forEach((n,i)=>{var r;i!==t&&null!==(r=n.user)&&void 0!==r&&r.color&&e.push(n.user.color.toUpperCase())}),e}async typeIntro(e){const t=e=>new Promise(t=>setTimeout(t,e)),n=async(e,n,i)=>{for(const r of n){if(this.introAborted)return;await t(i),e.insert(e.length,r)}},i=async(e,n,i)=>{const r=n.split(" ");for(let s=0;s<r.length;s++){if(this.introAborted)return;await t(i),e.insert(e.length,(s>0?" ":"")+r[s])}},r=async(t,i)=>{if(this.introAborted)return;const r=new dS("heading");r.setAttribute("level",t);const s=new mS;r.push([s]),e.push([r]),await n(s,i,55)},s=async t=>{if(this.introAborted)return;const n=new dS("paragraph"),r=new mS;n.push([r]),e.push([n]),await i(r,t,80)};try{if(await t(1500),this.introAborted)return;await r(1,"Welcome to Flashy"),await t(500),e.push([new dS("paragraph")]),await r(2,"What is Flashy?"),await t(400),await s("A collaborative study tool. Write your notes here and Flashy turns them into flashcards."),await t(600),e.push([new dS("paragraph")]),await r(2,"How do I make a flashcard?"),await t(400),await s("Use a ## heading for the front of the card. Write text below it for the back. Use # headings to group cards into sections."),await t(200),this.introAborted||(e.push([new dS("paragraph")]),e.push([new dS("paragraph")]))}catch(Kre){KS.warn("Intro typewriter interrupted:",Kre)}}disconnect(){this.introAborted=!0,this.refCount--,KS.log("\ud83d\udcca CollaborationManager.disconnect() - refCount:",this.refCount),this.refCount<=0&&(KS.log("\u23f3 Scheduling cleanup in 2s (in case of remount)..."),this.cleanupTimer=setTimeout(async()=>{if(this.refCount<=0){var e;if(KS.log("\ud83e\uddf9 Cleaning up provider (confirmed no active references)"),this.persistence){try{await this.persistence.saveNow()}catch(t){}this.persistence.destroy()}null===(e=this.provider)||void 0===e||e.destroy(),this.provider=null,this.persistence=null,this.ydoc=null,this.refCount=0,this.cleanupTimer=null,this.dbLoaded=!1}else KS.log("\u267b\ufe0f  Provider still in use, skipping cleanup")},2e3))}}z_.instance=null;const W_=z_.getInstance();function V_(e){const t=function(e){return/^#[0-9A-Fa-f]{3,8}$/.test(e)||/^[a-zA-Z]+$/.test(e)?e:"#999"}(e);return'\n    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z" fill="'.concat(t,'" stroke="').concat(t,'" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>\n  ').trim()}function U_(e){const t=V_(e);return"data:image/svg+xml;base64,"+btoa(t)}function X_(e,t){return n=>{let{state:i,dispatch:r}=n;if(i.readOnly)return!1;let s=e(t,i);return!!s&&(r(i.update(s)),!0)}}const q_=X_(J_,0),Z_=X_(K_,0),H_=X_((e,t)=>K_(e,t,function(e){let t=[];for(let n of e.selection.ranges){let i=e.doc.lineAt(n.from),r=n.to<=i.to?i:e.doc.lineAt(n.to);r.from>i.from&&r.from==n.to&&(r=n.to==i.to+1?i:e.doc.lineAt(n.to-1));let s=t.length-1;s>=0&&t[s].to>i.from?t[s].to=r.to:t.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:r.to})}return t}(t)),0);function Y_(e,t){let n=e.languageDataAt("commentTokens",t,1);return n.length?n[0]:{}}const G_=50;function K_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.selection.ranges,i=n.map(e=>Y_(t,e.from).block);if(!i.every(e=>e))return null;let r=n.map((e,n)=>function(e,t,n,i){let r,s,{open:o,close:a}=t,l=e.sliceDoc(n-G_,n),c=e.sliceDoc(i,i+G_),u=/\s*$/.exec(l)[0].length,h=/^\s*/.exec(c)[0].length,d=l.length-u;if(l.slice(d-o.length,d)==o&&c.slice(h,h+a.length)==a)return{open:{pos:n-u,margin:u&&1},close:{pos:i+h,margin:h&&1}};i-n<=2*G_?r=s=e.sliceDoc(n,i):(r=e.sliceDoc(n,n+G_),s=e.sliceDoc(i-G_,i));let p=/^\s*/.exec(r)[0].length,f=/\s*$/.exec(s)[0].length,m=s.length-f-a.length;return r.slice(p,p+o.length)==o&&s.slice(m,m+a.length)==a?{open:{pos:n+p+o.length,margin:/\s/.test(r.charAt(p+o.length))?1:0},close:{pos:i-f-a.length,margin:/\s/.test(s.charAt(m-1))?1:0}}:null}(t,i[n],e.from,e.to));if(2!=e&&!r.every(e=>e))return{changes:t.changes(n.map((e,t)=>r[t]?[]:[{from:e.from,insert:i[t].open+" "},{from:e.to,insert:" "+i[t].close}]))};if(1!=e&&r.some(e=>e)){let e=[];for(let t,n=0;n<r.length;n++)if(t=r[n]){let r=i[n],{open:s,close:o}=t;e.push({from:s.pos-r.open.length,to:s.pos+s.margin},{from:o.pos-o.margin,to:o.pos+r.close.length})}return{changes:e}}return null}function J_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.selection.ranges,i=[],r=-1;for(let{from:s,to:o}of n){let e=i.length,n=1e9,a=Y_(t,s).line;if(a){for(let e=s;e<=o;){let l=t.doc.lineAt(e);if(l.from>r&&(s==o||o>l.from)){r=l.from;let e=/^\s*/.exec(l.text)[0].length,t=e==l.length,s=l.text.slice(e,e+a.length)==a?e:-1;e<l.text.length&&e<n&&(n=e),i.push({line:l,comment:s,token:a,indent:e,empty:t,single:!1})}e=l.to+1}if(n<1e9)for(let t=e;t<i.length;t++)i[t].indent<i[t].line.text.length&&(i[t].indent=n);i.length==e+1&&(i[e].single=!0)}}if(2!=e&&i.some(e=>e.comment<0&&(!e.empty||e.single))){let e=[];for(let{line:t,token:r,indent:s,empty:o,single:a}of i)!a&&o||e.push({from:t.from+s,insert:r+" "});let n=t.changes(e);return{changes:n,selection:t.selection.map(n,1)}}if(1!=e&&i.some(e=>e.comment>=0)){let e=[];for(let{line:t,comment:n,token:r}of i)if(n>=0){let i=t.from+n,s=i+r.length;" "==t.text[s-t.from]&&s++,e.push({from:i,to:s})}return{changes:e}}return null}const eT=ii.define(),tT=ii.define(),nT=Tn.define(),iT=Tn.define({combine:e=>Oi(e,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,i)=>e(n,i)||t(n,i)})}),rT=Bn.define({create:()=>bT.empty,update(e,t){let n=t.state.facet(iT),i=t.annotation(eT);if(i){let r=hT.fromTransaction(t,i.selection),s=i.side,o=0==s?e.undone:e.done;return o=r?dT(o,o.length,n.minDepth,r):gT(o,t.startState.selection),new bT(0==s?i.rest:o,0==s?o:i.rest)}let r=t.annotation(tT);if("full"!=r&&"before"!=r||(e=e.isolate()),!1===t.annotation(ai.addToHistory))return t.changes.empty?e:e.addMapping(t.changes.desc);let s=hT.fromTransaction(t),o=t.annotation(ai.time),a=t.annotation(ai.userEvent);return s?e=e.addChanges(s,o,a,n,t):t.selection&&(e=e.addSelection(t.startState.selection,o,a,n.newGroupDelay)),"full"!=r&&"after"!=r||(e=e.isolate()),e},toJSON:e=>({done:e.done.map(e=>e.toJSON()),undone:e.undone.map(e=>e.toJSON())}),fromJSON:e=>new bT(e.done.map(hT.fromJSON),e.undone.map(hT.fromJSON))});function sT(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rT,iT.of(e),sl.domEventHandlers({beforeinput(e,t){let n="historyUndo"==e.inputType?aT:"historyRedo"==e.inputType?lT:null;return!!n&&(e.preventDefault(),n(t))}})]}function oT(e,t){return function(n){let{state:i,dispatch:r}=n;if(!t&&i.readOnly)return!1;let s=i.field(rT,!1);if(!s)return!1;let o=s.pop(e,i,t);return!!o&&(r(o),!0)}}const aT=oT(0,!1),lT=oT(1,!1),cT=oT(0,!0),uT=oT(1,!0);class hT{constructor(e,t,n,i,r){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=i,this.selectionsAfter=r}setSelAfter(e){return new hT(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:null===(e=this.changes)||void 0===e?void 0:e.toJSON(),mapped:null===(t=this.mapped)||void 0===t?void 0:t.toJSON(),startSelection:null===(n=this.startSelection)||void 0===n?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(e=>e.toJSON())}}static fromJSON(e){return new hT(e.changes&&On.fromJSON(e.changes),[],e.mapped&&yn.fromJSON(e.mapped),e.startSelection&&An.fromJSON(e.startSelection),e.selectionsAfter.map(An.fromJSON))}static fromTransaction(e,t){let n=fT;for(let i of e.startState.facet(nT)){let t=i(e);t.length&&(n=n.concat(t))}return!n.length&&e.changes.empty?null:new hT(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,fT)}static selection(e){return new hT(void 0,fT,void 0,void 0,e)}}function dT(e,t,n,i){let r=t+1>n+20?t-n-1:0,s=e.slice(r,t);return s.push(i),s}function pT(e,t){return e.length?t.length?e.concat(t):e:t}const fT=[],mT=200;function gT(e,t){if(e.length){let n=e[e.length-1],i=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-mT));return i.length&&i[i.length-1].eq(t)?e:(i.push(t),dT(e,e.length-1,1e9,n.setSelAfter(i)))}return[hT.selection([t])]}function vT(e){let t=e[e.length-1],n=e.slice();return n[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),n}function yT(e,t){if(!e.length)return e;let n=e.length,i=fT;for(;n;){let r=OT(e[n-1],t,i);if(r.changes&&!r.changes.empty||r.effects.length){let t=e.slice(0,n);return t[n-1]=r,t}t=r.mapped,n--,i=r.selectionsAfter}return i.length?[hT.selection(i)]:fT}function OT(e,t,n){let i=pT(e.selectionsAfter.length?e.selectionsAfter.map(e=>e.map(t)):fT,n);if(!e.changes)return hT.selection(i);let r=e.changes.map(t),s=t.mapDesc(e.changes,!0),o=e.mapped?e.mapped.composeDesc(s):s;return new hT(r,oi.mapEffects(e.effects,t),o,e.startSelection.map(s),i)}const wT=/^(input\.type|delete)($|\.)/;class bT{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=i}isolate(){return this.prevTime?new bT(this.done,this.undone):this}addChanges(e,t,n,i,r){let s=this.done,o=s[s.length-1];return s=o&&o.changes&&!o.changes.empty&&e.changes&&(!n||wT.test(n))&&(!o.selectionsAfter.length&&t-this.prevTime<i.newGroupDelay&&i.joinToEvent(r,function(e,t){let n=[],i=!1;return e.iterChangedRanges((e,t)=>n.push(e,t)),t.iterChangedRanges((e,t,r,s)=>{for(let o=0;o<n.length;){let e=n[o++],t=n[o++];s>=e&&r<=t&&(i=!0)}}),i}(o.changes,e.changes))||"input.type.compose"==n)?dT(s,s.length-1,i.minDepth,new hT(e.changes.compose(o.changes),pT(oi.mapEffects(e.effects,o.changes),o.effects),o.mapped,o.startSelection,fT)):dT(s,s.length,i.minDepth,e),new bT(s,fT,t,n)}addSelection(e,t,n,i){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:fT;return r.length>0&&t-this.prevTime<i&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&(s=r[r.length-1],o=e,s.ranges.length==o.ranges.length&&0===s.ranges.filter((e,t)=>e.empty!=o.ranges[t].empty).length)?this:new bT(gT(this.done,e),this.undone,t,n);var s,o}addMapping(e){return new bT(yT(this.done,e),yT(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let i=0==e?this.done:this.undone;if(0==i.length)return null;let r=i[i.length-1],s=r.selectionsAfter[0]||t.selection;if(n&&r.selectionsAfter.length)return t.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:eT.of({side:e,rest:vT(i),selection:s}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let n=1==i.length?fT:i.slice(0,i.length-1);return r.mapped&&(n=yT(n,r.mapped)),t.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:eT.of({side:e,rest:n,selection:s}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}return null}}bT.empty=new bT(fT,fT);const kT=[{key:"Mod-z",run:aT,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:lT,preventDefault:!0},{linux:"Ctrl-Shift-z",run:lT,preventDefault:!0},{key:"Mod-u",run:cT,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:uT,preventDefault:!0}];function xT(e,t){return An.create(e.ranges.map(t),e.mainIndex)}function DT(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function ST(e,t){let{state:n,dispatch:i}=e,r=xT(n.selection,t);return!r.eq(n.selection,!0)&&(i(DT(n,r)),!0)}function CT(e,t){return An.cursor(t?e.to:e.from)}function AT(e,t){return ST(e,n=>n.empty?e.moveByChar(n,t):CT(n,t))}function ET(e){return e.textDirectionAt(e.state.selection.main.head)==Xr.LTR}const _T=e=>AT(e,!ET(e)),TT=e=>AT(e,ET(e));function PT(e,t){return ST(e,n=>n.empty?e.moveByGroup(n,t):CT(n,t))}"undefined"!=typeof Intl&&Intl.Segmenter;function MT(e,t,n){if(t.type.prop(n))return!0;let i=t.to-t.from;return i&&(i>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}function FT(e,t,n){let i,r,s=ch(e).resolveInner(t.head),o=n?jc.closedBy:jc.openedBy;for(let a=t.head;;){let t=n?s.childAfter(a):s.childBefore(a);if(!t)break;MT(e,t,o)?s=t:a=n?t.to:t.from}return r=s.type.prop(o)&&(i=n?Ed(e,s.from,1):Ed(e,s.to,-1))&&i.matched?n?i.end.to:i.end.from:n?s.to:s.from,An.cursor(r,n?-1:1)}function RT(e,t){return ST(e,n=>{if(!n.empty)return CT(n,t);let i=e.moveVertically(n,t);return i.head!=n.head?i:e.moveToLineBoundary(n,t)})}const NT=e=>RT(e,!1),IT=e=>RT(e,!0);function BT(e){let t,n=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,i=0,r=0;if(n){for(let t of e.state.facet(sl.scrollMargins)){let n=t(e);(null===n||void 0===n?void 0:n.top)&&(i=Math.max(null===n||void 0===n?void 0:n.top,i)),(null===n||void 0===n?void 0:n.bottom)&&(r=Math.max(null===n||void 0===n?void 0:n.bottom,r))}t=e.scrollDOM.clientHeight-i-r}else t=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:i,marginBottom:r,selfScroll:n,height:Math.max(e.defaultLineHeight,t-5)}}function QT(e,t){let n,i=BT(e),{state:r}=e,s=xT(r.selection,n=>n.empty?e.moveVertically(n,t,i.height):CT(n,t));if(s.eq(r.selection))return!1;if(i.selfScroll){let t=e.coordsAtPos(r.selection.main.head),o=e.scrollDOM.getBoundingClientRect(),a=o.top+i.marginTop,l=o.bottom-i.marginBottom;t&&t.top>a&&t.bottom<l&&(n=sl.scrollIntoView(s.main.head,{y:"start",yMargin:t.top-a}))}return e.dispatch(DT(r,s),{effects:n}),!0}const LT=e=>QT(e,!1),jT=e=>QT(e,!0);function $T(e,t,n){let i=e.lineBlockAt(t.head),r=e.moveToLineBoundary(t,n);if(r.head==t.head&&r.head!=(n?i.to:i.from)&&(r=e.moveToLineBoundary(t,n,!1)),!n&&r.head==i.from&&i.length){let n=/^\s*/.exec(e.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;n&&t.head!=i.from+n&&(r=An.cursor(i.from+n))}return r}function zT(e,t,n){let i=!1,r=xT(e.selection,t=>{let r=Ed(e,t.head,-1)||Ed(e,t.head,1)||t.head>0&&Ed(e,t.head-1,1)||t.head<e.doc.length&&Ed(e,t.head+1,-1);if(!r||!r.end)return t;i=!0;let s=r.start.from==t.head?r.end.to:r.end.from;return n?An.range(t.anchor,s):An.cursor(s)});return!!i&&(t(DT(e,r)),!0)}function WT(e,t){let n=xT(e.state.selection,e=>{let n=t(e);return An.range(e.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return!n.eq(e.state.selection)&&(e.dispatch(DT(e.state,n)),!0)}function VT(e,t){return WT(e,n=>e.moveByChar(n,t))}const UT=e=>VT(e,!ET(e)),XT=e=>VT(e,ET(e));function qT(e,t){return WT(e,n=>e.moveByGroup(n,t))}function ZT(e,t){return WT(e,n=>e.moveVertically(n,t))}const HT=e=>ZT(e,!1),YT=e=>ZT(e,!0);function GT(e,t){return WT(e,n=>e.moveVertically(n,t,BT(e).height))}const KT=e=>GT(e,!1),JT=e=>GT(e,!0),eP=e=>{let{state:t,dispatch:n}=e;return n(DT(t,{anchor:0})),!0},tP=e=>{let{state:t,dispatch:n}=e;return n(DT(t,{anchor:t.doc.length})),!0},nP=e=>{let{state:t,dispatch:n}=e;return n(DT(t,{anchor:t.selection.main.anchor,head:0})),!0},iP=e=>{let{state:t,dispatch:n}=e;return n(DT(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0};function rP(e,t){let{state:n}=e,i=n.selection,r=n.selection.ranges.slice();for(let s of n.selection.ranges){let i=n.doc.lineAt(s.head);if(t?i.to<e.state.doc.length:i.from>0)for(let n=s;;){let s=e.moveVertically(n,t);if(s.head<i.from||s.head>i.to){r.some(e=>e.head==s.head)||r.push(s);break}if(s.head==n.head)break;n=s}}return r.length!=i.ranges.length&&(e.dispatch(DT(n,An.create(r,r.length-1))),!0)}function sP(e,t){if(e.state.readOnly)return!1;let n="delete.selection",{state:i}=e,r=i.changeByRange(i=>{let{from:r,to:s}=i;if(r==s){let o=t(i);o<r?(n="delete.backward",o=oP(e,o,!1)):o>r&&(n="delete.forward",o=oP(e,o,!0)),r=Math.min(r,o),s=Math.max(s,o)}else r=oP(e,r,!1),s=oP(e,s,!0);return r==s?{range:i}:{changes:{from:r,to:s},range:An.cursor(r,r<i.head?-1:1)}});return!r.changes.empty&&(e.dispatch(i.update(r,{scrollIntoView:!0,userEvent:n,effects:"delete.selection"==n?sl.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function oP(e,t,n){if(e instanceof sl)for(let i of e.state.facet(sl.atomicRanges).map(t=>t(e)))i.between(t,t,(e,i)=>{e<t&&i>t&&(t=n?i:e)});return t}const aP=(e,t,n)=>sP(e,i=>{let r,s,o=i.from,{state:a}=e,l=a.doc.lineAt(o);if(n&&!t&&o>l.from&&o<l.from+200&&!/[^ \t]/.test(r=l.text.slice(0,o-l.from))){if("\t"==r[r.length-1])return o-1;let e=Bi(r,a.tabSize)%xh(a)||xh(a);for(let t=0;t<e&&" "==r[r.length-1-t];t++)o--;s=o}else s=dn(l.text,o-l.from,t,t)+l.from,s==o&&l.number!=(t?a.doc.lines:1)?s+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(l.text.slice(s-l.from,o-l.from))&&(s=dn(l.text,s-l.from,!1,!1)+l.from);return s}),lP=e=>aP(e,!1,!0),cP=e=>aP(e,!0,!1),uP=(e,t)=>sP(e,n=>{let i=n.head,{state:r}=e,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let e=null;;){if(i==(t?s.to:s.from)){i==n.head&&s.number!=(t?r.doc.lines:1)&&(i+=t?1:-1);break}let a=dn(s.text,i-s.from,t)+s.from,l=s.text.slice(Math.min(i,a)-s.from,Math.max(i,a)-s.from),c=o(l);if(null!=e&&c!=e)break;" "==l&&i==n.head||(e=c),i=a}return i}),hP=e=>uP(e,!1);function dP(e){let t=[],n=-1;for(let i of e.selection.ranges){let r=e.doc.lineAt(i.from),s=e.doc.lineAt(i.to);if(i.empty||i.to!=s.from||(s=e.doc.lineAt(i.to-1)),n>=r.number){let e=t[t.length-1];e.to=s.to,e.ranges.push(i)}else t.push({from:r.from,to:s.to,ranges:[i]});n=s.number+1}return t}function pP(e,t,n){if(e.readOnly)return!1;let i=[],r=[];for(let s of dP(e)){if(n?s.to==e.doc.length:0==s.from)continue;let t=e.doc.lineAt(n?s.to+1:s.from-1),o=t.length+1;if(n){i.push({from:s.to,to:t.to},{from:s.from,insert:t.text+e.lineBreak});for(let t of s.ranges)r.push(An.range(Math.min(e.doc.length,t.anchor+o),Math.min(e.doc.length,t.head+o)))}else{i.push({from:t.from,to:s.from},{from:s.to,insert:e.lineBreak+t.text});for(let e of s.ranges)r.push(An.range(e.anchor-o,e.head-o))}}return!!i.length&&(t(e.update({changes:i,scrollIntoView:!0,selection:An.create(r,e.selection.mainIndex),userEvent:"move.line"})),!0)}function fP(e,t,n){if(e.readOnly)return!1;let i=[];for(let s of dP(e))n?i.push({from:s.from,insert:e.doc.slice(s.from,s.to)+e.lineBreak}):i.push({from:s.to,insert:e.lineBreak+e.doc.slice(s.from,s.to)});let r=e.changes(i);return t(e.update({changes:r,selection:e.selection.map(r,n?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const mP=vP(!1),gP=vP(!0);function vP(e){return t=>{let{state:n,dispatch:i}=t;if(n.readOnly)return!1;let r=n.changeByRange(t=>{let{from:i,to:r}=t,s=n.doc.lineAt(i),o=!e&&i==r&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let n,i=ch(e).resolveInner(t),r=i.childBefore(t),s=i.childAfter(t);return r&&s&&r.to<=t&&s.from>=t&&(n=r.type.prop(jc.closedBy))&&n.indexOf(s.name)>-1&&e.doc.lineAt(r.to).from==e.doc.lineAt(s.from).from&&!/\S/.test(e.sliceDoc(r.to,s.from))?{from:r.to,to:s.from}:null}(n,i);e&&(i=r=(r<=s.to?s:n.doc.lineAt(r)).to);let a=new Ch(n,{simulateBreak:i,simulateDoubleBreak:!!o}),l=Sh(a,i);for(null==l&&(l=Bi(/^\s*/.exec(n.doc.lineAt(i).text)[0],n.tabSize));r<s.to&&/\s/.test(s.text[r-s.from]);)r++;o?({from:i,to:r}=o):i>s.from&&i<s.from+100&&!/\S/.test(s.text.slice(0,i))&&(i=s.from);let c=["",Dh(n,l)];return o&&c.push(Dh(n,a.lineIndent(s.from,-1))),{changes:{from:i,to:r,insert:tn.of(c)},range:An.cursor(i+1+c[1].length)}});return i(n.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function yP(e,t){let n=-1;return e.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let s=e.doc.lineAt(o);s.number>n&&(i.empty||i.to>s.from)&&(t(s,r,i),n=s.number),o=s.to+1}let s=e.changes(r);return{changes:r,range:An.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const OP=e=>{let{state:t,dispatch:n}=e;return!t.readOnly&&(n(t.update(yP(t,(e,n)=>{n.push({from:e.from,insert:t.facet(kh)})}),{userEvent:"input.indent"})),!0)},wP=e=>{let{state:t,dispatch:n}=e;return!t.readOnly&&(n(t.update(yP(t,(e,n)=>{let i=/^\s*/.exec(e.text)[0];if(!i)return;let r=Bi(i,t.tabSize),s=0,o=Dh(t,Math.max(0,r-xh(t)));for(;s<i.length&&s<o.length&&i.charCodeAt(s)==o.charCodeAt(s);)s++;n.push({from:e.from+s,to:e.from+i.length,insert:o.slice(s)})}),{userEvent:"delete.dedent"})),!0)},bP=[{key:"Ctrl-b",run:_T,shift:UT,preventDefault:!0},{key:"Ctrl-f",run:TT,shift:XT},{key:"Ctrl-p",run:NT,shift:HT},{key:"Ctrl-n",run:IT,shift:YT},{key:"Ctrl-a",run:e=>ST(e,t=>An.cursor(e.lineBlockAt(t.head).from,1)),shift:e=>WT(e,t=>An.cursor(e.lineBlockAt(t.head).from))},{key:"Ctrl-e",run:e=>ST(e,t=>An.cursor(e.lineBlockAt(t.head).to,-1)),shift:e=>WT(e,t=>An.cursor(e.lineBlockAt(t.head).to))},{key:"Ctrl-d",run:cP},{key:"Ctrl-h",run:lP},{key:"Ctrl-k",run:e=>sP(e,t=>{let n=e.lineBlockAt(t.head).to;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)})},{key:"Ctrl-Alt-h",run:hP},{key:"Ctrl-o",run:e=>{let{state:t,dispatch:n}=e;if(t.readOnly)return!1;let i=t.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:tn.of(["",""])},range:An.cursor(e.from)}));return n(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:e=>{let{state:t,dispatch:n}=e;if(t.readOnly)return!1;let i=t.changeByRange(e=>{if(!e.empty||0==e.from||e.from==t.doc.length)return{range:e};let n=e.from,i=t.doc.lineAt(n),r=n==i.from?n-1:dn(i.text,n-i.from,!1)+i.from,s=n==i.to?n+1:dn(i.text,n-i.from,!0)+i.from;return{changes:{from:r,to:s,insert:t.doc.slice(n,s).append(t.doc.slice(r,n))},range:An.cursor(s)}});return!i.changes.empty&&(n(t.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:jT}],kP=[{key:"ArrowLeft",run:_T,shift:UT,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:e=>PT(e,!ET(e)),shift:e=>qT(e,!ET(e)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:e=>ST(e,t=>$T(e,t,!ET(e))),shift:e=>WT(e,t=>$T(e,t,!ET(e))),preventDefault:!0},{key:"ArrowRight",run:TT,shift:XT,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:e=>PT(e,ET(e)),shift:e=>qT(e,ET(e)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:e=>ST(e,t=>$T(e,t,ET(e))),shift:e=>WT(e,t=>$T(e,t,ET(e))),preventDefault:!0},{key:"ArrowUp",run:NT,shift:HT,preventDefault:!0},{mac:"Cmd-ArrowUp",run:eP,shift:nP},{mac:"Ctrl-ArrowUp",run:LT,shift:KT},{key:"ArrowDown",run:IT,shift:YT,preventDefault:!0},{mac:"Cmd-ArrowDown",run:tP,shift:iP},{mac:"Ctrl-ArrowDown",run:jT,shift:JT},{key:"PageUp",run:LT,shift:KT},{key:"PageDown",run:jT,shift:JT},{key:"Home",run:e=>ST(e,t=>$T(e,t,!1)),shift:e=>WT(e,t=>$T(e,t,!1)),preventDefault:!0},{key:"Mod-Home",run:eP,shift:nP},{key:"End",run:e=>ST(e,t=>$T(e,t,!0)),shift:e=>WT(e,t=>$T(e,t,!0)),preventDefault:!0},{key:"Mod-End",run:tP,shift:iP},{key:"Enter",run:mP,shift:mP},{key:"Mod-a",run:e=>{let{state:t,dispatch:n}=e;return n(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0}},{key:"Backspace",run:lP,shift:lP,preventDefault:!0},{key:"Delete",run:cP,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:hP,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:e=>uP(e,!0),preventDefault:!0},{mac:"Mod-Backspace",run:e=>sP(e,t=>{let n=e.moveToLineBoundary(t,!1).head;return t.head>n?n:Math.max(0,t.head-1)}),preventDefault:!0},{mac:"Mod-Delete",run:e=>sP(e,t=>{let n=e.moveToLineBoundary(t,!0).head;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)}),preventDefault:!0}].concat(bP.map(e=>({mac:e.key,run:e.run,shift:e.shift}))),xP=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e=>ST(e,t=>FT(e.state,t,!ET(e))),shift:e=>WT(e,t=>FT(e.state,t,!ET(e)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e=>ST(e,t=>FT(e.state,t,ET(e))),shift:e=>WT(e,t=>FT(e.state,t,ET(e)))},{key:"Alt-ArrowUp",run:e=>{let{state:t,dispatch:n}=e;return pP(t,n,!1)}},{key:"Shift-Alt-ArrowUp",run:e=>{let{state:t,dispatch:n}=e;return fP(t,n,!1)}},{key:"Alt-ArrowDown",run:e=>{let{state:t,dispatch:n}=e;return pP(t,n,!0)}},{key:"Shift-Alt-ArrowDown",run:e=>{let{state:t,dispatch:n}=e;return fP(t,n,!0)}},{key:"Mod-Alt-ArrowUp",run:e=>rP(e,!1)},{key:"Mod-Alt-ArrowDown",run:e=>rP(e,!0)},{key:"Escape",run:e=>{let{state:t,dispatch:n}=e,i=t.selection,r=null;return i.ranges.length>1?r=An.create([i.main]):i.main.empty||(r=An.create([An.cursor(i.main.head)])),!!r&&(n(DT(t,r)),!0)}},{key:"Mod-Enter",run:gP},{key:"Alt-l",mac:"Ctrl-l",run:e=>{let{state:t,dispatch:n}=e,i=dP(t).map(e=>{let{from:n,to:i}=e;return An.range(n,Math.min(i+1,t.doc.length))});return n(t.update({selection:An.create(i),userEvent:"select"})),!0}},{key:"Mod-i",run:e=>{let{state:t,dispatch:n}=e,i=xT(t.selection,e=>{let n=ch(t),i=n.resolveStack(e.from,1);if(e.empty){let t=n.resolveStack(e.from,-1);t.node.from>=i.node.from&&t.node.to<=i.node.to&&(i=t)}for(let t=i;t;t=t.next){let{node:n}=t;if((n.from<e.from&&n.to>=e.to||n.to>e.to&&n.from<=e.from)&&t.next)return An.range(n.to,n.from)}return e});return!i.eq(t.selection)&&(n(DT(t,i)),!0)},preventDefault:!0},{key:"Mod-[",run:wP},{key:"Mod-]",run:OP},{key:"Mod-Alt-\\",run:e=>{let{state:t,dispatch:n}=e;if(t.readOnly)return!1;let i=Object.create(null),r=new Ch(t,{overrideIndentation:e=>{let t=i[e];return null==t?-1:t}}),s=yP(t,(e,n,s)=>{let o=Sh(r,e.from);if(null==o)return;/\S/.test(e.text)||(o=0);let a=/^\s*/.exec(e.text)[0],l=Dh(t,o);(a!=l||s.from<e.from+a.length)&&(i[e.from]=o,n.push({from:e.from,to:e.from+a.length,insert:l}))});return s.changes.empty||n(t.update(s,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:e=>{if(e.state.readOnly)return!1;let{state:t}=e,n=t.changes(dP(t).map(e=>{let{from:n,to:i}=e;return n>0?n--:i<t.doc.length&&i++,{from:n,to:i}})),i=xT(t.selection,t=>{let n;if(e.lineWrapping){let i=e.lineBlockAt(t.head),r=e.coordsAtPos(t.head,t.assoc||1);r&&(n=i.bottom+e.documentTop-r.bottom+e.defaultLineHeight/2)}return e.moveVertically(t,!0,n)}).map(n);return e.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:e=>{let{state:t,dispatch:n}=e;return zT(t,n,!1)}},{key:"Mod-/",run:e=>{let{state:t}=e,n=t.doc.lineAt(t.selection.main.from),i=Y_(e.state,n.from);return i.line?q_(e):!!i.block&&H_(e)}},{key:"Alt-A",run:Z_},{key:"Ctrl-m",mac:"Shift-Alt-m",run:e=>(e.setTabFocusMode(),!0)}].concat(kP),DP={key:"Tab",run:OP,shift:wP},SP="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e;class CP{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,i),this.bufferStart=n,this.normalize=r?e=>r(SP(e)):SP,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return pn(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=fn(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=mn(e);let i=this.normalize(t);if(i.length)for(let r=0,s=n;;r++){let e=i.charCodeAt(r),o=this.match(e,s,this.bufferPos+this.bufferStart);if(r==i.length-1){if(o)return this.value=o,this;break}s==n&&r<t.length&&t.charCodeAt(r)==e&&s++}}}match(e,t,n){let i=null;for(let r=0;r<this.matches.length;r+=2){let t=this.matches[r],s=!1;this.query.charCodeAt(t)==e&&(t==this.query.length-1?i={from:this.matches[r+1],to:n}:(this.matches[r]++,s=!0)),s||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?i={from:t,to:n}:this.matches.push(1,t)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}"undefined"!=typeof Symbol&&(CP.prototype[Symbol.iterator]=function(){return this});const AP={from:-1,to:-1,match:/.*/.exec("")},EP="gm"+(null==/x/.unicode?"":"u");class _P{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length;if(this.text=e,this.to=r,this.curLine="",this.done=!1,this.value=AP,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new MP(e,t,n,i,r);this.re=new RegExp(t,EP+((null===n||void 0===n?void 0:n.ignoreCase)?"i":"")),this.test=null===n||void 0===n?void 0:n.test,this.iter=e.iter();let s=e.lineAt(i);this.curLineStart=s.from,this.matchPos=FP(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,i=n+t[0].length;if(this.matchPos=FP(this.text,i+(n==i?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<i||n>this.value.to)&&(!this.test||this.test(n,i,t)))return this.value={from:n,to:i,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}}const TP=new WeakMap;class PP{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let i=TP.get(e);if(!i||i.from>=n||i.to<=t){let i=new PP(t,e.sliceString(t,n));return TP.set(e,i),i}if(i.from==t&&i.to==n)return i;let{text:r,from:s}=i;return s>t&&(r=e.sliceString(t,s)+r,s=t),i.to<n&&(r+=e.sliceString(i.to,n)),TP.set(e,new PP(s,r)),new PP(t,r.slice(t-s,n-s))}}class MP{constructor(e,t,n,i,r){this.text=e,this.to=r,this.done=!1,this.value=AP,this.matchPos=FP(e,i),this.re=new RegExp(t,EP+((null===n||void 0===n?void 0:n.ignoreCase)?"i":"")),this.test=null===n||void 0===n?void 0:n.test,this.flat=PP.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let e=this.flat.from+t.index,n=e+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,n,t)))return this.value={from:e,to:n,match:t},this.matchPos=FP(this.text,n+(e==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=PP.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function FP(e,t){if(t>=e.length)return t;let n,i=e.lineAt(t);for(;t<i.to&&(n=i.text.charCodeAt(t-i.from))>=56320&&n<57344;)t++;return t}"undefined"!=typeof Symbol&&(_P.prototype[Symbol.iterator]=MP.prototype[Symbol.iterator]=function(){return this});const RP={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},NP=Tn.define({combine:e=>Oi(e,RP,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})});function IP(e){let t=[$P,jP];return e&&t.push(NP.of(e)),t}const BP=vr.mark({class:"cm-selectionMatch"}),QP=vr.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function LP(e,t,n,i){return(0==n||e(t.sliceDoc(n-1,n))!=fi.Word)&&(i==t.doc.length||e(t.sliceDoc(i,i+1))!=fi.Word)}const jP=Ms.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=e.state.facet(NP),{state:n}=e,i=n.selection;if(i.ranges.length>1)return vr.none;let r,s=i.main,o=null;if(s.empty){if(!t.highlightWordAroundCursor)return vr.none;let e=n.wordAt(s.head);if(!e)return vr.none;o=n.charCategorizer(s.head),r=n.sliceDoc(e.from,e.to)}else{let e=s.to-s.from;if(e<t.minSelectionLength||e>200)return vr.none;if(t.wholeWords){if(r=n.sliceDoc(s.from,s.to),o=n.charCategorizer(s.head),!LP(o,n,s.from,s.to)||!function(e,t,n,i){return e(t.sliceDoc(n,n+1))==fi.Word&&e(t.sliceDoc(i-1,i))==fi.Word}(o,n,s.from,s.to))return vr.none}else if(r=n.sliceDoc(s.from,s.to),!r)return vr.none}let a=[];for(let l of e.visibleRanges){let e=new CP(n.doc,r,l.from,l.to);for(;!e.next().done;){let{from:i,to:r}=e.value;if((!o||LP(o,n,i,r))&&(s.empty&&i<=s.from&&r>=s.to?a.push(QP.range(i,r)):(i>=s.to||r<=s.from)&&a.push(BP.range(i,r)),a.length>t.maxMatches))return vr.none}}return vr.set(a)}},{decorations:e=>e.decorations}),$P=sl.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});function zP(e){try{if(!e.doc)return KS.warn("prosemirrorToMarkdown: Fragment not attached to document"),""}catch(Kre){return KS.warn("prosemirrorToMarkdown: Cannot access fragment:",Kre),""}const t=[];function n(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e instanceof mS){const n=e.toString();return void(n.trim()&&t.push("  ".repeat(s)+n))}switch(e.nodeName){case"heading":{const n=e.getAttribute("level"),i="number"===typeof n?n:n?parseInt(n,10):1,s=r(e);t.push("#".repeat(i)+" "+s);break}case"paragraph":{const n=r(e);t.push(n);break}case"bulletList":e.forEach(e=>{e instanceof dS&&"listItem"===e.nodeName&&i(e,s,"-")});break;case"orderedList":{let t=1;e.forEach(e=>{e instanceof dS&&"listItem"===e.nodeName&&(i(e,s,"".concat(t,".")),t++)});break}case"codeBlock":{const n=r(e);t.push("```"),t.push(n),t.push("```");break}case"blockquote":r(e).split("\n").forEach(e=>{t.push("> "+e)});break;default:e.forEach(e=>{(e instanceof dS||e instanceof mS)&&n(e,s)})}}function i(e,i,r){const s="  ".repeat(i),o=[];if(e.forEach(e=>{if(e instanceof mS){const t=e.toString().trim();t&&o.push(t)}else if(e instanceof dS&&"paragraph"===e.nodeName){let t="";e.forEach(e=>{e instanceof mS&&(t+=e.toString())}),o.push(t)}}),o.length>0){t.push("".concat(s).concat(r," ").concat(o[0]));for(let e=1;e<o.length;e++)o[e].trim()&&t.push("".concat(s,"  ").concat(o[e]))}else t.push("".concat(s).concat(r," "));e.forEach(e=>{e instanceof dS&&("bulletList"===e.nodeName||"orderedList"===e.nodeName)&&n(e,i+1)})}function r(e){let t="";return e.forEach(e=>{e instanceof mS?t+=e.toString().replace(/\r/g,""):e instanceof dS&&(t+=r(e))}),t}try{let t=!1;e.forEach((e,i)=>{if(e instanceof dS||e instanceof mS){const i=e instanceof dS&&("bulletList"===e.nodeName||"orderedList"===e.nodeName);n(e),t=i}})}catch(Kre){return console.warn("prosemirrorToMarkdown: Error during iteration (document may be mid-transaction):",Kre),""}return t.join("\n")}function WP(e,t,n,i){const r=new dS("bullet"===n?"bulletList":"orderedList");i.push([r]);let s=t;const o=VP(e[s]);for(;s<e.length;){const t=e[s].trimEnd();if(!t)break;const n=VP(t),i=/^[\s]*[-*+]\s+/.test(t),a=/^[\s]*\d+\.\s+/.test(t);if(!(i||a)||n<o)break;if(n!==o)break;{const n=i?t.match(/^[\s]*[-*+]\s+(.+)$/):t.match(/^[\s]*\d+\.\s+(.+)$/),a=n?n[1]:t.trim(),l=new dS("listItem");r.push([l]);const c=new dS("paragraph");if(l.push([c]),c.push([new mS(a)]),s++,s<e.length){const t=e[s].trimEnd(),n=VP(t);if((/^[\s]*[-*+]\s+/.test(t)||/^[\s]*\d+\.\s+/.test(t))&&n>o){s=WP(e,s,/^[\s]*\d+\.\s+/.test(t)?"ordered":"bullet",l)}}}}return s}function VP(e){const t=e.match(/^(\s*)/);return t?Math.floor(t[1].length/2):0}const UP=oi.define();class XP extends mr{constructor(e,t){super(),this.name=e,this.color=t}toDOM(){const e=document.createElement("span");e.className="cm-remote-cursor",e.style.cssText="\n      position: relative;\n      border-left: 2px solid ".concat(this.color,";\n      margin-left: -1px;\n      margin-right: -1px;\n    ");const t=document.createElement("span");return t.className="cm-remote-cursor-label",t.textContent=this.name,t.style.cssText="\n      position: absolute;\n      top: -18px;\n      left: -1px;\n      font-size: 11px;\n      font-weight: 600;\n      line-height: 1;\n      color: white;\n      background: ".concat(this.color,";\n      padding: 2px 6px;\n      border-radius: 4px 4px 4px 0;\n      white-space: nowrap;\n      pointer-events: none;\n      z-index: 100;\n    "),e.appendChild(t),e}eq(e){return e.name===this.name&&e.color===this.color}}const qP=Bn.define({create:()=>vr.none,update(e,t){for(const n of t.effects)if(n.is(UP)){const e=n.value.map(e=>{const n=Math.min(e.position,t.state.doc.length);return vr.widget({widget:new XP(e.name,e.color),side:1}).range(n)});return vr.set(e,!0)}return e.map(t.changes)},provide:e=>sl.decorations.from(e)});function ZP(e){const t=e.doc.clientID;return Ms.fromClass(class{constructor(n){this.view=n,this.lastPos=-1,this.broadcastCursor=()=>{const t=this.view.state.selection.main.head;t!==this.lastPos&&(this.lastPos=t,e.setLocalStateField("cmCursor",{position:t}))},this.handleAwarenessChange=()=>{const n=e.getStates(),i=[];n.forEach((e,n)=>{if(n===t)return;const r=e.user,s=e.cmCursor;r&&s&&"number"===typeof s.position&&i.push({clientId:n,name:r.name||"User ".concat(n),color:r.color||"#888",position:s.position})}),requestAnimationFrame(()=>{this.view.dispatch({effects:UP.of(i)})})},requestAnimationFrame(()=>{this.broadcastCursor()}),e.on("change",this.handleAwarenessChange),requestAnimationFrame(()=>{this.handleAwarenessChange()})}update(e){(e.selectionSet||e.docChanged)&&this.broadcastCursor()}destroy(){e.off("change",this.handleAwarenessChange),e.setLocalStateField("cmCursor",null)}})}function HP(e){let{scrollTarget:t,isActive:n=!0,roomId:i}=e;const r=(0,s.useRef)(null),o=(0,s.useRef)(null),[a,l]=(0,s.useState)(!1),c=(0,s.useRef)(!1),u=(0,s.useRef)(n);u.current=n;const h=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!r.current)return;KS.log("\ud83c\udfa8 MarkdownEditor: Initializing as Y.XmlFragment lens...");let e=null,t=!1,n=null,i=null;return(async()=>{try{const{ydoc:s,provider:d,userInfo:p}=await W_.connect();i=s,n=s.getXmlFragment("prosemirror");const f=p.color;U_(f),KS.log("\ud83d\udcca Connected to Y.XmlFragment:",{clientID:s.clientID,fragmentLength:n.length}),await W_.waitForDatabaseSync(),await new Promise(e=>setTimeout(e,1e3)),l(!0),KS.log("\u2705 Database synced - Editor ready!");const m=zP(n);KS.log("\ud83d\udcc4 Initial markdown from Y.XmlFragment:",m.substring(0,100));const g=Ms.fromClass(class{constructor(e){setTimeout(()=>this.updateFoldGutters(e),100)}update(e){setTimeout(()=>this.updateFoldGutters(e.view),50)}updateFoldGutters(e){e.dom.querySelectorAll(".cm-foldGutter .cm-gutterElement").forEach(e=>{const t=e.querySelector("span");t&&t.textContent&&(t.textContent.includes("\u203a")?e.classList.add("folded"):e.classList.remove("folded"))})}}),v=e=>{KS.log("\ud83c\udfa8 setEditorCursorColor called with:",e),r.current&&(r.current.style.setProperty("--user-cursor-color",e),r.current.style.setProperty("--user-selection-color",e+"40"));const t=o.current;if(t){const n=t.dom.querySelectorAll(".cm-cursor, .cm-dropCursor");KS.log("\ud83c\udfa8 Found cursor elements:",n.length),n.forEach(t=>{t.style.borderLeftColor=e}),t.contentDOM.style.cursor="url(".concat(U_(e),") 0 0, text")}};v(f);const y=yi.create({doc:m,extensions:[Fc(),Ic,Wl(),sT(),od(),Al(),[Rl,Nl],yi.allowMultipleSelections.of(!0),yi.transactionFilter.of(e=>{if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;let t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;let n=e.newDoc,{head:i}=e.newSelection.main,r=n.lineAt(i);if(i>r.from+200)return e;let s=n.sliceString(r.from,i);if(!t.some(e=>e.test(s)))return e;let{state:o}=e,a=-1,l=[];for(let{head:c}of o.selection.ranges){let e=o.doc.lineAt(c);if(e.from==a)continue;a=e.from;let t=Sh(o,e.from);if(null==t)continue;let n=/^\s*/.exec(e.text)[0],i=Dh(o,t);n!=i&&l.push({from:e.from,to:e.from+n.length,insert:i})}return l.length?[e,{changes:l,sequential:!0}]:e}),dd(md,{fallback:!0}),Dd(),[Hp,Vp],sf(),Kl(),tc(),Zl,IP(),pl.of([...Yp,...xP,...kT,...Gh,...of,DP]),Vy(),g,(t=d.awareness,[qP,ZP(t)]),sl.updateListener.of(e=>{if(e.docChanged&&!c.current){const t=e.state.doc.toString();h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{i&&n&&(KS.log("\ud83d\udcdd Parsing markdown and updating Y.XmlFragment..."),i.transact(()=>{n.delete(0,n.length),function(e,t){const n=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n");let i=0;for(;i<n.length;){const e=n[i].trimEnd();if(!e){t.push([new dS("paragraph")]),i++;continue}const r=e.match(/^(#{1,6})\s+(.+)$/);if(r){const e=r[1].length,n=r[2],s=new dS("heading");s.setAttribute("level",e),t.push([s]),s.push([new mS(n)]),i++;continue}if(/^[\s]*[-*+]\s+/.test(e)){i=WP(n,i,"bullet",t);continue}if(/^[\s]*\d+\.\s+/.test(e)){i=WP(n,i,"ordered",t);continue}if(e.startsWith("```")){const e=[];for(i++;i<n.length&&!n[i].startsWith("```");)e.push(n[i]),i++;i++;const r=new dS("codeBlock");t.push([r]),r.push([new mS(e.join("\n"))]);continue}const s=new dS("paragraph");t.push([s]),s.push([new mS(e)]),i++}}(t,n)},"markdown-editor"))},300)}})]});if(!r.current)return;e=new sl({state:y,parent:r.current}),o.current=e,a||(e.contentDOM.setAttribute("contenteditable","false"),e.contentDOM.style.opacity="0.5");const O=(t,i)=>{if(!e||!n)return;if("markdown-editor"===i.origin)return void KS.log("\ud83d\udd04 Skipping self-update");if(!u.current)return void KS.log("\ud83d\udd04 Skipping remote update - editor is hidden");KS.log("\ud83d\udd04 Y.XmlFragment changed (remote), updating markdown view...");const r=e.state.selection.main.head;c.current=!0;const s=zP(n);e.dispatch({changes:{from:0,to:e.state.doc.length,insert:s}});const o=e.state.doc.length,a=Math.min(r,o);e.dispatch({selection:{anchor:a}}),c.current=!1};n.observeDeep(O);const w=W_.onColorChange(e=>{KS.log("\ud83c\udfa8 MarkdownEditor: Updating cursor color to:",e),v(e)});return KS.log("\u2705 MarkdownEditor: Ready as Y.XmlFragment lens!"),()=>{n&&n.unobserveDeep(O),w()}}catch(s){KS.error("\u274c Failed to initialize editor:",s)}var t})(),()=>{t||(t=!0,l(!1),KS.log("\ud83e\uddf9 MarkdownEditor: Cleaning up..."),h.current&&clearTimeout(h.current),e&&e.destroy(),W_.disconnect(),o.current=null)}},[]),(0,s.useEffect)(()=>{a&&o.current&&(o.current.contentDOM.setAttribute("contenteditable","true"),o.current.contentDOM.style.opacity="1",KS.log("\u2328\ufe0f  Editor enabled - ready for input"))},[a]),(0,s.useEffect)(()=>{if(!n||!a||!o.current)return;(async()=>{try{const{ydoc:e}=await W_.connect(),t=e.getXmlFragment("prosemirror"),n=o.current;if(!n)return;const i=zP(t);if(i!==n.state.doc.toString()){KS.log("\ud83d\udd04 Re-syncing markdown editor after becoming active"),c.current=!0;const e=n.state.selection.main.head;n.dispatch({changes:{from:0,to:n.state.doc.length,insert:i}});const t=n.state.doc.length,r=Math.min(e,t);n.dispatch({selection:{anchor:r}}),c.current=!1}}catch(e){KS.warn("Could not re-sync markdown:",e)}})()},[n,a]),(0,s.useEffect)(()=>{if(!n||!o.current)return;const e=e=>{const{query:t,matchIndex:n}=e.detail,i=o.current;if(!t||!i)return;const r=i.state.doc.toString(),s=t.toLowerCase();let a=0,l=-1;for(let o=0;o<=n&&(l=r.toLowerCase().indexOf(s,a),-1!==l);o++)a=l+s.length;-1!==l&&(i.dispatch({selection:{anchor:l,head:l+s.length},scrollIntoView:!0}),requestAnimationFrame(()=>{try{var e;const t=i.state.doc.lineAt(l),n=i.domAtPos(t.from),r=null===n||void 0===n||null===(e=n.node)||void 0===e?void 0:e.parentElement;r&&(r.classList.add("highlight-flash"),setTimeout(()=>r.classList.remove("highlight-flash"),1e3))}catch(t){}}))};return window.addEventListener("searchScrollTo",e),()=>window.removeEventListener("searchScrollTo",e)},[n,a]),(0,s.useEffect)(()=>{if(!t||!o.current)return;const e=o.current,n=Math.min(t.position,e.state.doc.length);e.dispatch({selection:{anchor:n}}),requestAnimationFrame(()=>{try{var t;const i=e.state.doc.lineAt(n),r=e.domAtPos(i.from),s=null===r||void 0===r||null===(t=r.node)||void 0===t?void 0:t.parentElement;s&&(s.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{s.classList.add("highlight-flash"),setTimeout(()=>s.classList.remove("highlight-flash"),1e3)},300))}catch(Kre){e.dispatch({effects:sl.scrollIntoView(n,{y:"center"})})}})},[t]);const[d,p]=(0,s.useState)(!1),f=(0,s.useRef)(0);return(0,s.useEffect)(()=>{if(!o.current)return;const e=o.current.scrollDOM;if(!e)return;const t=()=>{const t=e.scrollTop,n=t-f.current;Math.abs(n)>5&&(n>0&&t>60?p(!0):n<0&&p(!1),f.current=t),t<10&&p(!1)};return e.addEventListener("scroll",t,{passive:!0}),()=>e.removeEventListener("scroll",t)},[a]),(0,Qt.jsxs)("div",{className:"markdown-editor-wrapper",children:[(0,Qt.jsxs)("div",{className:"breadcrumb ".concat(d?"hidden":""),children:[(0,Qt.jsx)("span",{className:"breadcrumb-item",children:"Home"}),(0,Qt.jsx)("span",{className:"breadcrumb-separator",children:"/"}),(0,Qt.jsx)("span",{className:"breadcrumb-item breadcrumb-current",children:i?"".concat(i,".md"):"untitled.md"})]}),(0,Qt.jsx)("div",{ref:r,className:"markdown-editor"})]})}var YP=n(950);function GP(e){this.content=e}GP.prototype={constructor:GP,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var i=n&&n!=e?this.remove(n):this,r=i.find(e),s=i.content.slice();return-1==r?s.push(n||e,t):(s[r+1]=t,n&&(s[r]=n)),new GP(s)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new GP(n)},addToStart:function(e,t){return new GP([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new GP(n)},addBefore:function(e,t,n){var i=this.remove(t),r=i.content.slice(),s=i.find(e);return r.splice(-1==s?r.length:s,0,t,n),new GP(r)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=GP.from(e)).size?new GP(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=GP.from(e)).size?new GP(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=GP.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},GP.from=function(e){if(e instanceof GP)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new GP(t)};const KP=GP;function JP(e,t,n){for(let i=0;;i++){if(i==e.childCount||i==t.childCount)return e.childCount==t.childCount?null:n;let r=e.child(i),s=t.child(i);if(r!=s){if(!r.sameMarkup(s))return n;if(r.isText&&r.text!=s.text){for(let e=0;r.text[e]==s.text[e];e++)n++;return n}if(r.content.size||s.content.size){let e=JP(r.content,s.content,n+1);if(null!=e)return e}n+=r.nodeSize}else n+=r.nodeSize}}function eM(e,t,n,i){for(let r=e.childCount,s=t.childCount;;){if(0==r||0==s)return r==s?null:{a:n,b:i};let o=e.child(--r),a=t.child(--s),l=o.nodeSize;if(o!=a){if(!o.sameMarkup(a))return{a:n,b:i};if(o.isText&&o.text!=a.text){let e=0,t=Math.min(o.text.length,a.text.length);for(;e<t&&o.text[o.text.length-e-1]==a.text[a.text.length-e-1];)e++,n--,i--;return{a:n,b:i}}if(o.content.size||a.content.size){let e=eM(o.content,a.content,n-1,i-1);if(e)return e}n-=l,i-=l}else n-=l,i-=l}}class tM{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;if(l>e&&!1!==n(a,i+o,r||null,s)&&a.content.size){let r=o+1;a.nodesBetween(Math.max(0,e-r),Math.min(a.content.size,t-r),n,i+r)}o=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,i){let r="",s=!0;return this.nodesBetween(e,t,(o,a)=>{let l=o.isText?o.text.slice(Math.max(e,a)-a,t-a):o.isLeaf?i?"function"===typeof i?i(o):i:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&l||o.isTextblock)&&n&&(s?s=!1:r+=n),r+=l},0),r}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,i=this.content.slice(),r=0;for(t.isText&&t.sameMarkup(n)&&(i[i.length-1]=t.withText(t.text+n.text),r=1);r<e.content.length;r++)i.push(e.content[r]);return new tM(i,this.size+e.size)}cut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size;if(0==e&&t==this.size)return this;let n=[],i=0;if(t>e)for(let r=0,s=0;s<t;r++){let o=this.content[r],a=s+o.nodeSize;a>e&&((s<e||a>t)&&(o=o.isText?o.cut(Math.max(0,e-s),Math.min(o.text.length,t-s)):o.cut(Math.max(0,e-s-1),Math.min(o.content.size,t-s-1))),n.push(o),i+=o.nodeSize),s=a}return new tM(n,i)}cutByIndex(e,t){return e==t?tM.empty:0==e&&t==this.content.length?this:new tM(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let i=this.content.slice(),r=this.size+t.nodeSize-n.nodeSize;return i[e]=t,new tM(i,r)}addToStart(e){return new tM([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new tM(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let i=this.content[t];e(i,n,t),n+=i.nodeSize}}findDiffStart(e){return JP(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}findDiffEnd(e){return eM(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size)}findIndex(e){if(0==e)return iM(0,e);if(e==this.size)return iM(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position ".concat(e," outside of fragment (").concat(this,")"));for(let t=0,n=0;;t++){let i=n+this.child(t).nodeSize;if(i>=e)return i==e?iM(t+1,i):iM(t,n);n=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return tM.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new tM(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return tM.empty;let t,n=0;for(let i=0;i<e.length;i++){let r=e[i];n+=r.nodeSize,i&&r.isText&&e[i-1].sameMarkup(r)?(t||(t=e.slice(0,i)),t[t.length-1]=r.withText(t[t.length-1].text+r.text)):t&&t.push(r)}return new tM(t||e,n)}static from(e){if(!e)return tM.empty;if(e instanceof tM)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new tM([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}tM.empty=new tM([],0);const nM={index:0,offset:0};function iM(e,t){return nM.index=e,nM.offset=t,nM}function rM(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!rM(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!rM(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}class sM{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let i=0;i<e.length;i++){let r=e[i];if(this.eq(r))return e;if(this.type.excludes(r.type))t||(t=e.slice(0,i));else{if(r.type.excludes(this.type))return e;!n&&r.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),n=!0),t&&t.push(r)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&rM(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError("There is no mark type ".concat(t.type," in this schema"));let i=n.create(t.attrs);return n.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return sM.none;if(e instanceof sM)return[e];let t=e.slice();return t.sort((e,t)=>e.type.rank-t.type.rank),t}}sM.none=[];class oM extends Error{}class aM{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=cM(this.content,e+this.openStart,t);return n&&new aM(n,this.openStart,this.openEnd)}removeBetween(e,t){return new aM(lM(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return aM.empty;let n=t.openStart||0,i=t.openEnd||0;if("number"!=typeof n||"number"!=typeof i)throw new RangeError("Invalid input for Slice.fromJSON");return new aM(tM.fromJSON(e,t.content),n,i)}static maxOpen(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,i=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)n++;for(let r=e.lastChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.lastChild)i++;return new aM(e,n,i)}}function lM(e,t,n){let{index:i,offset:r}=e.findIndex(t),s=e.maybeChild(i),{index:o,offset:a}=e.findIndex(n);if(r==t||s.isText){if(a!=n&&!e.child(o).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(i!=o)throw new RangeError("Removing non-flat range");return e.replaceChild(i,s.copy(lM(s.content,t-r-1,n-r-1)))}function cM(e,t,n,i){let{index:r,offset:s}=e.findIndex(t),o=e.maybeChild(r);if(s==t||o.isText)return i&&!i.canReplace(r,r,n)?null:e.cut(0,t).append(n).append(e.cut(t));let a=cM(o.content,t-s-1,n,o);return a&&e.replaceChild(r,o.copy(a))}function uM(e,t,n){if(n.openStart>e.depth)throw new oM("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new oM("Inconsistent open depths");return hM(e,t,n,0)}function hM(e,t,n,i){let r=e.index(i),s=e.node(i);if(r==t.index(i)&&i<e.depth-n.openStart){let o=hM(e,t,n,i+1);return s.copy(s.content.replaceChild(r,o))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=i||t.depth!=i){let{start:r,end:o}=function(e,t){let n=t.depth-e.openStart,i=t.node(n).copy(e.content);for(let r=n-1;r>=0;r--)i=t.node(r).copy(tM.from(i));return{start:i.resolveNoCache(e.openStart+n),end:i.resolveNoCache(i.content.size-e.openEnd-n)}}(n,e);return gM(s,vM(e,r,o,t,i))}{let i=e.parent,r=i.content;return gM(i,r.cut(0,e.parentOffset).append(n.content).append(r.cut(t.parentOffset)))}}return gM(s,yM(e,t,i))}function dM(e,t){if(!t.type.compatibleContent(e.type))throw new oM("Cannot join "+t.type.name+" onto "+e.type.name)}function pM(e,t,n){let i=e.node(n);return dM(i,t.node(n)),i}function fM(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function mM(e,t,n,i){let r=(t||e).node(n),s=0,o=t?t.index(n):r.childCount;e&&(s=e.index(n),e.depth>n?s++:e.textOffset&&(fM(e.nodeAfter,i),s++));for(let a=s;a<o;a++)fM(r.child(a),i);t&&t.depth==n&&t.textOffset&&fM(t.nodeBefore,i)}function gM(e,t){return e.type.checkContent(t),e.copy(t)}function vM(e,t,n,i,r){let s=e.depth>r&&pM(e,t,r+1),o=i.depth>r&&pM(n,i,r+1),a=[];return mM(null,e,r,a),s&&o&&t.index(r)==n.index(r)?(dM(s,o),fM(gM(s,vM(e,t,n,i,r+1)),a)):(s&&fM(gM(s,yM(e,t,r+1)),a),mM(t,n,r,a),o&&fM(gM(o,yM(n,i,r+1)),a)),mM(i,null,r,a),new tM(a)}function yM(e,t,n){let i=[];if(mM(null,e,n,i),e.depth>n){fM(gM(pM(e,t,n+1),yM(e,t,n+1)),i)}return mM(t,null,n,i),new tM(i)}aM.empty=new aM(tM.empty,0,0);class OM{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(t);return n?e.child(t).cut(n):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],i=0==t?0:this.path[3*t-1]+1;for(let r=0;r<e;r++)i+=n.child(r).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return sM.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),i=e.maybeChild(t);if(!n){let e=n;n=i,i=e}let r=n.marks;for(var s=0;s<r.length;s++)!1!==r[s].type.spec.inclusive||i&&r[s].isInSet(i.marks)||(r=r[s--].removeFromSet(r));return r}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,i=e.parent.maybeChild(e.index());for(var r=0;r<n.length;r++)!1!==n[r].type.spec.inclusive||i&&n[r].isInSet(i.marks)||(n=n[r--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=arguments.length>1?arguments[1]:void 0;if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new xM(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],i=0,r=t;for(let s=e;;){let{index:e,offset:t}=s.content.findIndex(r),o=r-t;if(n.push(s,e,i+t),!o)break;if(s=s.child(e),s.isText)break;r=o-1,i+=t+1}return new OM(t,n,r)}static resolveCached(e,t){let n=kM.get(e);if(n)for(let r=0;r<n.elts.length;r++){let e=n.elts[r];if(e.pos==t)return e}else kM.set(e,n=new wM);let i=n.elts[n.i]=OM.resolve(e,t);return n.i=(n.i+1)%bM,i}}class wM{constructor(){this.elts=[],this.i=0}}const bM=12,kM=new WeakMap;class xM{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const DM=Object.create(null);class SM{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sM.none;this.type=e,this.attrs=t,this.marks=i,this.content=n||tM.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.content.nodesBetween(e,t,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,i){return this.content.textBetween(e,t,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&rM(this.attrs,t||e.defaultAttrs||DM)&&sM.sameSet(this.marks,n||sM.none)}copy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e==this.content?this:new SM(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new SM(this.type,this.attrs,this.content,e)}cut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size;return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e==t)return aM.empty;let i=this.resolve(e),r=this.resolve(t),s=n?0:i.sharedDepth(t),o=i.start(s),a=i.node(s).content.cut(i.pos-o,r.pos-o);return new aM(a,i.depth-s,r.depth-s)}replace(e,t,n){return uM(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let i=this.content.child(t-1);return{node:i,index:t-1,offset:n-i.nodeSize}}resolve(e){return OM.resolveCached(this,e)}resolveNoCache(e){return OM.resolve(this,e)}rangeHasMark(e,t,n){let i=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),AM(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tM.empty,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.childCount,s=this.contentMatchAt(e).matchFragment(n,i,r),o=s&&s.matchFragment(this.content,t);if(!o||!o.validEnd)return!1;for(let a=i;a<r;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0}canReplaceWith(e,t,n,i){if(i&&!this.type.allowsMarks(i))return!1;let r=this.contentMatchAt(e).matchType(n),s=r&&r.matchFragment(this.content,t);return!!s&&s.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=sM.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!sM.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node ".concat(this.type.name,": ").concat(this.marks.map(e=>e.type.name)));this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let i=tM.fromJSON(e,t.content),r=e.nodeType(t.type).create(t.attrs,i,n);return r.type.checkAttrs(r.attrs),r}}SM.prototype.text=void 0;class CM extends SM{constructor(e,t,n,i){if(super(e,t,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):AM(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new CM(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new CM(this.type,this.attrs,e,this.marks)}cut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.text.length;return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function AM(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class EM{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new _M(e,t);if(null==n.next)return EM.empty;let i=TM(n);n.next&&n.err("Unexpected trailing text");let r=function(e){let t=Object.create(null);return n(IM(e,0));function n(i){let r=[];i.forEach(t=>{e[t].forEach(t=>{let n,{term:i,to:s}=t;if(i){for(let e=0;e<r.length;e++)r[e][0]==i&&(n=r[e][1]);IM(e,s).forEach(e=>{n||r.push([i,n=[]]),-1==n.indexOf(e)&&n.push(e)})}})});let s=t[i.join(",")]=new EM(i.indexOf(e.length-1)>-1);for(let e=0;e<r.length;e++){let i=r[e][1].sort(NM);s.next.push({type:r[e][0],next:t[i.join(",")]||n(i)})}return s}}(function(e){let t=[[]];return r(s(e,0),n()),t;function n(){return t.push([])-1}function i(e,n,i){let r={term:i,to:n};return t[e].push(r),r}function r(e,t){e.forEach(e=>e.to=t)}function s(e,t){if("choice"==e.type)return e.exprs.reduce((e,n)=>e.concat(s(n,t)),[]);if("seq"!=e.type){if("star"==e.type){let o=n();return i(t,o),r(s(e.expr,o),o),[i(o)]}if("plus"==e.type){let o=n();return r(s(e.expr,t),o),r(s(e.expr,o),o),[i(o)]}if("opt"==e.type)return[i(t)].concat(s(e.expr,t));if("range"==e.type){let o=t;for(let t=0;t<e.min;t++){let t=n();r(s(e.expr,o),t),o=t}if(-1==e.max)r(s(e.expr,o),o);else for(let t=e.min;t<e.max;t++){let t=n();i(o,t),r(s(e.expr,o),t),o=t}return[i(o)]}if("name"==e.type)return[i(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let i=0;;i++){let o=s(e.exprs[i],t);if(i==e.exprs.length-1)return o;r(o,t=n())}}}(i));return function(e,t){for(let n=0,i=[e];n<i.length;n++){let e=i[n],r=!e.validEnd,s=[];for(let t=0;t<e.next.length;t++){let{type:n,next:o}=e.next[t];s.push(n.name),!r||n.isText||n.hasRequiredAttrs()||(r=!1),-1==i.indexOf(o)&&i.push(o)}r&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(r,n),r}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.childCount,i=this;for(let r=t;i&&r<n;r++)i=i.matchType(e.child(r).type);return i}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[this];return function r(s,o){let a=s.matchFragment(e,n);if(a&&(!t||a.validEnd))return tM.from(o.map(e=>e.createAndFill()));for(let e=0;e<s.next.length;e++){let{type:t,next:n}=s.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==i.indexOf(n)){i.push(n);let e=r(n,o.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),r=i.match;if(r.matchType(e)){let e=[];for(let t=i;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<r.next.length;e++){let{type:s,next:o}=r.next[e];s.isLeaf||s.hasRequiredAttrs()||s.name in t||i.type&&!o.validEnd||(n.push({match:s.contentMatch,type:s,via:i}),t[s.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError("There's no ".concat(e,"th edge in this content match"));return this.next[e]}toString(){let e=[];return function t(n){e.push(n);for(let i=0;i<n.next.length;i++)-1==e.indexOf(n.next[i].next)&&t(n.next[i].next)}(this),e.map((t,n)=>{let i=n+(t.validEnd?"*":" ")+" ";for(let r=0;r<t.next.length;r++)i+=(r?", ":"")+t.next[r].type.name+"->"+e.indexOf(t.next[r].next);return i}).join("\n")}}EM.empty=new EM(!0);class _M{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function TM(e){let t=[];do{t.push(PM(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function PM(e){let t=[];do{t.push(MM(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function MM(e){let t=function(e){if(e.eat("(")){let t=TM(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let n=e.nodeTypes,i=n[t];if(i)return[i];let r=[];for(let s in n){let e=n[s];e.isInGroup(t)&&r.push(e)}0==r.length&&e.err("No node type or group '"+t+"' found");return r}(e,e.next).map(t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=RM(e,t)}return t}function FM(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function RM(e,t){let n=FM(e),i=n;return e.eat(",")&&(i="}"!=e.next?FM(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:i,expr:t}}function NM(e,t){return t-e}function IM(e,t){let n=[];return function t(i){let r=e[i];if(1==r.length&&!r[0].term)return t(r[0].to);n.push(i);for(let e=0;e<r.length;e++){let{term:i,to:s}=r[e];i||-1!=n.indexOf(s)||t(s)}}(t),n.sort(NM)}function BM(e){let t=Object.create(null);for(let n in e){let i=e[n];if(!i.hasDefault)return null;t[n]=i.default}return t}function QM(e,t){let n=Object.create(null);for(let i in e){let r=t&&t[i];if(void 0===r){let t=e[i];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+i);r=t.default}n[i]=r}return n}function LM(e,t,n,i){for(let r in t)if(!(r in e))throw new RangeError("Unsupported attribute ".concat(r," for ").concat(n," of type ").concat(r));for(let r in e){let n=e[r];n.validate&&n.validate(t[r])}}function jM(e,t){let n=Object.create(null);if(t)for(let i in t)n[i]=new zM(e,i,t[i]);return n}class $M{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=jM(e,n.attrs),this.defaultAttrs=BM(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==EM.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:QM(this.attrs,e)}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new SM(this,this.computeAttrs(e),tM.from(t),sM.setFrom(n))}createChecked(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return t=tM.from(t),this.checkContent(t),new SM(this,this.computeAttrs(e),t,sM.setFrom(n))}createAndFill(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(e=this.computeAttrs(e),t=tM.from(t),t.size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let i=this.contentMatch.matchFragment(t),r=i&&i.fillBefore(tM.empty,!0);return r?new SM(this,e,t.append(r),sM.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError("Invalid content for node ".concat(this.name,": ").concat(e.toString().slice(0,50)))}checkAttrs(e){LM(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:sM.none:e}static compile(e,t){let n=Object.create(null);e.forEach((e,i)=>n[e]=new $M(e,t,i));let i=t.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let r in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}}class zM{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let i=n.split("|");return n=>{let r=null===n?"null":typeof n;if(i.indexOf(r)<0)throw new RangeError("Expected value of type ".concat(i," for attribute ").concat(t," on type ").concat(e,", got ").concat(r))}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class WM{constructor(e,t,n,i){this.name=e,this.rank=t,this.schema=n,this.spec=i,this.attrs=jM(e,i.attrs),this.excluded=null;let r=BM(this.attrs);this.instance=r?new sM(this,r):null}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!e&&this.instance?this.instance:new sM(this,QM(this.attrs,e))}static compile(e,t){let n=Object.create(null),i=0;return e.forEach((e,r)=>n[e]=new WM(e,i++,t,r)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){LM(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class VM{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=KP.from(e.nodes),t.marks=KP.from(e.marks||{}),this.nodes=$M.compile(this.spec.nodes,this),this.marks=WM.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let e=this.nodes[i],t=e.spec.content||"",r=e.spec.marks;if(e.contentMatch=n[t]||(n[t]=EM.parse(t,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==r?null:r?UM(this,r.split(" ")):""!=r&&e.inlineContent?null:[]}for(let i in this.marks){let e=this.marks[i],t=e.spec.excludes;e.excluded=null==t?[e]:""==t?[]:UM(this,t.split(" "))}this.nodeFromJSON=e=>SM.fromJSON(this,e),this.markFromJSON=e=>sM.fromJSON(this,e),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof $M))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,i)}text(e,t){let n=this.nodes.text;return new CM(n,n.defaultAttrs,e,sM.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function UM(e,t){let n=[];for(let i=0;i<t.length;i++){let r=t[i],s=e.marks[r],o=s;if(s)n.push(s);else for(let t in e.marks){let i=e.marks[t];("_"==r||i.spec.group&&i.spec.group.split(" ").indexOf(r)>-1)&&n.push(o=i)}if(!o)throw new SyntaxError("Unknown mark type: '"+t[i]+"'")}return n}class XM{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(function(e){return null!=e.tag}(e))this.tags.push(e);else if(function(e){return null!=e.style}(e)){let t=/[^=]*/.exec(e.style)[0];n.indexOf(t)<0&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new KM(this,t,!1);return n.addAll(e,sM.none,t.from,t.to),n.finish()}parseSlice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new KM(this,t,!0);return n.addAll(e,sM.none,t.from,t.to),aM.maxOpen(n.finish())}matchTag(e,t,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let n=this.tags[i];if(JM(e,n.tag)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,i){for(let r=i?this.styles.indexOf(i)+1:0;r<this.styles.length;r++){let i=this.styles[r],s=i.style;if(!(0!=s.indexOf(e)||i.context&&!n.matchesContext(i.context)||s.length>e.length&&(61!=s.charCodeAt(e.length)||s.slice(e.length+1)!=t))){if(i.getAttrs){let e=i.getAttrs(t);if(!1===e)continue;i.attrs=e||void 0}return i}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,i=0;for(;i<t.length;i++){let e=t[i];if((null==e.priority?50:e.priority)<n)break}t.splice(i,0,e)}for(let i in e.marks){let t=e.marks[i].spec.parseDOM;t&&t.forEach(e=>{n(e=eF(e)),e.mark||e.ignore||e.clearMark||(e.mark=i)})}for(let i in e.nodes){let t=e.nodes[i].spec.parseDOM;t&&t.forEach(e=>{n(e=eF(e)),e.node||e.ignore||e.mark||(e.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new XM(e,XM.schemaRules(e)))}}const qM={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ZM={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},HM={ol:!0,ul:!0};function YM(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}class GM{constructor(e,t,n,i,r,s){this.type=e,this.attrs=t,this.marks=n,this.solid=i,this.options=s,this.content=[],this.activeMarks=sM.none,this.match=r||(4&s?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(tM.from(e));if(!t){let t,n=this.type.contentMatch;return(t=n.findWrapping(e.type))?(this.match=n,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let n=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length))}}let t=tM.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(tM.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!qM.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class KM{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let i,r=t.topNode,s=YM(null,t.preserveWhitespace,0)|(n?4:0);i=r?new GM(r.type,r.attrs,sM.none,!0,t.topMatch||r.type.contentMatch,s):new GM(n?null:e.schema.topNodeType,null,sM.none,!0,null,s),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,i=this.top,r=2&i.options?"full":this.localPreserveWS||(1&i.options)>0,{schema:s}=this.parser;if("full"===r||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(r)if("full"===r)n=n.replace(/\r\n?/g,"\n");else if(s.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(s.linebreakReplacement.create())){let e=n.split(/\r?\n|\r/);for(let n=0;n<e.length;n++)n&&this.insertNode(s.linebreakReplacement.create(),t,!0),e[n]&&this.insertNode(s.text(e[n]),t,!/\S/.test(e[n]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=i.content[i.content.length-1],r=e.previousSibling;(!t||r&&"BR"==r.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(s.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let i=this.localPreserveWS,r=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s,o=e.nodeName.toLowerCase();HM.hasOwnProperty(o)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&HM.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,n));e:if(a?a.ignore:ZM.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let n,i=this.needsBlock;if(qM.hasOwnProperty(o))r.content.length&&r.content[0].isInline&&this.open&&(this.open--,r=this.top),n=!0,r.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let s=a&&a.skip?t:this.readStyles(e,t);s&&this.addAll(e,s),n&&this.sync(r),this.needsBlock=i}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,a,n,!1===a.consuming?s:void 0)}this.localPreserveWS=i}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let e=this.parser.matchedStyles[i],r=n.getPropertyValue(e);if(r)for(let n;;){let i=this.parser.matchStyle(e,r,this,n);if(!i)break;if(i.ignore)return null;if(t=i.clearMark?t.filter(e=>!i.clearMark(e)):t.concat(this.parser.schema.marks[i.mark].create(i.attrs)),!1!==i.consuming)break;n=i}}return t}addElementByRule(e,t,n,i){let r,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(s,t.attrs||null,n,t.preserveWhitespace);e&&(r=!0,n=e)}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let o=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,n,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let i=e;"string"==typeof t.contentElement?i=e.querySelector(t.contentElement):"function"==typeof t.contentElement?i=t.contentElement(e):t.contentElement&&(i=t.contentElement),this.findAround(e,i,!0),this.addAll(i,n),this.findAround(e,i,!1)}r&&this.sync(o)&&this.open--}addAll(e,t,n,i){let r=n||0;for(let s=n?e.childNodes[n]:e.firstChild,o=null==i?null:e.childNodes[i];s!=o;s=s.nextSibling,++r)this.findAtPoint(e,r),this.addDOM(s,t);this.findAtPoint(e,r)}findPlace(e,t,n){let i,r;for(let s=this.open,o=0;s>=0;s--){let t=this.nodes[s],a=t.findWrapping(e);if(a&&(!i||i.length>a.length+o)&&(i=a,r=t,!a.length))break;if(t.solid){if(n)break;o+=2}}if(!i)return null;this.sync(r);for(let s=0;s<i.length;s++)t=this.enterInner(i[s],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let i=this.findPlace(e,t,n);if(i){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=sM.none;for(let r of i.concat(e.marks))(t.type?t.type.allowsMarkType(r.type):tF(r.type,e.type))&&(n=r.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,i){let r=this.findPlace(e.create(t),n,!1);return r&&(r=this.enterInner(e,t,n,!0,i)),r}enterInner(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0;this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let o=YM(e,r,s.options);4&s.options&&0==s.content.length&&(o|=4);let a=sM.none;return n=n.filter(t=>!(s.type?s.type.allowsMarkType(t.type):tF(t.type,e))||(a=t.addToSet(a),!1)),this.nodes.push(new GM(e,t,a,i,null,o)),this.open++,n}closeExtra(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=1)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)if(null==this.find[i].pos&&1==e.nodeType&&e.contains(this.find[i].node)){t.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),r=-(n?n.depth+1:0)+(i?0:1),s=(e,o)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;o>=r;o--)if(s(e-1,o))return!0;return!1}{let e=o>0||0==o&&i?this.nodes[o].type:n&&o>=r?n.node(o-r).type:null;if(!e||e.name!=a&&!e.isInGroup(a))return!1;o--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function JM(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function eF(e){let t={};for(let n in e)t[n]=e[n];return t}function tF(e,t){let n=t.schema.nodes;for(let i in n){let r=n[i];if(!r.allowsMarkType(e))continue;let s=[],o=e=>{s.push(e);for(let n=0;n<e.edgeCount;n++){let{type:i,next:r}=e.edge(n);if(i==t)return!0;if(s.indexOf(r)<0&&o(r))return!0}};if(o(r.contentMatch))return!0}}class nF{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;n||(n=rF(t).createDocumentFragment());let i=n,r=[];return e.forEach(e=>{if(r.length||e.marks.length){let n=0,s=0;for(;n<r.length&&s<e.marks.length;){let t=e.marks[s];if(this.marks[t.type.name]){if(!t.eq(r[n][0])||!1===t.type.spec.spanning)break;n++,s++}else s++}for(;n<r.length;)i=r.pop()[1];for(;s<e.marks.length;){let n=e.marks[s++],o=this.serializeMark(n,e.isInline,t);o&&(r.push([n,i]),i.appendChild(o.dom),i=o.contentDOM||o.dom)}}i.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:i}=aF(rF(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return n}serializeNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let r=this.serializeMark(e.marks[i],e.isInline,t);r&&((r.contentDOM||r.dom).appendChild(n),n=r.dom)}return n}serializeMark(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.marks[e.type.name];return i&&aF(rF(n),i(e,t),null,e.attrs)}static renderSpec(e,t){return aF(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new nF(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=iF(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return iF(e.marks)}}function iF(e){let t={};for(let n in e){let i=e[n].spec.toDOM;i&&(t[n]=i)}return t}function rF(e){return e.document||window.document}const sF=new WeakMap;function oF(e){let t=sF.get(e);return void 0===t&&sF.set(e,t=function(e){let t=null;function n(e){if(e&&"object"==typeof e)if(Array.isArray(e))if("string"==typeof e[0])t||(t=[]),t.push(e);else for(let t=0;t<e.length;t++)n(e[t]);else for(let t in e)n(e[t])}return n(e),t}(e)),t}function aF(e,t,n,i){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let r,s=t[0];if("string"!=typeof s)throw new RangeError("Invalid array passed to renderSpec");if(i&&(r=oF(i))&&r.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o,a=s.indexOf(" ");a>0&&(n=s.slice(0,a),s=s.slice(a+1));let l=n?e.createElementNS(n,s):e.createElement(s),c=t[1],u=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){u=2;for(let e in c)if(null!=c[e]){let t=e.indexOf(" ");t>0?l.setAttributeNS(e.slice(0,t),e.slice(t+1),c[e]):"style"==e&&l.style?l.style.cssText=c[e]:l.setAttribute(e,c[e])}}for(let h=u;h<t.length;h++){let r=t[h];if(0===r){if(h<t.length-1||h>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:t,contentDOM:s}=aF(e,r,n,i);if(l.appendChild(t),s){if(o)throw new RangeError("Multiple content holes");o=s}}}return{dom:l,contentDOM:o}}const lF=Math.pow(2,16);function cF(e,t){return e+t*lF}function uF(e){return 65535&e}class hF{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class dF{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.ranges=e,this.inverted=t,!e.length&&dF.empty)return dF.empty}recover(e){let t=0,n=uF(e);if(!this.inverted)for(let i=0;i<n;i++)t+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/lF}(e)}mapResult(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!0)}_map(e,t,n){let i=0,r=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let a=this.ranges[o]-(this.inverted?i:0);if(a>e)break;let l=this.ranges[o+r],c=this.ranges[o+s],u=a+l;if(e<=u){let r=a+i+((l?e==a?-1:e==u?1:t:t)<0?0:c);if(n)return r;let s=e==(t<0?a:u)?null:cF(o/3,e-a),h=e==a?2:e==u?1:4;return(t<0?e!=a:e!=u)&&(h|=8),new hF(r,h,s)}i+=c-l}return n?e+i:new hF(e+i,0,null)}touches(e,t){let n=0,i=uF(t),r=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let t=this.ranges[o]-(this.inverted?n:0);if(t>e)break;let a=this.ranges[o+r];if(e<=t+a&&o==3*i)return!0;n+=this.ranges[o+s]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,r=0;i<this.ranges.length;i+=3){let s=this.ranges[i],o=s-(this.inverted?r:0),a=s+(this.inverted?0:r),l=this.ranges[i+t],c=this.ranges[i+n];e(o,o+l,a,a+c),r+=c-l}}invert(){return new dF(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?dF.empty:new dF(e<0?[0,-e,0]:[0,0,e])}}dF.empty=new dF([]);class pF{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e?e.length:0;this.mirror=t,this.from=n,this.to=i,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.maps.length;return new pF(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let i=e.getMirror(t);this.appendMap(e._maps[t],null!=i&&i<t?n+i:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=i&&i>t?n-i-1:void 0)}}invert(){let e=new pF;return e.appendMappingInverted(this),e}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}_map(e,t,n){let i=0;for(let r=this.from;r<this.to;r++){let n=this._maps[r].mapResult(e,t);if(null!=n.recover){let t=this.getMirror(r);if(null!=t&&t>r&&t<this.to){r=t,e=this._maps[t].recover(n.recover);continue}}i|=n.delInfo,e=n.pos}return n?e:new hF(e,i,null)}}const fF=Object.create(null);class mF{getMap(){return dF.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=fF[t.stepType];if(!n)throw new RangeError("No step type ".concat(t.stepType," defined"));return n.fromJSON(e,t)}static jsonID(e,t){if(e in fF)throw new RangeError("Duplicate use of step JSON ID "+e);return fF[e]=t,t.prototype.jsonID=e,t}}class gF{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new gF(e,null)}static fail(e){return new gF(null,e)}static fromReplace(e,t,n,i){try{return gF.ok(e.replace(t,n,i))}catch(Kre){if(Kre instanceof oM)return gF.fail(Kre.message);throw Kre}}}function vF(e,t,n){let i=[];for(let r=0;r<e.childCount;r++){let s=e.child(r);s.content.size&&(s=s.copy(vF(s.content,t,s))),s.isInline&&(s=t(s,n,r)),i.push(s)}return tM.fromArray(i)}class yF extends mF{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),r=new aM(vF(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,i),t.openStart,t.openEnd);return gF.fromReplace(e,this.from,this.to,r)}invert(){return new OF(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new yF(t.pos,n.pos,this.mark)}merge(e){return e instanceof yF&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new yF(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new yF(t.from,t.to,e.markFromJSON(t.mark))}}mF.jsonID("addMark",yF);class OF extends mF{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new aM(vF(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return gF.fromReplace(e,this.from,this.to,n)}invert(){return new yF(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new OF(t.pos,n.pos,this.mark)}merge(e){return e instanceof OF&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new OF(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new OF(t.from,t.to,e.markFromJSON(t.mark))}}mF.jsonID("removeMark",OF);class wF extends mF{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return gF.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return gF.fromReplace(e,this.pos,this.pos+1,new aM(tM.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new wF(this.pos,t.marks[n]);return new wF(this.pos,this.mark)}}return new bF(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new wF(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new wF(t.pos,e.markFromJSON(t.mark))}}mF.jsonID("addNodeMark",wF);class bF extends mF{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return gF.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return gF.fromReplace(e,this.pos,this.pos+1,new aM(tM.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new wF(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new bF(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new bF(t.pos,e.markFromJSON(t.mark))}}mF.jsonID("removeNodeMark",bF);class kF extends mF{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(),this.from=e,this.to=t,this.slice=n,this.structure=i}apply(e){return this.structure&&DF(e,this.from,this.to)?gF.fail("Structure replace would overwrite content"):gF.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new dF([this.from,this.to-this.from,this.slice.size])}invert(e){return new kF(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new kF(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof kF)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?aM.empty:new aM(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new kF(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?aM.empty:new aM(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new kF(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new kF(t.from,t.to,aM.fromJSON(e,t.slice),!!t.structure)}}mF.jsonID("replace",kF);class xF extends mF{constructor(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=i,this.slice=r,this.insert=s,this.structure=o}apply(e){if(this.structure&&(DF(e,this.from,this.gapFrom)||DF(e,this.gapTo,this.to)))return gF.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return gF.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?gF.fromReplace(e,this.from,this.to,n):gF.fail("Content does not fit in gap")}getMap(){return new dF([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new xF(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),r=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||i<t.pos||r>n.pos?null:new xF(t.pos,n.pos,i,r,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new xF(t.from,t.to,t.gapFrom,t.gapTo,aM.fromJSON(e,t.slice),t.insert,!!t.structure)}}function DF(e,t,n){let i=e.resolve(t),r=n-t,s=i.depth;for(;r>0&&s>0&&i.indexAfter(s)==i.node(s).childCount;)s--,r--;if(r>0){let e=i.node(s).maybeChild(i.indexAfter(s));for(;r>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,r--}}return!1}function SF(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.contentMatch,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=e.doc.nodeAt(t),o=[],a=t+1;for(let l=0;l<s.childCount;l++){let t=s.child(l),c=a+t.nodeSize,u=i.matchType(t.type);if(u){i=u;for(let i=0;i<t.marks.length;i++)n.allowsMarkType(t.marks[i].type)||e.step(new OF(a,c,t.marks[i]));if(r&&t.isText&&"pre"!=n.whitespace){let e,i,r=/\r?\n|\r/g;for(;e=r.exec(t.text);)i||(i=new aM(tM.from(n.schema.text(" ",n.allowedMarks(t.marks))),0,0)),o.push(new kF(a+e.index,a+e.index+e[0].length,i))}}else o.push(new kF(a,c,aM.empty));a=c}if(!i.validEnd){let t=i.fillBefore(tM.empty,!0);e.replace(a,a,new aM(t,0,0))}for(let l=o.length-1;l>=0;l--)e.step(o[l])}function CF(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function AF(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,i=0,r=0;;--n){let s=e.$from.node(n),o=e.$from.index(n)+i,a=e.$to.indexAfter(n)-r;if(n<e.depth&&s.canReplace(o,a,t))return n;if(0==n||s.type.spec.isolating||!CF(s,o,a))break;o&&(i=1),a<s.childCount&&(r=1)}return null}function EF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=function(e,t){let{parent:n,startIndex:i,endIndex:r}=e,s=n.contentMatchAt(i).findWrapping(t);if(!s)return null;let o=s.length?s[0]:t;return n.canReplaceWith(i,r,o)?s:null}(e,t),s=r&&function(e,t){let{parent:n,startIndex:i,endIndex:r}=e,s=n.child(i),o=t.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:t).contentMatch;for(let l=i;a&&l<r;l++)a=a.matchType(n.child(l).type);return a&&a.validEnd?o:null}(i,t);return s?r.map(_F).concat({type:t,attrs:n}).concat(s.map(_F)):null}function _F(e){return{type:e,attrs:null}}function TF(e,t,n,i){t.forEach((r,s)=>{if(r.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(r.text);){let r=e.mapping.slice(i).map(n+1+s+o.index);e.replaceWith(r,r+1,t.type.schema.linebreakReplacement.create())}}})}function PF(e,t,n,i){t.forEach((r,s)=>{if(r.type==r.type.schema.linebreakReplacement){let r=e.mapping.slice(i).map(n+1+s);e.replaceWith(r,r+1,t.type.schema.text("\n"))}})}function MF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0,r=e.resolve(t),s=r.depth-n,o=i&&i[i.length-1]||r.parent;if(s<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!o.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let c=r.depth-1,u=n-2;c>s;c--,u--){let e=r.node(c),t=r.index(c);if(e.type.spec.isolating)return!1;let n=e.content.cutByIndex(t,e.childCount),s=i&&i[u+1];s&&(n=n.replaceChild(0,s.type.create(s.attrs)));let o=i&&i[u]||e;if(!e.canReplace(t+1,e.childCount)||!o.type.validContent(n))return!1}let a=r.indexAfter(s),l=i&&i[0];return r.node(s).canReplaceWith(a,a,l?l.type:r.node(s+1).type)}function FF(e,t){let n=e.resolve(t),i=n.index();return RF(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(i,i+1)}function RF(e,t){return!(!e||!t||e.isLeaf||!function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:i}=e.type.schema;for(let r=0;r<t.childCount;r++){let s=t.child(r),o=s.type==i?e.type.schema.nodes.text:s.type;if(n=n.matchType(o),!n)return!1;if(!e.type.allowsMarks(s.marks))return!1}return n.validEnd}(e,t))}function NF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=e.resolve(t);for(let r=i.depth;;r--){let e,s,o=i.index(r);if(r==i.depth?(e=i.nodeBefore,s=i.nodeAfter):n>0?(e=i.node(r+1),o++,s=i.node(r).maybeChild(o)):(e=i.node(r).maybeChild(o-1),s=i.node(r+1)),e&&!e.isTextblock&&RF(e,s)&&i.node(r).canReplace(o,o+1))return t;if(0==r)break;t=n<0?i.before(r):i.after(r)}}function IF(e,t,n){let i=e.resolve(t);if(!n.content.size)return t;let r=n.content;for(let s=0;s<n.openStart;s++)r=r.firstChild.content;for(let s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(let e=i.depth;e>=0;e--){let t=e==i.depth?0:i.pos<=(i.start(e+1)+i.end(e+1))/2?-1:1,n=i.index(e)+(t>0?1:0),o=i.node(e),a=!1;if(1==s)a=o.canReplace(n,n,r);else{let e=o.contentMatchAt(n).findWrapping(r.firstChild.type);a=e&&o.canReplaceWith(n,n,e[0])}if(a)return 0==t?i.pos:t<0?i.before(e+1):i.after(e+1)}return null}function BF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:aM.empty;if(t==n&&!i.size)return null;let r=e.resolve(t),s=e.resolve(n);return QF(r,s,i)?new kF(t,n,i):new LF(r,s,i).fit()}function QF(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}mF.jsonID("replaceAround",xF);class LF{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=tM.empty;for(let i=0;i<=e.depth;i++){let t=e.node(i);this.frontier.push({type:t.type,match:t.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=tM.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let r=this.placed,s=n.depth,o=i.depth;for(;s&&o&&1==r.childCount;)r=r.firstChild.content,s--,o--;let a=new aM(r,s,o);return e>-1?new xF(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new kF(n.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let r=t.firstChild;if(t.childCount>1&&(i=0),r.type.spec.isolating&&i<=n){e=n;break}t=r.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,i=null;n?(i=zF(this.unplaced.content,n-1).firstChild,e=i.content):e=this.unplaced.content;let r=e.firstChild;for(let s=this.depth;s>=0;s--){let e,{type:o,match:a}=this.frontier[s],l=null;if(1==t&&(r?a.matchType(r.type)||(l=a.fillBefore(tM.from(r),!1)):i&&o.compatibleContent(i.type)))return{sliceDepth:n,frontierDepth:s,parent:i,inject:l};if(2==t&&r&&(e=a.findWrapping(r.type)))return{sliceDepth:n,frontierDepth:s,parent:i,wrap:e};if(i&&a.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=zF(e,t);return!(!i.childCount||i.firstChild.isLeaf)&&(this.unplaced=new aM(e,t+1,Math.max(n,i.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=zF(e,t);if(i.childCount<=1&&t>0){let r=e.size-t<=t+i.size;this.unplaced=new aM(jF(e,t-1,1),t-1,r?t-1:n)}else this.unplaced=new aM(jF(e,t,1),t,n)}placeNodes(e){let{sliceDepth:t,frontierDepth:n,parent:i,inject:r,wrap:s}=e;for(;this.depth>n;)this.closeFrontierNode();if(s)for(let m=0;m<s.length;m++)this.openFrontierNode(s[m]);let o=this.unplaced,a=i?i.content:o.content,l=o.openStart-t,c=0,u=[],{match:h,type:d}=this.frontier[n];if(r){for(let e=0;e<r.childCount;e++)u.push(r.child(e));h=h.matchFragment(r)}let p=a.size+t-(o.content.size-o.openEnd);for(;c<a.childCount;){let e=a.child(c),t=h.matchType(e.type);if(!t)break;c++,(c>1||0==l||e.content.size)&&(h=t,u.push(WF(e.mark(d.allowedMarks(e.marks)),1==c?l:0,c==a.childCount?p:-1)))}let f=c==a.childCount;f||(p=-1),this.placed=$F(this.placed,n,tM.from(u)),this.frontier[n].match=h,f&&p<0&&i&&i.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<p;m++){let e=g.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),g=e.content}this.unplaced=f?0==t?aM.empty:new aM(jF(o.content,t-1,1),t-1,p<0?o.openEnd:t-1):new aM(jF(o.content,t,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!VF(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:i}=this.frontier[t],r=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=VF(e,t,i,n,r);if(s){for(let n=t-1;n>=0;n--){let{match:t,type:i}=this.frontier[n],r=VF(e,n,i,t,!0);if(!r||r.childCount)continue e}return{depth:t,fit:s,move:r?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=$F(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),i=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,i)}return e}openFrontierNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=$F(this.placed,this.depth,tM.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(tM.empty,!0);e.childCount&&(this.placed=$F(this.placed,this.frontier.length,e))}}function jF(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(jF(e.firstChild.content,t-1,n)))}function $F(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy($F(e.lastChild.content,t-1,n)))}function zF(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function WF(e,t,n){if(t<=0)return e;let i=e.content;return t>1&&(i=i.replaceChild(0,WF(i.firstChild,t-1,1==i.childCount?n-1:0))),t>0&&(i=e.type.contentMatch.fillBefore(i).append(i),n<=0&&(i=i.append(e.type.contentMatch.matchFragment(i).fillBefore(tM.empty,!0)))),e.copy(i)}function VF(e,t,n,i,r){let s=e.node(t),o=r?e.indexAfter(t):e.index(t);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let a=i.fillBefore(s.content,!0,o);return a&&!function(e,t,n){for(let i=n;i<t.childCount;i++)if(!e.allowsMarks(t.child(i).marks))return!0;return!1}(n,s.content,o)?a:null}function UF(e){return e.spec.defining||e.spec.definingForContent}function XF(e,t,n,i,r){if(t<n){let r=e.firstChild;e=e.replaceChild(0,r.copy(XF(r.content,t+1,n,i,r)))}if(t>i){let t=r.contentMatchAt(0),n=t.fillBefore(e).append(e);e=n.append(t.matchFragment(n).fillBefore(tM.empty,!0))}return e}function qF(e,t){let n=[];for(let i=Math.min(e.depth,t.depth);i>=0;i--){let r=e.start(i);if(r<e.pos-(e.depth-i)||t.end(i)>t.pos+(t.depth-i)||e.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(r==t.start(i)||i==e.depth&&i==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==r-1)&&n.push(i)}return n}class ZF extends mF{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return gF.fail("No node at attribute step's position");let n=Object.create(null);for(let r in t.attrs)n[r]=t.attrs[r];n[this.attr]=this.value;let i=t.type.create(n,null,t.marks);return gF.fromReplace(e,this.pos,this.pos+1,new aM(tM.from(i),0,t.isLeaf?0:1))}getMap(){return dF.empty}invert(e){return new ZF(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ZF(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new ZF(t.pos,t.attr,t.value)}}mF.jsonID("attr",ZF);class HF extends mF{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return gF.ok(n)}getMap(){return dF.empty}invert(e){return new HF(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new HF(t.attr,t.value)}}mF.jsonID("docAttr",HF);let YF=class extends Error{};YF=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n},(YF.prototype=Object.create(Error.prototype)).constructor=YF,YF.prototype.name="TransformError";class GF{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new pF}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new YF(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,t=-1e9;for(let n=0;n<this.mapping.maps.length;n++){let i=this.mapping.maps[n];n&&(e=i.map(e,1),t=i.map(t,-1)),i.forEach((n,i,r,s)=>{e=Math.min(e,r),t=Math.max(t,s)})}return 1e9==e?null:{from:e,to:t}}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:aM.empty,i=BF(this.doc,e,t,n);return i&&this.step(i),this}replaceWith(e,t,n){return this.replace(e,t,new aM(tM.from(n),0,0))}delete(e,t){return this.replace(e,t,aM.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return function(e,t,n,i){if(!i.size)return e.deleteRange(t,n);let r=e.doc.resolve(t),s=e.doc.resolve(n);if(QF(r,s,i))return e.step(new kF(t,n,i));let o=qF(r,s);0==o[o.length-1]&&o.pop();let a=-(r.depth+1);o.unshift(a);for(let d=r.depth,p=r.pos-1;d>0;d--,p--){let e=r.node(d).type.spec;if(e.defining||e.definingAsContext||e.isolating)break;o.indexOf(d)>-1?a=d:r.before(d)==p&&o.splice(1,0,-d)}let l=o.indexOf(a),c=[],u=i.openStart;for(let d=i.content,p=0;;p++){let e=d.firstChild;if(c.push(e),p==i.openStart)break;d=e.content}for(let d=u-1;d>=0;d--){let e=c[d],t=UF(e.type);if(t&&!e.sameMarkup(r.node(Math.abs(a)-1)))u=d;else if(t||!e.type.isTextblock)break}for(let d=i.openStart;d>=0;d--){let t=(d+u+1)%(i.openStart+1),a=c[t];if(a)for(let c=0;c<o.length;c++){let u=o[(c+l)%o.length],h=!0;u<0&&(h=!1,u=-u);let d=r.node(u-1),p=r.index(u-1);if(d.canReplaceWith(p,p,a.type,a.marks))return e.replace(r.before(u),h?s.after(u):n,new aM(XF(i.content,0,i.openStart,t),t,i.openEnd))}}let h=e.steps.length;for(let d=o.length-1;d>=0&&(e.replace(t,n,i),!(e.steps.length>h));d--){let e=o[d];e<0||(t=r.before(e),n=s.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return function(e,t,n,i){if(!i.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let r=function(e,t,n){let i=e.resolve(t);if(i.parent.canReplaceWith(i.index(),i.index(),n))return t;if(0==i.parentOffset)for(let r=i.depth-1;r>=0;r--){let e=i.index(r);if(i.node(r).canReplaceWith(e,e,n))return i.before(r+1);if(e>0)return null}if(i.parentOffset==i.parent.content.size)for(let r=i.depth-1;r>=0;r--){let e=i.indexAfter(r);if(i.node(r).canReplaceWith(e,e,n))return i.after(r+1);if(e<i.node(r).childCount)return null}return null}(e.doc,t,i.type);null!=r&&(t=n=r)}e.replaceRange(t,n,new aM(tM.from(i),0,0))}(this,e,t,n),this}deleteRange(e,t){return function(e,t,n){let i=e.doc.resolve(t),r=e.doc.resolve(n),s=qF(i,r);for(let o=0;o<s.length;o++){let t=s[o],n=o==s.length-1;if(n&&0==t||i.node(t).type.contentMatch.validEnd)return e.delete(i.start(t),r.end(t));if(t>0&&(n||i.node(t-1).canReplace(i.index(t-1),r.indexAfter(t-1))))return e.delete(i.before(t),r.after(t))}for(let o=1;o<=i.depth&&o<=r.depth;o++)if(t-i.start(o)==i.depth-o&&n>i.end(o)&&r.end(o)-n!=r.depth-o&&i.start(o-1)==r.start(o-1)&&i.node(o-1).canReplace(i.index(o-1),r.index(o-1)))return e.delete(i.before(o),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return function(e,t,n){let{$from:i,$to:r,depth:s}=t,o=i.before(s+1),a=r.after(s+1),l=o,c=a,u=tM.empty,h=0;for(let f=s,m=!1;f>n;f--)m||i.index(f)>0?(m=!0,u=tM.from(i.node(f).copy(u)),h++):l--;let d=tM.empty,p=0;for(let f=s,m=!1;f>n;f--)m||r.after(f+1)<r.end(f)?(m=!0,d=tM.from(r.node(f).copy(d)),p++):c++;e.step(new xF(l,c,o,a,new aM(u.append(d),h,p),u.size-h,!0))}(this,e,t),this}join(e){return function(e,t,n){let i=null,{linebreakReplacement:r}=e.doc.type.schema,s=e.doc.resolve(t-n),o=s.node().type;if(r&&o.inlineContent){let e="pre"==o.whitespace,t=!!o.contentMatch.matchType(r);e&&!t?i=!1:!e&&t&&(i=!0)}let a=e.steps.length;if(!1===i){let i=e.doc.resolve(t+n);PF(e,i.node(),i.before(),a)}o.inlineContent&&SF(e,t+n-1,o,s.node().contentMatchAt(s.index()),null==i);let l=e.mapping.slice(a),c=l.map(t-n);if(e.step(new kF(c,l.map(t+n,-1),aM.empty,!0)),!0===i){let t=e.doc.resolve(c);TF(e,t.node(),t.before(),e.steps.length)}}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this}wrap(e,t){return function(e,t,n){let i=tM.empty;for(let o=n.length-1;o>=0;o--){if(i.size){let e=n[o].type.contentMatch.matchFragment(i);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=tM.from(n[o].type.create(n[o].attrs,i))}let r=t.start,s=t.end;e.step(new xF(r,s,r,s,new aM(i,0,0),n.length,!0))}(this,e,t),this}setBlockType(e){return function(e,t,n,i,r){if(!i.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=e.steps.length;e.doc.nodesBetween(t,n,(t,n)=>{let o="function"==typeof r?r(t):r;if(t.isTextblock&&!t.hasMarkup(i,o)&&function(e,t,n){let i=e.resolve(t),r=i.index();return i.parent.canReplaceWith(r,r+1,n)}(e.doc,e.mapping.slice(s).map(n),i)){let r=null;if(i.schema.linebreakReplacement){let e="pre"==i.whitespace,t=!!i.contentMatch.matchType(i.schema.linebreakReplacement);e&&!t?r=!1:!e&&t&&(r=!0)}!1===r&&PF(e,t,n,s),SF(e,e.mapping.slice(s).map(n,1),i,void 0,null===r);let a=e.mapping.slice(s),l=a.map(n,1),c=a.map(n+t.nodeSize,1);return e.step(new xF(l,c,l+1,c-1,new aM(tM.from(i.create(o,null,t.marks)),0,0),1,!0)),!0===r&&TF(e,t,n,s),!1}})}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,arguments.length>2?arguments[2]:void 0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null),this}setNodeMarkup(e,t){return function(e,t,n,i,r){let s=e.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(i,null,r||s.marks);if(s.isLeaf)return e.replaceWith(t,t+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new xF(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new aM(tM.from(o),0,0),1,!0))}(this,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0),this}setNodeAttribute(e,t,n){return this.step(new ZF(e,t,n)),this}setDocAttribute(e,t){return this.step(new HF(e,t)),this}addNodeMark(e,t){return this.step(new wF(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(t instanceof sM)t.isInSet(n.marks)&&this.step(new bF(e,t));else{let i,r=n.marks,s=[];for(;i=t.isInSet(r);)s.push(new bF(e,i)),r=i.removeFromSet(r);for(let e=s.length-1;e>=0;e--)this.step(s[e])}return this}split(e){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0,r=e.doc.resolve(t),s=tM.empty,o=tM.empty;for(let a=r.depth,l=r.depth-n,c=n-1;a>l;a--,c--){s=tM.from(r.node(a).copy(s));let e=i&&i[c];o=tM.from(e?e.type.create(e.attrs,o):r.node(a).copy(o))}e.step(new kF(t,t,new aM(s.append(o),n,n),!0))}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2?arguments[2]:void 0),this}addMark(e,t,n){return function(e,t,n,i){let r,s,o=[],a=[];e.doc.nodesBetween(t,n,(e,l,c)=>{if(!e.isInline)return;let u=e.marks;if(!i.isInSet(u)&&c.type.allowsMarkType(i.type)){let c=Math.max(l,t),h=Math.min(l+e.nodeSize,n),d=i.addToSet(u);for(let e=0;e<u.length;e++)u[e].isInSet(d)||(r&&r.to==c&&r.mark.eq(u[e])?r.to=h:o.push(r=new OF(c,h,u[e])));s&&s.to==c?s.to=h:a.push(s=new yF(c,h,i))}}),o.forEach(t=>e.step(t)),a.forEach(t=>e.step(t))}(this,e,t,n),this}removeMark(e,t,n){return function(e,t,n,i){let r=[],s=0;e.doc.nodesBetween(t,n,(e,o)=>{if(!e.isInline)return;s++;let a=null;if(i instanceof WM){let t,n=e.marks;for(;t=i.isInSet(n);)(a||(a=[])).push(t),n=t.removeFromSet(n)}else i?i.isInSet(e.marks)&&(a=[i]):a=e.marks;if(a&&a.length){let i=Math.min(o+e.nodeSize,n);for(let e=0;e<a.length;e++){let n,l=a[e];for(let e=0;e<r.length;e++){let t=r[e];t.step==s-1&&l.eq(r[e].style)&&(n=t)}n?(n.to=i,n.step=s):r.push({style:l,from:Math.max(o,t),to:i,step:s})}}}),r.forEach(t=>e.step(new OF(t.from,t.to,t.style)))}(this,e,t,n),this}clearIncompatible(e,t,n){return SF(this,e,t,n),this}}const KF=Object.create(null);class JF{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new eR(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:aM.empty,n=t.content.lastChild,i=null;for(let o=0;o<t.openEnd;o++)i=n,n=n.lastChild;let r=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:a,$to:l}=s[o],c=e.mapping.slice(r);e.replaceRange(c.map(a.pos),c.map(l.pos),o?aM.empty:t),0==o&&uR(e,r,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,i=this.ranges;for(let r=0;r<i.length;r++){let{$from:s,$to:o}=i[r],a=e.mapping.slice(n),l=a.map(s.pos),c=a.map(o.pos);r?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),uR(e,n,t.isInline?-1:1))}}static findFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.parent.inlineContent?new iR(e):cR(e.node(0),e.parent,e.pos,e.index(),t,n);if(i)return i;for(let r=e.depth-1;r>=0;r--){let i=t<0?cR(e.node(0),e.node(r),e.before(r+1),e.index(r),t,n):cR(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,n);if(i)return i}return null}static near(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.findFrom(e,t)||this.findFrom(e,-t)||new aR(e.node(0))}static atStart(e){return cR(e,e,0,0,1)||new aR(e)}static atEnd(e){return cR(e,e,e.content.size,e.childCount,-1)||new aR(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=KF[t.type];if(!n)throw new RangeError("No selection type ".concat(t.type," defined"));return n.fromJSON(e,t)}static jsonID(e,t){if(e in KF)throw new RangeError("Duplicate use of selection JSON ID "+e);return KF[e]=t,t.prototype.jsonID=e,t}getBookmark(){return iR.between(this.$anchor,this.$head).getBookmark()}}JF.prototype.visible=!0;class eR{constructor(e,t){this.$from=e,this.$to=t}}let tR=!1;function nR(e){tR||e.parent.inlineContent||(tR=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class iR extends JF{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;nR(e),nR(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return JF.near(n);let i=e.resolve(t.map(this.anchor));return new iR(i.parent.inlineContent?i:n,n)}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:aM.empty;if(super.replace(e,t),t==aM.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof iR&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new rR(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new iR(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=e.resolve(t);return new this(i,n==t?i:e.resolve(n))}static between(e,t,n){let i=e.pos-t.pos;if(n&&!i||(n=i>=0?1:-1),!t.parent.inlineContent){let e=JF.findFrom(t,n,!0)||JF.findFrom(t,-n,!0);if(!e)return JF.near(t,n);t=e.$head}return e.parent.inlineContent||(0==i||(e=(JF.findFrom(e,-n,!0)||JF.findFrom(e,n,!0)).$anchor).pos<t.pos!=i<0)&&(e=t),new iR(e,t)}}JF.jsonID("text",iR);class rR{constructor(e,t){this.anchor=e,this.head=t}map(e){return new rR(e.map(this.anchor),e.map(this.head))}resolve(e){return iR.between(e.resolve(this.anchor),e.resolve(this.head))}}class sR extends JF{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:i}=t.mapResult(this.anchor),r=e.resolve(i);return n?JF.near(r):new sR(r)}content(){return new aM(tM.from(this.node),0,0)}eq(e){return e instanceof sR&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new oR(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new sR(e.resolve(t.anchor))}static create(e,t){return new sR(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}sR.prototype.visible=!1,JF.jsonID("node",sR);class oR{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new rR(n,n):new oR(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&sR.isSelectable(n)?new sR(t):JF.near(t)}}class aR extends JF{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:aM.empty;if(t==aM.empty){e.delete(0,e.doc.content.size);let t=JF.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new aR(e)}map(e){return new aR(e)}eq(e){return e instanceof aR}getBookmark(){return lR}}JF.jsonID("all",aR);const lR={map(){return this},resolve:e=>new aR(e)};function cR(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(t.inlineContent)return iR.create(e,n);for(let o=i-(r>0?0:1);r>0?o<t.childCount:o>=0;o+=r){let i=t.child(o);if(i.isAtom){if(!s&&sR.isSelectable(i))return sR.create(e,n-(r<0?i.nodeSize:0))}else{let t=cR(e,i,n+r,r<0?i.childCount:0,r,s);if(t)return t}n+=i.nodeSize*r}return null}function uR(e,t,n){let i=e.steps.length-1;if(i<t)return;let r,s=e.steps[i];(s instanceof kF||s instanceof xF)&&(e.mapping.maps[i].forEach((e,t,n,i)=>{null==r&&(r=i)}),e.setSelection(JF.near(e.doc.resolve(r),n)))}class hR extends GF{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return sM.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||sM.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let i=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),!e)return this.deleteRange(t,n);let r=this.storedMarks;if(!r){let e=this.doc.resolve(t);r=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,i.text(e,r)),this.selection.empty||this.selection.to!=t+e.length||this.setSelection(JF.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function dR(e,t){return t&&e?e.bind(t):e}class pR{constructor(e,t,n){this.name=e,this.init=dR(t.init,n),this.apply=dR(t.apply,n)}}const fR=[new pR("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new pR("selection",{init:(e,t)=>e.selection||JF.atStart(t.doc),apply:e=>e.selection}),new pR("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,i)=>i.selection.$cursor?e.storedMarks:null}),new pR("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class mR{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=fR.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new pR(e.key,e.spec.state,e))})}}class gR{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),i=null;for(;;){let r=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let a=i?i[s].n:0,l=i?i[s].state:this,c=a<t.length&&o.spec.appendTransaction.call(o,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let e=0;e<this.config.plugins.length;e++)i.push(e<s?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),r=!0}i&&(i[s]={state:n,n:t.length})}}if(!r)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new gR(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let r=n[i];t[r.name]=r.apply(e,this[r.name],this,t)}return t}get tr(){return new hR(this)}static create(e){let t=new mR(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new gR(t);for(let i=0;i<t.fields.length;i++)n[t.fields[i].name]=t.fields[i].init(e,n);return n}reconfigure(e){let t=new mR(this.schema,e.plugins),n=t.fields,i=new gR(t);for(let r=0;r<n.length;r++){let t=n[r].name;i[t]=this.hasOwnProperty(t)?this[t]:n[r].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[n],r=i.spec.state;r&&r.toJSON&&(t[n]=r.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new mR(e.schema,e.plugins),r=new gR(i);return i.fields.forEach(i=>{if("doc"==i.name)r.doc=SM.fromJSON(e.schema,t.doc);else if("selection"==i.name)r.selection=JF.fromJSON(r.doc,t.selection);else if("storedMarks"==i.name)t.storedMarks&&(r.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let s in n){let o=n[s],a=o.spec.state;if(o.key==i.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,s))return void(r[i.name]=a.fromJSON.call(o,e,t[s],r))}r[i.name]=i.init(e,r)}}),r}}function vR(e,t,n){for(let i in e){let r=e[i];r instanceof Function?r=r.bind(t):"handleDOMEvents"==i&&(r=vR(r,t,{})),n[i]=r}return n}class yR{constructor(e){this.spec=e,this.props={},e.props&&vR(e.props,this,this.props),this.key=e.key?e.key.key:wR("plugin")}getState(e){return e[this.key]}}const OR=Object.create(null);function wR(e){return e in OR?e+"$"+ ++OR[e]:(OR[e]=0,e+"$")}class bR{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"key";this.key=wR(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const kR=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},xR=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let DR=null;const SR=function(e,t,n){let i=DR||(DR=document.createRange());return i.setEnd(e,null==n?e.nodeValue.length:n),i.setStart(e,t||0),i},CR=function(e,t,n,i){return n&&(ER(e,t,n,i,-1)||ER(e,t,n,i,1))},AR=/^(img|br|input|textarea|hr)$/i;function ER(e,t,n,i,r){for(var s;;){if(e==n&&t==i)return!0;if(t==(r<0?0:_R(e))){let n=e.parentNode;if(!n||1!=n.nodeType||TR(e)||AR.test(e.nodeName)||"false"==e.contentEditable)return!1;t=kR(e)+(r<0?0:1),e=n}else{if(1!=e.nodeType)return!1;{let n=e.childNodes[t+(r<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable){if(!(null===(s=n.pmViewDesc)||void 0===s?void 0:s.ignoreForSelection))return!1;t+=r}else e=n,t=r<0?_R(e):0}}}}function _R(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function TR(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const PR=function(e){return e.focusNode&&CR(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function MR(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const FR="undefined"!=typeof navigator?navigator:null,RR="undefined"!=typeof document?document:null,NR=FR&&FR.userAgent||"",IR=/Edge\/(\d+)/.exec(NR),BR=/MSIE \d/.exec(NR),QR=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(NR),LR=!!(BR||QR||IR),jR=BR?document.documentMode:QR?+QR[1]:IR?+IR[1]:0,$R=!LR&&/gecko\/(\d+)/i.test(NR);$R&&(/Firefox\/(\d+)/.exec(NR)||[0,0])[1];const zR=!LR&&/Chrome\/(\d+)/.exec(NR),WR=!!zR,VR=zR?+zR[1]:0,UR=!LR&&!!FR&&/Apple Computer/.test(FR.vendor),XR=UR&&(/Mobile\/\w+/.test(NR)||!!FR&&FR.maxTouchPoints>2),qR=XR||!!FR&&/Mac/.test(FR.platform),ZR=!!FR&&/Win/.test(FR.platform),HR=/Android \d/.test(NR),YR=!!RR&&"webkitFontSmoothing"in RR.documentElement.style,GR=YR?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function KR(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function JR(e,t){return"number"==typeof e?e:e[t]}function eN(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,i=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*i}}function tN(e,t,n){let i=e.someProp("scrollThreshold")||0,r=e.someProp("scrollMargin")||5,s=e.dom.ownerDocument;for(let o=n||e.dom;o;){if(1!=o.nodeType){o=xR(o);continue}let e=o,n=e==s.body,a=n?KR(s):eN(e),l=0,c=0;if(t.top<a.top+JR(i,"top")?c=-(a.top-t.top+JR(r,"top")):t.bottom>a.bottom-JR(i,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+JR(r,"top")-a.top:t.bottom-a.bottom+JR(r,"bottom")),t.left<a.left+JR(i,"left")?l=-(a.left-t.left+JR(r,"left")):t.right>a.right-JR(i,"right")&&(l=t.right-a.right+JR(r,"right")),l||c)if(n)s.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,i=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let r=e.scrollLeft-n,s=e.scrollTop-i;t={left:t.left-r,top:t.top-s,right:t.right-r,bottom:t.bottom-s}}let u=n?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(u))break;o="absolute"==u?o.offsetParent:xR(o)}}function nN(e){let t=[],n=e.ownerDocument;for(let i=e;i&&(t.push({dom:i,top:i.scrollTop,left:i.scrollLeft}),e!=n);i=xR(i));return t}function iN(e,t){for(let n=0;n<e.length;n++){let{dom:i,top:r,left:s}=e[n];i.scrollTop!=r+t&&(i.scrollTop=r+t),i.scrollLeft!=s&&(i.scrollLeft=s)}}let rN=null;function sN(e,t){let n,i,r,s,o=2e8,a=0,l=t.top,c=t.top;for(let u=e.firstChild,h=0;u;u=u.nextSibling,h++){let e;if(1==u.nodeType)e=u.getClientRects();else{if(3!=u.nodeType)continue;e=SR(u).getClientRects()}for(let d=0;d<e.length;d++){let p=e[d];if(p.top<=l&&p.bottom>=c){l=Math.max(p.bottom,l),c=Math.min(p.top,c);let e=p.left>t.left?p.left-t.left:p.right<t.left?t.left-p.right:0;if(e<o){n=u,o=e,i=e&&3==n.nodeType?{left:p.right<t.left?p.right:p.left,top:t.top}:t,1==u.nodeType&&e&&(a=h+(t.left>=(p.left+p.right)/2?1:0));continue}}else p.top>t.top&&!r&&p.left<=t.left&&p.right>=t.left&&(r=u,s={left:Math.max(p.left,Math.min(p.right,t.left)),top:p.top});!n&&(t.left>=p.right&&t.top>=p.top||t.left>=p.left&&t.top>=p.bottom)&&(a=h+1)}}return!n&&r&&(n=r,i=s,o=0),n&&3==n.nodeType?function(e,t){let n,i=e.nodeValue.length,r=document.createRange();for(let s=0;s<i;s++){r.setEnd(e,s+1),r.setStart(e,s);let i=uN(r,1);if(i.top!=i.bottom&&oN(t,i)){n={node:e,offset:s+(t.left>=(i.left+i.right)/2?1:0)};break}}return r.detach(),n||{node:e,offset:0}}(n,i):!n||o&&1==n.nodeType?{node:e,offset:a}:sN(n,i)}function oN(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function aN(e,t,n){let i=e.childNodes.length;if(i&&n.top<n.bottom)for(let r=Math.max(0,Math.min(i-1,Math.floor(i*(t.top-n.top)/(n.bottom-n.top))-2)),s=r;;){let n=e.childNodes[s];if(1==n.nodeType){let e=n.getClientRects();for(let i=0;i<e.length;i++){let r=e[i];if(oN(t,r))return aN(n,t,r)}}if((s=(s+1)%i)==r)break}return e}function lN(e,t){let n,i=e.dom.ownerDocument,r=0,s=function(e,t,n){if(e.caretPositionFromPoint)try{let i=e.caretPositionFromPoint(t,n);if(i)return{node:i.offsetNode,offset:Math.min(_R(i.offsetNode),i.offset)}}catch(Jre){}if(e.caretRangeFromPoint){let i=e.caretRangeFromPoint(t,n);if(i)return{node:i.startContainer,offset:Math.min(_R(i.startContainer),i.startOffset)}}}(i,t.left,t.top);s&&({node:n,offset:r}=s);let o,a=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top);if(!a||!e.dom.contains(1!=a.nodeType?a.parentNode:a)){let n=e.dom.getBoundingClientRect();if(!oN(t,n))return null;if(a=aN(e.dom,t,n),!a)return null}if(UR)for(let c=a;n&&c;c=xR(c))c.draggable&&(n=void 0);if(a=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(a,t),n){if($R&&1==n.nodeType&&(r=Math.min(r,n.childNodes.length),r<n.childNodes.length)){let e,i=n.childNodes[r];"IMG"==i.nodeName&&(e=i.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&r++}let i;YR&&r&&1==n.nodeType&&1==(i=n.childNodes[r-1]).nodeType&&"false"==i.contentEditable&&i.getBoundingClientRect().top>=t.top&&r--,n==e.dom&&r==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?o=e.state.doc.content.size:0!=r&&1==n.nodeType&&"BR"==n.childNodes[r-1].nodeName||(o=function(e,t,n,i){let r=-1;for(let s=t,o=!1;s!=e.dom;){let t,n=e.docView.nearestDesc(s,!0);if(!n)return null;if(1==n.dom.nodeType&&(n.node.isBlock&&n.parent||!n.contentDOM)&&((t=n.dom.getBoundingClientRect()).width||t.height)&&(n.node.isBlock&&n.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(n.dom.nodeName)&&(!o&&t.left>i.left||t.top>i.top?r=n.posBefore:(!o&&t.right<i.left||t.bottom<i.top)&&(r=n.posAfter),o=!0),!n.contentDOM&&r<0&&!n.node.isText))return(n.node.isBlock?i.top<(t.top+t.bottom)/2:i.left<(t.left+t.right)/2)?n.posBefore:n.posAfter;s=n.dom.parentNode}return r>-1?r:e.docView.posFromDOM(t,n,-1)}(e,n,r,t))}null==o&&(o=function(e,t,n){let{node:i,offset:r}=sN(t,n),s=-1;if(1==i.nodeType&&!i.firstChild){let e=i.getBoundingClientRect();s=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(i,r,s)}(e,a,t));let l=e.docView.nearestDesc(a,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function cN(e){return e.top<e.bottom||e.left<e.right}function uN(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(cN(e))return e}return Array.prototype.find.call(n,cN)||e.getBoundingClientRect()}const hN=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function dN(e,t,n){let{node:i,offset:r,atom:s}=e.docView.domFromPos(t,n<0?-1:1),o=YR||$R;if(3==i.nodeType){if(!o||!hN.test(i.nodeValue)&&(n<0?r:r!=i.nodeValue.length)){let e=r,t=r,s=n<0?1:-1;return n<0&&!r?(t++,s=-1):n>=0&&r==i.nodeValue.length?(e--,s=1):n<0?e--:t++,pN(uN(SR(i,e,t),s),s<0)}{let e=uN(SR(i,r,r),n);if($R&&r&&/\s/.test(i.nodeValue[r-1])&&r<i.nodeValue.length){let t=uN(SR(i,r-1,r-1),-1);if(t.top==e.top){let n=uN(SR(i,r,r+1),-1);if(n.top!=e.top)return pN(n,n.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(s||0)).parent.inlineContent){if(null==s&&r&&(n<0||r==_R(i))){let e=i.childNodes[r-1];if(1==e.nodeType)return fN(e.getBoundingClientRect(),!1)}if(null==s&&r<_R(i)){let e=i.childNodes[r];if(1==e.nodeType)return fN(e.getBoundingClientRect(),!0)}return fN(i.getBoundingClientRect(),n>=0)}if(null==s&&r&&(n<0||r==_R(i))){let e=i.childNodes[r-1],t=3==e.nodeType?SR(e,_R(e)-(o?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return pN(uN(t,1),!1)}if(null==s&&r<_R(i)){let e=i.childNodes[r];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?SR(e,0,o?0:1):1==e.nodeType?e:null:null;if(t)return pN(uN(t,-1),!0)}return pN(uN(3==i.nodeType?SR(i):i,-n),n>=0)}function pN(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function fN(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function mN(e,t,n){let i=e.state,r=e.root.activeElement;i!=t&&e.updateState(t),r!=e.dom&&e.focus();try{return n()}finally{i!=t&&e.updateState(i),r!=e.dom&&r&&r.focus()}}const gN=/[\u0590-\u08ac]/;let vN=null,yN=null,ON=!1;function wN(e,t,n){return vN==t&&yN==n?ON:(vN=t,yN=n,ON="up"==n||"down"==n?function(e,t,n){let i=t.selection,r="up"==n?i.$from:i.$to;return mN(e,t,()=>{let{node:t}=e.docView.domFromPos(r.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let i=dN(e,r.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=SR(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let r=t[e];if(r.bottom>r.top+1&&("up"==n?i.top-r.top>2*(r.bottom-i.top):r.bottom-i.bottom>2*(i.bottom-r.top)))return!1}}return!0})}(e,t,n):function(e,t,n){let{$head:i}=t.selection;if(!i.parent.isTextblock)return!1;let r=i.parentOffset,s=!r,o=r==i.parent.content.size,a=e.domSelection();return a?gN.test(i.parent.textContent)&&a.modify?mN(e,t,()=>{let{focusNode:t,focusOffset:r,anchorNode:s,anchorOffset:o}=e.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",n,"character");let c=i.depth?e.docView.domAfterPos(i.before()):e.dom,{focusNode:u,focusOffset:h}=e.domSelectionRange(),d=u&&!c.contains(1==u.nodeType?u:u.parentNode)||t==u&&r==h;try{a.collapse(s,o),t&&(t!=s||r!=o)&&a.extend&&a.extend(t,r)}catch(Jre){}return null!=l&&(a.caretBidiLevel=l),d}):"left"==n||"backward"==n?s:o:i.pos==i.start()||i.pos==i.end()}(e,t,n))}class bN{constructor(e,t,n,i){this.parent=e,this.children=t,this.dom=n,this.contentDOM=i,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let i=this.children[t];if(i==e)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,i;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&(!(i=n.pmViewDesc)||i.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(i)+i.size:this.posAtStart}{let n,i;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&(!(i=n.pmViewDesc)||i.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(i):this.posAtEnd}}let i;if(e==this.dom&&this.contentDOM)i=t>kR(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){i=!1;break}if(t.previousSibling)break}if(null==i&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){i=!0;break}if(t.nextSibling)break}}return(null==i?n>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(let n=!0,i=e;i;i=i.parentNode){let r,s=this.getDesc(i);if(s&&(!t||s.node)){if(!n||!(r=s.nodeDOM)||(1==r.nodeType?r.contains(1==e.nodeType?e:e.parentNode):r==e))return s;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let i=e;i;i=i.parentNode){let r=this.getDesc(i);if(r)return r.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let i=this.children[t],r=n+i.size;if(n==e&&r!=n){for(;!i.border&&i.children.length;)for(let e=0;e<i.children.length;e++){let t=i.children[e];if(t.size){i=t;break}}return i}if(e<r)return i.descAt(e-n-i.border);n=r}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,i=0;for(let r=0;n<this.children.length;n++){let t=this.children[n],s=r+t.size;if(s>e||t instanceof EN){i=e-r;break}r=s}if(i)return this.children[n].domFromPos(i-this.children[n].border,t);for(let r;n&&!(r=this.children[n-1]).size&&r instanceof kN&&r.side>=0;n--);if(t<=0){let e,i=!0;for(;e=n?this.children[n-1]:null,e&&e.dom.parentNode!=this.contentDOM;n--,i=!1);return e&&t&&i&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?kR(e.dom)+1:0}}{let e,i=!0;for(;e=n<this.children.length?this.children[n]:null,e&&e.dom.parentNode!=this.contentDOM;n++,i=!1);return e&&i&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?kR(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,r=-1;for(let s=n,o=0;;o++){let n=this.children[o],a=s+n.size;if(-1==i&&e<=a){let r=s+n.border;if(e>=r&&t<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,r);e=s;for(let t=o;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){i=kR(n.dom)+1;break}e-=n.size}-1==i&&(i=0)}if(i>-1&&(a>t||o==this.children.length-1)){t=a;for(let e=o+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){r=kR(n.dom);break}t+=n.size}-1==r&&(r=this.contentDOM.childNodes.length);break}s=a}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:r}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Math.min(e,t),s=Math.max(e,t);for(let d=0,p=0;d<this.children.length;d++){let o=this.children[d],a=p+o.size;if(r>p&&s<a)return o.setSelection(e-p-o.border,t-p-o.border,n,i);p=a}let o=this.domFromPos(e,e?-1:1),a=t==e?o:this.domFromPos(t,t?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),u=!1;if(($R||UR)&&e==t){let{node:e,offset:t}=o;if(3==e.nodeType){if(u=!(!t||"\n"!=e.nodeValue[t-1]),u&&t==e.nodeValue.length)for(let n,i=e;i;i=i.parentNode){if(n=i.nextSibling){"BR"==n.nodeName&&(o=a={node:n.parentNode,offset:kR(n)+1});break}let e=i.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];u=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if($R&&c.focusNode&&c.focusNode!=a.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(i=!0)}if(!(i||u&&UR)&&CR(o.node,o.offset,c.anchorNode,c.anchorOffset)&&CR(a.node,a.offset,c.focusNode,c.focusOffset))return;let h=!1;if((l.extend||e==t)&&(!u||!$R)){l.collapse(o.node,o.offset);try{e!=t&&l.extend(a.node,a.offset),h=!0}catch(Jre){}}if(!h){if(e>t){let e=o;o=a,a=e}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(o.node,o.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,i=0;i<this.children.length;i++){let r=this.children[i],s=n+r.size;if(n==s?e<=s&&t>=n:e<s&&t>n){let i=n+r.border,o=s-r.border;if(e>=i&&t<=o)return this.dirty=e==n||t==s?2:1,void(e!=i||t!=o||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(e-i,t-i):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}n=s}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class kN extends bN{constructor(e,t,n,i){let r,s=t.type.toDOM;if("function"==typeof s&&(s=s(n,()=>r?r.parent?r.parent.posBeforeChild(r):void 0:i)),!t.type.spec.raw){if(1!=s.nodeType){let e=document.createElement("span");e.appendChild(s),s=e}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,r=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class xN extends bN{constructor(e,t,n,i){super(e,[],t,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class DN extends bN{constructor(e,t,n,i,r){super(e,[],n,i),this.mark=t,this.spec=r}static create(e,t,n,i){let r=i.nodeViews[t.type.name],s=r&&r(t,i,n);return s&&s.dom||(s=nF.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new DN(e,t,s.dom,s.contentDOM||s.dom,s)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let i=DN.create(this.parent,this.mark,!0,n),r=this.children,s=this.size;t<s&&(r=$N(r,t,s,n)),e>0&&(r=$N(r,0,e,n));for(let o=0;o<r.length;o++)r[o].parent=i;return i.children=r,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class SN extends bN{constructor(e,t,n,i,r,s,o,a,l){super(e,[],r,s),this.node=t,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=o}static create(e,t,n,i,r,s){let o,a=r.nodeViews[t.type.name],l=a&&a(t,r,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:s,n,i),c=l&&l.dom,u=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=nF.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:u}=e)}u||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let h=c;return c=IN(c,n,t),l?o=new _N(e,t,n,i,c,u||null,h,l,r,s+1):t.isText?new AN(e,t,n,i,c,h,r):new SN(e,t,n,i,c,u||null,h,r,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>tM.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&BN(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,i=t,r=e.composing?this.localCompositionInfo(e,t):null,s=r&&r.pos>-1?r:null,o=r&&r.pos<0,a=new LN(this,s&&s.node,e);!function(e,t,n,i){let r=t.locals(e),s=0;if(0==r.length){for(let n=0;n<e.childCount;n++){let o=e.child(n);i(o,r,t.forChild(s,o),n),s+=o.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,h,d,p;for(;o<r.length&&r[o].to==s;){let e=r[o++];e.widget&&(u?(h||(h=[u])).push(e):u=e)}if(u)if(h){h.sort(jN);for(let e=0;e<h.length;e++)n(h[e],c,!!l)}else n(u,c,!!l);if(l)p=-1,d=l,l=null;else{if(!(c<e.childCount))break;p=c,d=e.child(c++)}for(let e=0;e<a.length;e++)a[e].to<=s&&a.splice(e--,1);for(;o<r.length&&r[o].from<=s&&r[o].to>s;)a.push(r[o++]);let f=s+d.nodeSize;if(d.isText){let e=f;o<r.length&&r[o].from<e&&(e=r[o].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<f&&(l=d.cut(e-s),d=d.cut(0,e-s),f=e,p=-1)}else for(;o<r.length&&r[o].to<f;)o++;i(d,d.isInline&&!d.isLeaf?a.filter(e=>!e.inline):a.slice(),t.forChild(s,d),p),s=f}}(this.node,this.innerDeco,(t,r,s)=>{t.spec.marks?a.syncToMarks(t.spec.marks,n,e,r):t.type.side>=0&&!s&&a.syncToMarks(r==this.node.childCount?sM.none:this.node.child(r).marks,n,e,r),a.placeWidget(t,e,i)},(t,s,l,c)=>{let u;a.syncToMarks(t.marks,n,e,c),a.findNodeMatch(t,s,l,c)||o&&e.state.selection.from>i&&e.state.selection.to<i+t.nodeSize&&(u=a.findIndexWithChild(r.node))>-1&&a.updateNodeAt(t,s,l,u,e)||a.updateNextNode(t,s,l,e,c,i)||a.addNode(t,s,l,e,i),i+=t.nodeSize}),a.syncToMarks([],n,e,0),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(s&&this.protectLocalComposition(e,s),TN(this.contentDOM,this.children,e),XR&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof iR)||n<t||i>t+this.node.content.size)return null;let r=e.input.compositionNode;if(!r||!this.dom.contains(r.parentNode))return null;if(this.node.inlineContent){let e=r.nodeValue,s=function(e,t,n,i){for(let r=0,s=0;r<e.childCount&&s<=i;){let o=e.child(r++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;r<e.childCount;){let t=e.child(r++);if(s+=t.nodeSize,!t.isText)break;l+=t.text}if(s>=n){if(s>=i&&l.slice(i-t.length-a,i-a)==t)return i-t.length;let e=a<i?l.lastIndexOf(t,i-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==i&&l.length>=i+t.length-a&&l.slice(i-a,i-a+t.length)==t)return i}}return-1}(this.node.content,e,n-t,i-t);return s<0?null:{node:r,pos:s,text:e}}return{node:r,pos:-1,text:""}}protectLocalComposition(e,t){let{node:n,pos:i,text:r}=t;if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new xN(this,s,n,r);e.input.compositionNodes.push(o),this.children=$N(this.children,i,i+r.length,e,o)}update(e,t,n,i){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,i),!0)}updateInner(e,t,n,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(BN(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=RN(this.dom,this.nodeDOM,FN(this.outerDeco,this.node,t),FN(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.nodeDOM.draggable=!0))}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function CN(e,t,n,i,r){IN(i,t,e);let s=new SN(void 0,e,t,n,i,i,i,r,0);return s.contentDOM&&s.updateChildren(r,0),s}class AN extends SN{constructor(e,t,n,i,r,s,o){super(e,t,n,i,r,null,s,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let i=this.node.cut(e,t),r=document.createTextNode(i.text);return new AN(this.parent,i,this.outerDeco,this.innerDeco,r,r,n)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class EN extends bN{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class _N extends SN{constructor(e,t,n,i,r,s,o,a,l,c){super(e,t,n,i,r,s,o,l,c),this.spec=a}update(e,t,n,i){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let r=this.spec.update(e,t,n);return r&&this.updateInner(e,t,n,i),r}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,i){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function TN(e,t,n){let i=e.firstChild,r=!1;for(let s=0;s<t.length;s++){let o=t[s],a=o.dom;if(a.parentNode==e){for(;a!=i;)i=QN(i),r=!0;i=i.nextSibling}else r=!0,e.insertBefore(a,i);if(o instanceof DN){let t=i?i.previousSibling:e.lastChild;TN(o.contentDOM,o.children,n),i=t?t.nextSibling:e.firstChild}}for(;i;)i=QN(i),r=!0;r&&n.trackWrites==e&&(n.trackWrites=null)}const PN=function(e){e&&(this.nodeName=e)};PN.prototype=Object.create(null);const MN=[new PN];function FN(e,t,n){if(0==e.length)return MN;let i=n?MN[0]:new PN,r=[i];for(let s=0;s<e.length;s++){let o=e[s].type.attrs;if(o){o.nodeName&&r.push(i=new PN(o.nodeName));for(let e in o){let s=o[e];null!=s&&(n&&1==r.length&&r.push(i=new PN(t.isInline?"span":"div")),"class"==e?i.class=(i.class?i.class+" ":"")+s:"style"==e?i.style=(i.style?i.style+";":"")+s:"nodeName"!=e&&(i[e]=s))}}}return r}function RN(e,t,n,i){if(n==MN&&i==MN)return t;let r=t;for(let s=0;s<i.length;s++){let t=i[s],o=n[s];if(s){let n;o&&o.nodeName==t.nodeName&&r!=e&&(n=r.parentNode)&&n.nodeName.toLowerCase()==t.nodeName||(n=document.createElement(t.nodeName),n.pmIsDeco=!0,n.appendChild(r),o=MN[0]),r=n}NN(r,o||MN[0],t)}return r}function NN(e,t,n){for(let i in t)"class"==i||"style"==i||"nodeName"==i||i in n||e.removeAttribute(i);for(let i in n)"class"!=i&&"style"!=i&&"nodeName"!=i&&n[i]!=t[i]&&e.setAttribute(i,n[i]);if(t.class!=n.class){let i=t.class?t.class.split(" ").filter(Boolean):[],r=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<i.length;t++)-1==r.indexOf(i[t])&&e.classList.remove(i[t]);for(let t=0;t<r.length;t++)-1==i.indexOf(r[t])&&e.classList.add(r[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n,i=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=i.exec(t.style);)e.style.removeProperty(n[1])}n.style&&(e.style.cssText+=n.style)}}function IN(e,t,n){return RN(e,e,MN,FN(t,n,1!=e.nodeType))}function BN(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function QN(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class LN{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,i=n.children.length,r=e.childCount,s=new Map,o=[];e:for(;r>0;){let a;for(;;)if(i){let e=n.children[i-1];if(!(e instanceof DN)){a=e,i--;break}n=e,i=e.children.length}else{if(n==t)break e;i=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=e.child(r-1))break;--r,s.set(a,r),o.push(a)}}return{index:r,matched:s,matches:o.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n,i){let r=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;r<o&&(r==s-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<s;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let r=-1,o=this.top.children.length;i<this.preMatch.index&&(o=Math.min(this.index+3,o));for(let t=this.index;t<o;t++){let n=this.top.children[t];if(n.matchesMark(e[s])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let i=DN.create(this.top,e[s],t,n);this.top.children.splice(this.index,0,i),this.top=i,this.changed=!0}this.index=0,s++}}findNodeMatch(e,t,n,i){let r,s=-1;if(i>=this.preMatch.index&&(r=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&r.matchesNode(e,t,n))s=this.top.children.indexOf(r,this.index);else for(let o=this.index,a=Math.min(this.top.children.length,o+5);o<a;o++){let i=this.top.children[o];if(i.matchesNode(e,t,n)&&!this.preMatch.matched.has(i)){s=o;break}}return!(s<0)&&(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,n,i,r){let s=this.top.children[i];return 3==s.dirty&&s.dom==s.contentDOM&&(s.dirty=2),!!s.update(e,t,n,r)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,n,i,r,s){for(let o=this.index;o<this.top.children.length;o++){let a=this.top.children[o];if(a instanceof SN){let l=this.preMatch.matched.get(a);if(null!=l&&l!=r)return!1;let c,u=a.dom,h=this.isLocked(u)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&BN(t,a.outerDeco));if(!h&&a.update(e,t,n,i))return this.destroyBetween(this.index,o),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(c=this.recreateWrapper(a,e,t,n,i,s)))return this.destroyBetween(this.index,o),this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(i,s+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,i,r,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!BN(n,e.outerDeco)||!i.eq(e.innerDeco))return null;let o=SN.create(this.top,t,n,i,r,s);if(o.contentDOM){o.children=e.children,e.children=[];for(let e of o.children)e.parent=o}return e.destroy(),o}addNode(e,t,n,i,r){let s=SN.create(this.top,e,t,n,i,r);s.contentDOM&&s.updateChildren(i,r+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(e)||e!=i.widget&&i.widget.type.toDOM.parentNode){let i=new kN(this.top,e,t,n);this.top.children.splice(this.index++,0,i),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof DN;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof AN)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((UR||WR)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let i=new EN(this.top,[],n,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function jN(e,t){return e.type.side-t.type.side}function $N(e,t,n,i,r){let s=[];for(let o=0,a=0;o<e.length;o++){let l=e[o],c=a,u=a+=l.size;c>=n||u<=t?s.push(l):(c<t&&s.push(l.slice(0,t-c,i)),r&&(s.push(r),r=void 0),u>n&&s.push(l.slice(n-c,l.size,i)))}return s}function zN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.domSelectionRange(),i=e.state.doc;if(!n.focusNode)return null;let r=e.docView.nearestDesc(n.focusNode),s=r&&0==r.size,o=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let a,l,c=i.resolve(o);if(PR(n)){for(a=o;r&&!r.node;)r=r.parent;let e=r.node;if(r&&e.isAtom&&sR.isSelectable(e)&&r.parent&&(!e.isInline||!function(e,t,n){for(let i=0==t,r=t==_R(e);i||r;){if(e==n)return!0;let t=kR(e);if(!(e=e.parentNode))return!1;i=i&&0==t,r=r&&t==_R(e)}}(n.focusNode,n.focusOffset,r.dom))){let e=r.posBefore;l=new sR(o==e?c:i.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=o,r=o;for(let i=0;i<n.rangeCount;i++){let s=n.getRangeAt(i);t=Math.min(t,e.docView.posFromDOM(s.startContainer,s.startOffset,1)),r=Math.max(r,e.docView.posFromDOM(s.endContainer,s.endOffset,-1))}if(t<0)return null;[a,o]=r==e.state.selection.anchor?[r,t]:[t,r],c=i.resolve(o)}else a=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let u=i.resolve(a);if(!l){l=GN(e,u,c,"pointer"==t||e.state.selection.head<c.pos&&!s?1:-1)}return l}function WN(e){return e.editable?e.hasFocus():JN(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function VN(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.state.selection;if(HN(e,n),WN(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&WR){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&CR(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection();if(!t)return;let n=e.cursorWrapper.dom,i="IMG"==n.nodeName;i?t.collapse(n.parentNode,kR(n)+1):t.collapse(n,0);!i&&!e.state.selection.visible&&LR&&jR<=11&&(n.disabled=!0,n.disabled=!1)}(e);else{let i,r,{anchor:s,head:o}=n;!UN||n instanceof iR||(n.$from.parent.inlineContent||(i=XN(e,n.from)),n.empty||n.$from.parent.inlineContent||(r=XN(e,n.to))),e.docView.setSelection(s,o,e,t),UN&&(i&&ZN(i),r&&ZN(r)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),i=n.anchorNode,r=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{n.anchorNode==i&&n.anchorOffset==r||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{WN(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const UN=UR||WR&&VR<63;function XN(e,t){let{node:n,offset:i}=e.docView.domFromPos(t,0),r=i<n.childNodes.length?n.childNodes[i]:null,s=i?n.childNodes[i-1]:null;if(UR&&r&&"false"==r.contentEditable)return qN(r);if((!r||"false"==r.contentEditable)&&(!s||"false"==s.contentEditable)){if(r)return qN(r);if(s)return qN(s)}}function qN(e){return e.contentEditable="true",UR&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function ZN(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function HN(e,t){if(t instanceof sR){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(YN(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else YN(e)}function YN(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function GN(e,t,n,i){return e.someProp("createSelectionBetween",i=>i(e,t,n))||iR.between(t,n,i)}function KN(e){return!(e.editable&&!e.hasFocus())&&JN(e)}function JN(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(Jre){return!1}}function eI(e,t){let{$anchor:n,$head:i}=e.selection,r=t>0?n.max(i):n.min(i),s=r.parent.inlineContent?r.depth?e.doc.resolve(t>0?r.after():r.before()):null:r;return s&&JF.findFrom(s,t)}function tI(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function nI(e,t,n){let i=e.state.selection;if(!(i instanceof iR)){if(i instanceof sR&&i.node.isInline)return tI(e,new iR(t>0?i.$to:i.$from));{let n=eI(e.state,t);return!!n&&tI(e,n)}}if(n.indexOf("s")>-1){let{$head:n}=i,r=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!r||r.isText||!r.isLeaf)return!1;let s=e.state.doc.resolve(n.pos+r.nodeSize*(t<0?-1:1));return tI(e,new iR(i.$anchor,s))}if(!i.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=eI(e.state,t);return!!(n&&n instanceof sR)&&tI(e,n)}if(!(qR&&n.indexOf("m")>-1)){let n,r=i.$head,s=r.textOffset?null:t<0?r.nodeBefore:r.nodeAfter;if(!s||s.isText)return!1;let o=t<0?r.pos-s.nodeSize:r.pos;return!!(s.isAtom||(n=e.docView.descAt(o))&&!n.contentDOM)&&(sR.isSelectable(s)?tI(e,new sR(t<0?e.state.doc.resolve(r.pos-s.nodeSize):r)):!!YR&&tI(e,new iR(e.state.doc.resolve(t<0?o:o+s.nodeSize))))}}function iI(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function rI(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function sI(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,i=t.focusOffset;if(!n)return;let r,s,o=!1;$R&&1==n.nodeType&&i<iI(n)&&rI(n.childNodes[i],-1)&&(o=!0);for(;;)if(i>0){if(1!=n.nodeType)break;{let e=n.childNodes[i-1];if(rI(e,-1))r=n,s=--i;else{if(3!=e.nodeType)break;n=e,i=n.nodeValue.length}}}else{if(oI(n))break;{let t=n.previousSibling;for(;t&&rI(t,-1);)r=n.parentNode,s=kR(t),t=t.previousSibling;if(t)n=t,i=iI(n);else{if(n=n.parentNode,n==e.dom)break;i=0}}}o?aI(e,n,i):r&&aI(e,r,s)}(e):function(e){let t=e.domSelectionRange(),n=t.focusNode,i=t.focusOffset;if(!n)return;let r,s,o=iI(n);for(;;)if(i<o){if(1!=n.nodeType)break;if(!rI(n.childNodes[i],1))break;r=n,s=++i}else{if(oI(n))break;{let t=n.nextSibling;for(;t&&rI(t,1);)r=t.parentNode,s=kR(t)+1,t=t.nextSibling;if(t)n=t,i=0,o=iI(n);else{if(n=n.parentNode,n==e.dom)break;i=o=0}}}r&&aI(e,r,s)}(e)}function oI(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function aI(e,t,n){if(3!=t.nodeType){let e,i;(i=function(e,t){for(;e&&t==e.childNodes.length&&!TR(e);)t=kR(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=i,n=0):(e=function(e,t){for(;e&&!t&&!TR(e);)t=kR(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let i=e.domSelection();if(!i)return;if(PR(i)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),i.removeAllRanges(),i.addRange(e)}else i.extend&&i.extend(t,n);e.domObserver.setCurSelection();let{state:r}=e;setTimeout(()=>{e.state==r&&VN(e)},50)}function lI(e,t){let n=e.state.doc.resolve(t);if(!WR&&!ZR&&n.parent.inlineContent){let i=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),r=(n.top+n.bottom)/2;if(r>i.top&&r<i.bottom&&Math.abs(n.left-i.left)>1)return n.left<i.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),r=(n.top+n.bottom)/2;if(r>i.top&&r<i.bottom&&Math.abs(n.left-i.left)>1)return n.left>i.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function cI(e,t,n){let i=e.state.selection;if(i instanceof iR&&!i.empty||n.indexOf("s")>-1)return!1;if(qR&&n.indexOf("m")>-1)return!1;let{$from:r,$to:s}=i;if(!r.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=eI(e.state,t);if(n&&n instanceof sR)return tI(e,n)}if(!r.parent.inlineContent){let n=t<0?r:s,o=i instanceof aR?JF.near(n,t):JF.findFrom(n,t);return!!o&&tI(e,o)}return!1}function uI(e,t){if(!(e.state.selection instanceof iR))return!0;let{$head:n,$anchor:i,empty:r}=e.state.selection;if(!n.sameParent(i))return!0;if(!r)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let i=e.state.tr;return t<0?i.delete(n.pos-s.nodeSize,n.pos):i.delete(n.pos,n.pos+s.nodeSize),e.dispatch(i),!0}return!1}function hI(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function dI(e,t){let n=t.keyCode,i=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==n||qR&&72==n&&"c"==i)return uI(e,-1)||sI(e,-1);if(46==n&&!t.shiftKey||qR&&68==n&&"c"==i)return uI(e,1)||sI(e,1);if(13==n||27==n)return!0;if(37==n||qR&&66==n&&"c"==i){let t=37==n?"ltr"==lI(e,e.state.selection.from)?-1:1:-1;return nI(e,t,i)||sI(e,t)}if(39==n||qR&&70==n&&"c"==i){let t=39==n?"ltr"==lI(e,e.state.selection.from)?1:-1:1;return nI(e,t,i)||sI(e,t)}return 38==n||qR&&80==n&&"c"==i?cI(e,-1,i)||sI(e,-1):40==n||qR&&78==n&&"c"==i?function(e){if(!UR||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;hI(e,n,"true"),setTimeout(()=>hI(e,n,"false"),20)}return!1}(e)||cI(e,1,i)||sI(e,1):i==(qR?"m":"c")&&(66==n||73==n||89==n||90==n)}function pI(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:i,openStart:r,openEnd:s}=t;for(;r>1&&s>1&&1==i.childCount&&1==i.firstChild.childCount;){r--,s--;let e=i.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),i=e.content}let o=e.someProp("clipboardSerializer")||nF.fromSchema(e.state.schema),a=xI(),l=a.createElement("div");l.appendChild(o.serializeFragment(i,{document:a}));let c,u=l.firstChild,h=0;for(;u&&1==u.nodeType&&(c=bI[u.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){let t=a.createElement(c[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),h++}u=l.firstChild}return u&&1==u.nodeType&&u.setAttribute("data-pm-slice","".concat(r," ").concat(s).concat(h?" -".concat(h):""," ").concat(JSON.stringify(n))),{dom:l,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function fI(e,t,n,i,r){let s,o,a=r.parent.type.spec.code;if(!n&&!t)return null;let l=!!t&&(i||a||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,a||i,e)}),a)return o=new aM(tM.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0),e.someProp("transformPasted",t=>{o=t(o,e,!0)}),o;let n=e.someProp("clipboardTextParser",n=>n(t,r,i,e));if(n)o=n;else{let n=r.marks(),{schema:i}=e.state,o=nF.fromSchema(i);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=s.appendChild(document.createElement("p"));e&&t.appendChild(o.serializeNode(i.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),s=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n,i=xI().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(e);(n=r&&bI[r[1].toLowerCase()])&&(e=n.map(e=>"<"+e+">").join("")+e+n.map(e=>"</"+e+">").reverse().join(""));if(i.innerHTML=function(e){let t=window.trustedTypes;if(!t)return e;DI||(DI=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e}));return DI.createHTML(e)}(e),n)for(let s=0;s<n.length;s++)i=i.querySelector(n[s])||i;return i}(n),YR&&function(e){let t=e.querySelectorAll(WR?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let i=t[n];1==i.childNodes.length&&"\xa0"==i.textContent&&i.parentNode&&i.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),i)}}(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let h=+u[3];h>0;h--){let e=s.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;s=e}if(!o){let t=e.someProp("clipboardParser")||e.someProp("domParser")||XM.fromSchema(e.state.schema);o=t.parseSlice(s,{preserveWhitespace:!(!l&&!u),context:r,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||mI.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(u)o=function(e,t){if(!e.size)return e;let n,i=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(Kre){return e}let{content:r,openStart:s,openEnd:o}=e;for(let a=n.length-2;a>=0;a-=2){let e=i.nodes[n[a]];if(!e||e.hasRequiredAttrs())break;r=tM.from(e.create(n[a+1],r)),s++,o++}return new aM(r,s,o)}(wI(o,+u[1],+u[2]),u[4]);else if(o=aM.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let i,r=t.node(n).contentMatchAt(t.index(n)),s=[];if(e.forEach(e=>{if(!s)return;let t,n=r.findWrapping(e.type);if(!n)return s=null;if(t=s.length&&i.length&&vI(n,i,e,s[s.length-1],0))s[s.length-1]=t;else{s.length&&(s[s.length-1]=yI(s[s.length-1],i.length));let t=gI(e,n);s.push(t),r=r.matchType(t.type),i=n}}),s)return tM.from(s)}return e}(o.content,r),!0),o.openStart||o.openEnd){let e=0,t=0;for(let n=o.content.firstChild;e<o.openStart&&!n.type.spec.isolating;e++,n=n.firstChild);for(let n=o.content.lastChild;t<o.openEnd&&!n.type.spec.isolating;t++,n=n.lastChild);o=wI(o,e,t)}return e.someProp("transformPasted",t=>{o=t(o,e,l)}),o}const mI=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function gI(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(let i=t.length-1;i>=n;i--)e=t[i].create(null,tM.from(e));return e}function vI(e,t,n,i,r){if(r<e.length&&r<t.length&&e[r]==t[r]){let s=vI(e,t,n,i.lastChild,r+1);if(s)return i.copy(i.content.replaceChild(i.childCount-1,s));if(i.contentMatchAt(i.childCount).matchType(r==e.length-1?n.type:e[r+1]))return i.copy(i.content.append(tM.from(gI(n,e,r+1))))}}function yI(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,yI(e.lastChild,t-1)),i=e.contentMatchAt(e.childCount).fillBefore(tM.empty,!0);return e.copy(n.append(i))}function OI(e,t,n,i,r,s){let o=t<0?e.firstChild:e.lastChild,a=o.content;return e.childCount>1&&(s=0),r<i-1&&(a=OI(a,t,n,i,r+1,s)),r>=n&&(a=t<0?o.contentMatchAt(0).fillBefore(a,s<=r).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(tM.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,o.copy(a))}function wI(e,t,n){return t<e.openStart&&(e=new aM(OI(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new aM(OI(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const bI={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let kI=null;function xI(){return kI||(kI=document.implementation.createHTMLDocument("title"))}let DI=null;const SI={},CI={},AI={touchstart:!0,touchmove:!0};class EI{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function _I(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function TI(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>PI(e,t))})}function PI(e,t){return e.someProp("handleDOMEvents",n=>{let i=n[t.type];return!!i&&(i(e,t)||t.defaultPrevented)})}function MI(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function FI(e){return{left:e.clientX,top:e.clientY}}function RI(e,t,n,i,r){if(-1==i)return!1;let s=e.state.doc.resolve(i);for(let o=s.depth+1;o>0;o--)if(e.someProp(t,t=>o>s.depth?t(e,n,s.nodeAfter,s.before(o),r,!0):t(e,n,s.node(o),s.before(o),r,!1)))return!0;return!1}function NI(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let i=e.state.tr.setSelection(t);"pointer"==n&&i.setMeta("pointer",!0),e.dispatch(i)}function II(e,t,n,i,r){return RI(e,"handleClickOn",t,n,i)||e.someProp("handleClick",n=>n(e,t,i))||(r?function(e,t){if(-1==t)return!1;let n,i,r=e.state.selection;r instanceof sR&&(n=r.node);let s=e.state.doc.resolve(t);for(let o=s.depth+1;o>0;o--){let e=o>s.depth?s.nodeAfter:s.node(o);if(sR.isSelectable(e)){i=n&&r.$from.depth>0&&o>=r.$from.depth&&s.before(r.$from.depth+1)==r.$from.pos?s.before(r.$from.depth):s.before(o);break}}return null!=i&&(NI(e,sR.create(e.state.doc,i),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),i=n.nodeAfter;return!!(i&&i.isAtom&&sR.isSelectable(i))&&(NI(e,new sR(n),"pointer"),!0)}(e,n))}function BI(e,t,n,i){return RI(e,"handleDoubleClickOn",t,n,i)||e.someProp("handleDoubleClick",n=>n(e,t,i))}function QI(e,t,n,i){return RI(e,"handleTripleClickOn",t,n,i)||e.someProp("handleTripleClick",n=>n(e,t,i))||function(e,t,n){if(0!=n.button)return!1;let i=e.state.doc;if(-1==t)return!!i.inlineContent&&(NI(e,iR.create(i,0,i.content.size),"pointer"),!0);let r=i.resolve(t);for(let s=r.depth+1;s>0;s--){let t=s>r.depth?r.nodeAfter:r.node(s),n=r.before(s);if(t.inlineContent)NI(e,iR.create(i,n+1,n+1+t.content.size),"pointer");else{if(!sR.isSelectable(t))continue;NI(e,sR.create(i,n),"pointer")}return!0}}(e,n,i)}function LI(e){return qI(e)}CI.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!zI(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!HR||!WR||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!XR||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",t=>t(e,n))||dI(e,n)?n.preventDefault():_I(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,MR(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},CI.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},CI.keypress=(e,t)=>{let n=t;if(zI(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||qR&&n.metaKey)return;if(e.someProp("handleKeyPress",t=>t(e,n)))return void n.preventDefault();let i=e.state.selection;if(!(i instanceof iR)||!i.$from.sameParent(i.$to)){let t=String.fromCharCode(n.charCode),r=()=>e.state.tr.insertText(t).scrollIntoView();/[\r\n]/.test(t)||e.someProp("handleTextInput",n=>n(e,i.$from.pos,i.$to.pos,t,r))||e.dispatch(r()),n.preventDefault()}};const jI=qR?"metaKey":"ctrlKey";SI.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let i=LI(e),r=Date.now(),s="singleClick";r-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,i=t.y-e.clientY;return n*n+i*i<100}(n,e.input.lastClick)&&!n[jI]&&e.input.lastClick.button==n.button&&("singleClick"==e.input.lastClick.type?s="doubleClick":"doubleClick"==e.input.lastClick.type&&(s="tripleClick")),e.input.lastClick={time:r,x:n.clientX,y:n.clientY,type:s,button:n.button};let o=e.posAtCoords(FI(n));o&&("singleClick"==s?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new $I(e,o,n,!!i)):("doubleClick"==s?BI:QI)(e,o.pos,o.inside,n)?n.preventDefault():_I(e,"pointer"))};class $I{constructor(e,t,n,i){let r,s;if(this.view=e,this.pos=t,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[jI],this.allowDefault=n.shiftKey,t.inside>-1)r=e.state.doc.nodeAt(t.inside),s=t.inside;else{let n=e.state.doc.resolve(t.pos);r=n.parent,s=n.depth?n.before():0}const o=i?null:n.target,a=o?e.docView.nearestDesc(o,!0):null;this.target=a&&1==a.nodeDOM.nodeType?a.nodeDOM:null;let{selection:l}=e.state;(0==n.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||l instanceof sR&&l.from<=s&&l.to>s)&&(this.mightDrag={node:r,pos:s,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!$R||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),_I(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>VN(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(FI(e))),this.updateAllowDefault(e),this.allowDefault||!t?_I(this.view,"pointer"):II(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||UR&&this.mightDrag&&!this.mightDrag.node.isAtom||WR&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(NI(this.view,JF.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):_I(this.view,"pointer")}move(e){this.updateAllowDefault(e),_I(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function zI(e,t){return!!e.composing||!!(UR&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}SI.touchstart=e=>{e.input.lastTouch=Date.now(),LI(e),_I(e,"pointer")},SI.touchmove=e=>{e.input.lastTouch=Date.now(),_I(e,"pointer")},SI.contextmenu=e=>LI(e);const WI=HR?5e3:-1;function VI(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>qI(e),t))}function UI(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function XI(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=_R(e=e.childNodes[t-1])}else{if(!e.parentNode||TR(e))return null;t=kR(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),i=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||TR(e))return null;t=kR(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&i&&n!=i){let t=i.pmViewDesc,r=e.domObserver.lastChangedTextNode;if(n==r||i==r)return r;if(!t||!t.isText(i.nodeValue))return i;if(e.input.compositionNode==i){let e=n.pmViewDesc;if(e&&e.isText(n.nodeValue))return i}}return n||i}function qI(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(HR&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),UI(e),t||e.docView&&e.docView.dirty){let n=zN(e),i=e.state.selection;return n&&!n.eq(i)?e.dispatch(e.state.tr.setSelection(n)):!e.markCursor&&!t||i.$from.node(i.$from.sharedDepth(i.to)).inlineContent?e.updateState(e.state):e.dispatch(e.state.tr.deleteSelection()),!0}return!1}}CI.compositionstart=CI.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof iR&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)||WR&&ZR&&function(e){let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(!t||1!=t.nodeType||n>=t.childNodes.length)return!1;let i=t.childNodes[n];return 1==i.nodeType&&"false"==i.contentEditable}(e)))e.markCursor=e.state.storedMarks||n.marks(),qI(e,!0),e.markCursor=null;else if(qI(e,!t.selection.empty),$R&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,i=t.focusOffset;n&&1==n.nodeType&&0!=i;){let t=i<0?n.lastChild:n.childNodes[i-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,i=-1}}e.input.composing=!0}VI(e,WI)},CI.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.badSafariComposition?e.domObserver.forceFlush():e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,VI(e,20))};const ZI=LR&&jR<15||XR&&GR<604;function HI(e,t,n,i,r){let s=fI(e,t,n,i,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,r,s||aM.empty)))return!0;if(!s)return!1;let o=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(s),a=o?e.state.tr.replaceSelectionWith(o,i):e.state.tr.replaceSelection(s);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function YI(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}SI.copy=CI.cut=(e,t)=>{let n=t,i=e.state.selection,r="cut"==n.type;if(i.empty)return;let s=ZI?null:n.clipboardData,o=i.content(),{dom:a,text:l}=pI(e,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let i=getSelection(),r=document.createRange();r.selectNodeContents(t),e.dom.blur(),i.removeAllRanges(),i.addRange(r),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,a),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},CI.paste=(e,t)=>{let n=t;if(e.composing&&!HR)return;let i=ZI?null:n.clipboardData,r=e.input.shiftKey&&45!=e.input.lastKeyCode;i&&HI(e,YI(i),i.getData("text/html"),r,n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,i=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(i.contentEditable="true"),i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus();let r=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),i.parentNode&&i.parentNode.removeChild(i),n?HI(e,i.value,null,r,t):HI(e,i.textContent,i.innerHTML,r,t)},50)}(e,n)};class GI{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const KI=qR?"altKey":"ctrlKey";function JI(e,t){let n=e.someProp("dragCopies",e=>!e(t));return null!=n?n:!t[KI]}SI.dragstart=(e,t)=>{let n=t,i=e.input.mouseDown;if(i&&i.done(),!n.dataTransfer)return;let r,s=e.state.selection,o=s.empty?null:e.posAtCoords(FI(n));if(o&&o.pos>=s.from&&o.pos<=(s instanceof sR?s.to-1:s.to));else if(i&&i.mightDrag)r=sR.create(e.state.doc,i.mightDrag.pos);else if(n.target&&1==n.target.nodeType){let t=e.docView.nearestDesc(n.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&(r=sR.create(e.state.doc,t.posBefore))}let a=(r||e.state.selection).content(),{dom:l,text:c,slice:u}=pI(e,a);(!n.dataTransfer.files.length||!WR||VR>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(ZI?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",ZI||n.dataTransfer.setData("text/plain",c),e.dragging=new GI(u,JI(e,n),r)},SI.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},CI.dragover=CI.dragenter=(e,t)=>t.preventDefault(),CI.drop=(e,t)=>{try{!function(e,t,n){if(!t.dataTransfer)return;let i=e.posAtCoords(FI(t));if(!i)return;let r=e.state.doc.resolve(i.pos),s=n&&n.slice;s?e.someProp("transformPasted",t=>{s=t(s,e,!1)}):s=fI(e,YI(t.dataTransfer),ZI?null:t.dataTransfer.getData("text/html"),!1,r);let o=!(!n||!JI(e,t));if(e.someProp("handleDrop",n=>n(e,t,s||aM.empty,o)))return void t.preventDefault();if(!s)return;t.preventDefault();let a=s?IF(e.state.doc,r.pos,s):r.pos;null==a&&(a=r.pos);let l=e.state.tr;if(o){let{node:e}=n;e?e.replace(l):l.deleteSelection()}let c=l.mapping.map(a),u=0==s.openStart&&0==s.openEnd&&1==s.content.childCount,h=l.doc;u?l.replaceRangeWith(c,c,s.content.firstChild):l.replaceRange(c,c,s);if(l.doc.eq(h))return;let d=l.doc.resolve(c);if(u&&sR.isSelectable(s.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(s.content.firstChild))l.setSelection(new sR(d));else{let t=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((e,n,i,r)=>t=r),l.setSelection(GN(e,d,l.doc.resolve(t)))}e.focus(),e.dispatch(l.setMeta("uiEvent","drop"))}(e,t,e.dragging)}finally{e.dragging=null}},SI.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&VN(e)},20))},SI.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},SI.beforeinput=(e,t)=>{if(WR&&HR&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,MR(8,"Backspace"))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}};for(let os in CI)SI[os]=CI[os];function eB(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class tB{constructor(e,t){this.toDOM=e,this.spec=t||oB,this.side=this.spec.side||0}map(e,t,n,i){let{pos:r,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new rB(r-n,r-n,this)}valid(){return!0}eq(e){return this==e||e instanceof tB&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&eB(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class nB{constructor(e,t){this.attrs=e,this.spec=t||oB}map(e,t,n,i){let r=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-n,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-n;return r>=s?null:new rB(r,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof nB&&eB(this.attrs,e.attrs)&&eB(this.spec,e.spec)}static is(e){return e.type instanceof nB}destroy(){}}class iB{constructor(e,t){this.attrs=e,this.spec=t||oB}map(e,t,n,i){let r=e.mapResult(t.from+i,1);if(r.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=r.pos?null:new rB(r.pos-n,s.pos-n,this)}valid(e,t){let n,{index:i,offset:r}=e.content.findIndex(t.from);return r==t.from&&!(n=e.child(i)).isText&&r+n.nodeSize==t.to}eq(e){return this==e||e instanceof iB&&eB(this.attrs,e.attrs)&&eB(this.spec,e.spec)}destroy(){}}class rB{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new rB(e,t,this.type)}eq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new rB(e,e,new tB(t,n))}static inline(e,t,n,i){return new rB(e,t,new nB(n,i))}static node(e,t,n,i){return new rB(e,t,new iB(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof nB}get widget(){return this.type instanceof tB}}const sB=[],oB={};class aB{constructor(e,t){this.local=e.length?e:sB,this.children=t.length?t:sB}static create(e,t){return t.length?pB(t,e,0,oB):lB}find(e,t,n){let i=[];return this.findInner(null==e?0:e,null==t?1e9:t,i,0,n),i}findInner(e,t,n,i,r){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=t&&o.to>=e&&(!r||r(o.spec))&&n.push(o.copy(o.from+i,o.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,t-o,n,i+o,r)}}map(e,t,n){return this==lB||0==e.maps.length?this:this.mapInner(e,t,0,0,n||oB)}mapInner(e,t,n,i,r){let s;for(let o=0;o<this.local.length;o++){let a=this.local[o].map(e,n,i);a&&a.type.valid(t,a)?(s||(s=[])).push(a):r.onRemove&&r.onRemove(this.local[o].spec)}return this.children.length?function(e,t,n,i,r,s,o){let a=e.slice();for(let c=0,u=s;c<n.maps.length;c++){let e=0;n.maps[c].forEach((t,n,i,r)=>{let s=r-i-(n-t);for(let o=0;o<a.length;o+=3){let i=a[o+1];if(i<0||t>i+u-e)continue;let r=a[o]+u-e;n>=r?a[o+1]=t<=r?-2:-1:t>=u&&s&&(a[o]+=s,a[o+1]+=s)}e+=s}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(-2==a[c+1]){l=!0,a[c+1]=-1;continue}let t=n.map(e[c]+s),u=t-r;if(u<0||u>=i.content.size){l=!0;continue}let h=n.map(e[c+1]+s,-1)-r,{index:d,offset:p}=i.content.findIndex(u),f=i.maybeChild(d);if(f&&p==u&&p+f.nodeSize==h){let i=a[c+2].mapInner(n,f,t+1,e[c]+s+1,o);i!=lB?(a[c]=u,a[c+1]=h,a[c+2]=i):(a[c+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,n,i,r,s,o){function a(e,t){for(let s=0;s<e.local.length;s++){let a=e.local[s].map(i,r,t);a?n.push(a):o.onRemove&&o.onRemove(e.local[s].spec)}for(let n=0;n<e.children.length;n+=3)a(e.children[n+2],e.children[n]+t+1)}for(let l=0;l<e.length;l+=3)-1==e[l+1]&&a(e[l+2],t[l]+s+1);return n}(a,e,t,n,r,s,o),c=pB(l,i,0,o);t=c.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<c.children.length;e+=3){let n=c.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,c.children[e],c.children[e+1],c.children[e+2])}}return new aB(t.sort(fB),a)}(this.children,s||[],e,t,n,i,r):s?new aB(s.sort(fB),sB):lB}add(e,t){return t.length?this==lB?aB.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let i,r=0;e.forEach((e,s)=>{let o,a=s+n;if(o=hB(t,e,a)){for(i||(i=this.children.slice());r<i.length&&i[r]<s;)r+=3;i[r]==s?i[r+2]=i[r+2].addInner(e,o,a+1):i.splice(r,0,s,s+e.nodeSize,pB(o,e,a+1,oB)),r+=3}});let s=uB(r?dB(t):t,-n);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||s.splice(o--,1);return new aB(s.length?this.local.concat(s).sort(fB):this.local,i||this.children)}remove(e){return 0==e.length||this==lB?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,i=this.local;for(let r=0;r<n.length;r+=3){let i,s=n[r]+t,o=n[r+1]+t;for(let t,n=0;n<e.length;n++)(t=e[n])&&t.from>s&&t.to<o&&(e[n]=null,(i||(i=[])).push(t));if(!i)continue;n==this.children&&(n=this.children.slice());let a=n[r+2].removeInner(i,s+1);a!=lB?n[r+2]=a:(n.splice(r,3),r-=3)}if(i.length)for(let r,s=0;s<e.length;s++)if(r=e[s])for(let e=0;e<i.length;e++)i[e].eq(r,t)&&(i==this.local&&(i=this.local.slice()),i.splice(e--,1));return n==this.children&&i==this.local?this:i.length||n.length?new aB(i,n):lB}forChild(e,t){if(this==lB)return this;if(t.isLeaf)return aB.empty;let n,i;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}let r=e+1,s=r+t.content.size;for(let o=0;o<this.local.length;o++){let e=this.local[o];if(e.from<s&&e.to>r&&e.type instanceof nB){let t=Math.max(r,e.from)-r,n=Math.min(s,e.to)-r;t<n&&(i||(i=[])).push(e.copy(t,n))}}if(i){let e=new aB(i.sort(fB),sB);return n?new cB([e,n]):e}return n||lB}eq(e){if(this==e)return!0;if(!(e instanceof aB)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return mB(this.localsInner(e))}localsInner(e){if(this==lB)return sB;if(e.inlineContent||!this.local.some(nB.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof nB||t.push(this.local[n]);return t}forEachSet(e){e(this)}}aB.empty=new aB([],[]),aB.removeOverlap=mB;const lB=aB.empty;class cB{constructor(e){this.members=e}map(e,t){const n=this.members.map(n=>n.map(e,t,oB));return cB.from(n)}forChild(e,t){if(t.isLeaf)return aB.empty;let n=[];for(let i=0;i<this.members.length;i++){let r=this.members[i].forChild(e,t);r!=lB&&(r instanceof cB?n=n.concat(r.members):n.push(r))}return cB.from(n)}eq(e){if(!(e instanceof cB)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let i=0;i<this.members.length;i++){let r=this.members[i].localsInner(e);if(r.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<r.length;e++)t.push(r[e])}else t=r}return t?mB(n?t:t.sort(fB)):sB}static from(e){switch(e.length){case 0:return lB;case 1:return e[0];default:return new cB(e.every(e=>e instanceof aB)?e:e.reduce((e,t)=>e.concat(t instanceof aB?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function uB(e,t){if(!t||!e.length)return e;let n=[];for(let i=0;i<e.length;i++){let r=e[i];n.push(new rB(r.from+t,r.to+t,r.type))}return n}function hB(e,t,n){if(t.isLeaf)return null;let i=n+t.nodeSize,r=null;for(let s,o=0;o<e.length;o++)(s=e[o])&&s.from>n&&s.to<i&&((r||(r=[])).push(s),e[o]=null);return r}function dB(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function pB(e,t,n,i){let r=[],s=!1;t.forEach((t,o)=>{let a=hB(e,t,o+n);if(a){s=!0;let e=pB(a,t,n+o+1,i);e!=lB&&r.push(o,o+t.nodeSize,e)}});let o=uB(s?dB(e):e,-n).sort(fB);for(let a=0;a<o.length;a++)o[a].type.valid(t,o[a])||(i.onRemove&&i.onRemove(o[a].spec),o.splice(a--,1));return o.length||r.length?new aB(o,r):lB}function fB(e,t){return e.from-t.from||e.to-t.to}function mB(e){let t=e;for(let n=0;n<t.length-1;n++){let i=t[n];if(i.from!=i.to)for(let r=n+1;r<t.length;r++){let s=t[r];if(s.from!=i.from){s.from<i.to&&(t==e&&(t=e.slice()),t[n]=i.copy(i.from,s.from),gB(t,r,i.copy(s.from,i.to)));break}s.to!=i.to&&(t==e&&(t=e.slice()),t[r]=s.copy(s.from,i.to),gB(t,r+1,s.copy(i.to,s.to)))}}return t}function gB(e,t,n){for(;t<e.length&&fB(n,e[t])>0;)t++;e.splice(t,0,n)}function vB(e){let t=[];return e.someProp("decorations",n=>{let i=n(e.state);i&&i!=lB&&t.push(i)}),e.cursorWrapper&&t.push(aB.create(e.state.doc,[e.cursorWrapper.deco])),cB.from(t)}const yB={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},OB=LR&&jR<=11;class wB{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class bB{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new wB,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(t=>{for(let e=0;e<t.length;e++)this.queue.push(t[e]);LR&&jR<=11&&t.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():UR&&e.composing&&t.some(e=>"childList"==e.type&&"TR"==e.target.nodeName)?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),OB&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,yB)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(KN(this.view)){if(this.suppressingSelectionUpdates)return VN(this.view);if(LR&&jR<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&CR(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,n=new Set;for(let r=e.focusNode;r;r=xR(r))n.add(r);for(let r=e.anchorNode;r;r=xR(r))if(n.has(r)){t=r;break}let i=t&&this.view.docView.nearestDesc(t);return i&&i.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&KN(e)&&!this.ignoreSelectionChange(n),r=-1,s=-1,o=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let e=this.registerMutation(t[c],a);e&&(r=r<0?e.from:Math.min(e.from,r),s=s<0?e.to:Math.max(e.to,s),e.typeOver&&(o=!0))}if(!a.some(e=>"BR"==e.nodeName)||8!=e.input.lastKeyCode&&46!=e.input.lastKeyCode){if($R&&a.length){let t=a.filter(e=>"BR"==e.nodeName);if(2==t.length){let[e,n]=t;e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}else{let{focusNode:n}=this.currentSelection;for(let i of t){let t=i.parentNode;!t||"LI"!=t.nodeName||n&&SB(e,n)==t||i.remove()}}}}else for(let c of a)if("BR"==c.nodeName&&c.parentNode){let e=c.nextSibling;e&&1==e.nodeType&&"false"==e.contentEditable&&c.parentNode.removeChild(c)}let l=null;r<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&PR(n)&&(l=zN(e))&&l.eq(JF.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,VN(e),this.currentSelection.set(n),e.scrollToSelection()):(r>-1||i)&&(r>-1&&(e.docView.markDirty(r,s),function(e){if(kB.has(e))return;if(kB.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)){if(e.requiresGeckoHackNode=$R,xB)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),xB=!0}}(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,function(e,t){var n;let{focusNode:i,focusOffset:r}=e.domSelectionRange();for(let s of t)if("TR"==(null===(n=s.parentNode)||void 0===n?void 0:n.nodeName)){let t=s.nextSibling;for(;t&&"TD"!=t.nodeName&&"TH"!=t.nodeName;)t=t.nextSibling;if(t){let n=t;for(;;){let e=n.firstChild;if(!e||1!=e.nodeType||"false"==e.contentEditable||/^(BR|IMG)$/.test(e.nodeName))break;n=e}n.insertBefore(s,n.firstChild),i==s&&e.domSelection().collapse(s,r)}else s.parentNode.removeChild(s)}}(e,a)),this.handleDOMChange(r,s,o,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||VN(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let i=e.addedNodes[n];t.push(i),3==i.nodeType&&(this.lastChangedTextNode=i)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,r=e.nextSibling;if(LR&&jR<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:s}=e.addedNodes[t];(!n||Array.prototype.indexOf.call(e.addedNodes,n)<0)&&(i=n),(!s||Array.prototype.indexOf.call(e.addedNodes,s)<0)&&(r=s)}let s=i&&i.parentNode==e.target?kR(i)+1:0,o=n.localPosFromDOM(e.target,s,-1),a=r&&r.parentNode==e.target?kR(r):e.target.childNodes.length;return{from:o,to:n.localPosFromDOM(e.target,a,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let kB=new WeakMap,xB=!1;function DB(e,t){let n=t.startContainer,i=t.startOffset,r=t.endContainer,s=t.endOffset,o=e.domAtPos(e.state.selection.anchor);return CR(o.node,o.offset,r,s)&&([n,i,r,s]=[r,s,n,i]),{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}}function SB(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}function CB(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(UR&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||UR&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const AB=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function EB(e,t,n,i,r){let s=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=zN(e,t);if(n&&!e.state.selection.eq(n)){if(WR&&HR&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,MR(13,"Enter"))))return;let i=e.state.tr.setSelection(n);"pointer"==t?i.setMeta("pointer",!0):"key"==t&&i.scrollIntoView(),s&&i.setMeta("composition",s),e.dispatch(i)}return}let o=e.state.doc.resolve(t),a=o.sharedDepth(n);t=o.before(a+1),n=e.state.doc.resolve(n).after(a+1);let l,c,u=e.state.selection,h=function(e,t,n){let i,{node:r,fromOffset:s,toOffset:o,from:a,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),u=c.anchorNode;if(u&&e.dom.contains(1==u.nodeType?u:u.parentNode)&&(i=[{node:u,offset:c.anchorOffset}],PR(c)||i.push({node:c.focusNode,offset:c.focusOffset})),WR&&8===e.input.lastKeyCode)for(let g=o;g>s;g--){let e=r.childNodes[g-1],t=e.pmViewDesc;if("BR"==e.nodeName&&!t){o=g;break}if(!t||t.size)break}let h=e.state.doc,d=e.someProp("domParser")||XM.fromSchema(e.state.schema),p=h.resolve(a),f=null,m=d.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:s,to:o,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:i,ruleFromNode:CB,context:p});if(i&&null!=i[0].pos){let e=i[0].pos,t=i[1]&&i[1].pos;null==t&&(t=e),f={anchor:e+a,head:t+a}}return{doc:m,sel:f,from:a,to:l}}(e,t,n),d=e.state.doc,p=d.slice(h.from,h.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(l=e.state.selection.to,c="end"):(l=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let f=function(e,t,n,i,r){let s=e.findDiffStart(t,n);if(null==s)return null;let{a:o,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==r){i-=o+Math.max(0,s-Math.min(o,a))-s}if(o<s&&e.size<t.size){let e=i<=s&&i>=o?s-i:0;s-=e,s&&s<t.size&&PB(t.textBetween(s-1,s+1))&&(s+=e?1:-1),a=s+(a-o),o=s}else if(a<s){let t=i<=s&&i>=a?s-i:0;s-=t,s&&s<e.size&&PB(e.textBetween(s-1,s+1))&&(s+=t?1:-1),o=s+(o-a),a=s}return{start:s,endA:o,endB:a}}(p.content,h.doc.content,h.from,l,c);if(f&&e.input.domChangeCount++,(XR&&e.input.lastIOSEnter>Date.now()-225||HR)&&r.some(e=>1==e.nodeType&&!AB.test(e.nodeName))&&(!f||f.endA>=f.endB)&&e.someProp("handleKeyDown",t=>t(e,MR(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(!f){if(!(i&&u instanceof iR&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||h.sel&&h.sel.anchor!=h.sel.head){if(h.sel){let t=_B(e,e.state.doc,h.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);s&&n.setMeta("composition",s),e.dispatch(n)}}return}f={start:u.from,endA:u.to,endB:u.to}}e.state.selection.from<e.state.selection.to&&f.start==f.endB&&e.state.selection instanceof iR&&(f.start>e.state.selection.from&&f.start<=e.state.selection.from+2&&e.state.selection.from>=h.from?f.start=e.state.selection.from:f.endA<e.state.selection.to&&f.endA>=e.state.selection.to-2&&e.state.selection.to<=h.to&&(f.endB+=e.state.selection.to-f.endA,f.endA=e.state.selection.to)),LR&&jR<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>h.from&&" \xa0"==h.doc.textBetween(f.start-h.from-1,f.start-h.from+1)&&(f.start--,f.endA--,f.endB--);let m=h.doc.resolveNoCache(f.start-h.from),g=h.doc.resolveNoCache(f.endB-h.from),v=d.resolve(f.start),y=m.sameParent(g)&&m.parent.inlineContent&&v.end()>=f.endA;if((XR&&e.input.lastIOSEnter>Date.now()-225&&(!y||r.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!y&&m.pos<h.doc.content.size&&(!m.sameParent(g)||!m.parent.inlineContent)&&m.pos<g.pos&&!/\S/.test(h.doc.textBetween(m.pos,g.pos,"","")))&&e.someProp("handleKeyDown",t=>t(e,MR(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>f.start&&function(e,t,n,i,r){if(n-t<=r.pos-i.pos||TB(i,!0,!1)<r.pos)return!1;let s=e.resolve(t);if(!i.parent.isTextblock){let e=s.nodeAfter;return null!=e&&n==t+e.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=e.resolve(TB(s,!0,!0));return!(!o.parent.isTextblock||o.pos>n||TB(o,!0,!1)<n)&&i.parent.content.cut(i.parentOffset).eq(o.parent.content)}(d,f.start,f.endA,m,g)&&e.someProp("handleKeyDown",t=>t(e,MR(8,"Backspace"))))return void(HR&&WR&&e.domObserver.suppressSelectionUpdates());WR&&f.endB==f.start&&(e.input.lastChromeDelete=Date.now()),HR&&!y&&m.start()!=g.start()&&0==g.parentOffset&&m.depth==g.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==f.endA&&(f.endB-=2,g=h.doc.resolveNoCache(f.endB-h.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,MR(13,"Enter"))})},20));let O,w=f.start,b=f.endA,k=t=>{let n=t||e.state.tr.replace(w,b,h.doc.slice(f.start-h.from,f.endB-h.from));if(h.sel){let t=_B(e,n.doc,h.sel);t&&!(WR&&e.composing&&t.empty&&(f.start!=f.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==w||t.head==n.mapping.map(b)-1)||LR&&t.empty&&t.head==w)&&n.setSelection(t)}return s&&n.setMeta("composition",s),n.scrollIntoView()};if(y)if(m.pos==g.pos){LR&&jR<=11&&0==m.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>VN(e),20));let t=k(e.state.tr.delete(w,b)),n=d.resolve(f.start).marksAcross(d.resolve(f.endA));n&&t.ensureMarks(n),e.dispatch(t)}else if(f.endA==f.endB&&(O=function(e,t){let n,i,r,s=e.firstChild.marks,o=t.firstChild.marks,a=s,l=o;for(let u=0;u<o.length;u++)a=o[u].removeFromSet(a);for(let u=0;u<s.length;u++)l=s[u].removeFromSet(l);if(1==a.length&&0==l.length)i=a[0],n="add",r=e=>e.mark(i.addToSet(e.marks));else{if(0!=a.length||1!=l.length)return null;i=l[0],n="remove",r=e=>e.mark(i.removeFromSet(e.marks))}let c=[];for(let u=0;u<t.childCount;u++)c.push(r(t.child(u)));if(tM.from(c).eq(e))return{mark:i,type:n}}(m.parent.content.cut(m.parentOffset,g.parentOffset),v.parent.content.cut(v.parentOffset,f.endA-v.start())))){let t=k(e.state.tr);"add"==O.type?t.addMark(w,b,O.mark):t.removeMark(w,b,O.mark),e.dispatch(t)}else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let t=m.parent.textBetween(m.parentOffset,g.parentOffset),n=()=>k(e.state.tr.insertText(t,w,b));e.someProp("handleTextInput",i=>i(e,w,b,t,n))||e.dispatch(n())}else e.dispatch(k());else e.dispatch(k())}function _B(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:GN(e,t.resolve(n.anchor),t.resolve(n.head))}function TB(e,t,n){let i=e.depth,r=t?e.end():e.pos;for(;i>0&&(t||e.indexAfter(i)==e.node(i).childCount);)i--,r++,t=!1;if(n){let t=e.node(i).maybeChild(e.indexAfter(i));for(;t&&!t.isLeaf;)t=t.firstChild,r++}return r}function PB(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class MB{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new EI,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(BB),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=NB(this),RB(this),this.nodeViews=IB(this),this.docView=CN(this.state.doc,FB(this),vB(this),this.dom,this),this.domObserver=new bB(this,(e,t,n,i)=>EB(this,e,t,n,i)),this.domObserver.start(),function(e){for(let t in SI){let n=SI[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!MI(e,t)||PI(e,t)||!e.editable&&t.type in CI||n(e,t)},AI[t]?{passive:!0}:void 0)}UR&&e.dom.addEventListener("input",()=>null),TI(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&TI(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(BB),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let i=this.state,r=!1,s=!1;e.storedMarks&&this.composing&&(UI(this),s=!0),this.state=e;let o=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(o||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=IB(this);(function(e,t){let n=0,i=0;for(let r in e){if(e[r]!=t[r])return!0;n++}for(let r in t)i++;return n!=i})(e,this.nodeViews)&&(this.nodeViews=e,r=!0)}(o||t.handleDOMEvents!=this._props.handleDOMEvents)&&TI(this),this.editable=NB(this),RB(this);let a=vB(this),l=FB(this),c=i.plugins==e.plugins||i.doc.eq(e.doc)?e.scrollToSelection>i.scrollToSelection?"to selection":"preserve":"reset",u=r||!this.docView.matchesNode(e.doc,l,a);!u&&e.selection.eq(i.selection)||(s=!0);let h="preserve"==c&&s&&null==this.dom.style.overflowAnchor&&function(e){let t,n,i=e.dom.getBoundingClientRect(),r=Math.max(0,i.top);for(let s=(i.left+i.right)/2,o=r+1;o<Math.min(innerHeight,i.bottom);o+=5){let i=e.root.elementFromPoint(s,o);if(!i||i==e.dom||!e.dom.contains(i))continue;let a=i.getBoundingClientRect();if(a.top>=r-20){t=i,n=a.top;break}}return{refDOM:t,refTop:n,stack:nN(e.dom)}}(this);if(s){this.domObserver.stop();let t=u&&(LR||WR)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(i.selection,e.selection);if(u){let n=WR?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=XI(this)),!r&&this.docView.update(e.doc,l,a,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=CN(e.doc,l,a,this.dom,this)),!n||this.trackWrites&&this.dom.contains(this.trackWrites)||(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return CR(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?VN(this,t):(HN(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():h&&function(e){let{refDOM:t,refTop:n,stack:i}=e,r=t?t.getBoundingClientRect().top:0;iN(i,0==r?0:r-n)}(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof sR){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&tN(this,t.getBoundingClientRect(),e)}else tN(this,this.coordsAtPos(this.state.selection.head,1),e);else;}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(i=e)}this.dragging=new GI(e.slice,e.move,i<0?void 0:sR.create(this.state.doc,i))}someProp(e,t){let n,i=this._props&&this._props[e];if(null!=i&&(n=t?t(i):i))return n;for(let s=0;s<this.directPlugins.length;s++){let i=this.directPlugins[s].props[e];if(null!=i&&(n=t?t(i):i))return n}let r=this.state.plugins;if(r)for(let s=0;s<r.length;s++){let i=r[s].props[e];if(null!=i&&(n=t?t(i):i))return n}}hasFocus(){if(LR){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(rN)return e.focus(rN);let t=nN(e);e.focus(null==rN?{get preventScroll(){return rN={preventScroll:!0},!0}}:void 0),rN||(rN=!1,iN(t,0))}(this.dom),VN(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return e||document}updateRoot(){this._root=null}posAtCoords(e){return lN(this,e)}coordsAtPos(e){return dN(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}domAtPos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=this.docView.posFromDOM(e,t,n);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return wN(this,t||this.state,e)}pasteHTML(e,t){return HI(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return HI(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return pI(this,e)}destroy(){this.docView&&(!function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],vB(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,DR=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){PI(e,t)||!SI[t.type]||!e.editable&&t.type in CI||SI[t.type](e,t)}(this,e)}domSelectionRange(){let e=this.domSelection();return e?UR&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return DB(e,n)}let n;function i(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",i,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",i,!0),n?DB(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function FB(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[rB.node(0,e.state.doc.content.size,t)]}function RB(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:rB.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function NB(e){return!e.someProp("editable",t=>!1===t(e.state))}function IB(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function BB(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}MB.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};const QB="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),LB="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function jB(e){let t,n,i,r,s=e.split(/-(?!$)/),o=s[s.length-1];"Space"==o&&(o=" ");for(let a=0;a<s.length-1;a++){let e=s[a];if(/^(cmd|meta|m)$/i.test(e))r=!0;else if(/^a(lt)?$/i.test(e))t=!0;else if(/^(c|ctrl|control)$/i.test(e))n=!0;else if(/^s(hift)?$/i.test(e))i=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);QB?r=!0:n=!0}}return t&&(o="Alt-"+o),n&&(o="Ctrl-"+o),r&&(o="Meta-"+o),i&&(o="Shift-"+o),o}function $B(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function zB(e){let t=function(e){let t=Object.create(null);for(let n in e)t[jB(n)]=e[n];return t}(e);return function(e,n){let i,r=Gi(n),s=t[$B(r,n)];if(s&&s(e.state,e.dispatch,e))return!0;if(1==r.length&&" "!=r){if(n.shiftKey){let i=t[$B(r,n,!1)];if(i&&i(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(LB&&n.ctrlKey&&n.altKey)&&(i=Ui[n.keyCode])&&i!=r){let r=t[$B(i,n)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}const WB=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function VB(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}const UB=(e,t,n)=>{let i=VB(e,n);if(!i)return!1;let r=HB(i);if(!r){let n=i.blockRange(),r=n&&AF(n);return null!=r&&(t&&t(e.tr.lift(n,r).scrollIntoView()),!0)}let s=r.nodeBefore;if(aQ(e,r,t,-1))return!0;if(0==i.parent.content.size&&(qB(s,"end")||sR.isSelectable(s)))for(let o=i.depth;;o--){let n=BF(e.doc,i.before(o),i.after(o),aM.empty);if(n&&n.slice.size<n.to-n.from){if(t){let i=e.tr.step(n);i.setSelection(qB(s,"end")?JF.findFrom(i.doc.resolve(i.mapping.map(r.pos,-1)),-1):sR.create(i.doc,r.pos-s.nodeSize)),t(i.scrollIntoView())}return!0}if(1==o||i.node(o-1).childCount>1)break}return!(!s.isAtom||r.depth!=i.depth-1)&&(t&&t(e.tr.delete(r.pos-s.nodeSize,r.pos).scrollIntoView()),!0)};function XB(e,t,n){let i=t.nodeBefore,r=t.pos-1;for(;!i.isTextblock;r--){if(i.type.spec.isolating)return!1;let e=i.lastChild;if(!e)return!1;i=e}let s=t.nodeAfter,o=t.pos+1;for(;!s.isTextblock;o++){if(s.type.spec.isolating)return!1;let e=s.firstChild;if(!e)return!1;s=e}let a=BF(e.doc,r,o,aM.empty);if(!a||a.from!=r||a instanceof kF&&a.slice.size>=o-r)return!1;if(n){let t=e.tr.step(a);t.setSelection(iR.create(t.doc,r)),n(t.scrollIntoView())}return!0}function qB(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let i=e;i;i="start"==t?i.firstChild:i.lastChild){if(i.isTextblock)return!0;if(n&&1!=i.childCount)return!1}return!1}const ZB=(e,t,n)=>{let{$head:i,empty:r}=e.selection,s=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):i.parentOffset>0)return!1;s=HB(i)}let o=s&&s.nodeBefore;return!(!o||!sR.isSelectable(o))&&(t&&t(e.tr.setSelection(sR.create(e.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function HB(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function YB(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}const GB=(e,t,n)=>{let i=YB(e,n);if(!i)return!1;let r=JB(i);if(!r)return!1;let s=r.nodeAfter;if(aQ(e,r,t,1))return!0;if(0==i.parent.content.size&&(qB(s,"start")||sR.isSelectable(s))){let n=BF(e.doc,i.before(),i.after(),aM.empty);if(n&&n.slice.size<n.to-n.from){if(t){let i=e.tr.step(n);i.setSelection(qB(s,"start")?JF.findFrom(i.doc.resolve(i.mapping.map(r.pos)),1):sR.create(i.doc,i.mapping.map(r.pos))),t(i.scrollIntoView())}return!0}}return!(!s.isAtom||r.depth!=i.depth-1)&&(t&&t(e.tr.delete(r.pos,r.pos+s.nodeSize).scrollIntoView()),!0)},KB=(e,t,n)=>{let{$head:i,empty:r}=e.selection,s=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):i.parentOffset<i.parent.content.size)return!1;s=JB(i)}let o=s&&s.nodeAfter;return!(!o||!sR.isSelectable(o))&&(t&&t(e.tr.setSelection(sR.create(e.doc,s.pos)).scrollIntoView()),!0)};function JB(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}const eQ=(e,t)=>{let{$head:n,$anchor:i}=e.selection;return!(!n.parent.type.spec.code||!n.sameParent(i))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function tQ(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const nQ=(e,t)=>{let{$head:n,$anchor:i}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(i))return!1;let r=n.node(-1),s=n.indexAfter(-1),o=tQ(r.contentMatchAt(s));if(!o||!r.canReplaceWith(s,s,o))return!1;if(t){let i=n.after(),r=e.tr.replaceWith(i,i,o.createAndFill());r.setSelection(JF.near(r.doc.resolve(i),1)),t(r.scrollIntoView())}return!0},iQ=(e,t)=>{let n=e.selection,{$from:i,$to:r}=n;if(n instanceof aR||i.parent.inlineContent||r.parent.inlineContent)return!1;let s=tQ(r.parent.contentMatchAt(r.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let n=(!i.parentOffset&&r.index()<r.parent.childCount?i:r).pos,o=e.tr.insert(n,s.createAndFill());o.setSelection(iR.create(o.doc,n+1)),t(o.scrollIntoView())}return!0},rQ=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if(MF(e.doc,i))return t&&t(e.tr.split(i).scrollIntoView()),!0}let i=n.blockRange(),r=i&&AF(i);return null!=r&&(t&&t(e.tr.lift(i,r).scrollIntoView()),!0)};const sQ=(e,t)=>{let{$from:n,$to:i}=e.selection;if(e.selection instanceof sR&&e.selection.node.isBlock)return!(!n.parentOffset||!MF(e.doc,n.pos))&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let r,s,o=[],a=!1,l=!1;for(let d=n.depth;;d--){if(n.node(d).isBlock){a=n.end(d)==n.pos+(n.depth-d),l=n.start(d)==n.pos-(n.depth-d),s=tQ(n.node(d-1).contentMatchAt(n.indexAfter(d-1)));let e=oQ&&oQ(i.parent,a,n);o.unshift(e||(a&&s?{type:s}:null)),r=d;break}if(1==d)return!1;o.unshift(null)}let c=e.tr;(e.selection instanceof iR||e.selection instanceof aR)&&c.deleteSelection();let u=c.mapping.map(n.pos),h=MF(c.doc,u,o.length,o);if(h||(o[0]=s?{type:s}:null,h=MF(c.doc,u,o.length,o)),!h)return!1;if(c.split(u,o.length,o),!a&&l&&n.node(r).type!=s){let e=c.mapping.map(n.before(r)),t=c.doc.resolve(e);s&&n.node(r-1).canReplaceWith(t.index(),t.index()+1,s)&&c.setNodeMarkup(c.mapping.map(n.before(r)),s)}return t&&t(c.scrollIntoView()),!0};var oQ;function aQ(e,t,n,i){let r,s,o=t.nodeBefore,a=t.nodeAfter,l=o.type.spec.isolating||a.type.spec.isolating;if(!l&&function(e,t,n){let i=t.nodeBefore,r=t.nodeAfter,s=t.index();return!!(i&&r&&i.type.compatibleContent(r.type))&&(!i.content.size&&t.parent.canReplace(s-1,s)?(n&&n(e.tr.delete(t.pos-i.nodeSize,t.pos).scrollIntoView()),!0):!(!t.parent.canReplace(s,s+1)||!r.isTextblock&&!FF(e.doc,t.pos))&&(n&&n(e.tr.join(t.pos).scrollIntoView()),!0))}(e,t,n))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(r=(s=o.contentMatchAt(o.childCount)).findWrapping(a.type))&&s.matchType(r[0]||a.type).validEnd){if(n){let i=t.pos+a.nodeSize,s=tM.empty;for(let e=r.length-1;e>=0;e--)s=tM.from(r[e].create(null,s));s=tM.from(o.copy(s));let l=e.tr.step(new xF(t.pos-1,i,t.pos,i,new aM(s,1,0),r.length,!0)),c=l.doc.resolve(i+2*r.length);c.nodeAfter&&c.nodeAfter.type==o.type&&FF(l.doc,c.pos)&&l.join(c.pos),n(l.scrollIntoView())}return!0}let u=a.type.spec.isolating||i>0&&l?null:JF.findFrom(t,1),h=u&&u.$from.blockRange(u.$to),d=h&&AF(h);if(null!=d&&d>=t.depth)return n&&n(e.tr.lift(h,d).scrollIntoView()),!0;if(c&&qB(a,"start",!0)&&qB(o,"end")){let i=o,r=[];for(;r.push(i),!i.isTextblock;)i=i.lastChild;let s=a,l=1;for(;!s.isTextblock;s=s.firstChild)l++;if(i.canReplace(i.childCount,i.childCount,s.content)){if(n){let i=tM.empty;for(let e=r.length-1;e>=0;e--)i=tM.from(r[e].copy(i));n(e.tr.step(new xF(t.pos-r.length,t.pos+a.nodeSize,t.pos+l,t.pos+a.nodeSize-l,new aM(i,r.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function lQ(e){return function(t,n){let i=t.selection,r=e<0?i.$from:i.$to,s=r.depth;for(;r.node(s).isInline;){if(!s)return!1;s--}return!!r.node(s).isTextblock&&(n&&n(t.tr.setSelection(iR.create(t.doc,e<0?r.start(s):r.end(s)))),!0)}}const cQ=lQ(-1),uQ=lQ(1);function hQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,i){let r=!1;for(let s=0;s<n.selection.ranges.length&&!r;s++){let{$from:{pos:i},$to:{pos:o}}=n.selection.ranges[s];n.doc.nodesBetween(i,o,(i,s)=>{if(r)return!1;if(i.isTextblock&&!i.hasMarkup(e,t))if(i.type==e)r=!0;else{let t=n.doc.resolve(s),i=t.index();r=t.parent.canReplaceWith(i,i+1,e)}})}if(!r)return!1;if(i){let r=n.tr;for(let i=0;i<n.selection.ranges.length;i++){let{$from:{pos:s},$to:{pos:o}}=n.selection.ranges[i];r.setBlockType(s,o,e,t)}i(r.scrollIntoView())}return!0}}function dQ(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n,i){for(let r=0;r<t.length;r++)if(t[r](e,n,i))return!0;return!1}}let pQ=dQ(WB,UB,ZB),fQ=dQ(WB,GB,KB);const mQ={Enter:dQ(eQ,iQ,rQ,sQ),"Mod-Enter":nQ,Backspace:pQ,"Mod-Backspace":pQ,"Shift-Backspace":pQ,Delete:fQ,"Mod-Delete":fQ,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new aR(e.doc))),!0)},gQ={"Ctrl-h":mQ.Backspace,"Alt-Backspace":mQ["Mod-Backspace"],"Ctrl-d":mQ.Delete,"Ctrl-Alt-Backspace":mQ["Mod-Delete"],"Alt-Delete":mQ["Mod-Delete"],"Alt-d":mQ["Mod-Delete"],"Ctrl-a":cQ,"Ctrl-e":uQ};for(let os in mQ)gQ[os]=mQ[os];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!("undefined"==typeof os||!os.platform)&&os.platform();function vQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,i){let{$from:r,$to:s}=n.selection,o=r.blockRange(s);if(!o)return!1;let a=i?n.tr:null;return!!function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!1,s=t,o=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=o.resolve(t.start-2);s=new xM(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new xM(t.$from,o.resolve(t.$to.end(t.depth)),t.depth)),r=!0}let a=EF(s,n,i,t);if(!a)return!1;e&&function(e,t,n,i,r){let s=tM.empty;for(let u=n.length-1;u>=0;u--)s=tM.from(n[u].type.create(n[u].attrs,s));e.step(new xF(t.start-(i?2:0),t.end,t.start,t.end,new aM(s,0,0),n.length,!0));let o=0;for(let u=0;u<n.length;u++)n[u].type==r&&(o=u+1);let a=n.length-o,l=t.start+n.length-(i?2:0),c=t.parent;for(let u=t.startIndex,h=t.endIndex,d=!0;u<h;u++,d=!1)!d&&MF(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(u).nodeSize}(e,t,a,r,n);return!0}(a,o,e,t)&&(i&&i(a.scrollIntoView()),!0)}}function yQ(e){return function(t,n){let{$from:i,$to:r}=t.selection,s=i.blockRange(r,t=>t.childCount>0&&t.firstChild.type==e);return!!s&&(!n||(i.node(s.depth-1).type==e?function(e,t,n,i){let r=e.tr,s=i.end,o=i.$to.end(i.depth);s<o&&(r.step(new xF(s-1,o,s,o,new aM(tM.from(n.create(null,i.parent.copy())),1,0),1,!0)),i=new xM(r.doc.resolve(i.$from.pos),r.doc.resolve(o),i.depth));const a=AF(i);if(null==a)return!1;r.lift(i,a);let l=r.doc.resolve(r.mapping.map(s,-1)-1);FF(r.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&r.join(l.pos);return t(r.scrollIntoView()),!0}(t,n,e,s):function(e,t,n){let i=e.tr,r=n.parent;for(let p=n.end,f=n.endIndex-1,m=n.startIndex;f>m;f--)p-=r.child(f).nodeSize,i.delete(p-1,p+1);let s=i.doc.resolve(n.start),o=s.nodeAfter;if(i.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==r.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?tM.empty:tM.from(r))))return!1;let h=s.pos,d=h+o.nodeSize;return i.step(new xF(h-(a?1:0),d+(l?1:0),h+1,d-1,new aM((a?tM.empty:tM.from(r.copy(tM.empty))).append(l?tM.empty:tM.from(r.copy(tM.empty))),a?0:1,l?0:1),a?0:1)),t(i.scrollIntoView()),!0}(t,n,s)))}}function OQ(e){const{state:t,transaction:n}=e;let{selection:i}=n,{doc:r}=n,{storedMarks:s}=n;return p(p({},t),{},{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return s},get selection(){return i},get doc(){return r},get tr(){return i=n.selection,r=n.doc,s=n.storedMarks,n}})}class wQ{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){var e=this;const{rawCommands:t,editor:n,state:i}=this,{view:r}=n,{tr:s}=i,o=this.buildProps(s);return Object.fromEntries(Object.entries(t).map(t=>{let[n,i]=t;return[n,function(){const t=i(...arguments)(o);return s.getMeta("preventDispatch")||e.hasCustomState||r.dispatch(s),t}]}))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:i,editor:r,state:s}=this,{view:o}=r,a=[],l=!!e,c=e||s.tr,u=p(p({},Object.fromEntries(Object.entries(i).map(e=>{let[i,r]=e;return[i,function(){const e=t.buildProps(c,n),i=r(...arguments)(e);return a.push(i),u}]}))),{},{run:()=>(l||!n||c.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(c),a.every(e=>!0===e))});return u}createCan(e){const{rawCommands:t,state:n}=this,i=!1,r=e||n.tr,s=this.buildProps(r,i),o=Object.fromEntries(Object.entries(t).map(e=>{let[t,n]=e;return[t,function(){return n(...arguments)(p(p({},s),{},{dispatch:void 0}))}]}));return p(p({},o),{},{chain:()=>this.createChain(r,i)})}buildProps(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:n,editor:i,state:r}=this,{view:s}=i,o={tr:e,editor:i,view:s,state:OQ({state:r,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(e=>{let[t,n]=e;return[t,function(){return n(...arguments)(o)}]}))}};return o}}class bQ{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=this.callbacks[e];return r&&r.forEach(e=>e.apply(this,n)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}once(e,t){var n=this;const i=function(){n.off(e,i);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];t.apply(n,s)};return this.on(e,i)}removeAllListeners(){this.callbacks={}}}function kQ(e,t,n){if(void 0===e.config[t]&&e.parent)return kQ(e.parent,t,n);if("function"===typeof e.config[t]){return e.config[t].bind(p(p({},n),{},{parent:e.parent?kQ(e.parent,t,n):null}))}return e.config[t]}function xQ(e){const t=e.filter(e=>"extension"===e.type),n=e.filter(e=>"node"===e.type),i=e.filter(e=>"mark"===e.type);return{baseExtensions:t,nodeExtensions:n,markExtensions:i}}function DQ(e){const t=[],{nodeExtensions:n,markExtensions:i}=xQ(e),r=[...n,...i],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{const n=kQ(e,"addGlobalAttributes",{name:e.name,options:e.options,storage:e.storage,extensions:r});if(!n)return;n().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(e=>{let[i,r]=e;t.push({type:n,name:i,attribute:p(p({},s),r)})})})})}),r.forEach(e=>{const n={name:e.name,options:e.options,storage:e.storage},i=kQ(e,"addAttributes",n);if(!i)return;const r=i();Object.entries(r).forEach(n=>{let[i,r]=n;const o=p(p({},s),r);"function"===typeof(null===o||void 0===o?void 0:o.default)&&(o.default=o.default()),(null===o||void 0===o?void 0:o.isRequired)&&void 0===(null===o||void 0===o?void 0:o.default)&&delete o.default,t.push({type:e.name,name:i,attribute:o})})}),t}function SQ(e,t){if("string"===typeof e){if(!t.nodes[e])throw Error("There is no node type named '".concat(e,"'. Maybe you forgot to add the extension?"));return t.nodes[e]}return e}function CQ(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(e=>!!e).reduce((e,t)=>{const n=p({},e);return Object.entries(t).forEach(e=>{let[t,i]=e;if(n[t])if("class"===t){const e=i?String(i).split(" "):[],r=n[t]?n[t].split(" "):[],s=e.filter(e=>!r.includes(e));n[t]=[...r,...s].join(" ")}else if("style"===t){const e=i?i.split(";").map(e=>e.trim()).filter(Boolean):[],r=n[t]?n[t].split(";").map(e=>e.trim()).filter(Boolean):[],s=new Map;r.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());s.set(t,n)}),e.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());s.set(t,n)}),n[t]=Array.from(s.entries()).map(e=>{let[t,n]=e;return"".concat(t,": ").concat(n)}).join("; ")}else n[t]=i;else n[t]=i}),n},{})}function AQ(e,t){return t.filter(t=>t.type===e.type.name).filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>CQ(e,t),{})}function EQ(e){return"function"===typeof e}function _Q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(EQ(e)){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return t?e.bind(t)(...i):e(...i)}return e}function TQ(e,t){return"style"in e?e:p(p({},e),{},{getAttrs:n=>{const i=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===i)return!1;const r=t.reduce((e,t)=>{const i=t.attribute.parseHTML?t.attribute.parseHTML(n):function(e){return"string"!==typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(n.getAttribute(t.name));return null===i||void 0===i?e:p(p({},e),{},{[t.name]:i})},{});return p(p({},i),r)}})}function PQ(e){return Object.fromEntries(Object.entries(e).filter(e=>{let[t,n]=e;return("attrs"!==t||!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(e).length&&e.constructor===Object}(n))&&(null!==n&&void 0!==n)}))}function MQ(e,t){var n;const i=DQ(e),{nodeExtensions:r,markExtensions:s}=xQ(e),o=null===(n=r.find(e=>kQ(e,"topNode")))||void 0===n?void 0:n.name,a=Object.fromEntries(r.map(n=>{const r=i.filter(e=>e.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:t},o=e.reduce((e,t)=>{const i=kQ(t,"extendNodeSchema",s);return p(p({},e),i?i(n):{})},{}),a=PQ(p(p({},o),{},{content:_Q(kQ(n,"content",s)),marks:_Q(kQ(n,"marks",s)),group:_Q(kQ(n,"group",s)),inline:_Q(kQ(n,"inline",s)),atom:_Q(kQ(n,"atom",s)),selectable:_Q(kQ(n,"selectable",s)),draggable:_Q(kQ(n,"draggable",s)),code:_Q(kQ(n,"code",s)),whitespace:_Q(kQ(n,"whitespace",s)),linebreakReplacement:_Q(kQ(n,"linebreakReplacement",s)),defining:_Q(kQ(n,"defining",s)),isolating:_Q(kQ(n,"isolating",s)),attrs:Object.fromEntries(r.map(e=>{var t;return[e.name,{default:null===(t=null===e||void 0===e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))})),l=_Q(kQ(n,"parseHTML",s));l&&(a.parseDOM=l.map(e=>TQ(e,r)));const c=kQ(n,"renderHTML",s);c&&(a.toDOM=e=>c({node:e,HTMLAttributes:AQ(e,r)}));const u=kQ(n,"renderText",s);return u&&(a.toText=u),[n.name,a]})),l=Object.fromEntries(s.map(n=>{const r=i.filter(e=>e.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:t},o=e.reduce((e,t)=>{const i=kQ(t,"extendMarkSchema",s);return p(p({},e),i?i(n):{})},{}),a=PQ(p(p({},o),{},{inclusive:_Q(kQ(n,"inclusive",s)),excludes:_Q(kQ(n,"excludes",s)),group:_Q(kQ(n,"group",s)),spanning:_Q(kQ(n,"spanning",s)),code:_Q(kQ(n,"code",s)),attrs:Object.fromEntries(r.map(e=>{var t;return[e.name,{default:null===(t=null===e||void 0===e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))})),l=_Q(kQ(n,"parseHTML",s));l&&(a.parseDOM=l.map(e=>TQ(e,r)));const c=kQ(n,"renderHTML",s);return c&&(a.toDOM=e=>c({mark:e,HTMLAttributes:AQ(e,r)})),[n.name,a]}));return new VM({topNode:o,nodes:a,marks:l})}function FQ(e,t){return t.nodes[e]||t.marks[e]||null}function RQ(e,t){return Array.isArray(t)?t.some(t=>("string"===typeof t?t:t.name)===e.name):t}function NQ(e,t){const n=nF.fromSchema(t).serializeFragment(e),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}function IQ(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class BQ{constructor(e){this.find=e.find,this.handler=e.handler}}function QQ(e){var t;const{editor:n,from:i,to:r,text:s,rules:o,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(i);if(c.parent.type.spec.code||(null===(t=c.nodeBefore||c.nodeAfter)||void 0===t?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let u=!1;const h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n="";const i=e.parentOffset;return e.parent.nodesBetween(Math.max(0,i-t),i,(e,t,r,s)=>{var o,a;const l=(null===(a=(o=e.type.spec).toText)||void 0===a?void 0:a.call(o,{node:e,pos:t,parent:r,index:s}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,i-t))}),n}(c)+s;return o.forEach(e=>{if(u)return;const t=((e,t)=>{if(IQ(t))return t.exec(e);const n=t(e);if(!n)return null;const i=[n.text];return i.index=n.index,i.input=e,i.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),i.push(n.replaceWith)),i})(h,e.find);if(!t)return;const o=l.state.tr,c=OQ({state:l.state,transaction:o}),d={from:i-(t[0].length-s.length),to:r},{commands:p,chain:f,can:m}=new wQ({editor:n,state:c});null!==e.handler({state:c,range:d,match:t,commands:p,chain:f,can:m})&&o.steps.length&&(o.setMeta(a,{transform:o,from:i,to:r,text:s}),l.dispatch(o),u=!0)}),u}function LQ(e){const{editor:t,rules:n}=e,i=new yR({state:{init:()=>null,apply(e,r,s){const o=e.getMeta(i);if(o)return o;const a=e.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:e}=a;"string"===typeof e||(e=NQ(tM.from(e),s.schema));const{from:r}=a,o=r+e.length;QQ({editor:t,from:r,to:o,text:e,rules:n,plugin:i})}),e.selectionSet||e.docChanged?null:r}},props:{handleTextInput:(e,r,s,o)=>QQ({editor:t,from:r,to:s,text:o,rules:n,plugin:i}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{const{$cursor:r}=e.state.selection;r&&QQ({editor:t,from:r.pos,to:r.pos,text:"",rules:n,plugin:i})}),!1)},handleKeyDown(e,r){if("Enter"!==r.key)return!1;const{$cursor:s}=e.state.selection;return!!s&&QQ({editor:t,from:s.pos,to:s.pos,text:"\n",rules:n,plugin:i})}},isInputRules:!0});return i}function jQ(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&(e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype)}function $Q(e,t){const n=p({},e);return jQ(e)&&jQ(t)&&Object.keys(t).forEach(i=>{jQ(t[i])&&jQ(e[i])?n[i]=$Q(e[i],t[i]):n[i]=t[i]}),n}class zQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=p(p({},this.config),e),this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'.concat(this.name,'".')),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_Q(kQ(this,"addOptions",{name:this.name}))),this.storage=_Q(kQ(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(){return new zQ(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend(p(p({},this.config),{},{addOptions:()=>$Q(this.options,e)}));return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new zQ(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'.concat(t.name,'".')),t.options=_Q(kQ(t,"addOptions",{name:t.name})),t.storage=_Q(kQ(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit(e){let{editor:t,mark:n}=e;const{tr:i}=t.state,r=t.state.selection.$from;if(r.pos===r.end()){const e=r.marks();if(!!!e.find(e=>(null===e||void 0===e?void 0:e.type.name)===n.name))return!1;const s=e.find(e=>(null===e||void 0===e?void 0:e.type.name)===n.name);return s&&i.removeStoredMark(s),i.insertText(" ",r.pos),t.view.dispatch(i),!0}return!1}}class WQ{constructor(e){this.find=e.find,this.handler=e.handler}}function VQ(e){const{editor:t,state:n,from:i,to:r,rule:s,pasteEvent:o,dropEvent:a}=e,{commands:l,chain:c,can:u}=new wQ({editor:t,state:n}),h=[];n.doc.nodesBetween(i,r,(e,t)=>{if(!e.isTextblock||e.type.spec.code)return;const d=Math.max(i,t),p=Math.min(r,t+e.content.size),f=((e,t,n)=>{if(IQ(t))return[...e.matchAll(t)];const i=t(e,n);return i?i.map(t=>{const n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]})(e.textBetween(d-t,p-t,void 0,"\ufffc"),s.find,o);f.forEach(e=>{if(void 0===e.index)return;const t=d+e.index+1,i=t+e[0].length,r={from:n.tr.mapping.map(t),to:n.tr.mapping.map(i)},p=s.handler({state:n,range:r,match:e,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});h.push(p)})});return h.every(e=>null!==e)}let UQ=null;function XQ(e){const{editor:t,rules:n}=e;let i,r=null,s=!1,o=!1,a="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{i="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch(u){i=null}const l=e=>{let{state:n,from:r,to:s,rule:o,pasteEvt:l}=e;const c=n.tr,u=OQ({state:n,transaction:c});if(VQ({editor:t,state:u,from:Math.max(r-1,0),to:s.b-1,rule:o,pasteEvent:l,dropEvent:i})&&c.steps.length){try{i="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch(h){i=null}return a="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null,c}},c=n.map(e=>new yR({view(e){const n=n=>{var i;r=(null===(i=e.dom.parentElement)||void 0===i?void 0:i.contains(n.target))?e.dom.parentElement:null,r&&(UQ=t)},i=()=>{UQ&&(UQ=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",i),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",i)}}},props:{handleDOMEvents:{drop:(e,t)=>{if(o=r===e.dom.parentElement,i=t,!o){const e=UQ;(null===e||void 0===e?void 0:e.isEditable)&&setTimeout(()=>{const t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:(e,t)=>{var n;const i=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/html");return a=t,s=!!(null===i||void 0===i?void 0:i.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,i)=>{const r=t[0],c="paste"===r.getMeta("uiEvent")&&!s,u="drop"===r.getMeta("uiEvent")&&!o,h=r.getMeta("applyPasteRules"),d=!!h;if(!c&&!u&&!d)return;if(d){let{text:t}=h;"string"===typeof t||(t=NQ(tM.from(t),i.schema));const{from:n}=h,r=n+t.length,s=(e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null===(t=n.clipboardData)||void 0===t||t.setData("text/html",e),n})(t);return l({rule:e,state:i,from:n,to:{b:r},pasteEvt:s})}const p=n.doc.content.findDiffStart(i.doc.content),f=n.doc.content.findDiffEnd(i.doc.content);return function(e){return"number"===typeof e}(p)&&f&&p!==f.b?l({rule:e,state:i,from:p,to:f,pasteEvt:a}):void 0}}));return c}class qQ{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=qQ.resolve(e),this.schema=MQ(this.extensions,t),this.setupExtensions()}static resolve(e){const t=qQ.sort(qQ.flatten(e)),n=function(e){const t=e.filter((t,n)=>e.indexOf(t)!==n);return Array.from(new Set(t))}(t.map(e=>e.name));return n.length&&console.warn("[tiptap warn]: Duplicate extension names found: [".concat(n.map(e=>"'".concat(e,"'")).join(", "),"]. This can lead to issues.")),t}static flatten(e){return e.map(e=>{const t=kQ(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return t?[e,...this.flatten(t())]:e}).flat(10)}static sort(e){return e.sort((e,t)=>{const n=kQ(e,"priority")||100,i=kQ(t,"priority")||100;return n>i?-1:n<i?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const n=kQ(t,"addCommands",{name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:FQ(t.name,this.schema)});return n?p(p({},e),n()):e},{})}get plugins(){const{editor:e}=this,t=qQ.sort([...this.extensions].reverse()),n=[],i=[],r=t.map(t=>{const r={name:t.name,options:t.options,storage:t.storage,editor:e,type:FQ(t.name,this.schema)},s=[],o=kQ(t,"addKeyboardShortcuts",r);let a={};if("mark"===t.type&&kQ(t,"exitable",r)&&(a.ArrowRight=()=>zQ.handleExit({editor:e,mark:t})),o){const t=Object.fromEntries(Object.entries(o()).map(t=>{let[n,i]=t;return[n,()=>i({editor:e})]}));a=p(p({},a),t)}const l=new yR({props:{handleKeyDown:zB(a)}});s.push(l);const c=kQ(t,"addInputRules",r);RQ(t,e.options.enableInputRules)&&c&&n.push(...c());const u=kQ(t,"addPasteRules",r);RQ(t,e.options.enablePasteRules)&&u&&i.push(...u());const h=kQ(t,"addProseMirrorPlugins",r);if(h){const e=h();s.push(...e)}return s}).flat();return[LQ({editor:e,rules:n}),...XQ({editor:e,rules:i}),...r]}get attributes(){return DQ(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=xQ(this.extensions);return Object.fromEntries(t.filter(e=>!!kQ(e,"addNodeView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),i={name:t.name,options:t.options,storage:t.storage,editor:e,type:SQ(t.name,this.schema)},r=kQ(t,"addNodeView",i);if(!r)return[];return[t.name,(i,s,o,a,l)=>{const c=AQ(i,n);return r()({node:i,view:s,getPos:o,decorations:a,innerDecorations:l,editor:e,extension:t,HTMLAttributes:c})}]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:FQ(e.name,this.schema)};if("mark"===e.type){(null===(t=_Q(kQ(e,"keepOnSplit",n)))||void 0===t||t)&&this.splittableMarks.push(e.name)}const i=kQ(e,"onBeforeCreate",n),r=kQ(e,"onCreate",n),s=kQ(e,"onUpdate",n),o=kQ(e,"onSelectionUpdate",n),a=kQ(e,"onTransaction",n),l=kQ(e,"onFocus",n),c=kQ(e,"onBlur",n),u=kQ(e,"onDestroy",n);i&&this.editor.on("beforeCreate",i),r&&this.editor.on("create",r),s&&this.editor.on("update",s),o&&this.editor.on("selectionUpdate",o),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),u&&this.editor.on("destroy",u)})}}class ZQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=p(p({},this.config),e),this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'.concat(this.name,'".')),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_Q(kQ(this,"addOptions",{name:this.name}))),this.storage=_Q(kQ(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(){return new ZQ(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend(p(p({},this.config),{},{addOptions:()=>$Q(this.options,e)}));return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new ZQ(p(p({},this.config),e));return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'.concat(t.name,'".')),t.options=_Q(kQ(t,"addOptions",{name:t.name})),t.storage=_Q(kQ(t,"addStorage",{name:t.name,options:t.options})),t}}function HQ(e,t,n){const{from:i,to:r}=t,{blockSeparator:s="\n\n",textSerializers:o={}}=n||{};let a="";return e.nodesBetween(i,r,(e,n,l,c)=>{var u;e.isBlock&&n>i&&(a+=s);const h=null===o||void 0===o?void 0:o[e.type.name];if(h)return l&&(a+=h({node:e,pos:n,parent:l,index:c,range:t})),!1;e.isText&&(a+=null===(u=null===e||void 0===e?void 0:e.text)||void 0===u?void 0:u.slice(Math.max(i,n)-n,r-n))}),a}function YQ(e){return Object.fromEntries(Object.entries(e.nodes).filter(e=>{let[,t]=e;return t.spec.toText}).map(e=>{let[t,n]=e;return[t,n.spec.toText]}))}const GQ=ZQ.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new yR({key:new bR("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:i,selection:r}=t,{ranges:s}=r,o=Math.min(...s.map(e=>e.$from.pos)),a=Math.max(...s.map(e=>e.$to.pos)),l=YQ(n);return HQ(i,{from:o,to:a},p(p({},void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{}),{},{textSerializers:l}))}}})]}});function KQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{strict:!0};const i=Object.keys(t);return!i.length||i.every(i=>n.strict?t[i]===e[i]:IQ(t[i])?t[i].test(e[i]):t[i]===e[i])}function JQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.find(e=>e.type===t&&KQ(Object.fromEntries(Object.keys(n).map(t=>[t,e.attrs[t]])),n))}function eL(e,t){return!!JQ(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}function tL(e,t,n){var i;if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if(r.node&&r.node.marks.some(e=>e.type===t)||(r=e.parent.childBefore(e.parentOffset)),!r.node||!r.node.marks.some(e=>e.type===t))return;n=n||(null===(i=r.node.marks[0])||void 0===i?void 0:i.attrs);if(!JQ([...r.node.marks],t,n))return;let s=r.index,o=e.start()+r.offset,a=s+1,l=o+r.node.nodeSize;for(;s>0&&eL([...e.parent.child(s-1).marks],t,n);)s-=1,o-=e.parent.child(s).nodeSize;for(;a<e.parent.childCount&&eL([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function nL(e,t){if("string"===typeof e){if(!t.marks[e])throw Error("There is no mark type named '".concat(e,"'. Maybe you forgot to add the extension?"));return t.marks[e]}return e}function iL(e){return e instanceof iR}function rL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(e,t),n)}function sL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return null;const n=JF.atStart(e),i=JF.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return i;const r=n.from,s=i.to;return"all"===t?iR.create(e,rL(0,r,s),rL(e.content.size,r,s)):iR.create(e,rL(t,r,s),rL(t,r,s))}function oL(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}function aL(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const lL=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const i=t[n];3===i.nodeType&&i.nodeValue&&/^(\n\s\s|\n)$/.test(i.nodeValue)?e.removeChild(i):1===i.nodeType&&lL(i)}return e};function cL(e){const t="<body>".concat(e,"</body>"),n=(new window.DOMParser).parseFromString(t,"text/html").body;return lL(n)}function uL(e,t,n){if(e instanceof SM||e instanceof tM)return e;n=p({slice:!0,parseOptions:{}},n);const i="string"===typeof e;if("object"===typeof e&&null!==e)try{if(Array.isArray(e)&&e.length>0)return tM.fromArray(e.map(e=>t.nodeFromJSON(e)));const i=t.nodeFromJSON(e);return n.errorOnInvalidContent&&i.check(),i}catch(r){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),uL("",t,n)}if(i){if(n.errorOnInvalidContent){let i=!1,r="";const s=new VM({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(i=!0,r="string"===typeof e?e:e.outerHTML,null)}]}})});if(n.slice?XM.fromSchema(s).parseSlice(cL(e),n.parseOptions):XM.fromSchema(s).parse(cL(e),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error("Invalid element found: ".concat(r))})}const i=XM.fromSchema(t);return n.slice?i.parseSlice(cL(e),n.parseOptions).content:i.parse(cL(e),n.parseOptions)}return uL("",t,n)}function hL(){return"undefined"!==typeof navigator&&/Mac/.test(navigator.platform)}function dL(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{from:i,to:r,empty:s}=e.selection,o=t?SQ(t,e.schema):null,a=[];e.doc.nodesBetween(i,r,(e,t)=>{if(e.isText)return;const n=Math.max(i,t),s=Math.min(r,t+e.nodeSize);a.push({node:e,from:n,to:s})});const l=r-i,c=a.filter(e=>!o||o.name===e.node.type.name).filter(e=>KQ(e.node.attrs,n,{strict:!1}));if(s)return!!c.length;return c.reduce((e,t)=>e+t.to-t.from,0)>=l}function pL(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function fL(e,t){const n="string"===typeof t?[t]:t;return Object.keys(e).reduce((t,i)=>(n.includes(i)||(t[i]=e[i]),t),{})}function mL(e,t){return uL(e,t,{slice:!1,parseOptions:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},errorOnInvalidContent:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).errorOnInvalidContent})}function gL(e,t){const n=nL(t,e.schema),{from:i,to:r,empty:s}=e.selection,o=[];s?(e.storedMarks&&o.push(...e.storedMarks),o.push(...e.selection.$head.marks())):e.doc.nodesBetween(i,r,e=>{o.push(...e.marks)});const a=o.find(e=>e.type.name===n.name);return a?p({},a.attrs):{}}function vL(e){return t=>function(e,t){for(let n=e.depth;n>0;n-=1){const i=e.node(n);if(t(i))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:i}}}(t.$from,e)}function yL(e,t){return HQ(e,{from:0,to:e.content.size},t)}function OL(e,t){const n=pL("string"===typeof t?t:t.name,e.schema);return"node"===n?function(e,t){const n=SQ(t,e.schema),{from:i,to:r}=e.selection,s=[];e.doc.nodesBetween(i,r,e=>{s.push(e)});const o=s.reverse().find(e=>e.type.name===n.name);return o?p({},o.attrs):{}}(e,t):"mark"===n?gL(e,t):{}}function wL(e,t,n){const i=[];return e===t?n.resolve(e).marks().forEach(t=>{const r=tL(n.resolve(e),t.type);r&&i.push(p({mark:t},r))}):n.nodesBetween(e,t,(e,t)=>{e&&void 0!==(null===e||void 0===e?void 0:e.nodeSize)&&i.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),i}function bL(e,t,n){return Object.fromEntries(Object.entries(n).filter(n=>{let[i]=n;const r=e.find(e=>e.type===t&&e.name===i);return!!r&&r.attribute.keepOnSplit}))}function kL(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{empty:i,ranges:r}=e.selection,s=t?nL(t,e.schema):null;if(i)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!s||s.name===e.type.name).find(e=>KQ(e.attrs,n,{strict:!1}));let o=0;const a=[];if(r.forEach(t=>{let{$from:n,$to:i}=t;const r=n.pos,s=i.pos;e.doc.nodesBetween(r,s,(e,t)=>{if(!e.isText&&!e.marks.length)return;const n=Math.max(r,t),i=Math.min(s,t+e.nodeSize);o+=i-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:i})))})}),0===o)return!1;const l=a.filter(e=>!s||s.name===e.mark.type.name).filter(e=>KQ(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=a.filter(e=>!s||e.mark.type!==s&&e.mark.type.excludes(s)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=o}function xL(e,t){const{nodeExtensions:n}=xQ(t),i=n.find(t=>t.name===e);if(!i)return!1;const r=_Q(kQ(i,"group",{name:i.name,options:i.options,storage:i.storage}));return"string"===typeof r&&r.split(" ").includes("list")}function DL(e){let{checkChildren:t=!0,ignoreWhitespace:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;if(n){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!==(i=e.text)&&void 0!==i?i:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let i=!0;return e.content.forEach(e=>{!1!==i&&(DL(e,{ignoreWhitespace:n,checkChildren:t})||(i=!1))}),i}return!1}function SL(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const i=n.filter(e=>null===t||void 0===t?void 0:t.includes(e.type.name));e.tr.ensureMarks(i)}}const CL=(e,t)=>{const n=vL(e=>e.type===t)(e.selection);if(!n)return!0;const i=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===i)return!0;const r=e.doc.nodeAt(i);return n.node.type!==(null===r||void 0===r?void 0:r.type)||!FF(e.doc,n.pos)||(e.join(n.pos),!0)},AL=(e,t)=>{const n=vL(e=>e.type===t)(e.selection);if(!n)return!0;const i=e.doc.resolve(n.start).after(n.depth);if(void 0===i)return!0;const r=e.doc.nodeAt(i);return n.node.type!==(null===r||void 0===r?void 0:r.type)||!FF(e.doc,i)||(e.join(i),!0)};var EL=Object.freeze({__proto__:null,blur:()=>e=>{let{editor:t,view:n}=e;return requestAnimationFrame(()=>{var e;t.isDestroyed||(n.dom.blur(),null===(e=null===window||void 0===window?void 0:window.getSelection())||void 0===e||e.removeAllRanges())}),!0},clearContent:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t=>{let{commands:n}=t;return n.setContent("",e)}},clearNodes:()=>e=>{let{state:t,tr:n,dispatch:i}=e;const{selection:r}=n,{ranges:s}=r;return!i||(s.forEach(e=>{let{$from:i,$to:r}=e;t.doc.nodesBetween(i.pos,r.pos,(e,t)=>{if(e.type.isText)return;const{doc:i,mapping:r}=n,s=i.resolve(r.map(t)),o=i.resolve(r.map(t+e.nodeSize)),a=s.blockRange(o);if(!a)return;const l=AF(a);if(e.type.isTextblock){const{defaultType:e}=s.parent.contentMatchAt(s.index());n.setNodeMarkup(a.start,e)}(l||0===l)&&n.lift(a,l)})}),!0)},command:e=>t=>e(t),createParagraphNear:()=>e=>{let{state:t,dispatch:n}=e;return iQ(t,n)},cut:(e,t)=>n=>{let{editor:i,tr:r}=n;const{state:s}=i,o=s.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const a=r.mapping.map(t);return r.insert(a,o.content),r.setSelection(new iR(r.doc.resolve(Math.max(a-1,0)))),!0},deleteCurrentNode:()=>e=>{let{tr:t,dispatch:n}=e;const{selection:i}=t,r=i.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let o=s.depth;o>0;o-=1){if(s.node(o).type===r.type){if(n){const e=s.before(o),n=s.after(o);t.delete(e,n).scrollIntoView()}return!0}}return!1},deleteNode:e=>t=>{let{tr:n,state:i,dispatch:r}=t;const s=SQ(e,i.schema),o=n.selection.$anchor;for(let e=o.depth;e>0;e-=1){if(o.node(e).type===s){if(r){const t=o.before(e),i=o.after(e);n.delete(t,i).scrollIntoView()}return!0}}return!1},deleteRange:e=>t=>{let{tr:n,dispatch:i}=t;const{from:r,to:s}=e;return i&&n.delete(r,s),!0},deleteSelection:()=>e=>{let{state:t,dispatch:n}=e;return WB(t,n)},enter:()=>e=>{let{commands:t}=e;return t.keyboardShortcut("Enter")},exitCode:()=>e=>{let{state:t,dispatch:n}=e;return nQ(t,n)},extendMarkRange:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:i,state:r,dispatch:s}=n;const o=nL(e,r.schema),{doc:a,selection:l}=i,{$from:c,from:u,to:h}=l;if(s){const e=tL(c,o,t);if(e&&e.from<=u&&e.to>=h){const t=iR.create(a,e.from,e.to);i.setSelection(t)}}return!0}},first:e=>t=>{const n="function"===typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1},focus:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{editor:i,view:r,tr:s,dispatch:o}=n;t=p({scrollIntoView:!0},t);const a=()=>{(aL()||oL())&&r.dom.focus(),requestAnimationFrame(()=>{i.isDestroyed||(r.focus(),"undefined"===typeof navigator||!/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||aL()||oL()||r.dom.focus({preventScroll:!0}))})};if(r.hasFocus()&&null===e||!1===e)return!0;if(o&&null===e&&!iL(i.state.selection))return a(),!0;const l=sL(s.doc,e)||i.state.selection,c=i.state.selection.eq(l);return o&&(c||s.setSelection(l),c&&s.storedMarks&&s.setStoredMarks(s.storedMarks),a()),!0}},forEach:(e,t)=>n=>e.every((e,i)=>t(e,p(p({},n),{},{index:i}))),insertContent:(e,t)=>n=>{let{tr:i,commands:r}=n;return r.insertContentAt({from:i.selection.from,to:i.selection.to},e,t)},insertContentAt:(e,t,n)=>i=>{let{tr:r,dispatch:s,editor:o}=i;var a;if(s){let i;n=p({parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1},n);const s=e=>{o.emit("contentError",{editor:o,error:e,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},l=p({preserveWhitespace:"full"},n.parseOptions);if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{uL(t,o.schema,{parseOptions:l,errorOnInvalidContent:!0})}catch(Kre){s(Kre)}try{i=uL(t,o.schema,{parseOptions:l,errorOnInvalidContent:null!==(a=n.errorOnInvalidContent)&&void 0!==a?a:o.options.enableContentCheck})}catch(Kre){return s(Kre),!1}let{from:c,to:u}="number"===typeof e?{from:e,to:e}:{from:e.from,to:e.to},h=!0,d=!0;if(("type"in i?[i]:i).forEach(e=>{e.check(),h=!!h&&(e.isText&&0===e.marks.length),d=!!d&&e.isBlock}),c===u&&d){const{parent:e}=r.doc.resolve(c);e.isTextblock&&!e.type.spec.code&&!e.childCount&&(c-=1,u+=1)}let f;if(h){if(Array.isArray(t))f=t.map(e=>e.text||"").join("");else if(t instanceof tM){let e="";t.forEach(t=>{t.text&&(e+=t.text)}),f=e}else f="object"===typeof t&&t&&t.text?t.text:t;r.insertText(f,c,u)}else f=i,r.replaceWith(c,u,f);n.updateSelection&&function(e,t,n){const i=e.steps.length-1;if(i<t)return;const r=e.steps[i];if(!(r instanceof kF||r instanceof xF))return;const s=e.mapping.maps[i];let o=0;s.forEach((e,t,n,i)=>{0===o&&(o=i)}),e.setSelection(JF.near(e.doc.resolve(o),n))}(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:c,text:f}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:c,text:f})}return!0},joinBackward:()=>e=>{let{state:t,dispatch:n}=e;return UB(t,n)},joinDown:()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,i=e.selection;if(i instanceof sR){if(i.node.isTextblock||!FF(e.doc,i.to))return!1;n=i.to}else if(n=NF(e.doc,i.to,1),null==n)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0})(t,n)},joinForward:()=>e=>{let{state:t,dispatch:n}=e;return GB(t,n)},joinItemBackward:()=>e=>{let{state:t,dispatch:n,tr:i}=e;try{const e=NF(t.doc,t.selection.$from.pos,-1);return null!==e&&void 0!==e&&(i.join(e,2),n&&n(i),!0)}catch(r){return!1}},joinItemForward:()=>e=>{let{state:t,dispatch:n,tr:i}=e;try{const e=NF(t.doc,t.selection.$from.pos,1);return null!==e&&void 0!==e&&(i.join(e,2),n&&n(i),!0)}catch(r){return!1}},joinTextblockBackward:()=>e=>{let{state:t,dispatch:n}=e;return((e,t,n)=>{let i=VB(e,n);if(!i)return!1;let r=HB(i);return!!r&&XB(e,r,t)})(t,n)},joinTextblockForward:()=>e=>{let{state:t,dispatch:n}=e;return((e,t,n)=>{let i=YB(e,n);if(!i)return!1;let r=JB(i);return!!r&&XB(e,r,t)})(t,n)},joinUp:()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,i=e.selection,r=i instanceof sR;if(r){if(i.node.isTextblock||!FF(e.doc,i.from))return!1;n=i.from}else if(n=NF(e.doc,i.from,-1),null==n)return!1;if(t){let i=e.tr.join(n);r&&i.setSelection(sR.create(i.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(i.scrollIntoView())}return!0})(t,n)},keyboardShortcut:e=>t=>{let{editor:n,view:i,tr:r,dispatch:s}=t;const o=function(e){const t=e.split(/-(?!$)/);let n,i,r,s,o=t[t.length-1];"Space"===o&&(o=" ");for(let a=0;a<t.length-1;a+=1){const e=t[a];if(/^(cmd|meta|m)$/i.test(e))s=!0;else if(/^a(lt)?$/i.test(e))n=!0;else if(/^(c|ctrl|control)$/i.test(e))i=!0;else if(/^s(hift)?$/i.test(e))r=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: ".concat(e));aL()||hL()?s=!0:i=!0}}return n&&(o="Alt-".concat(o)),i&&(o="Ctrl-".concat(o)),s&&(o="Meta-".concat(o)),r&&(o="Shift-".concat(o)),o}(e).split(/-(?!$)/),a=o.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),l=new KeyboardEvent("keydown",{key:"Space"===a?" ":a,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),c=n.captureTransaction(()=>{i.someProp("handleKeyDown",e=>e(i,l))});return null===c||void 0===c||c.steps.forEach(e=>{const t=e.map(r.mapping);t&&s&&r.maybeStep(t)}),!0},lift:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:i,dispatch:r}=n;return!!dL(i,SQ(e,i.schema),t)&&((e,t)=>{let{$from:n,$to:i}=e.selection,r=n.blockRange(i),s=r&&AF(r);return null!=s&&(t&&t(e.tr.lift(r,s).scrollIntoView()),!0)})(i,r)}},liftEmptyBlock:()=>e=>{let{state:t,dispatch:n}=e;return rQ(t,n)},liftListItem:e=>t=>{let{state:n,dispatch:i}=t;return yQ(SQ(e,n.schema))(n,i)},newlineInCode:()=>e=>{let{state:t,dispatch:n}=e;return eQ(t,n)},resetAttributes:(e,t)=>n=>{let{tr:i,state:r,dispatch:s}=n,o=null,a=null;const l=pL("string"===typeof e?e:e.name,r.schema);return!!l&&("node"===l&&(o=SQ(e,r.schema)),"mark"===l&&(a=nL(e,r.schema)),s&&i.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,n)=>{o&&o===e.type&&i.setNodeMarkup(n,void 0,fL(e.attrs,t)),a&&e.marks.length&&e.marks.forEach(r=>{a===r.type&&i.addMark(n,n+e.nodeSize,a.create(fL(r.attrs,t)))})})}),!0)},scrollIntoView:()=>e=>{let{tr:t,dispatch:n}=e;return n&&t.scrollIntoView(),!0},selectAll:()=>e=>{let{tr:t,dispatch:n}=e;if(n){const e=new aR(t.doc);t.setSelection(e)}return!0},selectNodeBackward:()=>e=>{let{state:t,dispatch:n}=e;return ZB(t,n)},selectNodeForward:()=>e=>{let{state:t,dispatch:n}=e;return KB(t,n)},selectParentNode:()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,{$from:i,to:r}=e.selection,s=i.sharedDepth(r);return 0!=s&&(n=i.before(s),t&&t(e.tr.setSelection(sR.create(e.doc,n))),!0)})(t,n)},selectTextblockEnd:()=>e=>{let{state:t,dispatch:n}=e;return uQ(t,n)},selectTextblockStart:()=>e=>{let{state:t,dispatch:n}=e;return cQ(t,n)},setContent:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r=>{let{editor:s,tr:o,dispatch:a,commands:l}=r;var c,u;const{doc:h}=o;if("full"!==n.preserveWhitespace){const r=mL(e,s.schema,n,{errorOnInvalidContent:null!==(c=i.errorOnInvalidContent)&&void 0!==c?c:s.options.enableContentCheck});return a&&o.replaceWith(0,h.content.size,r).setMeta("preventUpdate",!t),!0}return a&&o.setMeta("preventUpdate",!t),l.insertContentAt({from:0,to:h.content.size},e,{parseOptions:n,errorOnInvalidContent:null!==(u=i.errorOnInvalidContent)&&void 0!==u?u:s.options.enableContentCheck})}},setMark:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:i,state:r,dispatch:s}=n;const{selection:o}=i,{empty:a,ranges:l}=o,c=nL(e,r.schema);if(s)if(a){const e=gL(r,c);i.addStoredMark(c.create(p(p({},e),t)))}else l.forEach(e=>{const n=e.$from.pos,s=e.$to.pos;r.doc.nodesBetween(n,s,(e,r)=>{const o=Math.max(r,n),a=Math.min(r+e.nodeSize,s),l=e.marks.find(e=>e.type===c);l?e.marks.forEach(e=>{c===e.type&&i.addMark(o,a,c.create(p(p({},e.attrs),t)))}):i.addMark(o,a,c.create(t))})});return function(e,t,n){var i;const{selection:r}=t;let s=null;if(iL(r)&&(s=r.$cursor),s){const t=null!==(i=e.storedMarks)&&void 0!==i?i:s.marks();return!!n.isInSet(t)||!t.some(e=>e.type.excludes(n))}const{ranges:o}=r;return o.some(t=>{let{$from:i,$to:r}=t,s=0===i.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(i.pos,r.pos,(e,t,i)=>{if(s)return!1;if(e.isInline){const t=!i||i.type.allowsMarkType(n),r=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));s=t&&r}return!s}),s})}(r,i,c)}},setMeta:(e,t)=>n=>{let{tr:i}=n;return i.setMeta(e,t),!0},setNode:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:i,dispatch:r,chain:s}=n;const o=SQ(e,i.schema);let a;return i.selection.$anchor.sameParent(i.selection.$head)&&(a=i.selection.$anchor.parent.attrs),o.isTextblock?s().command(e=>{let{commands:n}=e;return!!hQ(o,p(p({},a),t))(i)||n.clearNodes()}).command(e=>{let{state:n}=e;return hQ(o,p(p({},a),t))(n,r)}).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}},setNodeSelection:e=>t=>{let{tr:n,dispatch:i}=t;if(i){const{doc:t}=n,i=rL(e,0,t.content.size),r=sR.create(t,i);n.setSelection(r)}return!0},setTextSelection:e=>t=>{let{tr:n,dispatch:i}=t;if(i){const{doc:t}=n,{from:i,to:r}="number"===typeof e?{from:e,to:e}:e,s=iR.atStart(t).from,o=iR.atEnd(t).to,a=rL(i,s,o),l=rL(r,s,o),c=iR.create(t,a,l);n.setSelection(c)}return!0},sinkListItem:e=>t=>{let{state:n,dispatch:i}=t;const r=SQ(e,n.schema);return(s=r,function(e,t){let{$from:n,$to:i}=e.selection,r=n.blockRange(i,e=>e.childCount>0&&e.firstChild.type==s);if(!r)return!1;let o=r.startIndex;if(0==o)return!1;let a=r.parent,l=a.child(o-1);if(l.type!=s)return!1;if(t){let n=l.lastChild&&l.lastChild.type==a.type,i=tM.from(n?s.create():null),o=new aM(tM.from(s.create(null,tM.from(a.type.create(null,i)))),n?3:1,0),c=r.start,u=r.end;t(e.tr.step(new xF(c-(n?3:1),u,c,u,o,1,!0)).scrollIntoView())}return!0})(n,i);var s},splitBlock:function(){let{keepMarks:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>{let{tr:n,state:i,dispatch:r,editor:s}=t;const{selection:o,doc:a}=n,{$from:l,$to:c}=o,u=bL(s.extensionManager.attributes,l.node().type.name,l.node().attrs);if(o instanceof sR&&o.node.isBlock)return!(!l.parentOffset||!MF(a,l.pos))&&(r&&(e&&SL(i,s.extensionManager.splittableMarks),n.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const h=c.parentOffset===c.parent.content.size,d=0===l.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(l.node(-1).contentMatchAt(l.indexAfter(-1)));let p=h&&d?[{type:d,attrs:u}]:void 0,f=MF(n.doc,n.mapping.map(l.pos),1,p);if(p||f||!MF(n.doc,n.mapping.map(l.pos),1,d?[{type:d}]:void 0)||(f=!0,p=d?[{type:d,attrs:u}]:void 0),r){if(f&&(o instanceof iR&&n.deleteSelection(),n.split(n.mapping.map(l.pos),1,p),d&&!h&&!l.parentOffset&&l.parent.type!==d)){const e=n.mapping.map(l.before()),t=n.doc.resolve(e);l.node(-1).canReplaceWith(t.index(),t.index()+1,d)&&n.setNodeMarkup(n.mapping.map(l.before()),d)}e&&SL(i,s.extensionManager.splittableMarks),n.scrollIntoView()}return f}},splitListItem:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:i,state:r,dispatch:s,editor:o}=n;var a;const l=SQ(e,r.schema),{$from:c,$to:u}=r.selection,h=r.selection.node;if(h&&h.isBlock||c.depth<2||!c.sameParent(u))return!1;const d=c.node(-1);if(d.type!==l)return!1;const f=o.extensionManager.attributes;if(0===c.parent.content.size&&c.node(-1).childCount===c.indexAfter(-1)){if(2===c.depth||c.node(-3).type!==l||c.index(-2)!==c.node(-2).childCount-1)return!1;if(s){let e=tM.empty;const n=c.index(-1)?1:c.index(-2)?2:3;for(let t=c.depth-n;t>=c.depth-3;t-=1)e=tM.from(c.node(t).copy(e));const r=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,s=p(p({},bL(f,c.node().type.name,c.node().attrs)),t),o=(null===(a=l.contentMatch.defaultType)||void 0===a?void 0:a.createAndFill(s))||void 0;e=e.append(tM.from(l.createAndFill(null,o)||void 0));const u=c.before(c.depth-(n-1));i.replace(u,c.after(-r),new aM(e,4-n,0));let h=-1;i.doc.nodesBetween(u,i.doc.content.size,(e,t)=>{if(h>-1)return!1;e.isTextblock&&0===e.content.size&&(h=t+1)}),h>-1&&i.setSelection(iR.near(i.doc.resolve(h))),i.scrollIntoView()}return!0}const m=u.pos===c.end()?d.contentMatchAt(0).defaultType:null,g=p(p({},bL(f,d.type.name,d.attrs)),t),v=p(p({},bL(f,c.node().type.name,c.node().attrs)),t);i.delete(c.pos,u.pos);const y=m?[{type:l,attrs:g},{type:m,attrs:v}]:[{type:l,attrs:g}];if(!MF(i.doc,c.pos,2))return!1;if(s){const{selection:e,storedMarks:t}=r,{splittableMarks:n}=o.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();if(i.split(c.pos,2,y).scrollIntoView(),!a||!s)return!0;const l=a.filter(e=>n.includes(e.type.name));i.ensureMarks(l)}return!0}},toggleList:function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r=>{let{editor:s,tr:o,state:a,dispatch:l,chain:c,commands:u,can:h}=r;const{extensions:d,splittableMarks:p}=s.extensionManager,f=SQ(e,a.schema),m=SQ(t,a.schema),{selection:g,storedMarks:v}=a,{$from:y,$to:O}=g,w=y.blockRange(O),b=v||g.$to.parentOffset&&g.$from.marks();if(!w)return!1;const k=vL(e=>xL(e.type.name,d))(g);if(w.depth>=1&&k&&w.depth-k.depth<=1){if(k.node.type===f)return u.liftListItem(m);if(xL(k.node.type.name,d)&&f.validContent(k.node.content)&&l)return c().command(()=>(o.setNodeMarkup(k.pos,f),!0)).command(()=>CL(o,f)).command(()=>AL(o,f)).run()}return n&&b&&l?c().command(()=>{const e=h().wrapInList(f,i),t=b.filter(e=>p.includes(e.type.name));return o.ensureMarks(t),!!e||u.clearNodes()}).wrapInList(f,i).command(()=>CL(o,f)).command(()=>AL(o,f)).run():c().command(()=>!!h().wrapInList(f,i)||u.clearNodes()).wrapInList(f,i).command(()=>CL(o,f)).command(()=>AL(o,f)).run()}},toggleMark:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=>{let{state:r,commands:s}=i;const{extendEmptyMarkRange:o=!1}=n,a=nL(e,r.schema);return kL(r,a,t)?s.unsetMark(a,{extendEmptyMarkRange:o}):s.setMark(a,t)}},toggleNode:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=>{let{state:r,commands:s}=i;const o=SQ(e,r.schema),a=SQ(t,r.schema),l=dL(r,o,n);let c;return r.selection.$anchor.sameParent(r.selection.$head)&&(c=r.selection.$anchor.parent.attrs),l?s.setNode(a,c):s.setNode(o,p(p({},c),n))}},toggleWrap:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:i,commands:r}=n;const s=SQ(e,i.schema);return dL(i,s,t)?r.lift(s):r.wrapIn(s,t)}},undoInputRule:()=>e=>{let{state:t,dispatch:n}=e;const i=t.plugins;for(let r=0;r<i.length;r+=1){const e=i[r];let s;if(e.spec.isInputRules&&(s=e.getState(t))){if(n){const e=t.tr,n=s.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(s.text){const n=e.doc.resolve(s.from).marks();e.replaceWith(s.from,s.to,t.schema.text(s.text,n))}else e.delete(s.from,s.to)}return!0}}return!1},unsetAllMarks:()=>e=>{let{tr:t,dispatch:n}=e;const{selection:i}=t,{empty:r,ranges:s}=i;return r||n&&s.forEach(e=>{t.removeMark(e.$from.pos,e.$to.pos)}),!0},unsetMark:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:i,state:r,dispatch:s}=n;var o;const{extendEmptyMarkRange:a=!1}=t,{selection:l}=i,c=nL(e,r.schema),{$from:u,empty:h,ranges:d}=l;if(!s)return!0;if(h&&a){let{from:e,to:t}=l;const n=null===(o=u.marks().find(e=>e.type===c))||void 0===o?void 0:o.attrs,r=tL(u,c,n);r&&(e=r.from,t=r.to),i.removeMark(e,t,c)}else d.forEach(e=>{i.removeMark(e.$from.pos,e.$to.pos,c)});return i.removeStoredMark(c),!0}},updateAttributes:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:i,state:r,dispatch:s}=n,o=null,a=null;const l=pL("string"===typeof e?e:e.name,r.schema);return!!l&&("node"===l&&(o=SQ(e,r.schema)),"mark"===l&&(a=nL(e,r.schema)),s&&i.selection.ranges.forEach(e=>{const n=e.$from.pos,s=e.$to.pos;let l,c,u,h;i.selection.empty?r.doc.nodesBetween(n,s,(e,t)=>{o&&o===e.type&&(u=Math.max(t,n),h=Math.min(t+e.nodeSize,s),l=t,c=e)}):r.doc.nodesBetween(n,s,(e,r)=>{r<n&&o&&o===e.type&&(u=Math.max(r,n),h=Math.min(r+e.nodeSize,s),l=r,c=e),r>=n&&r<=s&&(o&&o===e.type&&i.setNodeMarkup(r,void 0,p(p({},e.attrs),t)),a&&e.marks.length&&e.marks.forEach(o=>{if(a===o.type){const l=Math.max(r,n),c=Math.min(r+e.nodeSize,s);i.addMark(l,c,a.create(p(p({},o.attrs),t)))}}))}),c&&(void 0!==l&&i.setNodeMarkup(l,void 0,p(p({},c.attrs),t)),a&&c.marks.length&&c.marks.forEach(e=>{a===e.type&&i.addMark(u,h,a.create(p(p({},e.attrs),t)))}))}),!0)}},wrapIn:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:i,dispatch:r}=n;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,i){let{$from:r,$to:s}=n.selection,o=r.blockRange(s),a=o&&EF(o,e,t);return!!a&&(i&&i(n.tr.wrap(o,a).scrollIntoView()),!0)}}(SQ(e,i.schema),t)(i,r)}},wrapInList:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:i,dispatch:r}=n;return vQ(SQ(e,i.schema),t)(i,r)}}});const _L=ZQ.create({name:"commands",addCommands:()=>p({},EL)}),TL=ZQ.create({name:"drop",addProseMirrorPlugins(){return[new yR({key:new bR("tiptapDrop"),props:{handleDrop:(e,t,n,i)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:i})}}})]}}),PL=ZQ.create({name:"editable",addProseMirrorPlugins(){return[new yR({key:new bR("editable"),props:{editable:()=>this.editor.options.editable}})]}}),ML=new bR("focusEvents"),FL=ZQ.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new yR({key:ML,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const i=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(i),!1},blur:(t,n)=>{e.isFocused=!1;const i=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(i),!1}}}})]}}),RL=ZQ.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.undoInputRule(),()=>t.command(e=>{let{tr:n}=e;const{selection:i,doc:r}=n,{empty:s,$anchor:o}=i,{pos:a,parent:l}=o,c=o.parent.isTextblock&&a>0?n.doc.resolve(a-1):o,u=c.parent.type.spec.isolating,h=o.pos-o.parentOffset,d=u&&1===c.parent.childCount?h===o.pos:JF.atStart(r).from===a;return!(!s||!l.type.isTextblock||l.textContent.length||!d||d&&"paragraph"===o.parent.type.name)&&t.clearNodes()}),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()]}),t=()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()]}),n={Enter:()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()]}),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i=p({},n),r=p(p({},n),{},{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return aL()||hL()?r:i},addProseMirrorPlugins(){return[new yR({key:new bR("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(e=>e.getMeta("composition")))return;const i=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),r=e.some(e=>e.getMeta("preventClearDocument"));if(!i||r)return;const{empty:s,from:o,to:a}=t.selection,l=JF.atStart(t.doc).from,c=JF.atEnd(t.doc).to;if(s||!(o===l&&a===c))return;if(!DL(n.doc))return;const u=n.tr,h=OQ({state:n,transaction:u}),{commands:d}=new wQ({editor:this.editor,state:h});return d.clearNodes(),u.steps.length?u:void 0}})]}}),NL=ZQ.create({name:"paste",addProseMirrorPlugins(){return[new yR({key:new bR("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),IL=ZQ.create({name:"tabindex",addProseMirrorPlugins(){return[new yR({key:new bR("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class BL{get name(){return this.node.type.name}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!==(e=this.actualDepth)&&void 0!==e?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error("You can\u2019t set content on a block node. Tried to set content on ".concat(this.name," at ").concat(this.pos));t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new BL(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new BL(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new BL(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,n)=>{const i=t.isBlock&&!t.isTextblock,r=t.isAtom&&!t.isText,s=this.pos+n+(r?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const o=this.resolvedPos.doc.resolve(s);if(!i&&o.depth<=this.depth)return;const a=new BL(o,this.editor,i,i?t:null);i&&(a.actualDepth=this.depth+1),e.push(new BL(o,this.editor,i,i?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=this.parent;for(;i&&!n;){if(i.node.type.name===e)if(Object.keys(t).length>0){const e=i.node.attrs,n=Object.keys(t);for(let i=0;i<n.length;i+=1){const r=n[i];if(e[r]!==t[r])break}}else n=i;i=i.parent}return n}querySelector(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];if(!this.children||0===this.children.length)return i;const r=Object.keys(t);return this.children.forEach(s=>{if(!(n&&i.length>0)){if(s.node.type.name===e){r.every(e=>t[e]===s.node.attrs[e])&&i.push(s)}n&&i.length>0||(i=i.concat(s.querySelectorAll(e,t,n)))}}),i}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,p(p({},this.node.attrs),e)),this.editor.view.dispatch(t)}}class QL extends bQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:e=>{let{error:t}=e;throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",e=>{let{event:t,slice:n,moved:i}=e;return this.options.onDrop(t,n,i)}),this.on("paste",e=>{let{event:t,slice:n}=e;return this.options.onPaste(t,n)}),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t,n){const i=document.querySelector("style[data-tiptap-style".concat(n?"-".concat(n):"","]"));if(null!==i)return i;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute("data-tiptap-style".concat(n?"-".concat(n):""),""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=p(p({},this.options),e),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const n=EQ(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:n});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let n=t;if([].concat(e).forEach(e=>{const t="string"===typeof e?"".concat(e,"$"):e.key;n=n.filter(e=>!e.key.startsWith(t))}),t.length===n.length)return;const i=this.state.reconfigure({plugins:n});return this.view.updateState(i),i}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[PL,GQ.configure({blockSeparator:null===(t=null===(e=this.options.coreExtensionOptions)||void 0===e?void 0:e.clipboardTextSerializer)||void 0===t?void 0:t.blockSeparator}),_L,FL,RL,IL,TL,NL].filter(e=>"object"!==typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name]):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null===e||void 0===e?void 0:e.type));this.extensionManager=new qQ(n,this)}createCommandManager(){this.commandManager=new wQ({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=mL(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(Kre){if(!(Kre instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(Kre.message))throw Kre;this.emit("contentError",{editor:this,error:Kre,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),t=mL(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const n=sL(t,this.options.autofocus);this.view=new MB(this.options.element,p(p({},this.options.editorProps),{},{attributes:p({role:"textbox"},null===(e=this.options.editorProps)||void 0===e?void 0:e.attributes),dispatchTransaction:this.dispatchTransaction.bind(this),state:gR.create({doc:t,selection:n||void 0})}));const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className="tiptap ".concat(this.view.dom.className)}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach(e=>{var t;return null===(t=this.capturedTransaction)||void 0===t?void 0:t.step(e)}):void(this.capturedTransaction=e);const t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),r=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),r&&this.emit("blur",{editor:this,event:r.event,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return OL(this.state,e)}isActive(e,t){const n="string"===typeof e?e:null,i="string"===typeof e?t:e;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return dL(e,null,n)||kL(e,null,n);const i=pL(t,e.schema);return"node"===i?dL(e,t,n):"mark"===i&&kL(e,t,n)}(this.state,n,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return NQ(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return yL(this.state.doc,{blockSeparator:t,textSerializers:p(p({},YQ(this.schema)),n)})}get isEmpty(){return DL(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(null===(e=this.view)||void 0===e?void 0:e.docView)}$node(e,t){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new BL(t,this)}get $doc(){return this.$pos(0)}}function LL(e){return new BQ({find:e.find,handler:t=>{let{state:n,range:i,match:r}=t;const s=_Q(e.getAttributes,void 0,r);if(!1===s||null===s)return null;const{tr:o}=n,a=r[r.length-1],l=r[0];if(a){const t=l.search(/\S/),r=i.from+l.indexOf(a),c=r+a.length;if(wL(i.from,i.to,n.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>r).length)return null;c<i.to&&o.delete(c,i.to),r>i.from&&o.delete(i.from+t,r);const u=i.from+t+a.length;o.addMark(i.from+t,u,e.type.create(s||{})),o.removeStoredMark(e.type)}}})}function jL(e){return new BQ({find:e.find,handler:t=>{let{state:n,range:i,match:r}=t;const s=_Q(e.getAttributes,void 0,r)||{},{tr:o}=n,a=i.from;let l=i.to;const c=e.type.create(s);if(r[1]){let e=a+r[0].lastIndexOf(r[1]);e>l?e=l:l=e+r[1].length;const t=r[0][r[0].length-1];o.insertText(t,a+r[0].length-1),o.replaceWith(e,l,c)}else if(r[0]){const t=e.type.isInline?a:a-1;o.insert(t,e.type.create(s)).delete(o.mapping.map(a),o.mapping.map(l))}o.scrollIntoView()}})}function $L(e){return new BQ({find:e.find,handler:t=>{let{state:n,range:i,match:r}=t;const s=n.doc.resolve(i.from),o=_Q(e.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;n.tr.delete(i.from,i.to).setBlockType(i.from,i.from,e.type,o)}})}function zL(e){return new BQ({find:e.find,handler:t=>{let{state:n,range:i,match:r,chain:s}=t;const o=_Q(e.getAttributes,void 0,r)||{},a=n.tr.delete(i.from,i.to),l=a.doc.resolve(i.from).blockRange(),c=l&&EF(l,e.type,o);if(!c)return null;if(a.wrap(l,c),e.keepMarks&&e.editor){const{selection:t,storedMarks:i}=n,{splittableMarks:r}=e.editor.extensionManager,s=i||t.$to.parentOffset&&t.$from.marks();if(s){const e=s.filter(e=>r.includes(e.type.name));a.ensureMarks(e)}}if(e.keepAttributes){const t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";s().updateAttributes(t,o).run()}const u=a.doc.resolve(i.from-1).nodeBefore;u&&u.type===e.type&&FF(a.doc,i.from-1)&&(!e.joinPredicate||e.joinPredicate(r,u))&&a.join(i.from-1)}})}class WL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=p(p({},this.config),e),this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'.concat(this.name,'".')),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_Q(kQ(this,"addOptions",{name:this.name}))),this.storage=_Q(kQ(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(){return new WL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend(p(p({},this.config),{},{addOptions:()=>$Q(this.options,e)}));return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new WL(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'.concat(t.name,'".')),t.options=_Q(kQ(t,"addOptions",{name:t.name})),t.storage=_Q(kQ(t,"addStorage",{name:t.name,options:t.options})),t}}function VL(e){return new WQ({find:e.find,handler:t=>{let{state:n,range:i,match:r,pasteEvent:s}=t;const o=_Q(e.getAttributes,void 0,r,s);if(!1===o||null===o)return null;const{tr:a}=n,l=r[r.length-1],c=r[0];let u=i.to;if(l){const t=c.search(/\S/),r=i.from+c.indexOf(l),s=r+l.length;if(wL(i.from,i.to,n.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>r).length)return null;s<i.to&&a.delete(s,i.to),r>i.from&&a.delete(i.from+t,r),u=i.from+t+l.length,a.addMark(i.from+t,u,e.type.create(o||{})),a.removeStoredMark(e.type)}}})}const UL=["editor","innerRef"];function XL(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var qL,ZL={exports:{}},HL={};ZL.exports=function(){if(qL)return HL;qL=1;var e=s,t="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},n=e.useState,i=e.useEffect,r=e.useLayoutEffect,o=e.useDebugValue;function a(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!t(e,i)}catch(r){return!0}}var l="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),l=n({inst:{value:s,getSnapshot:t}}),c=l[0].inst,u=l[1];return r(function(){c.value=s,c.getSnapshot=t,a(c)&&u({inst:c})},[e,s,t]),i(function(){return a(c)&&u({inst:c}),e(function(){a(c)&&u({inst:c})})},[e]),o(s),s};return HL.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:l,HL}();var YL=ZL.exports;const GL=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):t&&(t.current=e)})}},KL=e=>{let{contentComponent:t}=e;const n=YL.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return s.createElement(s.Fragment,null,Object.values(n))};class JL extends s.Component{constructor(e){var t;super(e),this.editorContentRef=s.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:Boolean(null===(t=e.editor)||void 0===t?void 0:t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=function(){const e=new Set;let t={};return{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(n,i){t=p(p({},t),{},{[n]:YP.createPortal(i.reactElement,i.element,n)}),e.forEach(e=>e())},removeRenderer(n){const i=p({},t);delete i[n],t=i,e.forEach(e=>e())}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e)return;if(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild)return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const e=this.props,{editor:t,innerRef:n}=e,i=l(e,UL);return s.createElement(s.Fragment,null,s.createElement("div",p({ref:GL(n,this.editorContentRef)},i)),(null===t||void 0===t?void 0:t.contentComponent)&&s.createElement(KL,{contentComponent:t.contentComponent}))}}const ej=(0,s.forwardRef)((e,t)=>{const n=s.useMemo(()=>Math.floor(4294967295*Math.random()).toString(),[e.editor]);return s.createElement(JL,p({key:n,innerRef:t},e))}),tj=s.memo(ej);var nj,ij=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,r,s;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(r=i;0!==r--;)if(!e(t[r],n[r]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(r of t.entries())if(!n.has(r[0]))return!1;for(r of t.entries())if(!e(r[1],n.get(r[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(r of t.entries())if(!n.has(r[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if((i=t.length)!=n.length)return!1;for(r=i;0!==r--;)if(t[r]!==n[r])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(s=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(r=i;0!==r--;)if(!Object.prototype.hasOwnProperty.call(n,s[r]))return!1;for(r=i;0!==r--;){var o=s[r];if(("_owner"!==o||!t.$$typeof)&&!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},rj=XL(ij),sj={exports:{}},oj={};sj.exports=function(){if(nj)return oj;nj=1;var e=s,t=YL,n="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=t.useSyncExternalStore,r=e.useRef,o=e.useEffect,a=e.useMemo,l=e.useDebugValue;return oj.useSyncExternalStoreWithSelector=function(e,t,s,c,u){var h=r(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=a(function(){function e(e){if(!o){if(o=!0,i=e,e=c(e),void 0!==u&&d.hasValue){var t=d.value;if(u(t,e))return r=t}return r=e}if(t=r,n(i,e))return t;var s=c(e);return void 0!==u&&u(t,s)?t:(i=e,r=s)}var i,r,o=!1,a=void 0===s?null:s;return[function(){return e(t())},null===a?void 0:function(){return e(a())}]},[t,s,c,u]);var p=i(e,h[0],h[1]);return o(function(){d.hasValue=!0,d.value=p},[p]),l(p),p},oj}();var aj=sj.exports;const lj="undefined"!==typeof window?s.useLayoutEffect:s.useEffect;class cj{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(e=>e())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}}const uj="undefined"===typeof window,hj=uj||Boolean("undefined"!==typeof window&&window.next);class dj{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return void 0===this.options.current.immediatelyRender?uj||hj?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){var e=this;const t=p(p({},this.options.current),{},{onBeforeCreate:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onBeforeCreate)||void 0===n?void 0:n.call(t,...r)},onBlur:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onBlur)||void 0===n?void 0:n.call(t,...r)},onCreate:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onCreate)||void 0===n?void 0:n.call(t,...r)},onDestroy:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onDestroy)||void 0===n?void 0:n.call(t,...r)},onFocus:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onFocus)||void 0===n?void 0:n.call(t,...r)},onSelectionUpdate:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onSelectionUpdate)||void 0===n?void 0:n.call(t,...r)},onTransaction:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onTransaction)||void 0===n?void 0:n.call(t,...r)},onUpdate:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onUpdate)||void 0===n?void 0:n.call(t,...r)},onContentError:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onContentError)||void 0===n?void 0:n.call(t,...r)},onDrop:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onDrop)||void 0===n?void 0:n.call(t,...r)},onPaste:function(){for(var t,n,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return null===(n=(t=e.options.current).onPaste)||void 0===n?void 0:n.call(t,...r)}});return new QL(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(n=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)||("extensions"===n&&e.extensions&&t.extensions?e.extensions.length===t.extensions.length&&e.extensions.every((e,n)=>{var i;return e===(null===(i=t.extensions)||void 0===i?void 0:i[n])}):e[n]===t[n]))}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===e.length?dj.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions(p(p({},this.options.current),{},{editable:this.editor.isEditable})):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps)return void(this.previousDeps=e);const t=this.previousDeps.length===e.length&&this.previousDeps.every((t,n)=>t===e[n]);if(t)return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{this.isComponentMounted&&this.instanceId===e?t&&t.setOptions(this.options.current):t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function pj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=(0,s.useRef)(e);n.current=e;const[i]=(0,s.useState)(()=>new dj(n)),r=YL.useSyncExternalStore(i.subscribe,i.getEditor,i.getServerSnapshot);return(0,s.useDebugValue)(r),(0,s.useEffect)(i.onRender(t)),function(e){var t;const[n]=(0,s.useState)(()=>new cj(e.editor)),i=aj.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,null!==(t=e.equalityFn)&&void 0!==t?t:rj);lj(()=>n.watch(e.editor),[e.editor,n]),(0,s.useDebugValue)(i)}({editor:r,selector:t=>{let{transactionNumber:n}=t;return!1===e.shouldRerenderOnTransaction?null:e.immediatelyRender&&0===n?0:n+1}}),r}const fj=(0,s.createContext)({editor:null});fj.Consumer;const mj=(0,s.createContext)({onDragStart:void 0}),gj=()=>(0,s.useContext)(mj);s.forwardRef((e,t)=>{const{onDragStart:n}=gj(),i=e.as||"div";return s.createElement(i,p(p({},e),{},{ref:t,"data-node-view-wrapper":"",onDragStart:n,style:p({whiteSpace:"normal"},e.style)}))});const vj=/^\s*>\s$/,yj=WL.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML(e){let{HTMLAttributes:t}=e;return["blockquote",CQ(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>e=>{let{commands:t}=e;return t.wrapIn(this.name)},toggleBlockquote:()=>e=>{let{commands:t}=e;return t.toggleWrap(this.name)},unsetBlockquote:()=>e=>{let{commands:t}=e;return t.lift(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[zL({find:vj,type:this.type})]}}),Oj=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,wj=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,bj=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,kj=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,xj=zQ.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML(e){let{HTMLAttributes:t}=e;return["strong",CQ(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleBold:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetBold:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[LL({find:Oj,type:this.type}),LL({find:bj,type:this.type})]},addPasteRules(){return[VL({find:wj,type:this.type}),VL({find:kj,type:this.type})]}}),Dj="textStyle",Sj=/^\s*([-+*])\s$/,Cj=WL.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return"".concat(this.options.itemTypeName,"+")},parseHTML:()=>[{tag:"ul"}],renderHTML(e){let{HTMLAttributes:t}=e;return["ul",CQ(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>e=>{let{commands:t,chain:n}=e;return this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(Dj)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=zL({find:Sj,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=zL({find:Sj,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Dj),editor:this.editor})),[e]}}),Aj=/(^|[^`])`([^`]+)`(?!`)/,Ej=/(^|[^`])`([^`]+)`(?!`)/g,_j=zQ.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML(e){let{HTMLAttributes:t}=e;return["code",CQ(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleCode:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetCode:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[LL({find:Aj,type:this.type})]},addPasteRules(){return[VL({find:Ej,type:this.type})]}}),Tj=/^```([a-z]+)?[\s\n]$/,Pj=/^~~~([a-z]+)?[\s\n]$/,Mj=WL.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,i=[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter(e=>e.startsWith(n)).map(e=>e.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML(e){let{node:t,HTMLAttributes:n}=e;return["pre",CQ(this.options.HTMLAttributes,n),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>t=>{let{commands:n}=t;return n.setNode(this.name,e)},toggleCodeBlock:e=>t=>{let{commands:n}=t;return n.toggleNode(this.name,"paragraph",e)}}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!n&&t.parent.textContent.length)&&this.editor.commands.clearNodes())},Enter:e=>{let{editor:t}=e;if(!this.options.exitOnTripleEnter)return!1;const{state:n}=t,{selection:i}=n,{$from:r,empty:s}=i;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,a=r.parent.textContent.endsWith("\n\n");return!(!o||!a)&&t.chain().command(e=>{let{tr:t}=e;return t.delete(r.pos-2,r.pos),!0}).exitCode().run()},ArrowDown:e=>{let{editor:t}=e;if(!this.options.exitOnArrowDown)return!1;const{state:n}=t,{selection:i,doc:r}=n,{$from:s,empty:o}=i;if(!o||s.parent.type!==this.type)return!1;if(!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();if(void 0===a)return!1;return r.nodeAt(a)?t.commands.command(e=>{let{tr:t}=e;return t.setSelection(JF.near(r.resolve(a))),!0}):t.commands.exitCode()}}},addInputRules(){return[$L({find:Tj,type:this.type,getAttributes:e=>({language:e[1]})}),$L({find:Pj,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new yR({key:new bR("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),i=t.clipboardData.getData("vscode-editor-data"),r=i?JSON.parse(i):void 0,s=null===r||void 0===r?void 0:r.mode;if(!n||!s)return!1;const{tr:o,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,"\n"));return o.replaceSelectionWith(this.type.create({language:s},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(iR.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),e.dispatch(o),!0}}})]}}),Fj=WL.create({name:"doc",topNode:!0,content:"block+"});function Rj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new yR({view:t=>new Nj(t,e)})}class Nj{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=t.width)&&void 0!==n?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(e=>{let{name:t,handler:n}=e;return this.editorView.dom.removeEventListener(t,n)})}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent,i=this.editorView.dom,r=i.getBoundingClientRect(),s=r.width/i.offsetWidth,o=r.height/i.offsetHeight;if(n){let n=t.nodeBefore,i=t.nodeAfter;if(n||i){let t=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(t){let r=t.getBoundingClientRect(),s=n?r.bottom:r.top;n&&i&&(s=(s+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let a=this.width/2*o;e={left:r.left,right:r.right,top:s-a,bottom:s+a}}}}if(!e){let t=this.editorView.coordsAtPos(this.cursorPos),n=this.width/2*s;e={left:t.left-n,right:t.left+n,top:t.top,bottom:t.bottom}}let a,l,c=this.editorView.dom.offsetParent;if(this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!c||c==document.body&&"static"==getComputedStyle(c).position)a=-pageXOffset,l=-pageYOffset;else{let e=c.getBoundingClientRect(),t=e.width/c.offsetWidth,n=e.height/c.offsetHeight;a=e.left-c.scrollLeft*t,l=e.top-c.scrollTop*n}this.element.style.left=(e.left-a)/s+"px",this.element.style.top=(e.top-l)/o+"px",this.element.style.width=(e.right-e.left)/s+"px",this.element.style.height=(e.bottom-e.top)/o+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=n&&n.type.spec.disableDropCursor,r="function"==typeof i?i(this.editorView,t,e):i;if(t&&!r){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=IF(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const Ij=ZQ.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[Rj(this.options)]}});class Bj extends JF{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return Bj.valid(n)?new Bj(n):JF.near(n)}content(){return aM.empty}eq(e){return e instanceof Bj&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new Bj(e.resolve(t.pos))}getBookmark(){return new Qj(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),i=e.node(t);if(0!=n)for(let e=i.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||Lj(e.type))return!0;if(e.inlineContent)return!1}else if(i.type.spec.isolating)return!0}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),i=e.node(t);if(n!=i.childCount)for(let e=i.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||Lj(e.type))return!0;if(e.inlineContent)return!1}else if(i.type.spec.isolating)return!0}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e:for(;;){if(!n&&Bj.valid(e))return e;let i=e.pos,r=null;for(let n=e.depth;;n--){let s=e.node(n);if(t>0?e.indexAfter(n)<s.childCount:e.index(n)>0){r=s.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;i+=t;let o=e.doc.resolve(i);if(Bj.valid(o))return o}for(;;){let s=t>0?r.firstChild:r.lastChild;if(!s){if(r.isAtom&&!r.isText&&!sR.isSelectable(r)){e=e.doc.resolve(i+r.nodeSize*t),n=!1;continue e}break}r=s,i+=t;let o=e.doc.resolve(i);if(Bj.valid(o))return o}return null}}}Bj.prototype.visible=!1,Bj.findFrom=Bj.findGapCursorFrom,JF.jsonID("gapcursor",Bj);class Qj{constructor(e){this.pos=e}map(e){return new Qj(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Bj.valid(t)?new Bj(t):JF.near(t)}}function Lj(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}const jj=zB({ArrowLeft:$j("horiz",-1),ArrowRight:$j("horiz",1),ArrowUp:$j("vert",-1),ArrowDown:$j("vert",1)});function $j(e,t){const n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,i,r){let s=e.selection,o=t>0?s.$to:s.$from,a=s.empty;if(s instanceof iR){if(!r.endOfTextblock(n)||0==o.depth)return!1;a=!1,o=e.doc.resolve(t>0?o.after():o.before())}let l=Bj.findGapCursorFrom(o,t,a);return!!l&&(i&&i(e.tr.setSelection(new Bj(l))),!0)}}function zj(e,t,n){if(!e||!e.editable)return!1;let i=e.state.doc.resolve(t);if(!Bj.valid(i))return!1;let r=e.posAtCoords({left:n.clientX,top:n.clientY});return!(r&&r.inside>-1&&sR.isSelectable(e.state.doc.nodeAt(r.inside)))&&(e.dispatch(e.state.tr.setSelection(new Bj(i))),!0)}function Wj(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof Bj))return!1;let{$from:n}=e.state.selection,i=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!i)return!1;let r=tM.empty;for(let o=i.length-1;o>=0;o--)r=tM.from(i[o].createAndFill(null,r));let s=e.state.tr.replace(n.pos,n.pos,new aM(r,0,0));return s.setSelection(iR.near(s.doc.resolve(n.pos+1))),e.dispatch(s),!1}function Vj(e){if(!(e.selection instanceof Bj))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",aB.create(e.doc,[rB.widget(e.selection.head,t,{key:"gapcursor"})])}const Uj=ZQ.create({name:"gapCursor",addProseMirrorPlugins:()=>[new yR({props:{decorations:Vj,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&Bj.valid(n)?new Bj(n):null,handleClick:zj,handleKeyDown:jj,handleDOMEvents:{beforeinput:Wj}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!==(t=_Q(kQ(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))&&void 0!==t?t:null}}}),Xj=WL.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML(e){let{HTMLAttributes:t}=e;return["br",CQ(this.options.HTMLAttributes,t)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>e=>{let{commands:t,chain:n,state:i,editor:r}=e;return t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:e,storedMarks:t}=i;if(e.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=r.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();return n().insertContent({type:this.name}).command(e=>{let{tr:t,dispatch:n}=e;if(n&&a&&s){const e=a.filter(e=>o.includes(e.type.name));t.ensureMarks(e)}return!0}).run()})])}}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),qj=WL.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:"h".concat(e),attrs:{level:e}}))},renderHTML(e){let{node:t,HTMLAttributes:n}=e;const i=this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0];return["h".concat(i),CQ(this.options.HTMLAttributes,n),0]},addCommands(){return{setHeading:e=>t=>{let{commands:n}=t;return!!this.options.levels.includes(e.level)&&n.setNode(this.name,e)},toggleHeading:e=>t=>{let{commands:n}=t;return!!this.options.levels.includes(e.level)&&n.toggleNode(this.name,"paragraph",e)}}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>p(p({},e),{["Mod-Alt-".concat(t)]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>$L({find:new RegExp("^(#{".concat(Math.min(...this.options.levels),",").concat(e,"})\\s$")),type:this.type,getAttributes:{level:e}}))}});var Zj=200,Hj=function(){};Hj.prototype.append=function(e){return e.length?(e=Hj.from(e),!this.length&&e||e.length<Zj&&this.leafAppend(e)||this.length<Zj&&e.leafPrepend(this)||this.appendInner(e)):this},Hj.prototype.prepend=function(e){return e.length?Hj.from(e).append(this):this},Hj.prototype.appendInner=function(e){return new Gj(this,e)},Hj.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?Hj.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},Hj.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},Hj.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},Hj.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var i=[];return this.forEach(function(t,n){return i.push(e(t,n))},t,n),i},Hj.from=function(e){return e instanceof Hj?e:e&&e.length?new Yj(e):Hj.empty};var Yj=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,i){for(var r=t;r<n;r++)if(!1===e(this.values[r],i+r))return!1},t.prototype.forEachInvertedInner=function(e,t,n,i){for(var r=t-1;r>=n;r--)if(!1===e(this.values[r],i+r))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=Zj)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=Zj)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(Hj);Hj.empty=new Yj([]);var Gj=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,i){var r=this.left.length;return!(t<r&&!1===this.left.forEachInner(e,t,Math.min(n,r),i))&&(!(n>r&&!1===this.right.forEachInner(e,Math.max(t-r,0),Math.min(this.length,n)-r,i+r))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,i){var r=this.left.length;return!(t>r&&!1===this.right.forEachInvertedInner(e,t-r,Math.max(n,r)-r,i+r))&&(!(n<r&&!1===this.left.forEachInvertedInner(e,Math.min(t,r),n,i))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(Hj);const Kj=Hj;class Jj{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let n,i,r=this.items.length;for(;;r--){if(this.items.get(r-1).selection){--r;break}}t&&(n=this.remapping(r,this.items.length),i=n.maps.length);let s,o,a=e.tr,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step)return n||(n=this.remapping(r,t+1),i=n.maps.length),i--,void c.push(e);if(n){c.push(new e$(e.map));let t,r=e.step.map(n.slice(i));r&&a.maybeStep(r).doc&&(t=a.mapping.maps[a.mapping.maps.length-1],l.push(new e$(t,void 0,void 0,l.length+c.length))),i--,t&&n.appendMap(t,i)}else a.maybeStep(e.step);return e.selection?(s=n?e.selection.map(n.slice(i)):e.selection,o=new Jj(this.items.slice(0,r).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:o,transform:a,selection:s}}addTransform(e,t,n,i){let r=[],s=this.eventCount,o=this.items,a=!i&&o.length?o.get(o.length-1):null;for(let c=0;c<e.steps.length;c++){let n,l=e.steps[c].invert(e.docs[c]),u=new e$(e.mapping.maps[c],l,t);(n=a&&a.merge(u))&&(u=n,c?r.pop():o=o.slice(0,o.length-1)),r.push(u),t&&(s++,t=void 0),i||(a=u)}let l=s-n.depth;return l>n$&&(o=function(e,t){let n;return e.forEach((e,i)=>{if(e.selection&&0==t--)return n=i,!1}),e.slice(n)}(o,l),s-=l),new Jj(o.append(r),s)}remapping(e,t){let n=new pF;return this.items.forEach((t,i)=>{let r=null!=t.mirrorOffset&&i-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,r)},e,t),n}addMaps(e){return 0==this.eventCount?this:new Jj(this.items.append(e.map(e=>new e$(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-t),r=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach(e=>{e.selection&&o--},i);let a=t;this.items.forEach(t=>{let i=r.getMirror(--a);if(null==i)return;s=Math.min(s,i);let l=r.maps[i];if(t.step){let s=e.steps[i].invert(e.docs[i]),c=t.selection&&t.selection.map(r.slice(a+1,i));c&&o++,n.push(new e$(l,s,c))}else n.push(new e$(l))},i);let l=[];for(let h=t;h<s;h++)l.push(new e$(r.maps[h]));let c=this.items.slice(0,i).append(l).append(n),u=new Jj(c,o);return u.emptyItemCount()>500&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length,t=this.remapping(0,e),n=t.maps.length,i=[],r=0;return this.items.forEach((s,o)=>{if(o>=e)i.push(s),s.selection&&r++;else if(s.step){let e=s.step.map(t.slice(n)),o=e&&e.getMap();if(n--,o&&t.appendMap(o,n),e){let a=s.selection&&s.selection.map(t.slice(n));a&&r++;let l,c=new e$(o.invert(),e,a),u=i.length-1;(l=i.length&&i[u].merge(c))?i[u]=l:i.push(c)}}else s.map&&n--},this.items.length,0),new Jj(Kj.from(i.reverse()),r)}}Jj.empty=new Jj(Kj.empty,0);class e${constructor(e,t,n,i){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new e$(t.getMap().invert(),t,this.selection)}}}class t${constructor(e,t,n,i,r){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=i,this.prevComposition=r}}const n$=20;function i$(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,i,r)=>t.push(i,r));return t}function r$(e,t){if(!e)return null;let n=[];for(let i=0;i<e.length;i+=2){let r=t.map(e[i],1),s=t.map(e[i+1],-1);r<=s&&n.push(r,s)}return n}let s$=!1,o$=null;function a$(e){let t=e.plugins;if(o$!=t){s$=!1,o$=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){s$=!0;break}}return s$}const l$=new bR("history"),c$=new bR("closeHistory");function u$(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new yR({key:l$,state:{init:()=>new t$(Jj.empty,Jj.empty,null,0,-1),apply:(t,n,i)=>function(e,t,n,i){let r,s=n.getMeta(l$);if(s)return s.historyState;n.getMeta(c$)&&(e=new t$(e.done,e.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(o&&o.getMeta(l$))return o.getMeta(l$).redo?new t$(e.done.addTransform(n,void 0,i,a$(t)),e.undone,i$(n.mapping.maps),e.prevTime,e.prevComposition):new t$(e.done,e.undone.addTransform(n,void 0,i,a$(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||o&&!1===o.getMeta("addToHistory"))return(r=n.getMeta("rebased"))?new t$(e.done.rebased(n,r),e.undone.rebased(n,r),r$(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new t$(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),r$(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let r=n.getMeta("composition"),s=0==e.prevTime||!o&&e.prevComposition!=r&&(e.prevTime<(n.time||0)-i.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,i)=>{for(let r=0;r<t.length;r+=2)e<=t[r+1]&&i>=t[r]&&(n=!0)}),n}(n,e.prevRanges)),a=o?r$(e.prevRanges,n.mapping):i$(n.mapping.maps);return new t$(e.done.addTransform(n,s?t.selection.getBookmark():void 0,i,a$(t)),Jj.empty,a,n.time,null==r?e.prevComposition:r)}}(n,i,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,i="historyUndo"==n?d$:"historyRedo"==n?p$:null;return!(!i||!e.editable)&&(t.preventDefault(),i(e.state,e.dispatch))}}}})}function h$(e,t){return(n,i)=>{let r=l$.getState(n);if(!r||0==(e?r.undone:r.done).eventCount)return!1;if(i){let s=function(e,t,n){let i=a$(t),r=l$.get(t).spec.config,s=(n?e.undone:e.done).popEvent(t,i);if(!s)return null;let o=s.selection.resolve(s.transform.doc),a=(n?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),r,i),l=new t$(n?a:s.remaining,n?s.remaining:a,null,0,-1);return s.transform.setSelection(o).setMeta(l$,{redo:n,historyState:l})}(r,n,e);s&&i(t?s.scrollIntoView():s)}return!0}}const d$=h$(!1,!0),p$=h$(!0,!0);h$(!1,!1),h$(!0,!1);const f$=ZQ.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>e=>{let{state:t,dispatch:n}=e;return d$(t,n)},redo:()=>e=>{let{state:t,dispatch:n}=e;return p$(t,n)}}),addProseMirrorPlugins(){return[u$(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),m$=WL.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML(e){let{HTMLAttributes:t}=e;return["hr",CQ(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>e=>{let{chain:t,state:n}=e;if(!function(e,t){const{selection:n}=e,{$from:i}=n;if(n instanceof sR){const e=i.index();return i.parent.canReplaceWith(e,e+1,t)}let r=i.depth;for(;r>=0;){const e=i.index(r);if(i.node(r).contentMatchAt(e).matchType(t))return!0;r-=1}return!1}(n,n.schema.nodes[this.name]))return!1;const{selection:i}=n,{$from:r,$to:s}=i,o=t();return 0===r.parentOffset?o.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):!function(e){return e instanceof sR}(i)?o.insertContent({type:this.name}):o.insertContentAt(s.pos,{type:this.name}),o.command(e=>{let{tr:t,dispatch:n}=e;var i;if(n){const{$to:e}=t.selection,n=e.end();if(e.nodeAfter)e.nodeAfter.isTextblock?t.setSelection(iR.create(t.doc,e.pos+1)):e.nodeAfter.isBlock?t.setSelection(sR.create(t.doc,e.pos)):t.setSelection(iR.create(t.doc,e.pos));else{const r=null===(i=e.parent.type.contentMatch.defaultType)||void 0===i?void 0:i.create();r&&(t.insert(n,r),t.setSelection(iR.create(t.doc,n+1)))}t.scrollIntoView()}return!0}).run()}}},addInputRules(){return[jL({find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type})]}}),g$=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,v$=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,y$=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,O$=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,w$=zQ.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML(e){let{HTMLAttributes:t}=e;return["em",CQ(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleItalic:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetItalic:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[LL({find:g$,type:this.type}),LL({find:y$,type:this.type})]},addPasteRules(){return[VL({find:v$,type:this.type}),VL({find:O$,type:this.type})]}}),b$=WL.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML(e){let{HTMLAttributes:t}=e;return["li",CQ(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),k$=["start"],x$="textStyle",D$=/^(\d+)\.\s$/,S$=WL.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return"".concat(this.options.itemTypeName,"+")},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML(e){let{HTMLAttributes:t}=e;const{start:n}=t,i=l(t,k$);return 1===n?["ol",CQ(this.options.HTMLAttributes,i),0]:["ol",CQ(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>e=>{let{commands:t,chain:n}=e;return this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(x$)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=zL({find:D$,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=zL({find:D$,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>p({start:+e[1]},this.editor.getAttributes(x$)),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),C$=WL.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML(e){let{HTMLAttributes:t}=e;return["p",CQ(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>e=>{let{commands:t}=e;return t.setNode(this.name)}}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),A$=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,E$=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,_$=zQ.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML(e){let{HTMLAttributes:t}=e;return["s",CQ(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleStrike:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetStrike:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[LL({find:A$,type:this.type})]},addPasteRules(){return[VL({find:E$,type:this.type})]}}),T$=WL.create({name:"text",group:"inline"}),P$=ZQ.create({name:"starterKit",addExtensions(){const e=[];return!1!==this.options.bold&&e.push(xj.configure(this.options.bold)),!1!==this.options.blockquote&&e.push(yj.configure(this.options.blockquote)),!1!==this.options.bulletList&&e.push(Cj.configure(this.options.bulletList)),!1!==this.options.code&&e.push(_j.configure(this.options.code)),!1!==this.options.codeBlock&&e.push(Mj.configure(this.options.codeBlock)),!1!==this.options.document&&e.push(Fj.configure(this.options.document)),!1!==this.options.dropcursor&&e.push(Ij.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&e.push(Uj.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&e.push(Xj.configure(this.options.hardBreak)),!1!==this.options.heading&&e.push(qj.configure(this.options.heading)),!1!==this.options.history&&e.push(f$.configure(this.options.history)),!1!==this.options.horizontalRule&&e.push(m$.configure(this.options.horizontalRule)),!1!==this.options.italic&&e.push(w$.configure(this.options.italic)),!1!==this.options.listItem&&e.push(b$.configure(this.options.listItem)),!1!==this.options.orderedList&&e.push(S$.configure(this.options.orderedList)),!1!==this.options.paragraph&&e.push(C$.configure(this.options.paragraph)),!1!==this.options.strike&&e.push(_$.configure(this.options.strike)),!1!==this.options.text&&e.push(T$.configure(this.options.text)),e}}),M$=new bR("y-sync"),F$=new bR("y-undo"),R$=new bR("yjs-cursor"),N$=/[\uD800-\uDBFF]/,I$=/[\uDC00-\uDFFF]/,B$=(e,t)=>{let n=0,i=0;for(;n<e.length&&n<t.length&&e[n]===t[n];)n++;for(n>0&&N$.test(e[n-1])&&n--;i+n<e.length&&i+n<t.length&&e[e.length-i-1]===t[t.length-i-1];)i++;return i>0&&I$.test(e[e.length-i])&&i--,{index:n,remove:e.length-n-i,insert:t.slice(n,t.length-i)}};const Q$=e=>class{constructor(e){this._=e}destroy(){e(this._)}},L$=Q$(clearTimeout),j$=(e,t)=>new L$(setTimeout(t,e));Q$(clearInterval),Q$(e=>"undefined"!==typeof requestAnimationFrame&&cancelAnimationFrame(e)),Q$(e=>"undefined"!==typeof cancelIdleCallback&&cancelIdleCallback(e));let $$=null;const z$=()=>{const e=$$;$$=null,e.forEach((e,t)=>{const n=t.state.tr,i=M$.getState(t.state);i&&i.binding&&!i.binding.isDestroyed&&(e.forEach((e,t)=>{n.setMeta(t,e)}),t.dispatch(n))})},W$=(e,t,n)=>{if(0===e)return _x(t,0,0===t.length?-1:0);let i=null===t._first?null:t._first.content.type;for(;null!==i&&t!==i;){if(i instanceof mS){if(i._length>=e)return _x(i,e,0===t.length?-1:0);if(e-=i._length,null!==i._item&&null!==i._item.next)i=i._item.next.content.type;else{do{i=null===i._item?null:i._item.parent,e--}while(i!==t&&null!==i&&null!==i._item&&null===i._item.next);null!==i&&i!==t&&(i=null===i._item?null:i._item.next.content.type)}}else{const r=(n.get(i)||{nodeSize:0}).nodeSize;if(null!==i._first&&e<r)i=i._first.content.type,e--;else{if(1===e&&0===i._length&&r>1)return new Sx(null===i._item?null:i._item.id,null===i._item?xx(i):null,null);if(e-=r,null!==i._item&&null!==i._item.next)i=i._item.next.content.type;else{if(0===e)return i=null===i._item?i:i._item.parent,new Sx(null===i._item?null:i._item.id,null===i._item?xx(i):null,null);do{i=i._item.parent,e--}while(i!==t&&null===i._item.next);i!==t&&(i=i._item.next.content.type)}}}if(null===i)throw KO();if(0===e&&i.constructor!==mS&&i!==t)return V$(i._item.parent,i._item)}return _x(t,t._length,0===t.length?-1:0)},V$=(e,t)=>{let n=null,i=null;return null===e._item?i=xx(e):n=kx(e._item.id.client,e._item.id.clock),new Sx(n,i,t.id)},U$=(e,t,n,i)=>{const r=Tx(n,e);if(null===r||r.type!==t&&!Dx(t,r.type._item))return null;let s=r.type,o=0;if(s.constructor===mS)o=r.index;else if(null===s._item||!s._item.deleted){let e=s._first,t=0;for(;t<s._length&&t<r.index&&null!==e;){if(!e.deleted){const n=e.content.type;t++,o+=n instanceof mS?n._length:i.get(n).nodeSize}e=e.right}o+=1}for(;s!==t&&null!==s._item;){const e=s._item.parent;if(null===e._item||!e._item.deleted){o+=1;let t=e._first;for(;null!==t;){const e=t.content.type;if(e===s)break;t.deleted||(o+=e instanceof mS?e._length:i.get(e).nodeSize),t=t.right}}s=e}return o-1};function X$(e){const t=e.toArray(),n=e=>{let t;if(e instanceof mS){t=e.toDelta().map(e=>{const t={type:"text",text:e.insert};return e.attributes&&(t.marks=Object.keys(e.attributes).map(t=>{const n=e.attributes[t],i={type:wz(t)};return Object.keys(n)&&(i.attrs=n),i})),t})}else if(e instanceof dS){t={type:e.nodeName};const i=e.getAttributes();Object.keys(i).length&&(t.attrs=i);const r=e.toArray();r.length&&(t.content=r.map(n).flat())}else KO();return t};return{type:"doc",content:t.map(n)}}const q$=(e,t)=>e>>>t|e<<32-t,Z$=e=>q$(e,2)^q$(e,13)^q$(e,22),H$=e=>q$(e,6)^q$(e,11)^q$(e,25),Y$=e=>q$(e,7)^q$(e,18)^e>>>3,G$=e=>q$(e,17)^q$(e,19)^e>>>10,K$=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),J$=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);class ez{constructor(){const e=new ArrayBuffer(320);this._H=new Uint32Array(e,0,8),this._H.set(J$),this._W=new Uint32Array(e,64,64)}_updateHash(){const e=this._H,t=this._W;for(let u=16;u<64;u++)t[u]=G$(t[u-2])+t[u-7]+Y$(t[u-15])+t[u-16];let n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7];for(let u,h,d=0;d<64;d++)u=c+H$(o)+(o&a^~o&l)+K$[d]+t[d]>>>0,h=Z$(n)+(n&i^n&r^i&r)>>>0,c=l,l=a,a=o,o=s+u>>>0,s=r,r=i,i=n,n=u+h>>>0;e[0]+=n,e[1]+=i,e[2]+=r,e[3]+=s,e[4]+=o,e[5]+=a,e[6]+=l,e[7]+=c}digest(e){let t=0;for(;t+56<=e.length;){let n=0;for(;n<16&&t+3<e.length;n++)this._W[n]=e[t++]<<24|e[t++]<<16|e[t++]<<8|e[t++];if(t%64!==0){for(this._W.fill(0,n,16);t<e.length;)this._W[n]|=e[t]<<8*(3-t%4),t++;this._W[n]|=fO<<8*(3-t%4)}this._updateHash()}const n=t%64!==0;this._W.fill(0,0,16);let i=0;for(;t<e.length;i++)for(let n=3;n>=0&&t<e.length;n--)this._W[i]|=e[t++]<<8*n;n||(this._W[i-(t%4===0?0:1)]|=fO<<8*(3-t%4)),this._W[14]=e.byteLength/mO,this._W[15]=8*e.byteLength,this._updateHash();const r=new Uint8Array(32);for(let s=0;s<this._H.length;s++)for(let e=0;e<4;e++)r[4*s+e]=this._H[s]>>>8*(3-e);return r}}const tz=e=>Yw((e=>{for(let t=6;t<e.length;t++)e[t%6]=e[t%6]^e[t];return e.slice(0,6)})((e=>(new ez).digest(e))(Gw(e)))),nz=(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&t.sv.get(e.id.client)>e.id.clock&&!jk(t.ds,e.id),iz=[{light:"#ecd44433",dark:"#ecd444"}],rz=(e,t,n)=>{if(!e.has(n)){if(e.size<t.length){const n=Jy();e.forEach(e=>n.add(e)),t=t.filter(e=>!n.has(e))}e.set(n,(i=t)[lO(yw()*i.length)])}var i;return e.get(n)},sz=(e,t)=>({type:t.selection.jsonID,anchor:W$(t.selection.anchor,e.type,e.mapping),head:W$(t.selection.head,e.type,e.mapping)});class oz{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;this.type=e,this.prosemirrorView=null,this.mux=(()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else void 0!==n&&n()}})(),this.mapping=t,this.isOMark=new Map,this._observeFunction=this._typeChanged.bind(this),this.doc=e.doc,this.beforeTransactionSelection=null,this.beforeAllTransactions=()=>{null===this.beforeTransactionSelection&&null!=this.prosemirrorView&&(this.beforeTransactionSelection=sz(this,this.prosemirrorView.state))},this.afterAllTransactions=()=>{this.beforeTransactionSelection=null},this._domSelectionInView=null}get _tr(){return this.prosemirrorView.state.tr.setMeta("addToHistory",!1)}_isLocalCursorInView(){return!!this.prosemirrorView.hasFocus()&&(jw&&null===this._domSelectionInView&&(j$(0,()=>{this._domSelectionInView=null}),this._domSelectionInView=this._isDomSelectionInView()),this._domSelectionInView)}_isDomSelectionInView(){const e=this.prosemirrorView._root.getSelection();if(null==e||null==e.anchorNode)return!1;const t=this.prosemirrorView._root.createRange();t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset);0===t.getClientRects().length&&t.startContainer&&t.collapsed&&t.selectNodeContents(t.startContainer);const n=t.getBoundingClientRect(),i=pk.documentElement;return n.bottom>=0&&n.right>=0&&n.left<=(window.innerWidth||i.clientWidth||0)&&n.top<=(window.innerHeight||i.clientHeight||0)}renderSnapshot(e,t){t||(t=Fx(Vk(),new Map)),this.prosemirrorView.dispatch(this._tr.setMeta(M$,{snapshot:e,prevSnapshot:t}))}unrenderSnapshot(){this.mapping.clear(),this.mux(()=>{const e=this.type.toArray().map(e=>lz(e,this.prosemirrorView.state.schema,this)).filter(e=>null!==e),t=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new aM(tM.from(e),0,0));t.setMeta(M$,{snapshot:null,prevSnapshot:null}),this.prosemirrorView.dispatch(t)})}_forceRerender(){this.mapping.clear(),this.mux(()=>{const e=null!==this.beforeTransactionSelection?null:this.prosemirrorView.state.selection,t=this.type.toArray().map(e=>lz(e,this.prosemirrorView.state.schema,this)).filter(e=>null!==e),n=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new aM(tM.from(t),0,0));if(e){const t=uO(hO(e.anchor,0),n.doc.content.size),i=uO(hO(e.head,0),n.doc.content.size);n.setSelection(iR.create(n.doc,t,i))}this.prosemirrorView.dispatch(n.setMeta(M$,{isChangeOrigin:!0,binding:this}))})}_renderSnapshot(e,t,n){let i=this.doc,r=this.type;if(e||(e=Rx(this.doc)),e instanceof Uint8Array||t instanceof Uint8Array)if(e instanceof Uint8Array&&t instanceof Uint8Array||KO(),i=new Yk({gc:!1}),ax(i,t),t=Rx(i),ax(i,e),e=Rx(i),null===r._item){const e=Array.from(this.doc.share.keys()).find(e=>this.doc.share.get(e)===this.type);r=i.getXmlFragment(e)}else{var s;const e=null!==(s=i.store.clients.get(r._item.id.client))&&void 0!==s?s:[],t=e[$x(e,r._item.id.clock)].content;r=t.type}this.mapping.clear(),this.mux(()=>{i.transact(i=>{const s=n.permanentUserData;s&&s.dss.forEach(e=>{Lk(i,e,e=>{})});const o=(e,t)=>{const i="added"===e?s.getUserByClientId(t.client):s.getUserByDeletedId(t);return{user:i,type:e,color:rz(n.colorMapping,n.colors,i)}},a=_D(r,new Mx(t.ds,e.sv)).map(n=>!n._item.deleted||nz(n._item,e)||nz(n._item,t)?lz(n,this.prosemirrorView.state.schema,{mapping:new Map,isOMark:new Map},e,t,o):null).filter(e=>null!==e),l=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new aM(tM.from(a),0,0));this.prosemirrorView.dispatch(l.setMeta(M$,{isChangeOrigin:!0}))},M$)})}_typeChanged(e,t){if(null==this.prosemirrorView)return;const n=M$.getState(this.prosemirrorView.state);0!==e.length&&null==n.snapshot&&null==n.prevSnapshot?this.mux(()=>{const e=(e,t)=>this.mapping.delete(t);Lk(t,t.deleteSet,e=>{if(e.constructor===zS){const t=e.content.type;t&&this.mapping.delete(t)}}),t.changed.forEach(e),t.changedParentTypes.forEach(e);const n=this.type.toArray().map(e=>az(e,this.prosemirrorView.state.schema,this)).filter(e=>null!==e);let i=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new aM(tM.from(n),0,0));((e,t,n)=>{if(null!==t&&null!==t.anchor&&null!==t.head)if("all"===t.type)e.setSelection(new aR(e.doc));else if("node"===t.type){const i=U$(n.doc,n.type,t.anchor,n.mapping);e.setSelection(sR.create(e.doc,i))}else{const i=U$(n.doc,n.type,t.anchor,n.mapping),r=U$(n.doc,n.type,t.head,n.mapping);if(null!==i&&null!==r){const t=iR.between(e.doc.resolve(i),e.doc.resolve(r));e.setSelection(t)}}})(i,this.beforeTransactionSelection,this),i=i.setMeta(M$,{isChangeOrigin:!0,isUndoRedoOperation:t.origin instanceof rD}),null!==this.beforeTransactionSelection&&this._isLocalCursorInView()&&i.scrollIntoView(),this.prosemirrorView.dispatch(i)}):this.renderSnapshot(n.snapshot,n.prevSnapshot)}_prosemirrorChanged(e){this.doc.transact(()=>{xz(this.doc,this.type,e,this),this.beforeTransactionSelection=sz(this,this.prosemirrorView.state)},M$)}initView(e){null!=this.prosemirrorView&&this.destroy(),this.prosemirrorView=e,this.doc.on("beforeAllTransactions",this.beforeAllTransactions),this.doc.on("afterAllTransactions",this.afterAllTransactions),this.type.observeDeep(this._observeFunction)}destroy(){null!=this.prosemirrorView&&(this.prosemirrorView=null,this.type.unobserveDeep(this._observeFunction),this.doc.off("beforeAllTransactions",this.beforeAllTransactions),this.doc.off("afterAllTransactions",this.afterAllTransactions))}}const az=(e,t,n,i,r,s)=>{const o=n.mapping.get(e);if(void 0===o){if(e instanceof dS)return lz(e,t,n,i,r,s);throw GO()}return o},lz=(e,t,n,i,r,s)=>{const o=[],a=e=>{if(e instanceof dS){const a=az(e,t,n,i,r,s);null!==a&&o.push(a)}else{var a;const l=null===(a=e._item.right)||void 0===a||null===(a=a.content)||void 0===a?void 0:a.type;l instanceof cS&&!l._item.deleted&&l._item.id.client===l.doc.clientID&&(e.applyDelta([{retain:e.length},...l.toDelta()]),l.doc.transact(e=>{l._item.delete(e)}));const c=cz(e,t,n,i,r,s);null!==c&&c.forEach(e=>{null!==e&&o.push(e)})}};void 0===i||void 0===r?e.toArray().forEach(a):_D(e,new Mx(r.ds,i.sv)).forEach(a);try{const a=e.getAttributes(i);void 0!==i&&(nz(e._item,i)?nz(e._item,r)||(a.ychange=s?s("added",e._item.id):{type:"added"}):a.ychange=s?s("removed",e._item.id):{type:"removed"});const l=t.node(e.nodeName,a,o);return n.mapping.set(e,l),l}catch(Kre){return e.doc.transact(t=>{e._item.delete(t)},M$),n.mapping.delete(e),null}},cz=(e,t,n,i,r,s)=>{const o=[],a=e.toDelta(i,r,s);try{for(let e=0;e<a.length;e++){const n=a[e];o.push(t.text(n.insert,bz(n.attributes,t)))}}catch(Kre){return e.doc.transact(t=>{e._item.delete(t)},M$),null}return o},uz=(e,t)=>e instanceof Array?((e,t)=>{const n=new mS,i=e.map(e=>({insert:e.text,attributes:kz(e.marks,t)}));return n.applyDelta(i),t.mapping.set(n,e),n})(e,t):((e,t)=>{const n=new dS(e.type.name);for(const i in e.attrs){const t=e.attrs[i];null!==t&&"ychange"!==i&&n.setAttribute(i,t)}return n.insert(0,pz(e).map(e=>uz(e,t))),t.mapping.set(n,e),n})(e,t),hz=e=>"object"===typeof e&&null!==e,dz=(e,t)=>{const n=Object.keys(e).filter(t=>null!==e[t]);let i=n.length===(null==t?0:Object.keys(t).filter(e=>null!==t[e]).length);for(let r=0;r<n.length&&i;r++){const s=n[r],o=e[s],a=t[s];i="ychange"===s||o===a||hz(o)&&hz(a)&&dz(o,a)}return i},pz=e=>{const t=e.content.content,n=[];for(let i=0;i<t.length;i++){const e=t[i];if(e.isText){const e=[];for(let n=t[i];i<t.length&&n.isText;n=t[++i])e.push(n);i--,n.push(e)}else n.push(e)}return n},fz=(e,t)=>{const n=e.toDelta();return n.length===t.length&&n.every((e,n)=>e.insert===t[n].text&&Tw(e.attributes||{}).length===t[n].marks.length&&Mw(e.attributes,(e,i)=>{var r;const s=wz(i),o=t[n].marks;return dz(e,null===(r=o.find(e=>e.type.name===s))||void 0===r?void 0:r.attrs)}))},mz=(e,t)=>{if(e instanceof dS&&!(t instanceof Array)&&Dz(e,t)){const n=pz(t);return e._length===n.length&&dz(e.getAttributes(),t.attrs)&&e.toArray().every((e,t)=>mz(e,n[t]))}return e instanceof mS&&t instanceof Array&&fz(e,t)},gz=(e,t)=>e===t||e instanceof Array&&t instanceof Array&&e.length===t.length&&e.every((e,n)=>t[n]===e),vz=(e,t,n)=>{const i=e.toArray(),r=pz(t),s=r.length,o=i.length,a=uO(o,s);let l=0,c=0,u=!1;for(;l<a;l++){const e=i[l],t=r[l];if(gz(n.mapping.get(e),t))u=!0;else if(!mz(e,t))break}for(;l+c<a;c++){const e=i[o-c-1],t=r[s-c-1];if(gz(n.mapping.get(e),t))u=!0;else if(!mz(e,t))break}return{equalityFactor:l+c,foundMappedChild:u}},yz=(e,t,n)=>{n.mapping.set(e,t);const{nAttrs:i,str:r}=(e=>{let t="",n=e._start;const i={};for(;null!==n;)n.deleted||(n.countable&&n.content instanceof AS?t+=n.content.str:n.content instanceof xS&&(i[n.content.key]=null)),n=n.right;return{str:t,nAttrs:i}})(e),s=t.map(e=>({insert:e.text,attributes:Object.assign({},i,kz(e.marks,n))})),{insert:o,remove:a,index:l}=B$(r,s.map(e=>e.insert).join(""));e.delete(l,a),e.insert(l,o),e.applyDelta(s.map(e=>({retain:e.insert.length,attributes:e.attributes})))},Oz=/(.*)(--[a-zA-Z0-9+/=]{8})$/,wz=e=>{var t,n;return null!==(t=null===(n=Oz.exec(e))||void 0===n?void 0:n[1])&&void 0!==t?t:e},bz=(e,t)=>{const n=[];for(const i in e)n.push(t.mark(wz(i),e[i]));return n},kz=(e,t)=>{const n={};return e.forEach(e=>{if("ychange"!==e.type.name){const i=Ky(t.isOMark,e.type,()=>!e.type.excludes(e.type));n[i?"".concat(e.type.name,"--").concat(tz(e.toJSON())):e.type.name]=e.attrs}}),n},xz=(e,t,n,i)=>{if(t instanceof dS&&t.nodeName!==n.type.name)throw new Error("node name mismatch!");if(i.mapping.set(t,n),t instanceof dS){const e=t.getAttributes(),i=n.attrs;for(const n in i)null!==i[n]?e[n]!==i[n]&&"ychange"!==n&&t.setAttribute(n,i[n]):t.removeAttribute(n);for(const n in e)void 0===i[n]&&t.removeAttribute(n)}const r=pz(n),s=r.length,o=t.toArray(),a=o.length,l=uO(s,a);let c=0,u=0;for(;c<l;c++){const e=o[c],t=r[c];if(!gz(i.mapping.get(e),t)){if(!mz(e,t))break;i.mapping.set(e,t)}}for(;u+c<l;u++){const e=o[a-u-1],t=r[s-u-1];if(!gz(i.mapping.get(e),t)){if(!mz(e,t))break;i.mapping.set(e,t)}}e.transact(()=>{for(;a-c-u>0&&s-c-u>0;){const n=o[c],l=r[c],h=o[a-u-1],d=r[s-u-1];if(n instanceof mS&&l instanceof Array)fz(n,l)||yz(n,l,i),c+=1;else{let r=n instanceof dS&&Dz(n,l),s=h instanceof dS&&Dz(h,d);if(r&&s){const e=vz(n,l,i),t=vz(h,d,i);e.foundMappedChild&&!t.foundMappedChild?s=!1:!e.foundMappedChild&&t.foundMappedChild||e.equalityFactor<t.equalityFactor?r=!1:s=!1}r?(xz(e,n,l,i),c+=1):s?(xz(e,h,d,i),u+=1):(i.mapping.delete(t.get(c)),t.delete(c,1),t.insert(c,[uz(l,i)]),c+=1)}}const n=a-c-u;if(1===a&&0===s&&o[0]instanceof mS?(i.mapping.delete(o[0]),o[0].delete(0,o[0].length)):n>0&&(t.slice(c,c+n).forEach(e=>i.mapping.delete(e)),t.delete(c,n)),c+u<s){const e=[];for(let t=c;t<s-u;t++)e.push(uz(r[t],i));t.insert(c,e)}},M$)},Dz=(e,t)=>!(t instanceof Array)&&e.nodeName===t.type.name,Sz=e=>{var t;return null!=(null===(t=F$.getState(e))||void 0===t||null===(t=t.undoManager)||void 0===t?void 0:t.undo())},Cz=e=>{var t;return null!=(null===(t=F$.getState(e))||void 0===t||null===(t=t.undoManager)||void 0===t?void 0:t.redo())},Az=new Set(["paragraph"]),Ez=function(){let{protectedNodes:e=Az,trackedOrigins:t=[],undoManager:n=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new yR({key:F$,state:{init:(i,r)=>{const s=M$.getState(r),o=n||new rD(s.type,{trackedOrigins:new Set([M$].concat(t)),deleteFilter:t=>((e,t)=>!(e instanceof zS)||!(e.content instanceof IS)||!(e.content.type instanceof cS||e.content.type instanceof dS&&t.has(e.content.type.nodeName))||0===e.content.type._length)(t,e),captureTransaction:e=>!1!==e.meta.get("addToHistory")});return{undoManager:o,prevSel:null,hasUndoOps:o.undoStack.length>0,hasRedoOps:o.redoStack.length>0}},apply:(e,t,n,i)=>{const r=M$.getState(i).binding,s=t.undoManager,o=s.undoStack.length>0,a=s.redoStack.length>0;return r?{undoManager:s,prevSel:sz(r,n),hasUndoOps:o,hasRedoOps:a}:o!==t.hasUndoOps||a!==t.hasRedoOps?Object.assign({},t,{hasUndoOps:s.undoStack.length>0,hasRedoOps:s.redoStack.length>0}):t}},view:e=>{const t=M$.getState(e.state),n=F$.getState(e.state).undoManager;return n.on("stack-item-added",n=>{let{stackItem:i}=n;const r=t.binding;r&&i.meta.set(r,F$.getState(e.state).prevSel)}),n.on("stack-item-popped",e=>{let{stackItem:n}=e;const i=t.binding;i&&(i.beforeTransactionSelection=n.meta.get(i)||i.beforeTransactionSelection)}),{destroy:()=>{n.destroy()}}}})},_z=ZQ.create({name:"collaboration",priority:1e3,addOptions:()=>({document:null,field:"default",fragment:null}),addStorage:()=>({isDisabled:!1}),onCreate(){this.editor.extensionManager.extensions.find(e=>"history"===e.name)&&console.warn('[tiptap warn]: "@tiptap/extension-collaboration" comes with its own history support and is not compatible with "@tiptap/extension-history".')},addCommands:()=>({undo:()=>e=>{let{tr:t,state:n,dispatch:i}=e;t.setMeta("preventDispatch",!0);return 0!==F$.getState(n).undoManager.undoStack.length&&(!i||Sz(n))},redo:()=>e=>{let{tr:t,state:n,dispatch:i}=e;t.setMeta("preventDispatch",!0);return 0!==F$.getState(n).undoManager.redoStack.length&&(!i||Cz(n))}}),addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo()}},addProseMirrorPlugins(){var e;const t=this.options.fragment?this.options.fragment:this.options.document.getXmlFragment(this.options.field),n=Ez(this.options.yUndoOptions),i=n.spec.view;n.spec.view=e=>{const{undoManager:t}=F$.getState(e.state);t.restore&&(t.restore(),t.restore=()=>{});const n=i?i(e):void 0;return{destroy:()=>{const e=t.trackedOrigins.has(t),i=t._observers;t.restore=()=>{e&&t.trackedOrigins.add(t),t.doc.on("afterTransaction",t.afterTransactionHandler),t._observers=i},(null===n||void 0===n?void 0:n.destroy)&&n.destroy()}}};const r=p(p({},this.options.ySyncOptions),{},{onFirstRender:this.options.onFirstRender}),s=function(e){let{colors:t=iz,colorMapping:n=new Map,permanentUserData:i=null,onFirstRender:r=()=>{},mapping:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!1;const a=new oz(e,s),l=new yR({props:{editable:e=>{const t=M$.getState(e);return null==t.snapshot&&null==t.prevSnapshot}},key:M$,state:{init:(r,s)=>({type:e,doc:e.doc,binding:a,snapshot:null,prevSnapshot:null,isChangeOrigin:!1,isUndoRedoOperation:!1,addToHistory:!0,colors:t,colorMapping:n,permanentUserData:i}),apply:(e,t)=>{const n=e.getMeta(M$);if(void 0!==n){t=Object.assign({},t);for(const e in n)t[e]=n[e]}return t.addToHistory=!1!==e.getMeta("addToHistory"),t.isChangeOrigin=void 0!==n&&!!n.isChangeOrigin,t.isUndoRedoOperation=void 0!==n&&!!n.isChangeOrigin&&!!n.isUndoRedoOperation,null!==a.prosemirrorView&&(void 0===n||null==n.snapshot&&null==n.prevSnapshot||j$(0,()=>{null!=a.prosemirrorView&&(null==n.restore?a._renderSnapshot(n.snapshot,n.prevSnapshot,t):(a._renderSnapshot(n.snapshot,n.snapshot,t),delete t.restore,delete t.snapshot,delete t.prevSnapshot,a.mux(()=>{a._prosemirrorChanged(a.prosemirrorView.state.doc)})))})),t}},view:e=>(a.initView(e),null==s&&a._forceRerender(),r(),{update:()=>{const t=l.getState(e.state);if(null==t.snapshot&&null==t.prevSnapshot&&(o||null!==e.state.doc.content.findDiffStart(e.state.doc.type.createAndFill().content))){if(o=!0,!1===t.addToHistory&&!t.isChangeOrigin){const t=F$.getState(e.state),n=t&&t.undoManager;n&&n.stopCapturing()}a.mux(()=>{t.doc.transact(n=>{n.meta.set("addToHistory",t.addToHistory),a._prosemirrorChanged(e.state.doc)},M$)})}},destroy:()=>{a.destroy()}})});return l}(t,r);return this.editor.options.enableContentCheck&&(null===(e=t.doc)||void 0===e||e.on("beforeTransaction",()=>{try{const e=X$(t);if(0===e.content.length)return;this.editor.schema.nodeFromJSON(e).check()}catch(e){return this.editor.emit("contentError",{error:e,editor:this.editor,disableCollaboration:()=>{var e;null===(e=t.doc)||void 0===e||e.destroy(),this.storage.isDisabled=!0}}),!1}})),[s,n,this.editor.options.enableContentCheck&&new yR({key:new bR("filterInvalidContent"),filterTransaction:()=>{var e;return!this.storage.isDisabled||(null===(e=t.doc)||void 0===e||e.destroy(),!0)}})].filter(Boolean)}});const Tz=(e,t,n)=>e!==t,Pz=e=>{const t=document.createElement("span");t.classList.add("ProseMirror-yjs-cursor"),t.setAttribute("style","border-color: ".concat(e.color));const n=document.createElement("div");n.setAttribute("style","background-color: ".concat(e.color)),n.insertBefore(document.createTextNode(e.name),null);const i=document.createTextNode("\u2060"),r=document.createTextNode("\u2060");return t.insertBefore(i,null),t.insertBefore(n,null),t.insertBefore(r,null),t},Mz=e=>({style:"background-color: ".concat(e.color,"70"),class:"ProseMirror-yjs-selection"}),Fz=/^#[0-9a-fA-F]{6}$/,Rz=(e,t,n,i,r)=>{const s=M$.getState(e),o=s.doc,a=[];return null!=s.snapshot||null!=s.prevSnapshot||0===s.binding.mapping.size?aB.create(e.doc,[]):(t.getStates().forEach((t,l)=>{if(n(o.clientID,l,t)&&null!=t.cursor){const n=t.user||{};null==n.color?n.color="#ffa500":Fz.test(n.color)||console.warn("A user uses an unsupported color format",n),null==n.name&&(n.name="User: ".concat(l));let c=U$(o,s.type,Cx(t.cursor.anchor),s.binding.mapping),u=U$(o,s.type,Cx(t.cursor.head),s.binding.mapping);if(null!==c&&null!==u){const t=hO(e.doc.content.size-1,0);c=uO(c,t),u=uO(u,t),a.push(rB.widget(u,()=>i(n,l),{key:l+"",side:10}));const s=uO(c,u),o=hO(c,u);a.push(rB.inline(s,o,r(n,l),{inclusiveEnd:!0,inclusiveStart:!1}))}}}),aB.create(e.doc,a))},Nz=function(e){let{awarenessStateFilter:t=Tz,cursorBuilder:n=Pz,selectionBuilder:i=Mz,getSelection:r=e=>e.selection}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cursor";return new yR({key:R$,state:{init:(r,s)=>Rz(s,e,t,n,i),apply(r,s,o,a){const l=M$.getState(a),c=r.getMeta(R$);return l&&l.isChangeOrigin||c&&c.awarenessUpdated?Rz(a,e,t,n,i):s.map(r.mapping,r.doc)}},props:{decorations:e=>R$.getState(e)},view:t=>{const n=()=>{t.docView&&((e,t,n)=>{$$||($$=new Map,j$(0,z$)),Ky($$,e,Yy).set(t,n)})(t,R$,{awarenessUpdated:!0})},i=()=>{const n=M$.getState(t.state),i=e.getLocalState()||{};if(t.hasFocus()){const o=r(t.state),a=W$(o.anchor,n.type,n.binding.mapping),l=W$(o.head,n.type,n.binding.mapping);null!=i.cursor&&Px(Cx(i.cursor.anchor),a)&&Px(Cx(i.cursor.head),l)||e.setLocalStateField(s,{anchor:a,head:l})}else null!=i.cursor&&null!==U$(n.doc,n.type,Cx(i.cursor.anchor),n.binding.mapping)&&e.setLocalStateField(s,null)};return e.on("change",n),t.dom.addEventListener("focusin",i),t.dom.addEventListener("focusout",i),{update:i,destroy:()=>{t.dom.removeEventListener("focusin",i),t.dom.removeEventListener("focusout",i),e.off("change",n),e.setLocalStateField(s,null)}}}})},Iz=e=>Array.from(e.entries()).map(e=>{let[t,n]=e;return p({clientId:t},n.user)}),Bz=()=>null,Qz=ZQ.create({name:"collaborationCursor",priority:999,addOptions:()=>({provider:null,user:{name:null,color:null},render:e=>{const t=document.createElement("span");t.classList.add("collaboration-cursor__caret"),t.setAttribute("style","border-color: ".concat(e.color));const n=document.createElement("div");return n.classList.add("collaboration-cursor__label"),n.setAttribute("style","background-color: ".concat(e.color)),n.insertBefore(document.createTextNode(e.name),null),t.insertBefore(n,null),t},selectionRender:Mz,onUpdate:Bz}),onCreate(){if(this.options.onUpdate!==Bz&&console.warn('[tiptap warn]: DEPRECATED: The "onUpdate" option is deprecated. Please use `editor.storage.collaborationCursor.users` instead. Read more: https://tiptap.dev/api/extensions/collaboration-cursor'),!this.options.provider)throw new Error('The "provider" option is required for the CollaborationCursor extension')},addStorage:()=>({users:[]}),addCommands(){return{updateUser:e=>()=>(this.options.user=e,this.options.provider.awareness.setLocalStateField("user",this.options.user),!0),user:e=>t=>{let{editor:n}=t;return console.warn('[tiptap warn]: DEPRECATED: The "user" command is deprecated. Please use "updateUser" instead. Read more: https://tiptap.dev/api/extensions/collaboration-cursor'),n.commands.updateUser(e)}}},addProseMirrorPlugins(){return[Nz((()=>(this.options.provider.awareness.setLocalStateField("user",this.options.user),this.storage.users=Iz(this.options.provider.awareness.states),this.options.provider.awareness.on("update",()=>{this.storage.users=Iz(this.options.provider.awareness.states)}),this.options.provider.awareness))(),{cursorBuilder:this.options.render,selectionBuilder:this.options.selectionRender})]}}),Lz=ZQ.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something \u2026",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new yR({key:new bR("placeholder"),props:{decorations:e=>{let{doc:t,selection:n}=e;const i=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=n,s=[];if(!i)return null;const o=this.editor.isEmpty;return t.descendants((e,t)=>{const n=r>=t&&r<=t+e.nodeSize,i=!e.isLeaf&&DL(e);if((n||!this.options.showOnlyCurrent)&&i){const i=[this.options.emptyNodeClass];o&&i.push(this.options.emptyEditorClass);const r=rB.node(t,t+e.nodeSize,{class:i.join(" "),"data-placeholder":"function"===typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:n}):this.options.placeholder});s.push(r)}return this.options.includeChildren}),aB.create(t,s)}}})]}}),jz=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()},$z=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),zz=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)};var Wz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Vz=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],Uz=(0,s.forwardRef)((e,t)=>{let{color:n="currentColor",size:i=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:a="",children:c,iconNode:u}=e,h=l(e,Vz);return(0,s.createElement)("svg",p(p(p({ref:t},Wz),{},{width:i,height:i,stroke:n,strokeWidth:o?24*Number(r)/Number(i):r,className:jz("lucide",a)},!c&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(h)&&{"aria-hidden":"true"}),h),[...u.map(e=>{let[t,n]=e;return(0,s.createElement)(t,n)}),...Array.isArray(c)?c:[c]])}),Xz=["className"],qz=(e,t)=>{const n=(0,s.forwardRef)((n,i)=>{let{className:r}=n,o=l(n,Xz);return(0,s.createElement)(Uz,p({ref:i,iconNode:t,className:jz("lucide-".concat($z(zz(e))),"lucide-".concat(e),r)},o))});return n.displayName=zz(e),n},Zz=qz("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]),Hz=qz("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]),Yz=qz("braces",[["path",{d:"M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1",key:"ezmyqa"}],["path",{d:"M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1",key:"e1hn23"}]]),Gz=qz("heading-1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]),Kz=qz("heading-2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]),Jz=qz("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]),eW=qz("list-ordered",[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]]),tW=qj.extend({addAttributes:()=>({level:{default:1,parseHTML:e=>{const t=e.getAttribute("level");return t?parseInt(t,10):parseInt(e.tagName.replace("H",""),10)},renderHTML:e=>({"data-level":"string"===typeof e.level?parseInt(e.level,10):e.level})}}),renderHTML(e){let{node:t,HTMLAttributes:n}=e;const i="string"===typeof t.attrs.level?parseInt(t.attrs.level,10):t.attrs.level,r=[1,2,3,4,5,6].includes(i)?i:1;return["h".concat(r),n,0]}}),nW=ZQ.create({name:"tabIndentation",addKeyboardShortcuts(){return{Tab:()=>!!this.editor.can().sinkListItem("listItem")&&this.editor.commands.sinkListItem("listItem"),"Shift-Tab":()=>!!this.editor.can().liftListItem("listItem")&&this.editor.commands.liftListItem("listItem")}}});function iW(e){var t,n,i,r,o,a;let{scrollTarget:l,isActive:c=!0}=e;const[u,h]=(0,s.useState)(!1),[d,p]=(0,s.useState)(null),[f,m]=(0,s.useState)(null);(0,s.useEffect)(()=>((async()=>{try{const{ydoc:e,provider:t}=await W_.connect();await W_.waitForDatabaseSync(),KS.log("\ud83d\udcca TiptapEditor: Connected to Y.XmlFragment"),p(e),m(t),h(!0)}catch(e){KS.error("Failed to initialize Tiptap editor:",e)}})(),()=>{W_.disconnect()}),[]);const g=pj({extensions:[P$.configure({history:!1,heading:!1}),tW.configure({levels:[1,2,3,4,5,6]}),Lz.configure({placeholder:"Start typing..."}),nW,...d&&f?[_z.configure({fragment:d.getXmlFragment("prosemirror")}),Qz.configure({provider:f,user:{name:(null===(t=f.awareness)||void 0===t||null===(n=t.getLocalState())||void 0===n||null===(i=n.user)||void 0===i?void 0:i.name)||"Anonymous",color:(null===(r=f.awareness)||void 0===r||null===(o=r.getLocalState())||void 0===o||null===(a=o.user)||void 0===a?void 0:a.color)||"#B399D4"}})]:[]],editorProps:{attributes:{class:"tiptap-editor"}},editable:u},[d,f,u]);return(0,s.useEffect)(()=>{if(!g||!f)return;const e=()=>{const e=g.state.selection.anchor;f.awareness.setLocalStateField("cursorPosition",e)};return g.on("selectionUpdate",e),e(),()=>{g.off("selectionUpdate",e)}},[g,f]),(0,s.useEffect)(()=>{var e,t;if(!g||!f)return;const n=e=>{const t=g.view.dom;if(t){const n="url(data:image/svg+xml;base64,".concat(btoa('\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z" fill="'.concat(e,'" stroke="').concat(e,'" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n          </svg>\n        ').trim()),") 0 0, text");t.style.cursor=n,KS.log("\ud83c\udfa8 TipTap: Mouse cursor updated to:",e)}},i=null===(e=f.awareness.getLocalState())||void 0===e||null===(t=e.user)||void 0===t?void 0:t.color;i&&n(i);const r=W_.onColorChange(e=>{var t,i;KS.log("\ud83c\udfa8 TipTap: Updating cursor color to:",e),n(e);const r=(null===(t=f.awareness.getLocalState())||void 0===t||null===(i=t.user)||void 0===i?void 0:i.name)||"Anonymous";try{g.chain().updateUser({name:r,color:e}).run()}catch(Kre){KS.warn("Could not update TipTap collaborative cursor:",Kre)}});return()=>r()},[g,f]),(0,s.useEffect)(()=>{if(!g||!c)return;const e=e=>{const{query:t,matchIndex:n}=e.detail;if(!t)return;const i=g.state.doc.content.size,r=g.state.doc.textBetween(0,i,"\n","\n"),s=t.toLowerCase();let o=0,a=-1;for(let h=0;h<=n&&(a=r.toLowerCase().indexOf(s,o),-1!==a);h++)o=a+s.length;if(-1===a)return;let l=0,c=0,u=0;g.state.doc.descendants((e,t)=>{if(u>0)return!1;if(e.isText&&e.text){const n=l,i=l+e.text.length;if(a>=n&&a<i){return c=t+(a-n),u=c+s.length,!1}l+=e.text.length}else e.isBlock&&l>0&&(l+=1);return!0}),0===u&&(c=Math.min(a+1,i-1),u=Math.min(c+s.length,i));try{g.chain().focus().setTextSelection({from:c,to:u}).run(),requestAnimationFrame(()=>{if(g.view.coordsAtPos(c)){const e=g.state.doc.resolve(c),t=e.depth>0?e.before(1):0,n=g.view.nodeDOM(t);n instanceof HTMLElement&&n.scrollIntoView({behavior:"smooth",block:"center"})}})}catch(e){KS.warn("Could not scroll to search match:",e)}};return window.addEventListener("searchScrollTo",e),()=>window.removeEventListener("searchScrollTo",e)},[g,c]),(0,s.useEffect)(()=>{if(!l||!g)return;const e=g.state.doc.content.size,t=Math.min(Math.max(1,l.position),e-1);try{g.chain().focus().setTextSelection(t).run(),requestAnimationFrame(()=>{const e=g.view.coordsAtPos(t);if(e){const n=g.state.doc.resolve(t),i=g.view.nodeDOM(n.before(1));if(i instanceof HTMLElement)i.scrollIntoView({behavior:"smooth",block:"center"});else{const t=g.view.dom.closest(".tiptap-editor");if(t){const n=t.getBoundingClientRect(),i=e.top-n.top+t.scrollTop,r=t.clientHeight/2;t.scrollTo({top:i-r,behavior:"smooth"})}}}})}catch(Kre){KS.warn("Could not scroll to position:",Kre)}},[l,g]),u?(0,Qt.jsx)(Qt.Fragment,{children:(0,Qt.jsxs)("div",{className:"tiptap-container",children:[g&&(0,Qt.jsxs)("div",{className:"tiptap-toolbar",children:[(0,Qt.jsx)("button",{onClick:()=>g.chain().focus().toggleBold().run(),className:g.isActive("bold")?"is-active":"",title:"Bold (Ctrl+B)",children:(0,Qt.jsx)(Zz,{size:18})}),(0,Qt.jsx)("button",{onClick:()=>g.chain().focus().toggleItalic().run(),className:g.isActive("italic")?"is-active":"",title:"Italic (Ctrl+I)",children:(0,Qt.jsx)(Hz,{size:18})}),(0,Qt.jsx)("button",{onClick:()=>g.chain().focus().toggleCode().run(),className:g.isActive("code")?"is-active":"",title:"Inline Code (Ctrl+E)",children:(0,Qt.jsx)(Yz,{size:18})}),(0,Qt.jsx)("div",{className:"toolbar-divider"}),(0,Qt.jsx)("button",{onClick:()=>g.chain().focus().toggleHeading({level:1}).run(),className:g.isActive("heading",{level:1})?"is-active":"",title:"Heading 1",children:(0,Qt.jsx)(Gz,{size:18})}),(0,Qt.jsx)("button",{onClick:()=>g.chain().focus().toggleHeading({level:2}).run(),className:g.isActive("heading",{level:2})?"is-active":"",title:"Heading 2",children:(0,Qt.jsx)(Kz,{size:18})}),(0,Qt.jsx)("div",{className:"toolbar-divider"}),(0,Qt.jsx)("button",{onClick:()=>g.chain().focus().toggleBulletList().run(),className:g.isActive("bulletList")?"is-active":"",title:"Bullet List",children:(0,Qt.jsx)(Jz,{size:18})}),(0,Qt.jsx)("button",{onClick:()=>g.chain().focus().toggleOrderedList().run(),className:g.isActive("orderedList")?"is-active":"",title:"Numbered List",children:(0,Qt.jsx)(eW,{size:18})})]}),(0,Qt.jsx)(tj,{editor:g})]})}):(0,Qt.jsxs)("div",{className:"tiptap-loading",children:[(0,Qt.jsx)("div",{className:"loading-spinner"}),(0,Qt.jsx)("p",{children:"Loading editor..."})]})}const rW=qz("mouse-pointer-2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]),sW=qz("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),oW=qz("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),aW=qz("maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);function lW(e){let{activeTool:t,onToolChange:n,onAutoArrange:i,onCenterView:r,cardCount:s,connectionCount:o}=e;return(0,Qt.jsxs)("div",{className:"canvas-toolbar",onPointerDown:e=>e.stopPropagation(),children:[(0,Qt.jsx)("button",{className:"canvas-tool-btn ".concat("select"===t?"active":""),onClick:()=>n("select"),title:"Select & drag cards",children:(0,Qt.jsx)(rW,{size:16})}),(0,Qt.jsx)("button",{className:"canvas-tool-btn ".concat("connect"===t?"active":""),onClick:()=>n("connect"),title:"Draw connections between cards",children:(0,Qt.jsx)(sW,{size:16})}),(0,Qt.jsx)("div",{className:"canvas-divider"}),(0,Qt.jsxs)("button",{className:"canvas-tool-btn canvas-tool-btn-labeled",onClick:i,title:"Re-group cards by section",children:[(0,Qt.jsx)(oW,{size:14}),(0,Qt.jsx)("span",{children:"Re-group"})]}),(0,Qt.jsxs)("button",{className:"canvas-tool-btn canvas-tool-btn-labeled",onClick:r,title:"Fit all cards in view",children:[(0,Qt.jsx)(aW,{size:14}),(0,Qt.jsx)("span",{children:"Center"})]}),(0,Qt.jsx)("div",{className:"canvas-divider"}),(0,Qt.jsxs)("span",{className:"canvas-toolbar-info",children:[s," cards",o>0?" \xb7 ".concat(o," links"):""]})]})}const cW=qz("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);function uW(){}function hW(){}const dW=/^(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDB0-\uDDDB\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2-\uDFF6]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])(?:[\$0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u0870-\u0887\u0889-\u088F\u0897-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5C\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDC-\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1715\u171F-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1ABF-\u1ADD\u1AE0-\u1AEB\u1B00-\u1B4C\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA827\uA82C\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF65-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDD40-\uDD65\uDD69-\uDD6D\uDD6F-\uDD85\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDEC2-\uDEC7\uDEFA-\uDF1C\uDF27\uDF30-\uDF50\uDF70-\uDF85\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC75\uDC7F-\uDCBA\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD3\uDFE1\uDFE2]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E-\uDC61\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39\uDF40-\uDF46]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B-\uDD43\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEB0-\uDEF8\uDF60-\uDF67\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDDB0-\uDDDB\uDDE0-\uDDE9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF42\uDF50-\uDF5A\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC40-\uDC55\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFE4\uDFF0-\uDFF6]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD833[\uDCF0-\uDCF9\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAE\uDEC0-\uDEF9]|\uD839[\uDCD0-\uDCF9\uDDD0-\uDDFA\uDEC0-\uDEDE\uDEE0-\uDEF5\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]|\uDB40[\uDD00-\uDDEF])*$/,pW=/^(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDB0-\uDDDB\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2-\uDFF6]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])(?:[\$\x2D0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u0870-\u0887\u0889-\u088F\u0897-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5C\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDC-\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1715\u171F-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1ABF-\u1ADD\u1AE0-\u1AEB\u1B00-\u1B4C\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA827\uA82C\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF65-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDD40-\uDD65\uDD69-\uDD6D\uDD6F-\uDD85\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDEC2-\uDEC7\uDEFA-\uDF1C\uDF27\uDF30-\uDF50\uDF70-\uDF85\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC75\uDC7F-\uDCBA\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD3\uDFE1\uDFE2]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E-\uDC61\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39\uDF40-\uDF46]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B-\uDD43\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEB0-\uDEF8\uDF60-\uDF67\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDDB0-\uDDDB\uDDE0-\uDDE9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF42\uDF50-\uDF5A\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC40-\uDC55\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFE4\uDFF0-\uDFF6]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD833[\uDCF0-\uDCF9\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAE\uDEC0-\uDEF9]|\uD839[\uDCD0-\uDCF9\uDDD0-\uDDFA\uDEC0-\uDEDE\uDEE0-\uDEF5\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]|\uDB40[\uDD00-\uDDEF])*$/,fW={};function mW(e,t){return((t||fW).jsx?pW:dW).test(e)}const gW=/[ \t\n\f\r]/g;function vW(e){return""===e.replace(gW,"")}class yW{constructor(e,t,n){this.normal=t,this.property=e,n&&(this.space=n)}}function OW(e,t){const n={},i={};for(const r of e)Object.assign(n,r.property),Object.assign(i,r.normal);return new yW(n,i,t)}function wW(e){return e.toLowerCase()}yW.prototype.normal={},yW.prototype.property={},yW.prototype.space=void 0;class bW{constructor(e,t){this.attribute=t,this.property=e}}bW.prototype.attribute="",bW.prototype.booleanish=!1,bW.prototype.boolean=!1,bW.prototype.commaOrSpaceSeparated=!1,bW.prototype.commaSeparated=!1,bW.prototype.defined=!1,bW.prototype.mustUseProperty=!1,bW.prototype.number=!1,bW.prototype.overloadedBoolean=!1,bW.prototype.property="",bW.prototype.spaceSeparated=!1,bW.prototype.space=void 0;let kW=0;const xW=TW(),DW=TW(),SW=TW(),CW=TW(),AW=TW(),EW=TW(),_W=TW();function TW(){return 2**++kW}const PW=Object.keys(i);class MW extends bW{constructor(e,t,n,r){let s=-1;if(super(e,t),FW(this,"space",r),"number"===typeof n)for(;++s<PW.length;){const e=PW[s];FW(this,PW[s],(n&i[e])===i[e])}}}function FW(e,t,n){n&&(e[t]=n)}function RW(e){const t={},n={};for(const[i,r]of Object.entries(e.properties)){const s=new MW(i,e.transform(e.attributes||{},i),r,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(s.mustUseProperty=!0),t[i]=s,n[wW(i)]=i,n[wW(s.attribute)]=i}return new yW(t,n,e.space)}MW.prototype.defined=!0;const NW=RW({properties:{ariaActiveDescendant:null,ariaAtomic:DW,ariaAutoComplete:null,ariaBusy:DW,ariaChecked:DW,ariaColCount:CW,ariaColIndex:CW,ariaColSpan:CW,ariaControls:AW,ariaCurrent:null,ariaDescribedBy:AW,ariaDetails:null,ariaDisabled:DW,ariaDropEffect:AW,ariaErrorMessage:null,ariaExpanded:DW,ariaFlowTo:AW,ariaGrabbed:DW,ariaHasPopup:null,ariaHidden:DW,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:AW,ariaLevel:CW,ariaLive:null,ariaModal:DW,ariaMultiLine:DW,ariaMultiSelectable:DW,ariaOrientation:null,ariaOwns:AW,ariaPlaceholder:null,ariaPosInSet:CW,ariaPressed:DW,ariaReadOnly:DW,ariaRelevant:null,ariaRequired:DW,ariaRoleDescription:AW,ariaRowCount:CW,ariaRowIndex:CW,ariaRowSpan:CW,ariaSelected:DW,ariaSetSize:CW,ariaSort:null,ariaValueMax:CW,ariaValueMin:CW,ariaValueNow:CW,ariaValueText:null,role:null},transform:(e,t)=>"role"===t?t:"aria-"+t.slice(4).toLowerCase()});function IW(e,t){return t in e?e[t]:t}function BW(e,t){return IW(e,t.toLowerCase())}const QW=RW({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:EW,acceptCharset:AW,accessKey:AW,action:null,allow:null,allowFullScreen:xW,allowPaymentRequest:xW,allowUserMedia:xW,alt:null,as:null,async:xW,autoCapitalize:null,autoComplete:AW,autoFocus:xW,autoPlay:xW,blocking:AW,capture:null,charSet:null,checked:xW,cite:null,className:AW,cols:CW,colSpan:null,content:null,contentEditable:DW,controls:xW,controlsList:AW,coords:CW|EW,crossOrigin:null,data:null,dateTime:null,decoding:null,default:xW,defer:xW,dir:null,dirName:null,disabled:xW,download:SW,draggable:DW,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:xW,formTarget:null,headers:AW,height:CW,hidden:SW,high:CW,href:null,hrefLang:null,htmlFor:AW,httpEquiv:AW,id:null,imageSizes:null,imageSrcSet:null,inert:xW,inputMode:null,integrity:null,is:null,isMap:xW,itemId:null,itemProp:AW,itemRef:AW,itemScope:xW,itemType:AW,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:xW,low:CW,manifest:null,max:null,maxLength:CW,media:null,method:null,min:null,minLength:CW,multiple:xW,muted:xW,name:null,nonce:null,noModule:xW,noValidate:xW,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:xW,optimum:CW,pattern:null,ping:AW,placeholder:null,playsInline:xW,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:xW,referrerPolicy:null,rel:AW,required:xW,reversed:xW,rows:CW,rowSpan:CW,sandbox:AW,scope:null,scoped:xW,seamless:xW,selected:xW,shadowRootClonable:xW,shadowRootDelegatesFocus:xW,shadowRootMode:null,shape:null,size:CW,sizes:null,slot:null,span:CW,spellCheck:DW,src:null,srcDoc:null,srcLang:null,srcSet:null,start:CW,step:null,style:null,tabIndex:CW,target:null,title:null,translate:null,type:null,typeMustMatch:xW,useMap:null,value:DW,width:CW,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:AW,axis:null,background:null,bgColor:null,border:CW,borderColor:null,bottomMargin:CW,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:xW,declare:xW,event:null,face:null,frame:null,frameBorder:null,hSpace:CW,leftMargin:CW,link:null,longDesc:null,lowSrc:null,marginHeight:CW,marginWidth:CW,noResize:xW,noHref:xW,noShade:xW,noWrap:xW,object:null,profile:null,prompt:null,rev:null,rightMargin:CW,rules:null,scheme:null,scrolling:DW,standby:null,summary:null,text:null,topMargin:CW,valueType:null,version:null,vAlign:null,vLink:null,vSpace:CW,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:xW,disableRemotePlayback:xW,prefix:null,property:null,results:CW,security:null,unselectable:null},space:"html",transform:BW}),LW=RW({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:_W,accentHeight:CW,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:CW,amplitude:CW,arabicForm:null,ascent:CW,attributeName:null,attributeType:null,azimuth:CW,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:CW,by:null,calcMode:null,capHeight:CW,className:AW,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:CW,diffuseConstant:CW,direction:null,display:null,dur:null,divisor:CW,dominantBaseline:null,download:xW,dx:null,dy:null,edgeMode:null,editable:null,elevation:CW,enableBackground:null,end:null,event:null,exponent:CW,externalResourcesRequired:null,fill:null,fillOpacity:CW,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:EW,g2:EW,glyphName:EW,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:CW,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:CW,horizOriginX:CW,horizOriginY:CW,id:null,ideographic:CW,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:CW,k:CW,k1:CW,k2:CW,k3:CW,k4:CW,kernelMatrix:_W,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:CW,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:CW,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:CW,overlineThickness:CW,paintOrder:null,panose1:null,path:null,pathLength:CW,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:AW,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:CW,pointsAtY:CW,pointsAtZ:CW,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:_W,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:_W,rev:_W,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:_W,requiredFeatures:_W,requiredFonts:_W,requiredFormats:_W,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:CW,specularExponent:CW,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:CW,strikethroughThickness:CW,string:null,stroke:null,strokeDashArray:_W,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:CW,strokeOpacity:CW,strokeWidth:null,style:null,surfaceScale:CW,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:_W,tabIndex:CW,tableValues:null,target:null,targetX:CW,targetY:CW,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:_W,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:CW,underlineThickness:CW,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:CW,values:null,vAlphabetic:CW,vMathematical:CW,vectorEffect:null,vHanging:CW,vIdeographic:CW,version:null,vertAdvY:CW,vertOriginX:CW,vertOriginY:CW,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:CW,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:IW}),jW=RW({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform:(e,t)=>"xlink:"+t.slice(5).toLowerCase()}),$W=RW({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:BW}),zW=RW({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform:(e,t)=>"xml:"+t.slice(3).toLowerCase()}),WW=OW([NW,QW,jW,$W,zW],"html"),VW=OW([NW,LW,jW,$W,zW],"svg"),UW=/[A-Z]/g,XW=/-[a-z]/g,qW=/^data[-\w.:]+$/i;function ZW(e){return"-"+e.toLowerCase()}function HW(e){return e.charAt(1).toUpperCase()}const YW={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"};var GW=n(294);const KW=eV("end"),JW=eV("start");function eV(e){return function(t){const n=t&&t.position&&t.position[e]||{};if("number"===typeof n.line&&n.line>0&&"number"===typeof n.column&&n.column>0)return{line:n.line,column:n.column,offset:"number"===typeof n.offset&&n.offset>-1?n.offset:void 0}}}function tV(e){return e&&"object"===typeof e?"position"in e||"type"in e?iV(e.position):"start"in e||"end"in e?iV(e):"line"in e||"column"in e?nV(e):"":""}function nV(e){return rV(e&&e.line)+":"+rV(e&&e.column)}function iV(e){return nV(e&&e.start)+"-"+nV(e&&e.end)}function rV(e){return e&&"number"===typeof e?e:1}class sV extends Error{constructor(e,t,n){super(),"string"===typeof t&&(n=t,t=void 0);let i="",r={},s=!1;if(t&&(r="line"in t&&"column"in t||"start"in t&&"end"in t?{place:t}:"type"in t?{ancestors:[t],place:t.position}:p({},t)),"string"===typeof e?i=e:!r.cause&&e&&(s=!0,i=e.message,r.cause=e),!r.ruleId&&!r.source&&"string"===typeof n){const e=n.indexOf(":");-1===e?r.ruleId=n:(r.source=n.slice(0,e),r.ruleId=n.slice(e+1))}if(!r.place&&r.ancestors&&r.ancestors){const e=r.ancestors[r.ancestors.length-1];e&&(r.place=e.position)}const o=r.place&&"start"in r.place?r.place.start:r.place;this.ancestors=r.ancestors||void 0,this.cause=r.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file="",this.message=i,this.line=o?o.line:void 0,this.name=tV(r.place)||"1:1",this.place=r.place||void 0,this.reason=this.message,this.ruleId=r.ruleId||void 0,this.source=r.source||void 0,this.stack=s&&r.cause&&"string"===typeof r.cause.stack?r.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}sV.prototype.file="",sV.prototype.name="",sV.prototype.reason="",sV.prototype.message="",sV.prototype.stack="",sV.prototype.column=void 0,sV.prototype.line=void 0,sV.prototype.ancestors=void 0,sV.prototype.cause=void 0,sV.prototype.fatal=void 0,sV.prototype.place=void 0,sV.prototype.ruleId=void 0,sV.prototype.source=void 0;const oV={}.hasOwnProperty,aV=new Map,lV=/[A-Z]/g,cV=new Set(["table","tbody","thead","tfoot","tr"]),uV=new Set(["td","th"]),hV="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function dV(e,t){if(!t||void 0===t.Fragment)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let i;if(t.development){if("function"!==typeof t.jsxDEV)throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=function(e,t){return n;function n(n,i,r,s){const o=Array.isArray(r.children),a=JW(n);return t(i,r,s,o,{columnNumber:a?a.column-1:void 0,fileName:e,lineNumber:a?a.line:void 0},void 0)}}(n,t.jsxDEV)}else{if("function"!==typeof t.jsx)throw new TypeError("Expected `jsx` in production options");if("function"!==typeof t.jsxs)throw new TypeError("Expected `jsxs` in production options");i=function(e,t,n){return i;function i(e,i,r,s){const o=Array.isArray(r.children)?n:t;return s?o(i,r,s):o(i,r)}}(0,t.jsx,t.jsxs)}const r={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:i,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:!1!==t.passKeys,passNode:t.passNode||!1,schema:"svg"===t.space?VW:WW,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:!1!==t.tableCellAlignToStyle},s=pV(r,e,void 0);return s&&"string"!==typeof s?s:r.create(e,r.Fragment,{children:s||void 0},void 0)}function pV(e,t,n){return"element"===t.type?function(e,t,n){const i=e.schema;let r=i;"svg"===t.tagName.toLowerCase()&&"html"===i.space&&(r=VW,e.schema=r);e.ancestors.push(t);const s=yV(e,t.tagName,!1),o=function(e,t){const n={};let i,r;for(r in t.properties)if("children"!==r&&oV.call(t.properties,r)){const s=vV(e,r,t.properties[r]);if(s){const[r,o]=s;e.tableCellAlignToStyle&&"align"===r&&"string"===typeof o&&uV.has(t.tagName)?i=o:n[r]=o}}if(i){(n.style||(n.style={}))["css"===e.stylePropertyNameCase?"text-align":"textAlign"]=i}return n}(e,t);let a=gV(e,t);cV.has(t.tagName)&&(a=a.filter(function(e){return"string"!==typeof e||!("object"===typeof(t=e)?"text"===t.type&&vW(t.value):vW(t));var t}));return fV(e,o,s,t),mV(o,a),e.ancestors.pop(),e.schema=i,e.create(t,s,o,n)}(e,t,n):"mdxFlowExpression"===t.type||"mdxTextExpression"===t.type?function(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}OV(e,t.position)}(e,t):"mdxJsxFlowElement"===t.type||"mdxJsxTextElement"===t.type?function(e,t,n){const i=e.schema;let r=i;"svg"===t.name&&"html"===i.space&&(r=VW,e.schema=r);e.ancestors.push(t);const s=null===t.name?e.Fragment:yV(e,t.name,!0),o=function(e,t){const n={};for(const i of t.attributes)if("mdxJsxExpressionAttribute"===i.type)if(i.data&&i.data.estree&&e.evaluater){const t=i.data.estree.body[0];uW(t.type);const r=t.expression;uW(r.type);const s=r.properties[0];uW(s.type),Object.assign(n,e.evaluater.evaluateExpression(s.argument))}else OV(e,t.position);else{const r=i.name;let s;if(i.value&&"object"===typeof i.value)if(i.value.data&&i.value.data.estree&&e.evaluater){const t=i.value.data.estree.body[0];uW(t.type),s=e.evaluater.evaluateExpression(t.expression)}else OV(e,t.position);else s=null===i.value||i.value;n[r]=s}return n}(e,t),a=gV(e,t);return fV(e,o,s,t),mV(o,a),e.ancestors.pop(),e.schema=i,e.create(t,s,o,n)}(e,t,n):"mdxjsEsm"===t.type?function(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);OV(e,t.position)}(e,t):"root"===t.type?function(e,t,n){const i={};return mV(i,gV(e,t)),e.create(t,e.Fragment,i,n)}(e,t,n):"text"===t.type?function(e,t){return t.value}(0,t):void 0}function fV(e,t,n,i){"string"!==typeof n&&n!==e.Fragment&&e.passNode&&(t.node=i)}function mV(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function gV(e,t){const n=[];let i=-1;const r=e.passKeys?new Map:aV;for(;++i<t.children.length;){const s=t.children[i];let o;if(e.passKeys){const e="element"===s.type?s.tagName:"mdxJsxFlowElement"===s.type||"mdxJsxTextElement"===s.type?s.name:void 0;if(e){const t=r.get(e)||0;o=e+"-"+t,r.set(e,t+1)}}const a=pV(e,s,o);void 0!==a&&n.push(a)}return n}function vV(e,t,n){const i=function(e,t){const n=wW(t);let i=t,r=bW;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&"data"===n.slice(0,4)&&qW.test(t)){if("-"===t.charAt(4)){const e=t.slice(5).replace(XW,HW);i="data"+e.charAt(0).toUpperCase()+e.slice(1)}else{const e=t.slice(4);if(!XW.test(e)){let n=e.replace(UW,ZW);"-"!==n.charAt(0)&&(n="-"+n),t="data"+n}}r=MW}return new r(i,t)}(e.schema,t);if(!(null===n||void 0===n||"number"===typeof n&&Number.isNaN(n))){if(Array.isArray(n)&&(n=i.commaSeparated?function(e,t){const n=t||{};return(""===e[e.length-1]?[...e,""]:e).join((n.padRight?" ":"")+","+(!1===n.padLeft?"":" ")).trim()}(n):function(e){return e.join(" ").trim()}(n)),"style"===i.property){let t="object"===typeof n?n:function(e,t){try{return GW(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const t=n,i=new sV("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:t,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw i.file=e.filePath||void 0,i.url=hV+"#cannot-parse-style-attribute",i}}(e,String(n));return"css"===e.stylePropertyNameCase&&(t=function(e){const t={};let n;for(n in e)oV.call(e,n)&&(t[wV(n)]=e[n]);return t}(t)),["style",t]}return["react"===e.elementAttributeNameCase&&i.space?YW[i.property]||i.property:i.attribute,n]}}function yV(e,t,n){let i;if(n)if(t.includes(".")){const e=t.split(".");let n,r=-1;for(;++r<e.length;){const t=mW(e[r])?{type:"Identifier",name:e[r]}:{type:"Literal",value:e[r]};n=n?{type:"MemberExpression",object:n,property:t,computed:Boolean(r&&"Literal"===t.type),optional:!1}:t}i=n}else i=mW(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};else i={type:"Literal",value:t};if("Literal"===i.type){const t=i.value;return oV.call(e.components,t)?e.components[t]:t}if(e.evaluater)return e.evaluater.evaluateExpression(i);OV(e)}function OV(e,t){const n=new sV("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=hV+"#cannot-handle-mdx-estrees-without-createevaluater",n}function wV(e){let t=e.replace(lV,bV);return"ms-"===t.slice(0,3)&&(t="-"+t),t}function bV(e){return"-"+e.toLowerCase()}const kV={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},xV={};function DV(e,t,n){if(function(e){return Boolean(e&&"object"===typeof e)}(e)){if("value"in e)return"html"!==e.type||n?e.value:"";if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return SV(e.children,t,n)}return Array.isArray(e)?SV(e,t,n):""}function SV(e,t,n){const i=[];let r=-1;for(;++r<e.length;)i[r]=DV(e[r],t,n);return i.join("")}function CV(e,t,n,i){const r=e.length;let s,o=0;if(t=t<0?-t>r?0:r+t:t>r?r:t,n=n>0?n:0,i.length<1e4)s=Array.from(i),s.unshift(t,n),e.splice(...s);else for(n&&e.splice(t,n);o<i.length;)s=i.slice(o,o+1e4),s.unshift(t,0),e.splice(...s),o+=1e4,t+=1e4}function AV(e,t){return e.length>0?(CV(e,e.length,0,t),e):t}class EV{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const n=null===t||void 0===t?Number.POSITIVE_INFINITY:t;return n<this.left.length?this.left.slice(e,n):e>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(e,t,n){const i=t||0;this.setCursor(Math.trunc(e));const r=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return n&&_V(this.left,n),r.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),_V(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),_V(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&0===this.right.length||e<0&&0===this.left.length))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);_V(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);_V(this.left,t.reverse())}}}function _V(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function TV(e){const t={};let n,i,r,s,o,a,l,c=-1;const u=new EV(e);for(;++c<u.length;){for(;c in t;)c=t[c];if(n=u.get(c),c&&"chunkFlow"===n[1].type&&"listItemPrefix"===u.get(c-1)[1].type&&(a=n[1]._tokenizer.events,r=0,r<a.length&&"lineEndingBlank"===a[r][1].type&&(r+=2),r<a.length&&"content"===a[r][1].type))for(;++r<a.length&&"content"!==a[r][1].type;)"chunkText"===a[r][1].type&&(a[r][1]._isInFirstContentOfListItem=!0,r++);if("enter"===n[0])n[1].contentType&&(Object.assign(t,PV(u,c)),c=t[c],l=!0);else if(n[1]._container){for(r=c,i=void 0;r--;)if(s=u.get(r),"lineEnding"===s[1].type||"lineEndingBlank"===s[1].type)"enter"===s[0]&&(i&&(u.get(i)[1].type="lineEndingBlank"),s[1].type="lineEnding",i=r);else if("linePrefix"!==s[1].type&&"listItemIndent"!==s[1].type)break;i&&(n[1].end=p({},u.get(i)[1].start),o=u.slice(i,c),o.unshift(n),u.splice(i,c-i+1,o))}}return CV(e,0,Number.POSITIVE_INFINITY,u.slice(0)),!l}function PV(e,t){const n=e.get(t)[1],i=e.get(t)[2];let r=t-1;const s=[];let o=n._tokenizer;o||(o=i.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const a=o.events,l=[],c={};let u,h,d=-1,p=n,f=0,m=0;const g=[m];for(;p;){for(;e.get(++r)[1]!==p;);s.push(r),p._tokenizer||(u=i.sliceStream(p),p.next||u.push(null),h&&o.defineSkip(p.start),p._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(u),p._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),h=p,p=p.next}for(p=n;++d<a.length;)"exit"===a[d][0]&&"enter"===a[d-1][0]&&a[d][1].type===a[d-1][1].type&&a[d][1].start.line!==a[d][1].end.line&&(m=d+1,g.push(m),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(o.events=[],p?(p._tokenizer=void 0,p.previous=void 0):g.pop(),d=g.length;d--;){const t=a.slice(g[d],g[d+1]),n=s.pop();l.push([n,n+t.length-1]),e.splice(n,2,t)}for(l.reverse(),d=-1;++d<l.length;)c[f+l[d][0]]=f+l[d][1],f+=l[d][1]-l[d][0]-1;return c}const MV={}.hasOwnProperty;function FV(e,t){let n;for(n in t){const i=(MV.call(e,n)?e[n]:void 0)||(e[n]={}),r=t[n];let s;if(r)for(s in r){MV.call(i,s)||(i[s]=[]);const e=r[s];RV(i[s],Array.isArray(e)?e:e?[e]:[])}}}function RV(e,t){let n=-1;const i=[];for(;++n<t.length;)("after"===t[n].add?e:i).push(t[n]);CV(e,0,0,i)}const NV=qV(/[A-Za-z]/),IV=qV(/[\dA-Za-z]/),BV=qV(/[#-'*+\--9=?A-Z^-~]/);function QV(e){return null!==e&&(e<32||127===e)}const LV=qV(/\d/),jV=qV(/[\dA-Fa-f]/),$V=qV(/[!-/:-@[-`{-~]/);function zV(e){return null!==e&&e<-2}function WV(e){return null!==e&&(e<0||32===e)}function VV(e){return-2===e||-1===e||32===e}const UV=qV(/(?:[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B4E\u1B4F\u1B5A-\u1B60\u1B7D-\u1B7F\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDD6E\uDEAD\uDED0\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9\uDFD4\uDFD5\uDFD7\uDFD8]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09\uDFE1]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDD6D-\uDD6F\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD839\uDDFF|\uD83A[\uDD5E\uDD5F])|(?:[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C1\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2429\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E5\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBD2\uFD40-\uFD4F\uFD90\uFD91\uFDC8-\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD803[\uDD8E\uDD8F\uDED1-\uDED8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDC00-\uDCEF\uDCFA-\uDCFC\uDD00-\uDEB3\uDEBA-\uDED0\uDEE0-\uDEF0\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED8\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0-\uDCBB\uDCC0\uDCC1\uDCD0-\uDCD8\uDD00-\uDE57\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE8A\uDE8E-\uDEC6\uDEC8\uDECD-\uDEDC\uDEDF-\uDEEA\uDEEF-\uDEF8\uDF00-\uDF92\uDF94-\uDFEF\uDFFA])/),XV=qV(/\s/);function qV(e){return function(t){return null!==t&&t>-1&&e.test(String.fromCharCode(t))}}function ZV(e,t,n,i){const r=i?i-1:Number.POSITIVE_INFINITY;let s=0;return function(i){if(VV(i))return e.enter(n),o(i);return t(i)};function o(i){return VV(i)&&s++<r?(e.consume(i),o):(e.exit(n),t(i))}}const HV={tokenize:function(e){const t=e.attempt(this.parser.constructs.contentInitial,function(n){if(null===n)return void e.consume(n);return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),ZV(e,t,"linePrefix")},function(t){return e.enter("paragraph"),i(t)});let n;return t;function i(t){const i=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=i),n=i,r(t)}function r(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):zV(t)?(e.consume(t),e.exit("chunkText"),i):(e.consume(t),r)}}};const YV={tokenize:function(e){const t=this,n=[];let i,r,s,o=0;return a;function a(i){if(o<n.length){const r=n[o];return t.containerState=r[1],e.attempt(r[0].continuation,l,c)(i)}return c(i)}function l(e){if(o++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,i&&O();const n=t.events.length;let r,s=n;for(;s--;)if("exit"===t.events[s][0]&&"chunkFlow"===t.events[s][1].type){r=t.events[s][1].end;break}y(o);let a=n;for(;a<t.events.length;)t.events[a][1].end=p({},r),a++;return CV(t.events,s+1,0,t.events.slice(n)),t.events.length=a,c(e)}return a(e)}function c(r){if(o===n.length){if(!i)return d(r);if(i.currentConstruct&&i.currentConstruct.concrete)return m(r);t.interrupt=Boolean(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(GV,u,h)(r)}function u(e){return i&&O(),y(o),d(e)}function h(e){return t.parser.lazy[t.now().line]=o!==n.length,s=t.now().offset,m(e)}function d(n){return t.containerState={},e.attempt(GV,f,m)(n)}function f(e){return o++,n.push([t.currentConstruct,t.containerState]),d(e)}function m(n){return null===n?(i&&O(),y(0),void e.consume(n)):(i=i||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:r}),g(n))}function g(n){return null===n?(v(e.exit("chunkFlow"),!0),y(0),void e.consume(n)):zV(n)?(e.consume(n),v(e.exit("chunkFlow")),o=0,t.interrupt=void 0,a):(e.consume(n),g)}function v(e,n){const a=t.sliceStream(e);if(n&&a.push(null),e.previous=r,r&&(r.next=e),r=e,i.defineSkip(e.start),i.write(a),t.parser.lazy[e.start.line]){let e=i.events.length;for(;e--;)if(i.events[e][1].start.offset<s&&(!i.events[e][1].end||i.events[e][1].end.offset>s))return;const n=t.events.length;let r,a,l=n;for(;l--;)if("exit"===t.events[l][0]&&"chunkFlow"===t.events[l][1].type){if(r){a=t.events[l][1].end;break}r=!0}for(y(o),e=n;e<t.events.length;)t.events[e][1].end=p({},a),e++;CV(t.events,l+1,0,t.events.slice(n)),t.events.length=e}}function y(i){let r=n.length;for(;r-- >i;){const i=n[r];t.containerState=i[1],i[0].exit.call(t,e)}n.length=i}function O(){i.write([null]),r=void 0,i=void 0,t.containerState._closeFlow=void 0}}},GV={tokenize:function(e,t,n){return ZV(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}};const KV={partial:!0,tokenize:function(e,t,n){return function(t){return VV(t)?ZV(e,i,"linePrefix")(t):i(t)};function i(e){return null===e||zV(e)?t(e):n(e)}}};const JV={resolve:function(e){return TV(e),e},tokenize:function(e,t){let n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),i(t)};function i(t){return null===t?r(t):zV(t)?e.check(eU,s,r)(t):(e.consume(t),i)}function r(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function s(t){return e.consume(t),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}}},eU={partial:!0,tokenize:function(e,t,n){const i=this;return function(t){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),ZV(e,r,"linePrefix")};function r(r){if(null===r||zV(r))return n(r);const s=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&s&&"linePrefix"===s[1].type&&s[2].sliceSerialize(s[1],!0).length>=4?t(r):e.interrupt(i.parser.constructs.flow,n,t)(r)}}};const tU={tokenize:function(e){const t=this,n=e.attempt(KV,function(i){if(null===i)return void e.consume(i);return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n},e.attempt(this.parser.constructs.flowInitial,i,ZV(e,e.attempt(this.parser.constructs.flow,i,e.attempt(JV,i)),"linePrefix")));return n;function i(i){if(null!==i)return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(i)}}};const nU={resolveAll:oU()},iU=sU("string"),rU=sU("text");function sU(e){return{resolveAll:oU("text"===e?aU:void 0),tokenize:function(t){const n=this,i=this.parser.constructs[e],r=t.attempt(i,s,o);return s;function s(e){return l(e)?r(e):o(e)}function o(e){if(null!==e)return t.enter("data"),t.consume(e),a;t.consume(e)}function a(e){return l(e)?(t.exit("data"),r(e)):(t.consume(e),a)}function l(e){if(null===e)return!0;const t=i[e];let r=-1;if(t)for(;++r<t.length;){const e=t[r];if(!e.previous||e.previous.call(n,n.previous))return!0}return!1}}}}function oU(e){return function(t,n){let i,r=-1;for(;++r<=t.length;)void 0===i?t[r]&&"data"===t[r][1].type&&(i=r,r++):t[r]&&"data"===t[r][1].type||(r!==i+2&&(t[i][1].end=t[r-1][1].end,t.splice(i+2,r-i-2),r=i+2),i=void 0);return e?e(t,n):t}}function aU(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||"lineEnding"===e[n][1].type)&&"data"===e[n-1][1].type){const i=e[n-1][1],r=t.sliceStream(i);let s,o=r.length,a=-1,l=0;for(;o--;){const e=r[o];if("string"===typeof e){for(a=e.length;32===e.charCodeAt(a-1);)l++,a--;if(a)break;a=-1}else if(-2===e)s=!0,l++;else if(-1!==e){o++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(l=0),l){const r={type:n===e.length||s||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?a:i.start._bufferIndex+a,_index:i.start._index+o,line:i.end.line,column:i.end.column-l,offset:i.end.offset-l},end:p({},i.end)};i.end=p({},r.start),i.start.offset===i.end.offset?Object.assign(i,r):(e.splice(n,0,["enter",r,t],["exit",r,t]),n+=2)}n++}return e}const lU={name:"thematicBreak",tokenize:function(e,t,n){let i,r=0;return function(t){return e.enter("thematicBreak"),function(e){return i=e,s(e)}(t)};function s(s){return s===i?(e.enter("thematicBreakSequence"),o(s)):r>=3&&(null===s||zV(s))?(e.exit("thematicBreak"),t(s)):n(s)}function o(t){return t===i?(e.consume(t),r++,o):(e.exit("thematicBreakSequence"),VV(t)?ZV(e,s,"whitespace")(t):s(t))}}};const cU={continuation:{tokenize:function(e,t,n){const i=this;return i.containerState._closeFlow=void 0,e.check(KV,r,s);function r(n){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,ZV(e,t,"listItemIndent",i.containerState.size+1)(n)}function s(n){return i.containerState.furtherBlankLines||!VV(n)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,o(n)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(hU,t,o)(n))}function o(r){return i.containerState._closeFlow=!0,i.interrupt=void 0,ZV(e,e.attempt(cU,t,n),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(r)}}},exit:function(e){e.exit(this.containerState.type)},name:"list",tokenize:function(e,t,n){const i=this,r=i.events[i.events.length-1];let s=r&&"linePrefix"===r[1].type?r[2].sliceSerialize(r[1],!0).length:0,o=0;return function(t){const r=i.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===r?!i.containerState.marker||t===i.containerState.marker:LV(t)){if(i.containerState.type||(i.containerState.type=r,e.enter(r,{_container:!0})),"listUnordered"===r)return e.enter("listItemPrefix"),42===t||45===t?e.check(lU,n,l)(t):l(t);if(!i.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),a(t)}return n(t)};function a(t){return LV(t)&&++o<10?(e.consume(t),a):(!i.interrupt||o<2)&&(i.containerState.marker?t===i.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),l(t)):n(t)}function l(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||t,e.check(KV,i.interrupt?n:c,e.attempt(uU,h,u))}function c(e){return i.containerState.initialBlankLine=!0,s++,h(e)}function u(t){return VV(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),h):n(t)}function h(n){return i.containerState.size=s+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(n)}}},uU={partial:!0,tokenize:function(e,t,n){const i=this;return ZV(e,function(e){const r=i.events[i.events.length-1];return!VV(e)&&r&&"listItemPrefixWhitespace"===r[1].type?t(e):n(e)},"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5)}},hU={partial:!0,tokenize:function(e,t,n){const i=this;return ZV(e,function(e){const r=i.events[i.events.length-1];return r&&"listItemIndent"===r[1].type&&r[2].sliceSerialize(r[1],!0).length===i.containerState.size?t(e):n(e)},"listItemIndent",i.containerState.size+1)}};const dU={continuation:{tokenize:function(e,t,n){const i=this;return function(t){if(VV(t))return ZV(e,r,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t);return r(t)};function r(i){return e.attempt(dU,t,n)(i)}}},exit:function(e){e.exit("blockQuote")},name:"blockQuote",tokenize:function(e,t,n){const i=this;return function(t){if(62===t){const n=i.containerState;return n.open||(e.enter("blockQuote",{_container:!0}),n.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),r}return n(t)};function r(n){return VV(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}}};function pU(e,t,n,i,r,s,o,a,l){const c=l||Number.POSITIVE_INFINITY;let u=0;return function(t){if(60===t)return e.enter(i),e.enter(r),e.enter(s),e.consume(t),e.exit(s),h;if(null===t||32===t||41===t||QV(t))return n(t);return e.enter(i),e.enter(o),e.enter(a),e.enter("chunkString",{contentType:"string"}),f(t)};function h(n){return 62===n?(e.enter(s),e.consume(n),e.exit(s),e.exit(r),e.exit(i),t):(e.enter(a),e.enter("chunkString",{contentType:"string"}),d(n))}function d(t){return 62===t?(e.exit("chunkString"),e.exit(a),h(t)):null===t||60===t||zV(t)?n(t):(e.consume(t),92===t?p:d)}function p(t){return 60===t||62===t||92===t?(e.consume(t),d):d(t)}function f(r){return u||null!==r&&41!==r&&!WV(r)?u<c&&40===r?(e.consume(r),u++,f):41===r?(e.consume(r),u--,f):null===r||32===r||40===r||QV(r)?n(r):(e.consume(r),92===r?m:f):(e.exit("chunkString"),e.exit(a),e.exit(o),e.exit(i),t(r))}function m(t){return 40===t||41===t||92===t?(e.consume(t),f):f(t)}}function fU(e,t,n,i,r,s){const o=this;let a,l=0;return function(t){return e.enter(i),e.enter(r),e.consume(t),e.exit(r),e.enter(s),c};function c(h){return l>999||null===h||91===h||93===h&&!a||94===h&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?n(h):93===h?(e.exit(s),e.enter(r),e.consume(h),e.exit(r),e.exit(i),t):zV(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),c):(e.enter("chunkString",{contentType:"string"}),u(h))}function u(t){return null===t||91===t||93===t||zV(t)||l++>999?(e.exit("chunkString"),c(t)):(e.consume(t),a||(a=!VV(t)),92===t?h:u)}function h(t){return 91===t||92===t||93===t?(e.consume(t),l++,u):u(t)}}function mU(e,t,n,i,r,s){let o;return function(t){if(34===t||39===t||40===t)return e.enter(i),e.enter(r),e.consume(t),e.exit(r),o=40===t?41:t,a;return n(t)};function a(n){return n===o?(e.enter(r),e.consume(n),e.exit(r),e.exit(i),t):(e.enter(s),l(n))}function l(t){return t===o?(e.exit(s),a(o)):null===t?n(t):zV(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),ZV(e,l,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),c(t))}function c(t){return t===o||null===t||zV(t)?(e.exit("chunkString"),l(t)):(e.consume(t),92===t?u:c)}function u(t){return t===o||92===t?(e.consume(t),c):c(t)}}function gU(e,t){let n;return function i(r){if(zV(r))return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),n=!0,i;if(VV(r))return ZV(e,i,n?"linePrefix":"lineSuffix")(r);return t(r)}}function vU(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const yU={name:"definition",tokenize:function(e,t,n){const i=this;let r;return function(t){return e.enter("definition"),function(t){return fU.call(i,e,s,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)}(t)};function s(t){return r=vU(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),o):n(t)}function o(t){return WV(t)?gU(e,a)(t):a(t)}function a(t){return pU(e,l,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(t)}function l(t){return e.attempt(OU,c,c)(t)}function c(t){return VV(t)?ZV(e,u,"whitespace")(t):u(t)}function u(s){return null===s||zV(s)?(e.exit("definition"),i.parser.defined.push(r),t(s)):n(s)}}},OU={partial:!0,tokenize:function(e,t,n){return function(t){return WV(t)?gU(e,i)(t):n(t)};function i(t){return mU(e,r,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t)}function r(t){return VV(t)?ZV(e,s,"whitespace")(t):s(t)}function s(e){return null===e||zV(e)?t(e):n(e)}}};const wU={name:"codeIndented",tokenize:function(e,t,n){const i=this;return function(t){return e.enter("codeIndented"),ZV(e,r,"linePrefix",5)(t)};function r(e){const t=i.events[i.events.length-1];return t&&"linePrefix"===t[1].type&&t[2].sliceSerialize(t[1],!0).length>=4?s(e):n(e)}function s(t){return null===t?a(t):zV(t)?e.attempt(bU,s,a)(t):(e.enter("codeFlowValue"),o(t))}function o(t){return null===t||zV(t)?(e.exit("codeFlowValue"),s(t)):(e.consume(t),o)}function a(n){return e.exit("codeIndented"),t(n)}}},bU={partial:!0,tokenize:function(e,t,n){const i=this;return r;function r(t){return i.parser.lazy[i.now().line]?n(t):zV(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r):ZV(e,s,"linePrefix",5)(t)}function s(e){const s=i.events[i.events.length-1];return s&&"linePrefix"===s[1].type&&s[2].sliceSerialize(s[1],!0).length>=4?t(e):zV(e)?r(e):n(e)}}};const kU={name:"headingAtx",resolve:function(e,t){let n,i,r=e.length-2,s=3;"whitespace"===e[s][1].type&&(s+=2);r-2>s&&"whitespace"===e[r][1].type&&(r-=2);"atxHeadingSequence"===e[r][1].type&&(s===r-1||r-4>s&&"whitespace"===e[r-2][1].type)&&(r-=s+1===r?2:4);r>s&&(n={type:"atxHeadingText",start:e[s][1].start,end:e[r][1].end},i={type:"chunkText",start:e[s][1].start,end:e[r][1].end,contentType:"text"},CV(e,s,r-s+1,[["enter",n,t],["enter",i,t],["exit",i,t],["exit",n,t]]));return e},tokenize:function(e,t,n){let i=0;return function(t){return e.enter("atxHeading"),function(t){return e.enter("atxHeadingSequence"),r(t)}(t)};function r(t){return 35===t&&i++<6?(e.consume(t),r):null===t||WV(t)?(e.exit("atxHeadingSequence"),s(t)):n(t)}function s(n){return 35===n?(e.enter("atxHeadingSequence"),o(n)):null===n||zV(n)?(e.exit("atxHeading"),t(n)):VV(n)?ZV(e,s,"whitespace")(n):(e.enter("atxHeadingText"),a(n))}function o(t){return 35===t?(e.consume(t),o):(e.exit("atxHeadingSequence"),s(t))}function a(t){return null===t||35===t||WV(t)?(e.exit("atxHeadingText"),s(t)):(e.consume(t),a)}}};const xU={name:"setextUnderline",resolveTo:function(e,t){let n,i,r,s=e.length;for(;s--;)if("enter"===e[s][0]){if("content"===e[s][1].type){n=s;break}"paragraph"===e[s][1].type&&(i=s)}else"content"===e[s][1].type&&e.splice(s,1),r||"definition"!==e[s][1].type||(r=s);const o={type:"setextHeading",start:p({},e[n][1].start),end:p({},e[e.length-1][1].end)};e[i][1].type="setextHeadingText",r?(e.splice(i,0,["enter",o,t]),e.splice(r+1,0,["exit",e[n][1],t]),e[n][1].end=p({},e[r][1].end)):e[n][1]=o;return e.push(["exit",o,t]),e},tokenize:function(e,t,n){const i=this;let r;return function(t){let o,a=i.events.length;for(;a--;)if("lineEnding"!==i.events[a][1].type&&"linePrefix"!==i.events[a][1].type&&"content"!==i.events[a][1].type){o="paragraph"===i.events[a][1].type;break}if(!i.parser.lazy[i.now().line]&&(i.interrupt||o))return e.enter("setextHeadingLine"),r=t,function(t){return e.enter("setextHeadingLineSequence"),s(t)}(t);return n(t)};function s(t){return t===r?(e.consume(t),s):(e.exit("setextHeadingLineSequence"),VV(t)?ZV(e,o,"lineSuffix")(t):o(t))}function o(i){return null===i||zV(i)?(e.exit("setextHeadingLine"),t(i)):n(i)}}};const DU=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],SU=["pre","script","style","textarea"],CU={concrete:!0,name:"htmlFlow",resolveTo:function(e){let t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2));return e},tokenize:function(e,t,n){const i=this;let r,s,o,a,l;return function(t){return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),c}(t)};function c(a){return 33===a?(e.consume(a),u):47===a?(e.consume(a),s=!0,p):63===a?(e.consume(a),r=3,i.interrupt?t:R):NV(a)?(e.consume(a),o=String.fromCharCode(a),f):n(a)}function u(s){return 45===s?(e.consume(s),r=2,h):91===s?(e.consume(s),r=5,a=0,d):NV(s)?(e.consume(s),r=4,i.interrupt?t:R):n(s)}function h(r){return 45===r?(e.consume(r),i.interrupt?t:R):n(r)}function d(r){const s="CDATA[";return r===s.charCodeAt(a++)?(e.consume(r),6===a?i.interrupt?t:C:d):n(r)}function p(t){return NV(t)?(e.consume(t),o=String.fromCharCode(t),f):n(t)}function f(a){if(null===a||47===a||62===a||WV(a)){const l=47===a,c=o.toLowerCase();return l||s||!SU.includes(c)?DU.includes(o.toLowerCase())?(r=6,l?(e.consume(a),m):i.interrupt?t(a):C(a)):(r=7,i.interrupt&&!i.parser.lazy[i.now().line]?n(a):s?g(a):v(a)):(r=1,i.interrupt?t(a):C(a))}return 45===a||IV(a)?(e.consume(a),o+=String.fromCharCode(a),f):n(a)}function m(r){return 62===r?(e.consume(r),i.interrupt?t:C):n(r)}function g(t){return VV(t)?(e.consume(t),g):D(t)}function v(t){return 47===t?(e.consume(t),D):58===t||95===t||NV(t)?(e.consume(t),y):VV(t)?(e.consume(t),v):D(t)}function y(t){return 45===t||46===t||58===t||95===t||IV(t)?(e.consume(t),y):O(t)}function O(t){return 61===t?(e.consume(t),w):VV(t)?(e.consume(t),O):v(t)}function w(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),l=t,b):VV(t)?(e.consume(t),w):k(t)}function b(t){return t===l?(e.consume(t),l=null,x):null===t||zV(t)?n(t):(e.consume(t),b)}function k(t){return null===t||34===t||39===t||47===t||60===t||61===t||62===t||96===t||WV(t)?O(t):(e.consume(t),k)}function x(e){return 47===e||62===e||VV(e)?v(e):n(e)}function D(t){return 62===t?(e.consume(t),S):n(t)}function S(t){return null===t||zV(t)?C(t):VV(t)?(e.consume(t),S):n(t)}function C(t){return 45===t&&2===r?(e.consume(t),T):60===t&&1===r?(e.consume(t),P):62===t&&4===r?(e.consume(t),N):63===t&&3===r?(e.consume(t),R):93===t&&5===r?(e.consume(t),F):!zV(t)||6!==r&&7!==r?null===t||zV(t)?(e.exit("htmlFlowData"),A(t)):(e.consume(t),C):(e.exit("htmlFlowData"),e.check(AU,I,A)(t))}function A(t){return e.check(EU,E,I)(t)}function E(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),_}function _(t){return null===t||zV(t)?A(t):(e.enter("htmlFlowData"),C(t))}function T(t){return 45===t?(e.consume(t),R):C(t)}function P(t){return 47===t?(e.consume(t),o="",M):C(t)}function M(t){if(62===t){const n=o.toLowerCase();return SU.includes(n)?(e.consume(t),N):C(t)}return NV(t)&&o.length<8?(e.consume(t),o+=String.fromCharCode(t),M):C(t)}function F(t){return 93===t?(e.consume(t),R):C(t)}function R(t){return 62===t?(e.consume(t),N):45===t&&2===r?(e.consume(t),R):C(t)}function N(t){return null===t||zV(t)?(e.exit("htmlFlowData"),I(t)):(e.consume(t),N)}function I(n){return e.exit("htmlFlow"),t(n)}}},AU={partial:!0,tokenize:function(e,t,n){return function(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),e.attempt(KV,t,n)}}},EU={partial:!0,tokenize:function(e,t,n){const i=this;return function(t){if(zV(t))return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r;return n(t)};function r(e){return i.parser.lazy[i.now().line]?n(e):t(e)}}};const _U={partial:!0,tokenize:function(e,t,n){const i=this;return function(t){if(null===t)return n(t);return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r};function r(e){return i.parser.lazy[i.now().line]?n(e):t(e)}}},TU={concrete:!0,name:"codeFenced",tokenize:function(e,t,n){const i=this,r={partial:!0,tokenize:function(e,t,n){let r=0;return o;function o(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l}function l(t){return e.enter("codeFencedFence"),VV(t)?ZV(e,c,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):c(t)}function c(t){return t===s?(e.enter("codeFencedFenceSequence"),u(t)):n(t)}function u(t){return t===s?(r++,e.consume(t),u):r>=a?(e.exit("codeFencedFenceSequence"),VV(t)?ZV(e,h,"whitespace")(t):h(t)):n(t)}function h(i){return null===i||zV(i)?(e.exit("codeFencedFence"),t(i)):n(i)}}};let s,o=0,a=0;return function(t){return function(t){const n=i.events[i.events.length-1];return o=n&&"linePrefix"===n[1].type?n[2].sliceSerialize(n[1],!0).length:0,s=t,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),l(t)}(t)};function l(t){return t===s?(a++,e.consume(t),l):a<3?n(t):(e.exit("codeFencedFenceSequence"),VV(t)?ZV(e,c,"whitespace")(t):c(t))}function c(n){return null===n||zV(n)?(e.exit("codeFencedFence"),i.interrupt?t(n):e.check(_U,p,y)(n)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),u(n))}function u(t){return null===t||zV(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),c(t)):VV(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),ZV(e,h,"whitespace")(t)):96===t&&t===s?n(t):(e.consume(t),u)}function h(t){return null===t||zV(t)?c(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return null===t||zV(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),c(t)):96===t&&t===s?n(t):(e.consume(t),d)}function p(t){return e.attempt(r,y,f)(t)}function f(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),m}function m(t){return o>0&&VV(t)?ZV(e,g,"linePrefix",o+1)(t):g(t)}function g(t){return null===t||zV(t)?e.check(_U,p,y)(t):(e.enter("codeFlowValue"),v(t))}function v(t){return null===t||zV(t)?(e.exit("codeFlowValue"),g(t)):(e.consume(t),v)}function y(n){return e.exit("codeFenced"),t(n)}}};const PU=document.createElement("i");function MU(e){const t="&"+e+";";PU.innerHTML=t;const n=PU.textContent;return(59!==n.charCodeAt(n.length-1)||"semi"===e)&&(n!==t&&n)}const FU={name:"characterReference",tokenize:function(e,t,n){const i=this;let r,s,o=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),a};function a(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),l):(e.enter("characterReferenceValue"),r=31,s=IV,c(t))}function l(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),r=6,s=jV,c):(e.enter("characterReferenceValue"),r=7,s=LV,c(t))}function c(a){if(59===a&&o){const r=e.exit("characterReferenceValue");return s!==IV||MU(i.sliceSerialize(r))?(e.enter("characterReferenceMarker"),e.consume(a),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(a)}return s(a)&&o++<r?(e.consume(a),c):n(a)}}};const RU={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),i};function i(i){return $V(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}};const NU={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),ZV(e,t,"linePrefix")}}};function IU(e,t,n){const i=[];let r=-1;for(;++r<e.length;){const s=e[r].resolveAll;s&&!i.includes(s)&&(t=s(t,n),i.push(s))}return t}const BU={name:"labelEnd",resolveAll:function(e){let t=-1;const n=[];for(;++t<e.length;){const i=e[t][1];if(n.push(e[t]),"labelImage"===i.type||"labelLink"===i.type||"labelEnd"===i.type){const e="labelImage"===i.type?4:2;i.type="data",t+=e}}e.length!==n.length&&CV(e,0,e.length,n);return e},resolveTo:function(e,t){let n,i,r,s,o=e.length,a=0;for(;o--;)if(n=e[o][1],i){if("link"===n.type||"labelLink"===n.type&&n._inactive)break;"enter"===e[o][0]&&"labelLink"===n.type&&(n._inactive=!0)}else if(r){if("enter"===e[o][0]&&("labelImage"===n.type||"labelLink"===n.type)&&!n._balanced&&(i=o,"labelLink"!==n.type)){a=2;break}}else"labelEnd"===n.type&&(r=o);const l={type:"labelLink"===e[i][1].type?"link":"image",start:p({},e[i][1].start),end:p({},e[e.length-1][1].end)},c={type:"label",start:p({},e[i][1].start),end:p({},e[r][1].end)},u={type:"labelText",start:p({},e[i+a+2][1].end),end:p({},e[r-2][1].start)};return s=[["enter",l,t],["enter",c,t]],s=AV(s,e.slice(i+1,i+a+3)),s=AV(s,[["enter",u,t]]),s=AV(s,IU(t.parser.constructs.insideSpan.null,e.slice(i+a+4,r-3),t)),s=AV(s,[["exit",u,t],e[r-2],e[r-1],["exit",c,t]]),s=AV(s,e.slice(r+1)),s=AV(s,[["exit",l,t]]),CV(e,i,e.length,s),e},tokenize:function(e,t,n){const i=this;let r,s,o=i.events.length;for(;o--;)if(("labelImage"===i.events[o][1].type||"labelLink"===i.events[o][1].type)&&!i.events[o][1]._balanced){r=i.events[o][1];break}return function(t){if(!r)return n(t);if(r._inactive)return u(t);return s=i.parser.defined.includes(vU(i.sliceSerialize({start:r.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),a};function a(t){return 40===t?e.attempt(QU,c,s?c:u)(t):91===t?e.attempt(LU,c,s?l:u)(t):s?c(t):u(t)}function l(t){return e.attempt(jU,c,u)(t)}function c(e){return t(e)}function u(e){return r._balanced=!0,n(e)}}},QU={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),i};function i(t){return WV(t)?gU(e,r)(t):r(t)}function r(t){return 41===t?c(t):pU(e,s,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(t)}function s(t){return WV(t)?gU(e,a)(t):c(t)}function o(e){return n(e)}function a(t){return 34===t||39===t||40===t?mU(e,l,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):c(t)}function l(t){return WV(t)?gU(e,c)(t):c(t)}function c(i){return 41===i?(e.enter("resourceMarker"),e.consume(i),e.exit("resourceMarker"),e.exit("resource"),t):n(i)}}},LU={tokenize:function(e,t,n){const i=this;return function(t){return fU.call(i,e,r,s,"reference","referenceMarker","referenceString")(t)};function r(e){return i.parser.defined.includes(vU(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?t(e):n(e)}function s(e){return n(e)}}},jU={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),i};function i(i){return 93===i?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):n(i)}}};const $U={name:"labelStartImage",resolveAll:BU.resolveAll,tokenize:function(e,t,n){const i=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),r};function r(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),s):n(t)}function s(e){return 94===e&&"_hiddenFootnoteSupport"in i.parser.constructs?n(e):t(e)}}};function zU(e){return null===e||WV(e)||XV(e)?1:UV(e)?2:void 0}const WU={name:"attention",resolveAll:function(e,t){let n,i,r,s,o,a,l,c,u=-1;for(;++u<e.length;)if("enter"===e[u][0]&&"attentionSequence"===e[u][1].type&&e[u][1]._close)for(n=u;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[u][1]).charCodeAt(0)){if((e[n][1]._close||e[u][1]._open)&&(e[u][1].end.offset-e[u][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[u][1].end.offset-e[u][1].start.offset)%3))continue;a=e[n][1].end.offset-e[n][1].start.offset>1&&e[u][1].end.offset-e[u][1].start.offset>1?2:1;const h=p({},e[n][1].end),d=p({},e[u][1].start);VU(h,-a),VU(d,a),s={type:a>1?"strongSequence":"emphasisSequence",start:h,end:p({},e[n][1].end)},o={type:a>1?"strongSequence":"emphasisSequence",start:p({},e[u][1].start),end:d},r={type:a>1?"strongText":"emphasisText",start:p({},e[n][1].end),end:p({},e[u][1].start)},i={type:a>1?"strong":"emphasis",start:p({},s.start),end:p({},o.end)},e[n][1].end=p({},s.start),e[u][1].start=p({},o.end),l=[],e[n][1].end.offset-e[n][1].start.offset&&(l=AV(l,[["enter",e[n][1],t],["exit",e[n][1],t]])),l=AV(l,[["enter",i,t],["enter",s,t],["exit",s,t],["enter",r,t]]),l=AV(l,IU(t.parser.constructs.insideSpan.null,e.slice(n+1,u),t)),l=AV(l,[["exit",r,t],["enter",o,t],["exit",o,t],["exit",i,t]]),e[u][1].end.offset-e[u][1].start.offset?(c=2,l=AV(l,[["enter",e[u][1],t],["exit",e[u][1],t]])):c=0,CV(e,n-1,u-n+3,l),u=n+l.length-c-2;break}u=-1;for(;++u<e.length;)"attentionSequence"===e[u][1].type&&(e[u][1].type="data");return e},tokenize:function(e,t){const n=this.parser.constructs.attentionMarkers.null,i=this.previous,r=zU(i);let s;return function(t){return s=t,e.enter("attentionSequence"),o(t)};function o(a){if(a===s)return e.consume(a),o;const l=e.exit("attentionSequence"),c=zU(a),u=!c||2===c&&r||n.includes(a),h=!r||2===r&&c||n.includes(i);return l._open=Boolean(42===s?u:u&&(r||!h)),l._close=Boolean(42===s?h:h&&(c||!u)),t(a)}}};function VU(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const UU={name:"autolink",tokenize:function(e,t,n){let i=0;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),r};function r(t){return NV(t)?(e.consume(t),s):64===t?n(t):l(t)}function s(e){return 43===e||45===e||46===e||IV(e)?(i=1,o(e)):l(e)}function o(t){return 58===t?(e.consume(t),i=0,a):(43===t||45===t||46===t||IV(t))&&i++<32?(e.consume(t),o):(i=0,l(t))}function a(i){return 62===i?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(i),e.exit("autolinkMarker"),e.exit("autolink"),t):null===i||32===i||60===i||QV(i)?n(i):(e.consume(i),a)}function l(t){return 64===t?(e.consume(t),c):BV(t)?(e.consume(t),l):n(t)}function c(e){return IV(e)?u(e):n(e)}function u(n){return 46===n?(e.consume(n),i=0,c):62===n?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t):h(n)}function h(t){if((45===t||IV(t))&&i++<63){const n=45===t?h:u;return e.consume(t),n}return n(t)}}};const XU={name:"htmlText",tokenize:function(e,t,n){const i=this;let r,s,o;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),a};function a(t){return 33===t?(e.consume(t),l):47===t?(e.consume(t),w):63===t?(e.consume(t),y):NV(t)?(e.consume(t),x):n(t)}function l(t){return 45===t?(e.consume(t),c):91===t?(e.consume(t),s=0,p):NV(t)?(e.consume(t),v):n(t)}function c(t){return 45===t?(e.consume(t),d):n(t)}function u(t){return null===t?n(t):45===t?(e.consume(t),h):zV(t)?(o=u,M(t)):(e.consume(t),u)}function h(t){return 45===t?(e.consume(t),d):u(t)}function d(e){return 62===e?P(e):45===e?h(e):u(e)}function p(t){const i="CDATA[";return t===i.charCodeAt(s++)?(e.consume(t),6===s?f:p):n(t)}function f(t){return null===t?n(t):93===t?(e.consume(t),m):zV(t)?(o=f,M(t)):(e.consume(t),f)}function m(t){return 93===t?(e.consume(t),g):f(t)}function g(t){return 62===t?P(t):93===t?(e.consume(t),g):f(t)}function v(t){return null===t||62===t?P(t):zV(t)?(o=v,M(t)):(e.consume(t),v)}function y(t){return null===t?n(t):63===t?(e.consume(t),O):zV(t)?(o=y,M(t)):(e.consume(t),y)}function O(e){return 62===e?P(e):y(e)}function w(t){return NV(t)?(e.consume(t),b):n(t)}function b(t){return 45===t||IV(t)?(e.consume(t),b):k(t)}function k(t){return zV(t)?(o=k,M(t)):VV(t)?(e.consume(t),k):P(t)}function x(t){return 45===t||IV(t)?(e.consume(t),x):47===t||62===t||WV(t)?D(t):n(t)}function D(t){return 47===t?(e.consume(t),P):58===t||95===t||NV(t)?(e.consume(t),S):zV(t)?(o=D,M(t)):VV(t)?(e.consume(t),D):P(t)}function S(t){return 45===t||46===t||58===t||95===t||IV(t)?(e.consume(t),S):C(t)}function C(t){return 61===t?(e.consume(t),A):zV(t)?(o=C,M(t)):VV(t)?(e.consume(t),C):D(t)}function A(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),r=t,E):zV(t)?(o=A,M(t)):VV(t)?(e.consume(t),A):(e.consume(t),_)}function E(t){return t===r?(e.consume(t),r=void 0,T):null===t?n(t):zV(t)?(o=E,M(t)):(e.consume(t),E)}function _(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):47===t||62===t||WV(t)?D(t):(e.consume(t),_)}function T(e){return 47===e||62===e||WV(e)?D(e):n(e)}function P(i){return 62===i?(e.consume(i),e.exit("htmlTextData"),e.exit("htmlText"),t):n(i)}function M(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),F}function F(t){return VV(t)?ZV(e,R,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):R(t)}function R(t){return e.enter("htmlTextData"),o(t)}}};const qU={name:"labelStartLink",resolveAll:BU.resolveAll,tokenize:function(e,t,n){const i=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),r};function r(e){return 94===e&&"_hiddenFootnoteSupport"in i.parser.constructs?n(e):t(e)}}};const ZU={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.consume(t),i};function i(i){return zV(i)?(e.exit("hardBreakEscape"),t(i)):n(i)}}};const HU={name:"codeText",previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type},resolve:function(e){let t,n,i=e.length-4,r=3;if(("lineEnding"===e[r][1].type||"space"===e[r][1].type)&&("lineEnding"===e[i][1].type||"space"===e[i][1].type))for(t=r;++t<i;)if("codeTextData"===e[t][1].type){e[r][1].type="codeTextPadding",e[i][1].type="codeTextPadding",r+=2,i-=2;break}t=r-1,i++;for(;++t<=i;)void 0===n?t!==i&&"lineEnding"!==e[t][1].type&&(n=t):t!==i&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),i-=t-n-2,t=n+2),n=void 0);return e},tokenize:function(e,t,n){let i,r,s=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),o(t)};function o(t){return 96===t?(e.consume(t),s++,o):(e.exit("codeTextSequence"),a(t))}function a(t){return null===t?n(t):32===t?(e.enter("space"),e.consume(t),e.exit("space"),a):96===t?(r=e.enter("codeTextSequence"),i=0,c(t)):zV(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),a):(e.enter("codeTextData"),l(t))}function l(t){return null===t||32===t||96===t||zV(t)?(e.exit("codeTextData"),a(t)):(e.consume(t),l)}function c(n){return 96===n?(e.consume(n),i++,c):i===s?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(r.type="codeTextData",l(n))}}};const YU={42:cU,43:cU,45:cU,48:cU,49:cU,50:cU,51:cU,52:cU,53:cU,54:cU,55:cU,56:cU,57:cU,62:dU},GU={91:yU},KU={[-2]:wU,[-1]:wU,32:wU},JU={35:kU,42:lU,45:[xU,lU],60:CU,61:xU,95:lU,96:TU,126:TU},eX={38:FU,92:RU},tX={[-5]:NU,[-4]:NU,[-3]:NU,33:$U,38:FU,42:WU,60:[UU,XU],91:qU,92:[ZU,RU],93:BU,95:WU,96:HU},nX={null:[WU,nU]},iX={null:[42,95]},rX={null:[]};function sX(e,t,n){let i={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const r={},s=[];let o=[],a=[],l=!0;const c={attempt:y(function(e,t){O(e,t.from)}),check:y(v),consume:function(e){zV(e)?(i.line++,i.column=1,i.offset+=-3===e?2:1,w()):-1!==e&&(i.column++,i.offset++);i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===o[i._index].length&&(i._bufferIndex=-1,i._index++));u.previous=e,l=!0},enter:function(e,t){const n=t||{};return n.type=e,n.start=f(),u.events.push(["enter",n,u]),a.push(n),n},exit:function(e){const t=a.pop();return t.end=f(),u.events.push(["exit",t,u]),t},interrupt:y(v,{interrupt:!0})},u={code:null,containerState:{},defineSkip:function(e){r[e.line]=e.column,w()},events:[],now:f,parser:e,previous:null,sliceSerialize:function(e,t){return function(e,t){let n=-1;const i=[];let r;for(;++n<e.length;){const s=e[n];let o;if("string"===typeof s)o=s;else switch(s){case-5:o="\r";break;case-4:o="\n";break;case-3:o="\r\n";break;case-2:o=t?" ":"\t";break;case-1:if(!t&&r)continue;o=" ";break;default:o=String.fromCharCode(s)}r=-2===s,i.push(o)}return i.join("")}(p(e),t)},sliceStream:p,write:function(e){if(o=AV(o,e),m(),null!==o[o.length-1])return[];return O(t,0),u.events=IU(s,u.events,u),u.events}};let h,d=t.tokenize.call(u,c);return t.resolveAll&&s.push(t),u;function p(e){return function(e,t){const n=t.start._index,i=t.start._bufferIndex,r=t.end._index,s=t.end._bufferIndex;let o;if(n===r)o=[e[n].slice(i,s)];else{if(o=e.slice(n,r),i>-1){const e=o[0];"string"===typeof e?o[0]=e.slice(i):o.shift()}s>0&&o.push(e[r].slice(0,s))}return o}(o,e)}function f(){const{_bufferIndex:e,_index:t,line:n,column:r,offset:s}=i;return{_bufferIndex:e,_index:t,line:n,column:r,offset:s}}function m(){let e;for(;i._index<o.length;){const t=o[i._index];if("string"===typeof t)for(e=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===e&&i._bufferIndex<t.length;)g(t.charCodeAt(i._bufferIndex));else g(t)}}function g(e){l=void 0,h=e,d=d(e)}function v(e,t){t.restore()}function y(e,t){return function(n,r,s){let o,h,d,p;return Array.isArray(n)?m(n):"tokenize"in n?m([n]):function(e){return t;function t(t){const n=null!==t&&e[t],i=null!==t&&e.null;return m([...Array.isArray(n)?n:n?[n]:[],...Array.isArray(i)?i:i?[i]:[]])(t)}}(n);function m(e){return o=e,h=0,0===e.length?s:g(e[h])}function g(e){return function(n){p=function(){const e=f(),t=u.previous,n=u.currentConstruct,r=u.events.length,s=Array.from(a);return{from:r,restore:o};function o(){i=e,u.previous=t,u.currentConstruct=n,u.events.length=r,a=s,w()}}(),d=e,e.partial||(u.currentConstruct=e);if(e.name&&u.parser.constructs.disable.null.includes(e.name))return y(n);return e.tokenize.call(t?Object.assign(Object.create(u),t):u,c,v,y)(n)}}function v(t){return l=!0,e(d,p),r}function y(e){return l=!0,p.restore(),++h<o.length?g(o[h]):s}}}function O(e,t){e.resolveAll&&!s.includes(e)&&s.push(e),e.resolve&&CV(u.events,t,u.events.length-t,e.resolve(u.events.slice(t),u)),e.resolveTo&&(u.events=e.resolveTo(u.events,u))}function w(){i.line in r&&i.column<2&&(i.column=r[i.line],i.offset+=r[i.line]-1)}}function oX(e){const t=function(e){const t={};let n=-1;for(;++n<e.length;)FV(t,e[n]);return t}([r,...(e||{}).extensions||[]]),n={constructs:t,content:i(HV),defined:[],document:i(YV),flow:i(tU),lazy:{},string:i(iU),text:i(rU)};return n;function i(e){return function(t){return sX(n,e,t)}}}const aX=/[\0\t\n\r]/g;function lX(e,t){const n=Number.parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535===(65535&n)||65534===(65535&n)||n>1114111?"\ufffd":String.fromCodePoint(n)}const cX=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function uX(e,t,n){if(t)return t;if(35===n.charCodeAt(0)){const e=n.charCodeAt(1),t=120===e||88===e;return lX(n.slice(t?2:1),t?16:10)}return MU(n)||e}const hX={}.hasOwnProperty;function dX(e,t,n){return"string"!==typeof t&&(n=t,t=void 0),function(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(te),autolinkProtocol:S,autolinkEmail:S,atxHeading:s(G),blockQuote:s(X),characterEscape:S,characterReference:S,codeFenced:s(q),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:s(q,o),codeText:s(Z,o),codeTextData:S,data:S,codeFlowValue:S,definition:s(H),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:s(Y),hardBreakEscape:s(K),hardBreakTrailing:s(K),htmlFlow:s(J,o),htmlFlowData:S,htmlText:s(J,o),htmlTextData:S,image:s(ee),label:o,link:s(te),listItem:s(ie),listItemValue:d,listOrdered:s(ne,h),listUnordered:s(ne),paragraph:s(re),reference:L,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:s(G),strong:s(se),thematicBreak:s(ae)},exit:{atxHeading:l(),atxHeadingSequence:b,autolink:l(),autolinkEmail:U,autolinkProtocol:V,blockQuote:l(),characterEscapeValue:C,characterReferenceMarkerHexadecimal:$,characterReferenceMarkerNumeric:$,characterReferenceValue:z,characterReference:W,codeFenced:l(g),codeFencedFence:m,codeFencedFenceInfo:p,codeFencedFenceMeta:f,codeFlowValue:C,codeIndented:l(v),codeText:l(P),codeTextData:C,data:C,definition:l(),definitionDestinationString:w,definitionLabelString:y,definitionTitleString:O,emphasis:l(),hardBreakEscape:l(E),hardBreakTrailing:l(E),htmlFlow:l(_),htmlFlowData:C,htmlText:l(T),htmlTextData:C,image:l(F),label:N,labelText:R,lineEnding:A,link:l(M),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:j,resourceDestinationString:I,resourceTitleString:B,resource:Q,setextHeading:l(D),setextHeadingLineSequence:x,setextHeadingText:k,strong:l(),thematicBreak:l()}};fX(t,(e||{}).mdastExtensions||[]);const n={};return i;function i(e){let i={type:"root",children:[]};const s={stack:[i],tokenStack:[],config:t,enter:a,exit:c,buffer:o,resume:u,data:n},l=[];let h=-1;for(;++h<e.length;)if("listOrdered"===e[h][1].type||"listUnordered"===e[h][1].type)if("enter"===e[h][0])l.push(h);else{h=r(e,l.pop(),h)}for(h=-1;++h<e.length;){const n=t[e[h][0]];hX.call(n,e[h][1].type)&&n[e[h][1].type].call(Object.assign({sliceSerialize:e[h][2].sliceSerialize},s),e[h][1])}if(s.tokenStack.length>0){const e=s.tokenStack[s.tokenStack.length-1];(e[1]||gX).call(s,void 0,e[0])}for(i.position={start:pX(e.length>0?e[0][1].start:{line:1,column:1,offset:0}),end:pX(e.length>0?e[e.length-2][1].end:{line:1,column:1,offset:0})},h=-1;++h<t.transforms.length;)i=t.transforms[h](i)||i;return i}function r(e,t,n){let i,r,s,o,a=t-1,l=-1,c=!1;for(;++a<=n;){const t=e[a];switch(t[1].type){case"listUnordered":case"listOrdered":case"blockQuote":"enter"===t[0]?l++:l--,o=void 0;break;case"lineEndingBlank":"enter"===t[0]&&(!i||o||l||s||(s=a),o=void 0);break;case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:o=void 0}if(!l&&"enter"===t[0]&&"listItemPrefix"===t[1].type||-1===l&&"exit"===t[0]&&("listUnordered"===t[1].type||"listOrdered"===t[1].type)){if(i){let o=a;for(r=void 0;o--;){const t=e[o];if("lineEnding"===t[1].type||"lineEndingBlank"===t[1].type){if("exit"===t[0])continue;r&&(e[r][1].type="lineEndingBlank",c=!0),t[1].type="lineEnding",r=o}else if("linePrefix"!==t[1].type&&"blockQuotePrefix"!==t[1].type&&"blockQuotePrefixWhitespace"!==t[1].type&&"blockQuoteMarker"!==t[1].type&&"listItemIndent"!==t[1].type)break}s&&(!r||s<r)&&(i._spread=!0),i.end=Object.assign({},r?e[r][1].start:t[1].end),e.splice(r||a,0,["exit",i,t[2]]),a++,n++}if("listItemPrefix"===t[1].type){const r={type:"listItem",_spread:!1,start:Object.assign({},t[1].start),end:void 0};i=r,e.splice(a,0,["enter",r,t[2]]),a++,n++,s=void 0,o=!0}}}return e[t][1]._spread=c,n}function s(e,t){return n;function n(n){a.call(this,e(n),n),t&&t.call(this,n)}}function o(){this.stack.push({type:"fragment",children:[]})}function a(e,t,n){this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push([t,n||void 0]),e.position={start:pX(t.start),end:void 0}}function l(e){return t;function t(t){e&&e.call(this,t),c.call(this,t)}}function c(e,t){const n=this.stack.pop(),i=this.tokenStack.pop();if(!i)throw new Error("Cannot close `"+e.type+"` ("+tV({start:e.start,end:e.end})+"): it\u2019s not open");if(i[0].type!==e.type)if(t)t.call(this,e,i[0]);else{(i[1]||gX).call(this,e,i[0])}n.position.end=pX(e.end)}function u(){return function(e,t){const n=t||xV;return DV(e,"boolean"!==typeof n.includeImageAlt||n.includeImageAlt,"boolean"!==typeof n.includeHtml||n.includeHtml)}(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function d(e){if(this.data.expectingFirstListItemValue){this.stack[this.stack.length-2].start=Number.parseInt(this.sliceSerialize(e),10),this.data.expectingFirstListItemValue=void 0}}function p(){const e=this.resume();this.stack[this.stack.length-1].lang=e}function f(){const e=this.resume();this.stack[this.stack.length-1].meta=e}function m(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function g(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/(\r?\n|\r)$/g,"")}function y(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=vU(this.sliceSerialize(e)).toLowerCase()}function O(){const e=this.resume();this.stack[this.stack.length-1].title=e}function w(){const e=this.resume();this.stack[this.stack.length-1].url=e}function b(e){const t=this.stack[this.stack.length-1];if(!t.depth){const n=this.sliceSerialize(e).length;t.depth=n}}function k(){this.data.setextHeadingSlurpLineEnding=!0}function x(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).codePointAt(0)?1:2}function D(){this.data.setextHeadingSlurpLineEnding=void 0}function S(e){const t=this.stack[this.stack.length-1].children;let n=t[t.length-1];n&&"text"===n.type||(n=oe(),n.position={start:pX(e.start),end:void 0},t.push(n)),this.stack.push(n)}function C(e){const t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=pX(e.end)}function A(e){const n=this.stack[this.stack.length-1];if(this.data.atHardBreak){return n.children[n.children.length-1].position.end=pX(e.end),void(this.data.atHardBreak=void 0)}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(n.type)&&(S.call(this,e),C.call(this,e))}function E(){this.data.atHardBreak=!0}function _(){const e=this.resume();this.stack[this.stack.length-1].value=e}function T(){const e=this.resume();this.stack[this.stack.length-1].value=e}function P(){const e=this.resume();this.stack[this.stack.length-1].value=e}function M(){const e=this.stack[this.stack.length-1];if(this.data.inReference){const t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}function F(){const e=this.stack[this.stack.length-1];if(this.data.inReference){const t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}function R(e){const t=this.sliceSerialize(e),n=this.stack[this.stack.length-2];n.label=function(e){return e.replace(cX,uX)}(t),n.identifier=vU(t).toLowerCase()}function N(){const e=this.stack[this.stack.length-1],t=this.resume(),n=this.stack[this.stack.length-1];if(this.data.inReference=!0,"link"===n.type){const t=e.children;n.children=t}else n.alt=t}function I(){const e=this.resume();this.stack[this.stack.length-1].url=e}function B(){const e=this.resume();this.stack[this.stack.length-1].title=e}function Q(){this.data.inReference=void 0}function L(){this.data.referenceType="collapsed"}function j(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=vU(this.sliceSerialize(e)).toLowerCase(),this.data.referenceType="full"}function $(e){this.data.characterReferenceType=e.type}function z(e){const t=this.sliceSerialize(e),n=this.data.characterReferenceType;let i;if(n)i=lX(t,"characterReferenceMarkerNumeric"===n?10:16),this.data.characterReferenceType=void 0;else{i=MU(t)}this.stack[this.stack.length-1].value+=i}function W(e){this.stack.pop().position.end=pX(e.end)}function V(e){C.call(this,e);this.stack[this.stack.length-1].url=this.sliceSerialize(e)}function U(e){C.call(this,e);this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)}function X(){return{type:"blockquote",children:[]}}function q(){return{type:"code",lang:null,meta:null,value:""}}function Z(){return{type:"inlineCode",value:""}}function H(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Y(){return{type:"emphasis",children:[]}}function G(){return{type:"heading",depth:0,children:[]}}function K(){return{type:"break"}}function J(){return{type:"html",value:""}}function ee(){return{type:"image",title:null,url:"",alt:null}}function te(){return{type:"link",title:null,url:"",children:[]}}function ne(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}function ie(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}}function re(){return{type:"paragraph",children:[]}}function se(){return{type:"strong",children:[]}}function oe(){return{type:"text",value:""}}function ae(){return{type:"thematicBreak"}}}(n)(function(e){for(;!TV(e););return e}(oX(n).document().write(function(){let e,t=1,n="",i=!0;return function(r,s,o){const a=[];let l,c,u,h,d;for(r=n+("string"===typeof r?r.toString():new TextDecoder(s||void 0).decode(r)),u=0,n="",i&&(65279===r.charCodeAt(0)&&u++,i=void 0);u<r.length;){if(aX.lastIndex=u,l=aX.exec(r),h=l&&void 0!==l.index?l.index:r.length,d=r.charCodeAt(h),!l){n=r.slice(u);break}if(10===d&&u===h&&e)a.push(-3),e=void 0;else switch(e&&(a.push(-5),e=void 0),u<h&&(a.push(r.slice(u,h)),t+=h-u),d){case 0:a.push(65533),t++;break;case 9:for(c=4*Math.ceil(t/4),a.push(-2);t++<c;)a.push(-1);break;case 10:a.push(-4),t=1;break;default:e=!0,t=1}u=h+1}return o&&(e&&a.push(-5),n&&a.push(n),a.push(null)),a}}()(e,t,!0))))}function pX(e){return{line:e.line,column:e.column,offset:e.offset}}function fX(e,t){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?fX(e,i):mX(e,i)}}function mX(e,t){let n;for(n in t)if(hX.call(t,n))switch(n){case"canContainEols":{const i=t[n];i&&e[n].push(...i);break}case"transforms":{const i=t[n];i&&e[n].push(...i);break}case"enter":case"exit":{const i=t[n];i&&Object.assign(e[n],i);break}}}function gX(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+tV({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+tV({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+tV({start:t.start,end:t.end})+") is still open")}function vX(e){const t=this;t.parser=function(n){return dX(n,p(p(p({},t.data("settings")),e),{},{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}}const yX="object"===typeof self?self:globalThis,OX=e=>((e,t)=>{const n=(t,n)=>(e.set(n,t),t),i=r=>{if(e.has(r))return e.get(r);const[s,o]=t[r];switch(s){case 0:case-1:return n(o,r);case 1:{const e=n([],r);for(const t of o)e.push(i(t));return e}case 2:{const e=n({},r);for(const[t,n]of o)e[i(t)]=i(n);return e}case 3:return n(new Date(o),r);case 4:{const{source:e,flags:t}=o;return n(new RegExp(e,t),r)}case 5:{const e=n(new Map,r);for(const[t,n]of o)e.set(i(t),i(n));return e}case 6:{const e=n(new Set,r);for(const t of o)e.add(i(t));return e}case 7:{const{name:e,message:t}=o;return n(new yX[e](t),r)}case 8:return n(BigInt(o),r);case"BigInt":return n(Object(BigInt(o)),r);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:e}=new Uint8Array(o);return n(new DataView(e),o)}}return n(new yX[s](o),r)};return i})(new Map,e)(0),wX="",{toString:bX}={},{keys:kX}=Object,xX=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const n=bX.call(e).slice(8,-1);switch(n){case"Array":return[1,wX];case"Object":return[2,wX];case"Date":return[3,wX];case"RegExp":return[4,wX];case"Map":return[5,wX];case"Set":return[6,wX];case"DataView":return[1,n]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},DX=e=>{let[t,n]=e;return 0===t&&("function"===n||"symbol"===n)},SX=function(e){let{json:t,lossy:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=[];return((e,t,n,i)=>{const r=(e,t)=>{const r=i.push(e)-1;return n.set(t,r),r},s=i=>{if(n.has(i))return n.get(i);let[o,a]=xX(i);switch(o){case 0:{let t=i;switch(a){case"bigint":o=8,t=i.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+a);t=null;break;case"undefined":return r([-1],i)}return r([o,t],i)}case 1:{if(a){let e=i;return"DataView"===a?e=new Uint8Array(i.buffer):"ArrayBuffer"===a&&(e=new Uint8Array(i)),r([a,[...e]],i)}const e=[],t=r([o,e],i);for(const n of i)e.push(s(n));return t}case 2:{if(a)switch(a){case"BigInt":return r([a,i.toString()],i);case"Boolean":case"Number":case"String":return r([a,i.valueOf()],i)}if(t&&"toJSON"in i)return s(i.toJSON());const n=[],l=r([o,n],i);for(const t of kX(i))!e&&DX(xX(i[t]))||n.push([s(t),s(i[t])]);return l}case 3:return r([o,i.toISOString()],i);case 4:{const{source:e,flags:t}=i;return r([o,{source:e,flags:t}],i)}case 5:{const t=[],n=r([o,t],i);for(const[r,o]of i)(e||!DX(xX(r))&&!DX(xX(o)))&&t.push([s(r),s(o)]);return n}case 6:{const t=[],n=r([o,t],i);for(const r of i)!e&&DX(xX(r))||t.push(s(r));return n}}const{message:l}=i;return r([o,{name:a,message:l}],i)};return s})(!(t||n),!!t,new Map,i)(e),i},CX="function"===typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?OX(SX(e,t)):structuredClone(e):(e,t)=>OX(SX(e,t));function AX(e){const t=[];let n=-1,i=0,r=0;for(;++n<e.length;){const s=e.charCodeAt(n);let o="";if(37===s&&IV(e.charCodeAt(n+1))&&IV(e.charCodeAt(n+2)))r=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(o=String.fromCharCode(s));else if(s>55295&&s<57344){const t=e.charCodeAt(n+1);s<56320&&t>56319&&t<57344?(o=String.fromCharCode(s,t),r=1):o="\ufffd"}else o=String.fromCharCode(s);o&&(t.push(e.slice(i,n),encodeURIComponent(o)),i=n+r+1,o=""),r&&(n+=r,r=0)}return t.join("")+e.slice(i)}function EX(e,t){const n=[{type:"text",value:"\u21a9"}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function _X(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}const TX=function(e){if(null===e||void 0===e)return MX;if("function"===typeof e)return PX(e);if("object"===typeof e)return Array.isArray(e)?function(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=TX(e[n]);return PX(i);function i(){let e=-1;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];for(;++e<t.length;)if(t[e].apply(this,i))return!0;return!1}}(e):function(e){const t=e;return PX(n);function n(n){const i=n;let r;for(r in e)if(i[r]!==t[r])return!1;return!0}}(e);if("string"===typeof e)return function(e){return PX(t);function t(t){return t&&t.type===e}}(e);throw new Error("Expected function, string, or object as test")};function PX(e){return function(t,n,i){return Boolean(FX(t)&&e.call(this,t,"number"===typeof n?n:void 0,i||void 0))}}function MX(){return!0}function FX(e){return null!==e&&"object"===typeof e&&"type"in e}const RX=[],NX=!0,IX=!1;function BX(e,t,n,i){let r;"function"===typeof t&&"function"!==typeof n?(i=n,n=t):r=t;const s=TX(r),o=i?-1:1;!function e(r,a,l){const c=r&&"object"===typeof r?r:{};if("string"===typeof c.type){const e="string"===typeof c.tagName?c.tagName:"string"===typeof c.name?c.name:void 0;Object.defineProperty(u,"name",{value:"node ("+r.type+(e?"<"+e+">":"")+")"})}return u;function u(){let c,u,h,d=RX;if((!t||s(r,a,l[l.length-1]||void 0))&&(d=function(e){if(Array.isArray(e))return e;if("number"===typeof e)return[NX,e];return null===e||void 0===e?RX:[e]}(n(r,l)),d[0]===IX))return d;if("children"in r&&r.children){const t=r;if(t.children&&"skip"!==d[0])for(u=(i?t.children.length:-1)+o,h=l.concat(t);u>-1&&u<t.children.length;){const n=t.children[u];if(c=e(n,u,h)(),c[0]===IX)return c;u="number"===typeof c[1]?c[1]:u+o}}return d}}(e,void 0,[])()}function QX(e,t,n,i){let r,s,o;"function"===typeof t&&"function"!==typeof n?(s=void 0,o=t,r=n):(s=t,o=n,r=i),BX(e,s,function(e,t){const n=t[t.length-1],i=n?n.children.indexOf(e):void 0;return o(e,i,n)},r)}function LX(e,t){const n=t.referenceType;let i="]";if("collapsed"===n?i+="[]":"full"===n&&(i+="["+(t.label||t.identifier)+"]"),"imageReference"===t.type)return[{type:"text",value:"!["+t.alt+i}];const r=e.all(t),s=r[0];s&&"text"===s.type?s.value="["+s.value:r.unshift({type:"text",value:"["});const o=r[r.length-1];return o&&"text"===o.type?o.value+=i:r.push({type:"text",value:i}),r}function jX(e){const t=e.spread;return null===t||void 0===t?e.children.length>1:t}function $X(e){const t=String(e),n=/\r?\n|\r/g;let i=n.exec(t),r=0;const s=[];for(;i;)s.push(zX(t.slice(r,i.index),r>0,!0),i[0]),r=i.index+i[0].length,i=n.exec(t);return s.push(zX(t.slice(r),r>0,!1)),s.join("")}function zX(e,t,n){let i=0,r=e.length;if(t){let t=e.codePointAt(i);for(;9===t||32===t;)i++,t=e.codePointAt(i)}if(n){let t=e.codePointAt(r-1);for(;9===t||32===t;)r--,t=e.codePointAt(r-1)}return r>i?e.slice(i,r):""}const WX={blockquote:function(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)},break:function(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:"\n"}]},code:function(e,t){const n=t.value?t.value+"\n":"",i={},r=t.lang?t.lang.split(/\s+/):[];r.length>0&&(i.className=["language-"+r[0]]);let s={type:"element",tagName:"code",properties:i,children:[{type:"text",value:n}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s},delete:function(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},emphasis:function(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},footnoteReference:function(e,t){const n="string"===typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",i=String(t.identifier).toUpperCase(),r=AX(i.toLowerCase()),s=e.footnoteOrder.indexOf(i);let o,a=e.footnoteCounts.get(i);void 0===a?(a=0,e.footnoteOrder.push(i),o=e.footnoteOrder.length):o=s+1,a+=1,e.footnoteCounts.set(i,a);const l={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+r,id:n+"fnref-"+r+(a>1?"-"+a:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(t,l);const c={type:"element",tagName:"sup",properties:{},children:[l]};return e.patch(t,c),e.applyData(t,c)},heading:function(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},html:function(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}},imageReference:function(e,t){const n=String(t.identifier).toUpperCase(),i=e.definitionById.get(n);if(!i)return LX(e,t);const r={src:AX(i.url||""),alt:t.alt};null!==i.title&&void 0!==i.title&&(r.title=i.title);const s={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,s),e.applyData(t,s)},image:function(e,t){const n={src:AX(t.url)};null!==t.alt&&void 0!==t.alt&&(n.alt=t.alt),null!==t.title&&void 0!==t.title&&(n.title=t.title);const i={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,i),e.applyData(t,i)},inlineCode:function(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const i={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,i),e.applyData(t,i)},linkReference:function(e,t){const n=String(t.identifier).toUpperCase(),i=e.definitionById.get(n);if(!i)return LX(e,t);const r={href:AX(i.url||"")};null!==i.title&&void 0!==i.title&&(r.title=i.title);const s={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,s),e.applyData(t,s)},link:function(e,t){const n={href:AX(t.url)};null!==t.title&&void 0!==t.title&&(n.title=t.title);const i={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)},listItem:function(e,t,n){const i=e.all(t),r=n?function(e){let t=!1;if("list"===e.type){t=e.spread||!1;const n=e.children;let i=-1;for(;!t&&++i<n.length;)t=jX(n[i])}return t}(n):jX(t),s={},o=[];if("boolean"===typeof t.checked){const e=i[0];let n;e&&"element"===e.type&&"p"===e.tagName?n=e:(n={type:"element",tagName:"p",properties:{},children:[]},i.unshift(n)),n.children.length>0&&n.children.unshift({type:"text",value:" "}),n.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let a=-1;for(;++a<i.length;){const e=i[a];(r||0!==a||"element"!==e.type||"p"!==e.tagName)&&o.push({type:"text",value:"\n"}),"element"!==e.type||"p"!==e.tagName||r?o.push(e):o.push(...e.children)}const l=i[i.length-1];l&&(r||"element"!==l.type||"p"!==l.tagName)&&o.push({type:"text",value:"\n"});const c={type:"element",tagName:"li",properties:s,children:o};return e.patch(t,c),e.applyData(t,c)},list:function(e,t){const n={},i=e.all(t);let r=-1;for("number"===typeof t.start&&1!==t.start&&(n.start=t.start);++r<i.length;){const e=i[r];if("element"===e.type&&"li"===e.tagName&&e.properties&&Array.isArray(e.properties.className)&&e.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const s={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(i,!0)};return e.patch(t,s),e.applyData(t,s)},paragraph:function(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},root:function(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)},strong:function(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},table:function(e,t){const n=e.all(t),i=n.shift(),r=[];if(i){const n={type:"element",tagName:"thead",properties:{},children:e.wrap([i],!0)};e.patch(t.children[0],n),r.push(n)}if(n.length>0){const i={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},s=JW(t.children[1]),o=KW(t.children[t.children.length-1]);s&&o&&(i.position={start:s,end:o}),r.push(i)}const s={type:"element",tagName:"table",properties:{},children:e.wrap(r,!0)};return e.patch(t,s),e.applyData(t,s)},tableCell:function(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},tableRow:function(e,t,n){const i=n?n.children:void 0,r=0===(i?i.indexOf(t):1)?"th":"td",s=n&&"table"===n.type?n.align:void 0,o=s?s.length:t.children.length;let a=-1;const l=[];for(;++a<o;){const n=t.children[a],i={},o=s?s[a]:void 0;o&&(i.align=o);let c={type:"element",tagName:r,properties:i,children:[]};n&&(c.children=e.all(n),e.patch(n,c),c=e.applyData(n,c)),l.push(c)}const c={type:"element",tagName:"tr",properties:{},children:e.wrap(l,!0)};return e.patch(t,c),e.applyData(t,c)},text:function(e,t){const n={type:"text",value:$X(String(t.value))};return e.patch(t,n),e.applyData(t,n)},thematicBreak:function(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)},toml:VX,yaml:VX,definition:VX,footnoteDefinition:VX};function VX(){}const UX=["children"],XX={}.hasOwnProperty,qX={};function ZX(e,t){e.position&&(t.position=function(e){const t=JW(e),n=KW(e);if(t&&n)return{start:t,end:n}}(e))}function HX(e,t){let n=t;if(e&&e.data){const t=e.data.hName,i=e.data.hChildren,r=e.data.hProperties;if("string"===typeof t)if("element"===n.type)n.tagName=t;else{n={type:"element",tagName:t,properties:{},children:"children"in n?n.children:[n]}}"element"===n.type&&r&&Object.assign(n.properties,CX(r)),"children"in n&&n.children&&null!==i&&void 0!==i&&(n.children=i)}return n}function YX(e,t){const n=t.data||{},i=!("value"in t)||XX.call(n,"hProperties")||XX.call(n,"hChildren")?{type:"element",tagName:"div",properties:{},children:e.all(t)}:{type:"text",value:t.value};return e.patch(t,i),e.applyData(t,i)}function GX(e,t){const n=[];let i=-1;for(t&&n.push({type:"text",value:"\n"});++i<e.length;)i&&n.push({type:"text",value:"\n"}),n.push(e[i]);return t&&e.length>0&&n.push({type:"text",value:"\n"}),n}function KX(e){let t=0,n=e.charCodeAt(t);for(;9===n||32===n;)t++,n=e.charCodeAt(t);return e.slice(t)}function JX(e,t){const n=function(e,t){const n=t||qX,i=new Map,r=new Map,s=new Map,o=p(p({},WX),n.handlers),a={all:function(e){const t=[];if("children"in e){const n=e.children;let i=-1;for(;++i<n.length;){const r=a.one(n[i],e);if(r){if(i&&"break"===n[i-1].type&&(Array.isArray(r)||"text"!==r.type||(r.value=KX(r.value)),!Array.isArray(r)&&"element"===r.type)){const e=r.children[0];e&&"text"===e.type&&(e.value=KX(e.value))}Array.isArray(r)?t.push(...r):t.push(r)}}}return t},applyData:HX,definitionById:i,footnoteById:r,footnoteCounts:s,footnoteOrder:[],handlers:o,one:function(e,t){const n=e.type,i=a.handlers[n];if(XX.call(a.handlers,n)&&i)return i(a,e,t);if(a.options.passThrough&&a.options.passThrough.includes(n)){if("children"in e){const{children:t}=e,n=l(e,UX),i=CX(n);return i.children=a.all(e),i}return CX(e)}return(a.options.unknownHandler||YX)(a,e,t)},options:n,patch:ZX,wrap:GX};return QX(e,function(e){if("definition"===e.type||"footnoteDefinition"===e.type){const t="definition"===e.type?i:r,n=String(e.identifier).toUpperCase();t.has(n)||t.set(n,e)}}),a}(e,t),i=n.one(e,void 0),r=function(e){const t="string"===typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||EX,i=e.options.footnoteBackLabel||_X,r=e.options.footnoteLabel||"Footnotes",s=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},a=[];let l=-1;for(;++l<e.footnoteOrder.length;){const r=e.footnoteById.get(e.footnoteOrder[l]);if(!r)continue;const s=e.all(r),o=String(r.identifier).toUpperCase(),c=AX(o.toLowerCase());let u=0;const h=[],d=e.footnoteCounts.get(o);for(;void 0!==d&&++u<=d;){h.length>0&&h.push({type:"text",value:" "});let e="string"===typeof n?n:n(l,u);"string"===typeof e&&(e={type:"text",value:e}),h.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+c+(u>1?"-"+u:""),dataFootnoteBackref:"",ariaLabel:"string"===typeof i?i:i(l,u),className:["data-footnote-backref"]},children:Array.isArray(e)?e:[e]})}const p=s[s.length-1];if(p&&"element"===p.type&&"p"===p.tagName){const e=p.children[p.children.length-1];e&&"text"===e.type?e.value+=" ":p.children.push({type:"text",value:" "}),p.children.push(...h)}else s.push(...h);const f={type:"element",tagName:"li",properties:{id:t+"fn-"+c},children:e.wrap(s,!0)};e.patch(r,f),a.push(f)}if(0!==a.length)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:p(p({},CX(o)),{},{id:"footnote-label"}),children:[{type:"text",value:r}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:e.wrap(a,!0)},{type:"text",value:"\n"}]}}(n),s=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return r&&s.children.push({type:"text",value:"\n"},r),s}function eq(e,t){return e&&"run"in e?async function(n,i){const r=JX(n,p({file:i},t));await e.run(r,i)}:function(n,i){return JX(n,p({file:i},e||t))}}function tq(e){if(e)throw e}var nq=n(240);function iq(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function rq(){const e=[],t={run:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];let r=-1;const s=n.pop();if("function"!==typeof s)throw new TypeError("Expected function as last argument, not "+s);!function t(i){const o=e[++r];let a=-1;if(i)s(i);else{for(var l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];for(;++a<n.length;)null!==c[a]&&void 0!==c[a]||(c[a]=n[a]);n=c,o?function(e,t){let n;return r;function r(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];const l=e.length>r.length;let c;l&&r.push(s);try{c=e.apply(this,r)}catch(i){if(l&&n)throw i;return s(i)}l||(c&&c.then&&"function"===typeof c.then?c.then(o,s):c instanceof Error?s(c):o(c))}function s(e){if(!n){n=!0;for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];t(e,...r)}}function o(e){s(null,e)}}(o,t)(...c):s(null,...c)}}(null,...n)},use:function(n){if("function"!==typeof n)throw new TypeError("Expected `middelware` to be a function, not "+n);return e.push(n),t}};return t}const sq={basename:function(e,t){if(void 0!==t&&"string"!==typeof t)throw new TypeError('"ext" argument must be a string');oq(e);let n,i=0,r=-1,s=e.length;if(void 0===t||0===t.length||t.length>e.length){for(;s--;)if(47===e.codePointAt(s)){if(n){i=s+1;break}}else r<0&&(n=!0,r=s+1);return r<0?"":e.slice(i,r)}if(t===e)return"";let o=-1,a=t.length-1;for(;s--;)if(47===e.codePointAt(s)){if(n){i=s+1;break}}else o<0&&(n=!0,o=s+1),a>-1&&(e.codePointAt(s)===t.codePointAt(a--)?a<0&&(r=s):(a=-1,r=o));i===r?r=o:r<0&&(r=e.length);return e.slice(i,r)},dirname:function(e){if(oq(e),0===e.length)return".";let t,n=-1,i=e.length;for(;--i;)if(47===e.codePointAt(i)){if(t){n=i;break}}else t||(t=!0);return n<0?47===e.codePointAt(0)?"/":".":1===n&&47===e.codePointAt(0)?"//":e.slice(0,n)},extname:function(e){oq(e);let t,n=e.length,i=-1,r=0,s=-1,o=0;for(;n--;){const a=e.codePointAt(n);if(47!==a)i<0&&(t=!0,i=n+1),46===a?s<0?s=n:1!==o&&(o=1):s>-1&&(o=-1);else if(t){r=n+1;break}}if(s<0||i<0||0===o||1===o&&s===i-1&&s===r+1)return"";return e.slice(s,i)},join:function(){let e,t=-1;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];for(;++t<i.length;)oq(i[t]),i[t]&&(e=void 0===e?i[t]:e+"/"+i[t]);return void 0===e?".":function(e){oq(e);const t=47===e.codePointAt(0);let n=function(e,t){let n,i,r="",s=0,o=-1,a=0,l=-1;for(;++l<=e.length;){if(l<e.length)n=e.codePointAt(l);else{if(47===n)break;n=47}if(47===n){if(o===l-1||1===a);else if(o!==l-1&&2===a){if(r.length<2||2!==s||46!==r.codePointAt(r.length-1)||46!==r.codePointAt(r.length-2))if(r.length>2){if(i=r.lastIndexOf("/"),i!==r.length-1){i<0?(r="",s=0):(r=r.slice(0,i),s=r.length-1-r.lastIndexOf("/")),o=l,a=0;continue}}else if(r.length>0){r="",s=0,o=l,a=0;continue}t&&(r=r.length>0?r+"/..":"..",s=2)}else r.length>0?r+="/"+e.slice(o+1,l):r=e.slice(o+1,l),s=l-o-1;o=l,a=0}else 46===n&&a>-1?a++:a=-1}return r}(e,!t);0!==n.length||t||(n=".");n.length>0&&47===e.codePointAt(e.length-1)&&(n+="/");return t?"/"+n:n}(e)},sep:"/"};function oq(e){if("string"!==typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const aq={cwd:function(){return"/"}};function lq(e){return Boolean(null!==e&&"object"===typeof e&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&void 0===e.auth)}function cq(e){if("string"===typeof e)e=new URL(e);else if(!lq(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if("file:"!==e.protocol){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return function(e){if(""!==e.hostname){const e=new TypeError('File URL host must be "localhost" or empty on darwin');throw e.code="ERR_INVALID_FILE_URL_HOST",e}const t=e.pathname;let n=-1;for(;++n<t.length;)if(37===t.codePointAt(n)&&50===t.codePointAt(n+1)){const e=t.codePointAt(n+2);if(70===e||102===e){const e=new TypeError("File URL path must not include encoded / characters");throw e.code="ERR_INVALID_FILE_URL_PATH",e}}return decodeURIComponent(t)}(e)}const uq=["history","path","basename","stem","extname","dirname"];class hq{constructor(e){let t;t=e?lq(e)?{path:e}:"string"===typeof e||function(e){return Boolean(e&&"object"===typeof e&&"byteLength"in e&&"byteOffset"in e)}(e)?{value:e}:e:{},this.cwd="cwd"in t?"":aq.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n,i=-1;for(;++i<uq.length;){const e=uq[i];e in t&&void 0!==t[e]&&null!==t[e]&&(this[e]="history"===e?[...t[e]]:t[e])}for(n in t)uq.includes(n)||(this[n]=t[n])}get basename(){return"string"===typeof this.path?sq.basename(this.path):void 0}set basename(e){pq(e,"basename"),dq(e,"basename"),this.path=sq.join(this.dirname||"",e)}get dirname(){return"string"===typeof this.path?sq.dirname(this.path):void 0}set dirname(e){fq(this.basename,"dirname"),this.path=sq.join(e||"",this.basename)}get extname(){return"string"===typeof this.path?sq.extname(this.path):void 0}set extname(e){if(dq(e,"extname"),fq(this.dirname,"extname"),e){if(46!==e.codePointAt(0))throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=sq.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){lq(e)&&(e=cq(e)),pq(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return"string"===typeof this.path?sq.basename(this.path,this.extname):void 0}set stem(e){pq(e,"stem"),dq(e,"stem"),this.path=sq.join(this.dirname||"",e+(this.extname||""))}fail(e,t,n){const i=this.message(e,t,n);throw i.fatal=!0,i}info(e,t,n){const i=this.message(e,t,n);return i.fatal=void 0,i}message(e,t,n){const i=new sV(e,t,n);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(e){if(void 0===this.value)return"";if("string"===typeof this.value)return this.value;return new TextDecoder(e||void 0).decode(this.value)}}function dq(e,t){if(e&&e.includes(sq.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+sq.sep+"`")}function pq(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function fq(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}const mq=function(e){const t=this.constructor.prototype,n=t[e],i=function(){return n.apply(i,arguments)};return Object.setPrototypeOf(i,t),i},gq={}.hasOwnProperty;class vq extends mq{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=rq()}copy(){const e=new vq;let t=-1;for(;++t<this.attachers.length;){const n=this.attachers[t];e.use(...n)}return e.data(nq(!0,{},this.namespace)),e}data(e,t){return"string"===typeof e?2===arguments.length?(bq("data",this.frozen),this.namespace[e]=t,this):gq.call(this.namespace,e)&&this.namespace[e]||void 0:e?(bq("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...n]=this.attachers[this.freezeIndex];if(!1===n[0])continue;!0===n[0]&&(n[0]=void 0);const i=t.call(e,...n);"function"===typeof i&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=Dq(e),n=this.parser||this.Parser;return Oq("parse",n),n(String(t),t)}process(e,t){const n=this;return this.freeze(),Oq("process",this.parser||this.Parser),wq("process",this.compiler||this.Compiler),t?i(void 0,t):new Promise(i);function i(i,r){const s=Dq(e),o=n.parse(s);function a(e,n){e||!n?r(e):i?i(n):t(void 0,n)}n.run(o,s,function(e,t,i){if(e||!t||!i)return a(e);const r=t,s=n.stringify(r,i);!function(e){return"string"===typeof e||function(e){return Boolean(e&&"object"===typeof e&&"byteLength"in e&&"byteOffset"in e)}(e)}(s)?i.result=s:i.value=s,a(e,i)})}}processSync(e){let t,n=!1;return this.freeze(),Oq("processSync",this.parser||this.Parser),wq("processSync",this.compiler||this.Compiler),this.process(e,function(e,i){n=!0,tq(e),t=i}),xq("processSync","process",n),t}run(e,t,n){kq(e),this.freeze();const i=this.transformers;return n||"function"!==typeof t||(n=t,t=void 0),n?r(void 0,n):new Promise(r);function r(r,s){const o=Dq(t);i.run(e,o,function(t,i,o){const a=i||e;t?s(t):r?r(a):n(void 0,a,o)})}}runSync(e,t){let n,i=!1;return this.run(e,t,function(e,t){tq(e),n=t,i=!0}),xq("runSync","run",i),n}stringify(e,t){this.freeze();const n=Dq(t),i=this.compiler||this.Compiler;return wq("stringify",i),kq(e),i(e,n)}use(e){const t=this.attachers,n=this.namespace;if(bq("use",this.frozen),null===e||void 0===e);else if("function"===typeof e){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];c(e,r)}else{if("object"!==typeof e)throw new TypeError("Expected usable value, not `"+e+"`");Array.isArray(e)?l(e):a(e)}return this;function o(e){if("function"===typeof e)c(e,[]);else{if("object"!==typeof e)throw new TypeError("Expected usable value, not `"+e+"`");if(Array.isArray(e)){const[t,...n]=e;c(t,n)}else a(e)}}function a(e){if(!("plugins"in e)&&!("settings"in e))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(e.plugins),e.settings&&(n.settings=nq(!0,n.settings,e.settings))}function l(e){let t=-1;if(null===e||void 0===e);else{if(!Array.isArray(e))throw new TypeError("Expected a list of plugins, not `"+e+"`");for(;++t<e.length;){o(e[t])}}}function c(e,n){let i=-1,r=-1;for(;++i<t.length;)if(t[i][0]===e){r=i;break}if(-1===r)t.push([e,...n]);else if(n.length>0){let[i,...s]=n;const o=t[r][1];iq(o)&&iq(i)&&(i=nq(!0,o,i)),t[r]=[e,i,...s]}}}}const yq=(new vq).freeze();function Oq(e,t){if("function"!==typeof t)throw new TypeError("Cannot `"+e+"` without `parser`")}function wq(e,t){if("function"!==typeof t)throw new TypeError("Cannot `"+e+"` without `compiler`")}function bq(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function kq(e){if(!iq(e)||"string"!==typeof e.type)throw new TypeError("Expected node, got `"+e+"`")}function xq(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Dq(e){return function(e){return Boolean(e&&"object"===typeof e&&"message"in e&&"messages"in e)}(e)?e:new hq(e)}const Sq=[],Cq={allowDangerousHtml:!0},Aq=/^(https?|ircs?|mailto|xmpp)$/i,Eq=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function _q(e){const t=Tq(e),n=Pq(e);return Mq(t.runSync(t.parse(n),n),e)}function Tq(e){const t=e.rehypePlugins||Sq,n=e.remarkPlugins||Sq,i=e.remarkRehypeOptions?p(p({},e.remarkRehypeOptions),Cq):Cq;return yq().use(vX).use(n).use(eq,i).use(t)}function Pq(e){const t=e.children||"",n=new hq;return"string"===typeof t&&(n.value=t),n}function Mq(e,t){const n=t.allowedElements,i=t.allowElement,r=t.components,s=t.disallowedElements,o=t.skipHtml,a=t.unwrapDisallowed,l=t.urlTransform||Fq;for(const c of Eq)Object.hasOwn(t,c.from)&&hW((c.from,c.to&&c.to,c.id));return QX(e,function(e,t,r){if("raw"===e.type&&r&&"number"===typeof t)return o?r.children.splice(t,1):r.children[t]={type:"text",value:e.value},t;if("element"===e.type){let t;for(t in kV)if(Object.hasOwn(kV,t)&&Object.hasOwn(e.properties,t)){const n=e.properties[t],i=kV[t];(null===i||i.includes(e.tagName))&&(e.properties[t]=l(String(n||""),t,e))}}if("element"===e.type){let o=n?!n.includes(e.tagName):!!s&&s.includes(e.tagName);if(!o&&i&&"number"===typeof t&&(o=!i(e,t,r)),o&&r&&"number"===typeof t)return a&&e.children?r.children.splice(t,1,...e.children):r.children.splice(t,1),t}}),dV(e,{Fragment:Qt.Fragment,components:r,ignoreInvalidStyle:!0,jsx:Qt.jsx,jsxs:Qt.jsxs,passKeys:!0,passNode:!0})}function Fq(e){const t=e.indexOf(":"),n=e.indexOf("?"),i=e.indexOf("#"),r=e.indexOf("/");return-1===t||-1!==r&&t>r||-1!==n&&t>n||-1!==i&&t>i||Aq.test(e.slice(0,t))?e:""}const Rq=200,Nq=140,Iq=["#B399D4","#7C9CE5","#E57C7C","#E5B97C","#7CE5A3","#E57CC8","#7CE5D4","#C5E57C"];function Bq(e){return"flashy-canvas-".concat(e)}function Qq(e,t){try{localStorage.setItem(Bq(e),JSON.stringify(t))}catch(n){}}function Lq(e){let{isActive:t,flashcards:n,roomId:i}=e;const r=(0,s.useRef)(null),o=(0,s.useRef)(null),[a,l]=(0,s.useState)({}),[c,u]=(0,s.useState)([]),[h,d]=(0,s.useState)(null),[f,m]=(0,s.useState)(null),[g,v]=(0,s.useState)(null),[y,O]=(0,s.useState)(new Set),[w,b]=(0,s.useState)(null),[k,x]=(0,s.useState)(1),[,D]=(0,s.useState)(0),[S,C]=(0,s.useState)("select"),A=(0,s.useRef)({x:0,y:0}),E=(0,s.useRef)(!1),_=(0,s.useRef)({x:0,y:0}),T=(0,s.useRef)({x:0,y:0}),P=(0,s.useRef)({x:0,y:0}),M=(0,s.useRef)(1),F=(0,s.useRef)({}),R=(0,s.useRef)([]);(0,s.useEffect)(()=>{M.current=k},[k]),(0,s.useEffect)(()=>{F.current=a},[a]),(0,s.useEffect)(()=>{R.current=c},[c]);const N=(0,s.useCallback)(()=>{Qq(i,{positions:F.current,connections:R.current})},[i]),I=(0,s.useCallback)((e,t)=>{const n=r.current;if(!n)return{x:e,y:t};const i=n.getBoundingClientRect();return{x:(e-i.left-A.current.x)/M.current,y:(t-i.top-A.current.y)/M.current}},[]);(0,s.useEffect)(()=>{const e=function(e){try{const t=localStorage.getItem(Bq(e));if(t){const e=JSON.parse(t);return{positions:e.positions||{},connections:e.connections||[]}}}catch(t){}return{positions:{},connections:[]}}(i);l(e.positions),u(e.connections),F.current=e.positions,R.current=e.connections},[i]),(0,s.useEffect)(()=>{if(0===n.length)return;const e=F.current,t={};n.forEach(e=>{const n=e.section||"Unsorted";t[n]||(t[n]=[]),t[n].push(e)});let r=!1;const s=p({},e),o=Object.keys(t);let a=50;o.forEach((e,n)=>{const i=t[e],o=Math.ceil(Math.sqrt(i.length)),l=230*o;i.forEach((e,t)=>{if(!s[e.id]){r=!0;const i=Math.floor(t/o),l=t%o,c=n%Iq.length;s[e.id]={x:a+230*l,y:170*i+80,color:Iq[c]}}}),a+=l+80}),r&&(l(s),F.current=s,Qq(i,{positions:s,connections:R.current}))},[n,i]);const B=(0,s.useCallback)((e,t)=>{var n;if("connect"===S){e.stopPropagation(),m(t);const n=I(e.clientX,e.clientY);return void v(n)}e.stopPropagation();const i=I(e.clientX,e.clientY),r=a[t];r&&(P.current={x:i.x-r.x,y:i.y-r.y},d(t),b(t),null===(n=e.target.closest(".canvas-card"))||void 0===n||n.setPointerCapture(e.pointerId))},[S,a,I]),Q=(0,s.useCallback)(e=>{if(f){const t=I(e.clientX,e.clientY);return void v(t)}if(!h)return;const t=I(e.clientX,e.clientY),n=t.x-P.current.x,i=t.y-P.current.y;l(e=>{const t=e[h]||{},r=p(p({},e),{},{[h]:p(p({},t),{},{x:n,y:i})});return F.current=r,r})},[h,f,I]),L=(0,s.useCallback)((e,t)=>{f&&t&&t!==f&&u(e=>{const n=e.some(e=>e.from===f&&e.to===t)?e.filter(e=>!(e.from===f&&e.to===t)):[...e,{from:f,to:t}];return R.current=n,Qq(i,{positions:F.current,connections:n}),n}),m(null),v(null),h&&(d(null),N())},[h,f,i,N]),j=(0,s.useCallback)(e=>{var t;if(b(null),f)return m(null),void v(null);E.current=!0,_.current={x:e.clientX,y:e.clientY},T.current=p({},A.current),null===(t=r.current)||void 0===t||t.setPointerCapture(e.pointerId)},[f]),$=(0,s.useCallback)(e=>{if(f){const t=I(e.clientX,e.clientY);v(t)}if(!E.current)return;const t=e.clientX-_.current.x,n=e.clientY-_.current.y;A.current={x:T.current.x+t,y:T.current.y+n},D(e=>e+1)},[f,I]),z=(0,s.useCallback)(e=>{var t;E.current&&(E.current=!1,null===(t=r.current)||void 0===t||t.releasePointerCapture(e.pointerId));f&&(m(null),v(null))},[f]);(0,s.useEffect)(()=>{const e=r.current;if(!e)return;const t=t=>{t.preventDefault();const n=t.deltaY>0?.92:1.08,i=Math.max(.2,Math.min(3,M.current*n)),r=e.getBoundingClientRect(),s=t.clientX-r.left,o=t.clientY-r.top,a=i/M.current;A.current={x:s-a*(s-A.current.x),y:o-a*(o-A.current.y)},x(i)};return e.addEventListener("wheel",t,{passive:!1}),()=>e.removeEventListener("wheel",t)},[]);const W=(0,s.useCallback)(e=>{O(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),V=(0,s.useCallback)(()=>{const e={};n.forEach(t=>{const n=t.section||"Unsorted";e[n]||(e[n]=[]),e[n].push(t)});const t=Object.keys(e);let r=50;const s=p({},F.current);t.forEach((t,n)=>{const i=e[t],o=Math.ceil(Math.sqrt(i.length)),a=230*o,l=n%Iq.length;i.forEach((e,t)=>{const n=Math.floor(t/o),i=t%o,a=s[e.id]||{};s[e.id]=p(p({},a),{},{x:r+230*i,y:170*n+80,color:a.color||Iq[l]})}),r+=a+80}),l(s),F.current=s,Qq(i,{positions:s,connections:R.current}),A.current={x:0,y:0},x(1)},[n,i]),U=(0,s.useCallback)(()=>{if(0===n.length)return;const e=r.current;if(!e)return;let t=1/0,i=1/0,s=-1/0,o=-1/0;if(n.forEach(e=>{const n=a[e.id];n&&(t=Math.min(t,n.x),i=Math.min(i,n.y),s=Math.max(s,n.x+Rq),o=Math.max(o,n.y+Nq))}),t===1/0)return;const l=s-t,c=o-i,u=e.getBoundingClientRect(),h=(u.width-120)/l,d=(u.height-120)/c,p=Math.min(Math.max(Math.min(h,d),.3),1.5),f=(t+s)/2,m=(i+o)/2;A.current={x:u.width/2-f*p,y:u.height/2-m*p},x(p)},[n,a]),X=e=>{const t=a[e];return t?{x:t.x+100,y:t.y+70}:null};return(0,Qt.jsxs)("div",{ref:r,className:"collaborative-canvas-container ".concat("connect"===S?"tool-connect":""," ").concat(E.current?"panning":""),onPointerDown:j,onPointerMove:$,onPointerUp:z,children:[(0,Qt.jsx)("div",{className:"canvas-dot-grid",style:{backgroundPosition:"".concat(A.current.x,"px ").concat(A.current.y,"px"),backgroundSize:"".concat(24*k,"px ").concat(24*k,"px")}}),(0,Qt.jsx)(lW,{activeTool:S,onToolChange:C,onAutoArrange:V,onCenterView:U,cardCount:n.length,connectionCount:c.length}),(0,Qt.jsxs)("svg",{ref:o,className:"canvas-svg-layer",style:{transform:"translate(".concat(A.current.x,"px, ").concat(A.current.y,"px) scale(").concat(k,")"),transformOrigin:"0 0"},children:[(0,Qt.jsx)("defs",{children:(0,Qt.jsx)("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",children:(0,Qt.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#B399D4",opacity:"0.6"})})}),c.map(e=>{const t=X(e.from),n=X(e.to);return t&&n?(0,Qt.jsx)("line",{x1:t.x,y1:t.y,x2:n.x,y2:n.y,stroke:"#B399D4",strokeWidth:2/k,strokeDasharray:"".concat(6/k,",").concat(4/k),opacity:.6,markerEnd:"url(#arrowhead)"},"".concat(e.from,"-").concat(e.to)):null}),(()=>{if(!f||!g)return null;const e=X(f);return e?(0,Qt.jsx)("line",{x1:e.x,y1:e.y,x2:g.x,y2:g.y,stroke:"#B399D4",strokeWidth:2/k,strokeDasharray:"".concat(4/k,",").concat(4/k),opacity:.8}):null})()]}),(0,Qt.jsxs)("div",{className:"canvas-cards-layer",style:{transform:"translate(".concat(A.current.x,"px, ").concat(A.current.y,"px) scale(").concat(k,")"),transformOrigin:"0 0"},children:[(()=>{const e={};return n.forEach(t=>{const n=a[t.id];if(!n)return;const i=t.section||"Unsorted";e[i]?(e[i].minX=Math.min(e[i].minX,n.x),e[i].minY=Math.min(e[i].minY,n.y)):e[i]={minX:n.x,minY:n.y}}),Object.entries(e).map(e=>{let[t,n]=e;return(0,Qt.jsx)("div",{className:"canvas-section-label",style:{left:n.minX,top:n.minY-32},children:t},"section-".concat(t))})})(),n.map(e=>{const t=a[e.id];if(!t)return null;const n=y.has(e.id),i=w===e.id,r=h===e.id,s=t.color||"#B399D4";return(0,Qt.jsx)("div",{className:"canvas-card ".concat(i?"selected":""," ").concat(r?"dragging":""," ").concat(f===e.id?"connecting-source":""),style:{left:t.x,top:t.y,width:Rq,height:Nq,"--card-color":s},onPointerDown:t=>B(t,e.id),onPointerMove:Q,onPointerUp:t=>L(t,e.id),onDoubleClick:t=>{t.stopPropagation(),W(e.id)},children:(0,Qt.jsxs)("div",{className:"canvas-card-inner ".concat(n?"flipped":""),children:[(0,Qt.jsxs)("div",{className:"canvas-card-front",style:{background:s},children:[(0,Qt.jsx)("div",{className:"canvas-card-term",children:e.term}),e.section&&(0,Qt.jsx)("div",{className:"canvas-card-section",children:e.section})]}),(0,Qt.jsx)("div",{className:"canvas-card-back",style:{borderColor:s},children:(0,Qt.jsx)("div",{className:"canvas-card-definition",children:(0,Qt.jsx)(_q,{children:e.definition})})})]})},e.id)})]}),0===n.length&&(0,Qt.jsxs)("div",{className:"canvas-empty-state",children:[(0,Qt.jsx)("div",{className:"canvas-empty-icon",children:(0,Qt.jsx)(cW,{size:32})}),(0,Qt.jsx)("div",{className:"canvas-empty-title",children:"No flashcards yet"}),(0,Qt.jsx)("div",{className:"canvas-empty-subtitle",children:"Use ## headings in the editor to create cards"})]}),1!==k&&(0,Qt.jsxs)("div",{className:"canvas-zoom-indicator",children:[Math.round(100*k),"%"]})]})}const jq=qz("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);function $q(e){let{onRestore:t,roomId:n}=e;const[i,r]=(0,s.useState)(!1),[o,a]=(0,s.useState)([]),[l,c]=(0,s.useState)(!1),[u,h]=(0,s.useState)(null),[d,p]=(0,s.useState)(null),f=(0,s.useCallback)(async e=>{c(!0),h(null);try{const t=new Date(Date.now()-6048e5).toISOString(),i="room-".concat(n),{data:r,error:s}=await Q_.from("document_versions").select("version, created_at, last_edited_by").eq("document_id",i).gte("created_at",t).order("created_at",{ascending:!1}).limit(50).abortSignal(e);if(s)throw s;a(r||[])}catch(t){if("AbortError"===(null===t||void 0===t?void 0:t.name))return;KS.error("Error loading versions:",t),h((null===t||void 0===t?void 0:t.message)||"Failed to load version history")}finally{c(!1)}},[n]);(0,s.useEffect)(()=>{if(!i)return;const e=new AbortController;return f(e.signal),()=>e.abort()},[i,f]);const m=e=>{const t=new Date(e),n=new Date,i=new Date(n.getFullYear(),n.getMonth(),n.getDate()),r=new Date(i);r.setDate(r.getDate()-1);const s=new Date(t.getFullYear(),t.getMonth(),t.getDate()),o=Math.floor((i.getTime()-s.getTime())/864e5),a=t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});if(0===o)return"Today at ".concat(a);if(1===o)return"Yesterday at ".concat(a);if(o<7)return"".concat(o," days ago at ").concat(a);if(o<30){const e=Math.floor(o/7);return"".concat(e," week").concat(e>1?"s":""," ago")}return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==n.getFullYear()?"numeric":void 0})};return(0,Qt.jsxs)(Qt.Fragment,{children:[(0,Qt.jsxs)("div",{className:"version-history-container",children:[(0,Qt.jsx)("button",{className:"version-history-button",onClick:()=>r(!i),children:(0,Qt.jsx)(jq,{size:22})}),i&&(0,Qt.jsxs)("div",{className:"version-history-dropdown",children:[(0,Qt.jsxs)("div",{className:"version-history-header",children:[(0,Qt.jsx)("h3",{children:"Version History (7 Days)"}),(0,Qt.jsx)("button",{className:"version-history-close",onClick:()=>r(!1),children:"\xd7"})]}),(0,Qt.jsx)("div",{className:"version-history-list",children:l?(0,Qt.jsx)("div",{className:"version-history-loading",children:"Loading..."}):u?(0,Qt.jsxs)("div",{className:"version-history-error",children:[(0,Qt.jsx)("p",{children:u}),(0,Qt.jsx)("button",{className:"version-history-retry",onClick:()=>f(),children:"Retry"})]}):0===o.length?(0,Qt.jsx)("div",{className:"version-history-empty",children:"No snapshots yet. Snapshots are created automatically as you edit \u2014 they'll appear here shortly."}):o.map((e,t)=>(0,Qt.jsxs)("div",{className:"version-history-item",children:[(0,Qt.jsxs)("div",{className:"version-history-info",children:[(0,Qt.jsxs)("div",{className:"version-history-time",children:[0===t?"\u25cf ":"\u25cb ",m(e.created_at)]}),(0,Qt.jsxs)("div",{className:"version-history-user",children:["by ",e.last_edited_by||"anonymous"]})]}),0===t?(0,Qt.jsx)("span",{className:"version-history-current",children:"Current"}):(0,Qt.jsx)("button",{className:"version-history-restore",onClick:()=>(e=>{p(e)})(e),children:"Restore"})]},e.version))})]})]}),d&&(0,Qt.jsx)("div",{className:"version-history-modal-overlay",children:(0,Qt.jsxs)("div",{className:"version-history-modal",children:[(0,Qt.jsx)("h3",{children:"Restore Version?"}),(0,Qt.jsxs)("p",{children:["Restore to version from"," ",(0,Qt.jsx)("strong",{children:m(d.created_at)}),"?"]}),(0,Qt.jsx)("p",{className:"version-history-modal-warning",children:"This will replace the current content. Other users will see the change."}),(0,Qt.jsxs)("div",{className:"version-history-modal-buttons",children:[(0,Qt.jsx)("button",{className:"version-history-modal-cancel",onClick:()=>p(null),children:"Cancel"}),(0,Qt.jsx)("button",{className:"version-history-modal-confirm",onClick:async()=>{if(d)try{await t(d.version),p(null),r(!1)}catch(e){KS.error("\u274c Restore failed:",e),alert("Restore failed. Check console for details.")}},children:"Restore"})]})]})})]})}function zq(e){let{roomId:t}=e;const{syncState:n,lastSavedAt:i,errorMessage:r}=function(e){const[t,n]=(0,s.useState)(null),[i,r]=(0,s.useState)(!0),[o,a]=(0,s.useState)(null),[l,c]=(0,s.useState)(null),u=(0,s.useRef)(null);(0,s.useEffect)(()=>{let t=!0;return(async()=>{try{await W_.connect(e)}catch(h){return}if(!t)return;const i=W_.persistence,s=W_.getProvider(),o=e=>{let{status:i,message:r}=e;t&&(n(i),"saved"===i?(a(new Date),c(null)):"error"===i&&c(r||"Save failed"))};null===i||void 0===i||i.on("save-status",o);const l=e=>{let{status:n}=e;t&&r("connected"===n)};null===s||void 0===s||s.on("status",l),s&&r(s.connected),u.current=()=>{null===i||void 0===i||i.off("save-status",o),null===s||void 0===s||s.off("status",l)}})(),()=>{var e;t=!1,null===(e=u.current)||void 0===e||e.call(u),u.current=null}},[e]);let h="saved";return"error"===t?h="error":"saving"===t?h="saving":i||(h="offline"),{syncState:h,lastSavedAt:o,errorMessage:l}}(t),[o,a]=(0,s.useState)(!1),[l,c]=(0,s.useState)(!1),u=(0,s.useRef)(null);(0,s.useEffect)(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&a(!1)};return o&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[o]);const[,h]=(0,s.useState)(0);(0,s.useEffect)(()=>{if("saved"!==n||!i)return;const e=setInterval(()=>h(e=>e+1),15e3);return()=>clearInterval(e)},[n,i]);const d=()=>{switch(n){case"saving":return"Saving...";case"offline":return"Offline";case"error":return"Sync error";case"saved":return(()=>{if(!i)return"";const e=Math.floor((Date.now()-i.getTime())/1e3);if(e<10)return"Saved";if(e<60)return"Saved ".concat(e,"s ago");const t=Math.floor(e/60);return t<60?"Saved ".concat(t,"m ago"):"Saved ".concat(Math.floor(t/60),"h ago")})()||"Saved"}},p="error"===n;return(0,Qt.jsxs)("div",{className:"sync-status-container",ref:u,children:[(0,Qt.jsxs)("button",{className:"sync-status sync-status--".concat(n).concat(p?" sync-status--clickable":""),onClick:p?()=>a(!o):void 0,title:r||d(),children:[(0,Qt.jsx)("span",{className:"sync-dot sync-dot--".concat(n)}),(0,Qt.jsx)("span",{className:"sync-label",children:d()})]}),o&&(0,Qt.jsxs)("div",{className:"sync-dropdown",children:[r&&(0,Qt.jsx)("div",{className:"sync-dropdown-error",children:r}),(0,Qt.jsx)("button",{className:"sync-dropdown-item",onClick:()=>{var e;null===(e=W_.persistence)||void 0===e||e.saveNow(),a(!1)},children:"Retry now"}),(0,Qt.jsx)("button",{className:"sync-dropdown-item",onClick:async()=>{c(!0);try{await W_.resetRoom(t,"local"),a(!1)}catch(e){KS.error("Reset local failed:",e)}finally{c(!1)}},disabled:l,children:"Reset local cache"}),(0,Qt.jsx)("button",{className:"sync-dropdown-item sync-dropdown-item--danger",onClick:async()=>{if(window.confirm('This will permanently delete ALL content in room "'.concat(t,'" for ALL users. This cannot be undone.\n\nAre you sure?'))){c(!0);try{await W_.resetRoom(t,"full"),a(!1)}catch(e){KS.error("Reset full failed:",e)}finally{c(!1)}}},disabled:l,children:"Reset room"})]})]})}function Wq(e){let{onUserClick:t}=e;const[n,i]=(0,s.useState)([]),[,r]=(0,s.useState)(null),[o,a]=(0,s.useState)(!1),[l,c]=(0,s.useState)([]),u=(0,s.useRef)(null);(0,s.useEffect)(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&a(!1)};return o&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[o]),(0,s.useEffect)(()=>{let e=null;return(async()=>{try{const{provider:t}=await W_.connect();r(t.awareness.doc.clientID);const n=()=>{const e=t.awareness.getStates(),n=t.awareness.doc.clientID,r=new Map;KS.log("\ud83d\udc65 OnlineUsers: Awareness states:",e.size),e.forEach((e,t)=>{var i;if(KS.log("  Client",t,":",e),null!==(i=e.user)&&void 0!==i&&i.name){var s,o;const i=t===n,a=e.user.name,l=null!==(s=null===(o=e.cmCursor)||void 0===o?void 0:o.position)&&void 0!==s?s:e.cursorPosition,c={name:a,color:e.user.color||"#999",clientId:t,mode:e.editorMode||"markdown",cursorPosition:l,isLocal:i},u=r.get(a);u?(i||!u.isLocal&&t>u.clientId)&&r.set(a,c):r.set(a,c)}});const s=Array.from(r.values());KS.log("\ud83d\udc65 OnlineUsers: Final user list (deduped):",s);const o=s.filter(e=>!e.isLocal).map(e=>e.color.toUpperCase());c(o),s.sort((e,t)=>e.isLocal?-1:t.isLocal?1:e.name.localeCompare(t.name)),i(s)};n(),t.awareness.on("change",n),e=()=>{t.awareness.off("change",n),W_.disconnect()}}catch(t){KS.error("Failed to connect OnlineUsers:",t)}})(),()=>{e&&e()}},[]);const h=n.find(e=>e.isLocal);return 0===n.length?null:(0,Qt.jsx)("div",{className:"online-users",children:n.map(e=>(0,Qt.jsxs)("div",{className:"online-user-wrapper",children:[(0,Qt.jsxs)("button",{className:"online-user ".concat(e.isLocal?"is-local":""),style:{backgroundColor:e.color},title:e.isLocal?"Click to change your color":"Click to jump to ".concat(e.name,"'s position"),onClick:()=>{e.isLocal?a(!o):null===t||void 0===t||t(e)},children:[(0,Qt.jsx)("span",{className:"user-name",children:e.name}),e.isLocal&&(0,Qt.jsx)("span",{className:"user-you",children:"(you)"})]}),e.isLocal&&o&&(0,Qt.jsxs)("div",{ref:u,className:"color-picker-popup",children:[(0,Qt.jsx)("div",{className:"color-picker-title",children:"Choose your color"}),(0,Qt.jsx)("div",{className:"color-picker-grid",children:$_.USER_COLORS.map(e=>{const t=l.includes(e.toUpperCase()),n=(null===h||void 0===h?void 0:h.color.toUpperCase())===e.toUpperCase();return(0,Qt.jsx)("button",{className:"color-option ".concat(n?"current":""," ").concat(t?"used":""),style:{backgroundColor:e},onClick:()=>!t&&(e=>{W_.setUserColor(e),a(!1)})(e),disabled:t,title:t?"Color in use by another user":n?"Current color":"Select this color"},e)})})]})]},e.clientId))})}function Vq(){const[e,t]=(0,s.useState)([]);return(0,s.useEffect)(()=>{let e=null;return(async()=>{try{const{provider:n,ydoc:i,userInfo:r}=await W_.connect(),s=i.clientID,o=r.color,a=document.createElement("style");a.id="flashy-cursor-style";const l=e=>{const t=U_(e);a.textContent='\n            body {\n              cursor: url("'.concat(t,'") 0 0, auto;\n            }\n            .tiptap-editor,\n            .cm-editor .cm-content {\n              cursor: url("').concat(t,'") 0 0, text !important;\n            }\n          '),KS.log("\ud83c\udfa8 MouseCursors: Updated global cursor to:",e)};l(o),document.head.appendChild(a);const c=W_.onColorChange(l);let u=0;const h=50,d=e=>{const t=Date.now();t-u<h||(u=t,n.awareness.setLocalStateField("mouse",{x:e.clientX,y:e.clientY}))},p=()=>{n.awareness.setLocalStateField("mouse",null)},f=()=>{const e=n.awareness.getStates(),i=[];e.forEach((e,t)=>{var n;t!==s&&e.mouse&&null!==(n=e.user)&&void 0!==n&&n.name&&i.push({x:e.mouse.x,y:e.mouse.y,name:e.user.name,color:e.user.color||"#999",clientId:t})}),t(i)};document.addEventListener("mousemove",d),document.addEventListener("mouseleave",p),n.awareness.on("change",f),f(),e=()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseleave",p),n.awareness.off("change",f),c(),a.remove(),W_.disconnect()}}catch(n){KS.error("Failed to connect MouseCursors:",n)}})(),()=>{e&&e()}},[]),(0,Qt.jsx)(Qt.Fragment,{children:e.map(e=>(0,Qt.jsxs)("div",{className:"remote-cursor",style:{left:e.x,top:e.y},children:[(0,Qt.jsx)("div",{style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},dangerouslySetInnerHTML:{__html:V_(e.color)}}),(0,Qt.jsx)("div",{className:"cursor-label",style:{backgroundColor:e.color},children:e.name})]},e.clientId))})}const Uq=qz("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Xq=qz("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function qq(e){let{flashcards:t,starredCards:n,onToggleStar:i,onClose:r}=e;const[o,a]=(0,s.useState)(0),[l,c]=(0,s.useState)(!1),[u,h]=(0,s.useState)(!1),[d,p]=(0,s.useState)(null),f=t[o],m=!!f&&n.has(f.id),g=(0,s.useCallback)(()=>{h(!0),setTimeout(()=>{r()},300)},[r]),v=(0,s.useCallback)(()=>{o<t.length-1&&(c(!1),p("left"),setTimeout(()=>{a(o+1),p(null)},300))},[o,t.length]),y=(0,s.useCallback)(()=>{o>0&&(c(!1),p("right"),setTimeout(()=>{a(o-1),p(null)},300))},[o]),O=(0,s.useCallback)(()=>{c(!l)},[l]);return(0,s.useEffect)(()=>{const e=e=>{" "===e.key||"Spacebar"===e.key||"ArrowUp"===e.key||"ArrowDown"===e.key?(e.preventDefault(),O()):"ArrowRight"===e.key?(e.preventDefault(),v()):"ArrowLeft"===e.key?(e.preventDefault(),y()):"Escape"===e.key&&g()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[g,v,y,O]),(0,Qt.jsxs)("div",{className:"study-mode-panel ".concat(u?"closing":""),children:[(0,Qt.jsxs)("div",{className:"study-mode-header",children:[(0,Qt.jsxs)("div",{className:"study-progress",children:[o+1," / ",t.length]}),(0,Qt.jsxs)("div",{className:"header-controls",children:[(0,Qt.jsx)("button",{className:"study-star-button ".concat(m?"starred":""),onClick:e=>{e.stopPropagation(),i(f.id,e)},title:m?"Unstar":"Star",children:(0,Qt.jsx)(Uq,{size:20,fill:m?"currentColor":"none"})}),(0,Qt.jsx)("button",{className:"close-button",onClick:g,title:"Close study mode",children:(0,Qt.jsx)(Xq,{size:28})})]})]}),(0,Qt.jsx)("div",{className:"study-card-container",children:(0,Qt.jsxs)("div",{className:"study-card ".concat(l?"flipped":""," ").concat(d?"slide-".concat(d):""),onClick:O,children:[(0,Qt.jsxs)("div",{className:"study-card-front",children:[(0,Qt.jsx)("div",{className:"card-label",children:"Term"}),(0,Qt.jsx)("div",{className:"card-content",children:f.term})]}),(0,Qt.jsxs)("div",{className:"study-card-back",children:[(0,Qt.jsx)("div",{className:"card-label",children:"Definition"}),(0,Qt.jsx)("div",{className:"card-content card-content-markdown",children:(0,Qt.jsx)(_q,{children:f.definition})})]})]})}),(0,Qt.jsxs)("div",{className:"keyboard-shortcuts",children:[(0,Qt.jsx)("span",{children:"Space/\u2191\u2193: Flip"}),(0,Qt.jsx)("span",{children:"\u2190 \u2192: Navigate"}),(0,Qt.jsx)("span",{children:"Esc: Exit"})]})]})}const Zq=qz("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Hq=qz("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),Yq=qz("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Gq=qz("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Kq=qz("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Jq=qz("flame",[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]]),eZ=qz("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),tZ=qz("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function nZ(e){try{const t=localStorage.getItem("tutor_best_".concat(e));return t?JSON.parse(t):null}catch(t){return null}}function iZ(e){const t=[...e];for(let n=t.length-1;n>0;n--){const e=Math.floor(Math.random()*(n+1));[t[n],t[e]]=[t[e],t[n]]}return t}function rZ(e){const t=[];return iZ(e).forEach((n,i)=>{const r=["define","identify","truefalse","fillin"];switch(r[i%r.length]){case"define":t.push({id:"q-".concat(i,"-define"),type:"define",question:"Define: ".concat(n.term),correctAnswer:n.definition,flashcardId:n.id,section:n.section});break;case"identify":t.push({id:"q-".concat(i,"-identify"),type:"identify",question:"Which term is described by:",detail:n.definition,correctAnswer:n.term,flashcardId:n.id,section:n.section});break;case"truefalse":{const r=Math.random()>.5,s=r?n.definition:function(e,t){const n=e.filter(e=>e.id!==t);return 0===n.length?"No definition available":n[Math.floor(Math.random()*n.length)].definition}(e,n.id);t.push({id:"q-".concat(i,"-tf"),type:"truefalse",question:'True or False: "'.concat(n.term,'" means:'),detail:s,correctAnswer:r?"True":"False",flashcardId:n.id,section:n.section});break}case"fillin":{const e=function(e){const t=e.split(/\s+/).filter(e=>e.replace(/[^a-zA-Z]/g,"").length>3);if(0===t.length)return null;const n=t[Math.floor(Math.random()*t.length)],i=n.replace(/[^a-zA-Z]/g,"");return{blanked:e.replace(n,"___"),answer:i}}(n.definition);e?t.push({id:"q-".concat(i,"-fillin"),type:"fillin",question:'Fill in the blank for "'.concat(n.term,'":'),detail:e.blanked,correctAnswer:e.answer,flashcardId:n.id,section:n.section}):t.push({id:"q-".concat(i,"-define-fallback"),type:"define",question:"Define: ".concat(n.term),correctAnswer:n.definition,flashcardId:n.id,section:n.section});break}}}),iZ(t)}const sZ=["Great job!","Nailed it!","You got this!","Excellent!","Keep it up!","Well done!","Impressive!","On fire!"],oZ=["Not quite, but you are learning!","Almost there! Keep going.","Good effort! Review this one.","No worries, you will get it next time!","Learning is a process. Keep at it!"];function aZ(e){let{flashcards:t,onClose:n,roomId:i,tutorInstructions:r}=e;const[o,a]=(0,s.useState)([]),[l,c]=(0,s.useState)(0),[u,h]=(0,s.useState)(""),[d,f]=(0,s.useState)({score:0,total:0,streak:0,bestStreak:0,wrongCards:new Set,history:[]}),[m,g]=(0,s.useState)(null),[v,y]=(0,s.useState)(!1),[O,w]=(0,s.useState)(!1),[b,k]=(0,s.useState)(!1),x=(0,s.useRef)(null),D=(0,s.useRef)(null);(0,s.useEffect)(()=>{t.length>=4&&a(rZ(t))},[t]),(0,s.useEffect)(()=>{m||b||setTimeout(()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.focus()},100)},[l,m,b]),(0,s.useEffect)(()=>()=>{D.current&&clearTimeout(D.current)},[]);const S=(0,s.useCallback)(()=>{D.current&&clearTimeout(D.current),w(!0),setTimeout(()=>n(),300)},[n]);(0,s.useEffect)(()=>{const e=e=>{"Escape"===e.key&&S()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[S]);const C=o[l],A=o.length>0?l/o.length*100:0,E=async()=>{if(u.trim()&&C&&!v){y(!0);try{if("truefalse"===C.type){const e=u.trim().toLowerCase(),t="true"===e||"t"===e||"yes"===e?"True"===C.correctAnswer:("false"===e||"f"===e||"no"===e)&&"False"===C.correctAnswer,n=t?"Correct! The answer is ".concat(C.correctAnswer,"."):"The correct answer is ".concat(C.correctAnswer,".");return void _(t,n)}const s=null!==r&&void 0!==r&&r.trim()?"\n\nThe instructor has provided these sample question styles:\n".concat(r,"\n\nGrade the student's answer with these question styles in mind."):"",o='You are evaluating a student\'s answer to a flashcard question. Be lenient - accept answers that capture the key concept even if not word-for-word. For "identify" type questions, accept reasonable variations of the term name.\n\nThe question type is: '.concat(C.type,"\nThe correct answer is: ").concat(C.correctAnswer,"\nThe student answered: ").concat(u).concat(s,'\n\nRespond with ONLY valid JSON (no markdown, no code blocks): {"correct": true/false, "explanation": "brief 1-sentence explanation"}'),{data:a,error:l}=await Q_.functions.invoke("chat",{body:{messages:[{role:"user",content:o}],documentContent:"",model:"gpt-4o-mini",provider:"openai",roomId:i}});if(l)throw l;let c;try{const e=(a.content||"").replace(/```json\s*/g,"").replace(/```\s*/g,"").trim();c=JSON.parse(e)}catch(n){var e,t;c={correct:(null===(e=a.content)||void 0===e?void 0:e.toLowerCase().includes('"correct": true'))||(null===(t=a.content)||void 0===t?void 0:t.toLowerCase().includes('"correct":true'))||!1,explanation:a.content||"Could not evaluate the answer."}}_(c.correct,c.explanation)}catch(s){const e=u.trim().toLowerCase(),t=C.correctAnswer.toLowerCase(),n=t.includes(e)||e.includes(t.substring(0,20));_(n,n?"Looks correct!":"The expected answer was: ".concat(C.correctAnswer.substring(0,100),"..."))}finally{y(!1)}}},_=(e,t)=>{g({correct:e,explanation:t});const n=p({},d);if(n.total+=1,e)n.score+=1,n.streak+=1,n.streak>n.bestStreak&&(n.bestStreak=n.streak);else{n.streak=0;const e=new Set(n.wrongCards);e.add(C.flashcardId),n.wrongCards=e}n.history=[...d.history,{question:C,userAnswer:u,correct:e,explanation:t}],f(n),D.current=setTimeout(()=>{T()},e?2e3:3500)},T=()=>{D.current&&clearTimeout(D.current),l>=o.length-1?(!function(e,t,n){const i=nZ(e),r=i?i.score/i.total:0;(!i||(n>0?t/n:0)>r)&&localStorage.setItem("tutor_best_".concat(e),JSON.stringify({score:t,total:n}))}(i,d.score+(null!==m&&void 0!==m&&m.correct,0),d.total),k(!0)):(c(l+1),h(""),g(null))},P=()=>{a(rZ(t)),c(0),h(""),g(null),k(!1),f({score:0,total:0,streak:0,bestStreak:0,wrongCards:new Set,history:[]})};if(t.length<4)return(0,Qt.jsxs)("div",{className:"tutor-mode-panel ".concat(O?"closing":""),children:[(0,Qt.jsx)("div",{className:"tutor-close-row",children:(0,Qt.jsx)("button",{className:"tutor-close-button",onClick:S,title:"Close tutor mode",children:(0,Qt.jsx)(Xq,{size:28})})}),(0,Qt.jsxs)("div",{className:"tutor-not-enough",children:[(0,Qt.jsx)(Zq,{size:48}),(0,Qt.jsx)("h2",{children:"Need More Flashcards"}),(0,Qt.jsxs)("p",{children:["Add at least 4 flashcards to your document to start a tutoring session. You currently have ",t.length," card",1!==t.length?"s":"","."]}),(0,Qt.jsxs)("p",{className:"tutor-hint",children:["Use ",(0,Qt.jsx)("code",{children:"## Term"})," headers followed by definitions to create flashcards."]})]})]});if(b){const e=d.total>0?Math.round(d.score/d.total*100):0,n=nZ(i),r=t.filter(e=>d.wrongCards.has(e.id));return(0,Qt.jsxs)("div",{className:"tutor-mode-panel ".concat(O?"closing":""),children:[(0,Qt.jsx)("div",{className:"tutor-close-row",children:(0,Qt.jsx)("button",{className:"tutor-close-button",onClick:S,title:"Close tutor mode",children:(0,Qt.jsx)(Xq,{size:28})})}),(0,Qt.jsxs)("div",{className:"tutor-summary",children:[(0,Qt.jsxs)("div",{className:"tutor-summary-header",children:[(0,Qt.jsx)(Hq,{size:48,className:"tutor-trophy"}),(0,Qt.jsx)("h2",{children:"Session Complete!"})]}),(0,Qt.jsxs)("div",{className:"tutor-summary-stats",children:[(0,Qt.jsxs)("div",{className:"tutor-stat-card",children:[(0,Qt.jsxs)("div",{className:"tutor-stat-value",children:[d.score,"/",d.total]}),(0,Qt.jsx)("div",{className:"tutor-stat-label",children:"Score"})]}),(0,Qt.jsxs)("div",{className:"tutor-stat-card",children:[(0,Qt.jsxs)("div",{className:"tutor-stat-value",children:[e,"%"]}),(0,Qt.jsx)("div",{className:"tutor-stat-label",children:"Accuracy"})]}),(0,Qt.jsxs)("div",{className:"tutor-stat-card",children:[(0,Qt.jsx)("div",{className:"tutor-stat-value",children:d.bestStreak}),(0,Qt.jsx)("div",{className:"tutor-stat-label",children:"Best Streak"})]})]}),n&&(0,Qt.jsxs)("div",{className:"tutor-best-score",children:["Personal best: ",n.score,"/",n.total," (",Math.round(n.score/n.total*100),"%)"]}),r.length>0&&(0,Qt.jsxs)("div",{className:"tutor-weak-areas",children:[(0,Qt.jsx)("h3",{children:"Areas to Review"}),(0,Qt.jsx)("div",{className:"tutor-weak-list",children:r.map(e=>(0,Qt.jsxs)("div",{className:"tutor-weak-card",children:[(0,Qt.jsx)("span",{className:"tutor-weak-term",children:e.term}),e.section&&(0,Qt.jsx)("span",{className:"tutor-weak-section",children:e.section})]},e.id))})]}),(0,Qt.jsxs)("div",{className:"tutor-summary-history",children:[(0,Qt.jsx)("h3",{children:"Question Review"}),d.history.map((e,t)=>(0,Qt.jsxs)("div",{className:"tutor-history-item ".concat(e.correct?"correct":"wrong"),children:[(0,Qt.jsx)("div",{className:"tutor-history-icon",children:e.correct?(0,Qt.jsx)(Yq,{size:16}):(0,Qt.jsx)(Gq,{size:16})}),(0,Qt.jsxs)("div",{className:"tutor-history-content",children:[(0,Qt.jsx)("div",{className:"tutor-history-question",children:e.question.question}),(0,Qt.jsxs)("div",{className:"tutor-history-answer",children:["Your answer: ",e.userAnswer]})]})]},t))]}),(0,Qt.jsxs)("div",{className:"tutor-summary-actions",children:[(0,Qt.jsxs)("button",{className:"tutor-restart-button",onClick:P,children:[(0,Qt.jsx)(Kq,{size:18}),"Try Again"]}),(0,Qt.jsx)("button",{className:"tutor-done-button",onClick:S,children:"Done"})]})]})]})}const M="define"===(null===C||void 0===C?void 0:C.type)?"Define":"identify"===(null===C||void 0===C?void 0:C.type)?"Identify":"truefalse"===(null===C||void 0===C?void 0:C.type)?"True / False":"Fill in the Blank";return(0,Qt.jsxs)("div",{className:"tutor-mode-panel ".concat(O?"closing":""),children:[(0,Qt.jsx)("div",{className:"tutor-progress-bar",children:(0,Qt.jsx)("div",{className:"tutor-progress-fill",style:{width:"".concat(A,"%")}})}),(0,Qt.jsxs)("div",{className:"tutor-header",children:[(0,Qt.jsxs)("div",{className:"tutor-score-area",children:[(0,Qt.jsxs)("div",{className:"tutor-score",children:[(0,Qt.jsx)(Yq,{size:18}),(0,Qt.jsxs)("span",{children:[d.score,"/",d.total]})]}),d.streak>1&&(0,Qt.jsxs)("div",{className:"tutor-streak",children:[(0,Qt.jsx)(Jq,{size:18}),(0,Qt.jsx)("span",{children:d.streak})]})]}),(0,Qt.jsxs)("div",{className:"tutor-question-count",children:[l+1," / ",o.length]}),(0,Qt.jsx)("button",{className:"tutor-close-button",onClick:S,title:"Close tutor mode",children:(0,Qt.jsx)(Xq,{size:28})})]}),(0,Qt.jsx)("div",{className:"tutor-question-area",children:(0,Qt.jsxs)("div",{className:"tutor-question-card ".concat(m?m.correct?"correct":"wrong":""),children:[(0,Qt.jsx)("div",{className:"tutor-question-type",children:M}),(null===C||void 0===C?void 0:C.section)&&(0,Qt.jsx)("div",{className:"tutor-question-section",children:C.section}),(0,Qt.jsx)("div",{className:"tutor-question-text",children:null===C||void 0===C?void 0:C.question}),(null===C||void 0===C?void 0:C.detail)&&(0,Qt.jsx)("div",{className:"tutor-question-detail",children:(0,Qt.jsx)(_q,{children:C.detail})})]})}),(0,Qt.jsxs)("div",{className:"tutor-answer-area",children:["truefalse"===(null===C||void 0===C?void 0:C.type)?(0,Qt.jsxs)("div",{className:"tutor-tf-buttons",children:[(0,Qt.jsx)("button",{className:"tutor-tf-button true ".concat(m&&"true"===u.toLowerCase()?m.correct?"correct":"wrong":""),onClick:()=>{m||(h("True"),setTimeout(()=>{const e="True"===C.correctAnswer,t=e?"Correct! The answer is ".concat(C.correctAnswer,"."):"The correct answer is ".concat(C.correctAnswer,".");_(e,t)},100))},disabled:!!m,children:"True"}),(0,Qt.jsx)("button",{className:"tutor-tf-button false ".concat(m&&"false"===u.toLowerCase()?m.correct?"correct":"wrong":""),onClick:()=>{m||(h("False"),setTimeout(()=>{const e="False"===C.correctAnswer,t=e?"Correct! The answer is ".concat(C.correctAnswer,"."):"The correct answer is ".concat(C.correctAnswer,".");_(e,t)},100))},disabled:!!m,children:"False"})]}):(0,Qt.jsxs)("div",{className:"tutor-input-row",children:[(0,Qt.jsx)("input",{ref:x,className:"tutor-answer-input",type:"text",placeholder:"identify"===(null===C||void 0===C?void 0:C.type)?"Type the term...":"fillin"===(null===C||void 0===C?void 0:C.type)?"Type the missing word...":"Type your answer...",value:u,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"!==e.key||m?"Enter"===e.key&&m&&(e.preventDefault(),T()):(e.preventDefault(),E())},disabled:!!m||v}),!m&&(0,Qt.jsx)("button",{className:"tutor-submit-button",onClick:E,disabled:!u.trim()||v,children:v?(0,Qt.jsx)(eZ,{size:18,className:"spinning"}):(0,Qt.jsx)(tZ,{size:18})})]}),m&&(0,Qt.jsxs)("div",{className:"tutor-feedback ".concat(m.correct?"correct":"wrong"),children:[(0,Qt.jsxs)("div",{className:"tutor-feedback-row",children:[(0,Qt.jsx)("div",{className:"tutor-feedback-icon",children:m.correct?(0,Qt.jsx)(Yq,{size:24}):(0,Qt.jsx)(Gq,{size:24})}),(0,Qt.jsx)("div",{className:"tutor-feedback-content",children:(0,Qt.jsx)("div",{className:"tutor-feedback-title",children:m.correct?sZ[Math.floor(Math.random()*sZ.length)]:oZ[Math.floor(Math.random()*oZ.length)]})}),(0,Qt.jsxs)("button",{className:"tutor-next-button",onClick:T,children:[l>=o.length-1?"View Results":"Next",(0,Qt.jsx)(tZ,{size:16})]})]}),!m.correct&&C&&(0,Qt.jsxs)("div",{className:"tutor-correct-answer",children:[(0,Qt.jsx)("div",{className:"tutor-correct-answer-label",children:"Correct answer"}),(0,Qt.jsx)("div",{className:"tutor-correct-answer-text",children:(0,Qt.jsx)(_q,{children:C.correctAnswer})})]})]})]}),(0,Qt.jsxs)("div",{className:"tutor-keyboard-hints",children:[(0,Qt.jsx)("span",{children:"Enter: Submit / Next"}),(0,Qt.jsx)("span",{children:"Esc: Exit"})]})]})}const lZ=qz("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),cZ=qz("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),uZ=qz("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),hZ=qz("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function dZ(e){const t=[...e].sort(()=>Math.random()-.5),n=Math.min(10,t.length);return t.slice(0,n).map(t=>{const n=Math.random()>.5?"term":"definition",i=e.length>=4?function(e,t,n){return[...e.filter(e=>e.id!==t.id).sort(()=>Math.random()-.5).slice(0,3).map(e=>"term"===n?e.term:e.definition),"term"===n?t.term:t.definition].sort(()=>Math.random()-.5)}(e,t,n):["term"===n?t.term:t.definition];return{card:t,mode:n,choices:i,correctAnswer:"term"===n?t.term:t.definition}})}function pZ(e){let{flashcards:t,onComplete:n,onBack:i}=e;const[r,o]=(0,s.useState)([]),[a,l]=(0,s.useState)(0),[c,u]=(0,s.useState)(null),[h,d]=(0,s.useState)([]),[p,f]=(0,s.useState)(0),[m,g]=(0,s.useState)(!1),[v,y]=(0,s.useState)(!1);(0,s.useEffect)(()=>{const e=dZ(t);o(e),d(new Array(e.length).fill(null))},[t]);const O=(0,s.useCallback)(e=>{if(null!==c||v)return;u(e);const t=e===r[a].correctAnswer,i=[...h];i[a]=t?"correct":"wrong",d(i),t&&f(e=>e+1),y(!0),setTimeout(()=>{if(a<r.length-1)l(e=>e+1),u(null),y(!1);else{g(!0);const e=t?p+1:p,i="flashy_mc_highscore";e>parseInt(localStorage.getItem(i)||"0",10)&&localStorage.setItem(i,String(e)),n(e,r.length)}},1500)},[c,v,r,a,h,p,n]);if((0,s.useEffect)(()=>{const e=e=>{if(!m&&null===c&&("1"===e.key||"2"===e.key||"3"===e.key||"4"===e.key)){var t;const n=parseInt(e.key)-1;n<(null===(t=r[a])||void 0===t?void 0:t.choices.length)&&O(r[a].choices[n])}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[m,c,r,a,O]),0===r.length)return null;if(m){const e=Math.round(p/r.length*100),n=parseInt(localStorage.getItem("flashy_mc_highscore")||"0",10);return(0,Qt.jsxs)("div",{className:"game-complete-screen",children:[(0,Qt.jsx)("div",{className:"game-complete-icon",children:(0,Qt.jsx)(Hq,{size:64})}),(0,Qt.jsx)("h2",{className:"game-complete-title",children:e>=80?"Excellent!":e>=60?"Good job!":"Keep practicing!"}),(0,Qt.jsxs)("div",{className:"game-complete-score",children:[p," / ",r.length]}),(0,Qt.jsxs)("div",{className:"game-complete-percentage",children:[e,"% correct"]}),n>0&&(0,Qt.jsxs)("div",{className:"game-complete-highscore",children:["Best: ",n,"/",r.length]}),(0,Qt.jsxs)("div",{className:"game-complete-actions",children:[(0,Qt.jsx)("button",{className:"game-btn game-btn-primary",onClick:()=>{const e=dZ(t);o(e),d(new Array(e.length).fill(null)),l(0),u(null),f(0),g(!1),y(!1)},children:"Play Again"}),(0,Qt.jsx)("button",{className:"game-btn game-btn-secondary",onClick:i,children:"Back to Games"})]})]})}const w=r[a],b="term"===w.mode?w.card.definition:w.card.term,k="term"===w.mode?"Select the correct term":"Select the correct definition";return(0,Qt.jsxs)("div",{className:"mc-game",children:[(0,Qt.jsx)("div",{className:"mc-progress",children:r.map((e,t)=>(0,Qt.jsx)("div",{className:"mc-progress-dot ".concat("correct"===h[t]?"correct":"wrong"===h[t]?"wrong":t===a?"current":"")},t))}),(0,Qt.jsxs)("div",{className:"mc-question-number",children:["Question ",a+1," of ",r.length]}),(0,Qt.jsx)("div",{className:"mc-prompt",children:(0,Qt.jsx)("div",{className:"mc-prompt-text",children:b})}),(0,Qt.jsx)("div",{className:"mc-prompt-label",children:k}),(0,Qt.jsx)("div",{className:"mc-choices",children:w.choices.map((e,t)=>{const n=c===e,i=e===w.correctAnswer,r=null!==c;let s="mc-choice";return r&&i&&(s+=" correct"),r&&n&&!i&&(s+=" wrong"),r||(s+=" selectable"),(0,Qt.jsxs)("button",{className:s,onClick:()=>O(e),disabled:null!==c,children:[(0,Qt.jsx)("span",{className:"mc-choice-number",children:t+1}),(0,Qt.jsx)("span",{className:"mc-choice-text",children:e}),r&&i&&(0,Qt.jsx)("span",{className:"mc-choice-icon correct",children:(0,Qt.jsx)(hZ,{size:20})}),r&&n&&!i&&(0,Qt.jsx)("span",{className:"mc-choice-icon wrong",children:(0,Qt.jsx)(Xq,{size:20})})]},t)})}),(0,Qt.jsx)("div",{className:"mc-keyboard-hint",children:"Press 1-4 to select"})]})}const fZ=qz("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);function mZ(e){let{flashcards:t,onComplete:n,onBack:i}=e;const[r,o]=(0,s.useState)([]),[a,l]=(0,s.useState)([]),[c,u]=(0,s.useState)(null),[h,d]=(0,s.useState)(null),[p,f]=(0,s.useState)(null),[m,g]=(0,s.useState)(new Set),[v,y]=(0,s.useState)(0),[O,w]=(0,s.useState)(!1),[b,k]=(0,s.useState)(0),[x,D]=(0,s.useState)(0),S=(0,s.useRef)(null),C=(0,s.useCallback)(()=>{const e=Math.min(6,Math.max(3,t.length)),n=[...t].sort(()=>Math.random()-.5).slice(0,e),i=n.map(e=>({id:"term-".concat(e.id),text:e.term,type:"term",cardId:e.id,matched:!1})),r=n.map(e=>({id:"def-".concat(e.id),text:e.definition,type:"definition",cardId:e.id,matched:!1}));o(i.sort(()=>Math.random()-.5)),l(r.sort(()=>Math.random()-.5)),u(null),d(null),f(null),g(new Set),k(0),D(e),y(0),w(!1)},[t]);(0,s.useEffect)(()=>{C()},[C]),(0,s.useEffect)(()=>(!O&&x>0&&(S.current=setInterval(()=>{y(e=>e+1)},1e3)),()=>{S.current&&clearInterval(S.current)}),[O,x]);const A=(0,s.useCallback)((e,t)=>{const i=r.find(t=>t.id===e),s=a.find(e=>e.id===t);if(i&&s)if(i.cardId===s.cardId){const e=new Set(m);if(e.add(i.cardId),g(e),k(e=>e+1),u(null),d(null),e.size===x){w(!0),S.current&&clearInterval(S.current);const e="flashy_match_besttime",t=parseInt(localStorage.getItem(e)||"999999",10);v<t&&localStorage.setItem(e,String(v)),n(x,x)}}else f({term:e,def:t}),setTimeout(()=>{f(null),u(null),d(null)},600)},[r,a,m,x,v,n]),E=(0,s.useCallback)(e=>{var t;m.has((null===(t=r.find(t=>t.id===e))||void 0===t?void 0:t.cardId)||"")||p||(c!==e?(u(e),h&&A(e,h)):u(null))},[c,h,m,r,p,A]),_=(0,s.useCallback)(e=>{var t;m.has((null===(t=a.find(t=>t.id===e))||void 0===t?void 0:t.cardId)||"")||p||(h!==e?(d(e),c&&A(c,e)):d(null))},[c,h,m,a,p,A]),T=e=>{const t=Math.floor(e/60),n=e%60;return"".concat(t,":").concat(n.toString().padStart(2,"0"))};if(O){const e=parseInt(localStorage.getItem("flashy_match_besttime")||"999999",10);return(0,Qt.jsxs)("div",{className:"game-complete-screen",children:[(0,Qt.jsx)("div",{className:"game-complete-icon",children:(0,Qt.jsx)(Hq,{size:64})}),(0,Qt.jsx)("h2",{className:"game-complete-title",children:"All Matched!"}),(0,Qt.jsx)("div",{className:"game-complete-score",children:T(v)}),(0,Qt.jsxs)("div",{className:"game-complete-percentage",children:[x," pairs matched"]}),e<999999&&(0,Qt.jsxs)("div",{className:"game-complete-highscore",children:["Best time: ",T(e)]}),(0,Qt.jsxs)("div",{className:"game-complete-actions",children:[(0,Qt.jsx)("button",{className:"game-btn game-btn-primary",onClick:C,children:"Play Again"}),(0,Qt.jsx)("button",{className:"game-btn game-btn-secondary",onClick:i,children:"Back to Games"})]})]})}return(0,Qt.jsxs)("div",{className:"match-game",children:[(0,Qt.jsxs)("div",{className:"match-header",children:[(0,Qt.jsxs)("div",{className:"match-timer",children:[(0,Qt.jsx)(fZ,{size:18}),(0,Qt.jsx)("span",{children:T(v)})]}),(0,Qt.jsxs)("div",{className:"match-progress",children:[b," / ",x," matched"]})]}),(0,Qt.jsxs)("div",{className:"match-grid",children:[(0,Qt.jsxs)("div",{className:"match-column",children:[(0,Qt.jsx)("div",{className:"match-column-label",children:"Terms"}),r.map(e=>{const t=m.has(e.cardId),n=c===e.id,i=(null===p||void 0===p?void 0:p.term)===e.id;return(0,Qt.jsx)("button",{className:"match-card ".concat(t?"matched":""," ").concat(n?"selected":""," ").concat(i?"wrong":""),onClick:()=>E(e.id),disabled:t,children:(0,Qt.jsx)("span",{className:"match-card-text",children:e.text})},e.id)})]}),(0,Qt.jsxs)("div",{className:"match-column",children:[(0,Qt.jsx)("div",{className:"match-column-label",children:"Definitions"}),a.map(e=>{const t=m.has(e.cardId),n=h===e.id,i=(null===p||void 0===p?void 0:p.def)===e.id;return(0,Qt.jsx)("button",{className:"match-card definition ".concat(t?"matched":""," ").concat(n?"selected":""," ").concat(i?"wrong":""),onClick:()=>_(e.id),disabled:t,children:(0,Qt.jsx)("span",{className:"match-card-text",children:e.text})},e.id)})]})]})]})}const gZ=qz("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),vZ=new Set(["a","an","the","is","are","was","were","be","been","being","have","has","had","do","does","did","will","would","could","should","may","might","shall","can","need","dare","ought","used","to","of","in","for","on","with","at","by","from","as","into","through","during","before","after","above","below","between","out","off","over","under","again","further","then","once","and","but","or","nor","not","so","yet","both","either","neither","each","every","all","any","few","more","most","other","some","such","no","only","own","same","than","too","very","just","because","if","when","where","how","what","which","who","whom","this","that","these","those","it","its","also","about","up","like","them","they","their","there","here","we","us","our","he","she","him","her","his","i","me","my","you","your"]);function yZ(e,t){const n=e.toLowerCase(),i=t.toLowerCase();if(n===i)return!0;if(i.length>=5&&Math.abs(n.length-i.length)<=1){let e=0;for(let t=0;t<Math.max(n.length,i.length);t++)if(n[t]!==i[t]&&e++,e>1)return!1;return!0}return!1}function OZ(e,t){const n=e.toLowerCase().split(/\s+/).filter(e=>e.length>=2),i=new Set;for(const r of n)for(let e=0;e<t.length;e++)if(!i.has(e)&&yZ(r,t[e])){i.add(e);break}return i}function wZ(e){let{flashcards:t,onComplete:n,onBack:i}=e;const[r,o]=(0,s.useState)(60),[a,l]=(0,s.useState)(0),[c,u]=(0,s.useState)([]),[h,d]=(0,s.useState)(""),[p,f]=(0,s.useState)(0),[m,g]=(0,s.useState)(0),[v,y]=(0,s.useState)(0),[O,w]=(0,s.useState)(0),[b,k]=(0,s.useState)(0),[x,D]=(0,s.useState)(1),[S,C]=(0,s.useState)(!1),[A,E]=(0,s.useState)(null),[_,T]=(0,s.useState)([]),[P,M]=(0,s.useState)(!1),F=(0,s.useRef)(null),R=(0,s.useRef)(null),N=(0,s.useCallback)(()=>{const e=[...t].sort(()=>Math.random()-.5);u(e),l(0),d(""),f(0),g(0),y(0),w(0),k(0),D(1),o(60),C(!1),E(null),T([]),M(!1)},[t]);(0,s.useEffect)(()=>{N()},[N]),(0,s.useEffect)(()=>{var e;P&&!S&&(null===(e=F.current)||void 0===e||e.focus())},[P,S,a]),(0,s.useEffect)(()=>(P&&!S&&(R.current=setInterval(()=>{o(e=>e<=1?(C(!0),R.current&&clearInterval(R.current),0):e-1)},1e3)),()=>{R.current&&clearInterval(R.current)}),[P,S]),(0,s.useEffect)(()=>{if(S){const e="flashy_speed_highscore",t=parseInt(localStorage.getItem(e)||"0",10);p>t&&localStorage.setItem(e,String(p)),n(p,m)}},[S]);const I=c[a],B=(0,s.useMemo)(()=>I?function(e){const t=e.split(/\s+/),n=new Set,i=[];for(const r of t){const e=r.replace(/^[^a-zA-Z0-9]+|[^a-zA-Z0-9]+$/g,""),t=e.toLowerCase();e.length>=3&&!vZ.has(t)&&!n.has(t)&&(n.add(t),i.push(e))}if(i.length>8){const e=i.length/8,t=[];for(let n=0;n<8;n++)t.push(i[Math.round(n*e)]);return t}return i}(I.definition):[],[null===I||void 0===I?void 0:I.id]),Q=(0,s.useMemo)(()=>OZ(h,B),[h,B]),L=(0,s.useCallback)(e=>{if(e&&e.preventDefault(),!h.trim()||S||A)return;if(!I||0===B.length)return;const n=OZ(h,B),i=n.size/B.length;g(e=>e+1);const r=i>=.5;if(r){const e=100*x;f(t=>t+e),y(e=>e+1);const t=O+1;w(t),k(e=>Math.max(e,t)),D(Math.min(t+1,5)),E("correct"),T([])}else w(0),D(1),E("wrong"),T(B.filter((e,t)=>!n.has(t)));setTimeout(()=>{var e;if(E(null),T([]),d(""),a>=c.length-1){const e=[...t].sort(()=>Math.random()-.5);u(e),l(0)}else l(e=>e+1);null===(e=F.current)||void 0===e||e.focus()},r?500:1500)},[h,S,A,I,B,c,a,x,O,t]);if(!P)return(0,Qt.jsxs)("div",{className:"speed-start-screen",children:[(0,Qt.jsx)("div",{className:"speed-start-icon",children:(0,Qt.jsx)(gZ,{size:64})}),(0,Qt.jsx)("h2",{className:"speed-start-title",children:"Speed Round"}),(0,Qt.jsx)("p",{className:"speed-start-desc",children:"You have 60 seconds. Type what you remember about each definition \u2014 hit the keywords to score! Build combos for bonus points."}),(0,Qt.jsx)("button",{className:"game-btn game-btn-primary game-btn-large",onClick:()=>M(!0),autoFocus:!0,children:"Start!"})]});if(S){const e=m>0?Math.round(v/m*100):0,t=parseInt(localStorage.getItem("flashy_speed_highscore")||"0",10);return(0,Qt.jsxs)("div",{className:"game-complete-screen",children:[(0,Qt.jsx)("div",{className:"game-complete-icon",children:(0,Qt.jsx)(Hq,{size:64})}),(0,Qt.jsx)("h2",{className:"game-complete-title",children:"Time's Up!"}),(0,Qt.jsxs)("div",{className:"game-complete-score",children:[p," points"]}),(0,Qt.jsxs)("div",{className:"speed-stats",children:[(0,Qt.jsxs)("div",{className:"speed-stat",children:[(0,Qt.jsxs)("span",{className:"speed-stat-value",children:[v,"/",m]}),(0,Qt.jsx)("span",{className:"speed-stat-label",children:"Correct"})]}),(0,Qt.jsxs)("div",{className:"speed-stat",children:[(0,Qt.jsxs)("span",{className:"speed-stat-value",children:[e,"%"]}),(0,Qt.jsx)("span",{className:"speed-stat-label",children:"Accuracy"})]}),(0,Qt.jsxs)("div",{className:"speed-stat",children:[(0,Qt.jsx)("span",{className:"speed-stat-value",children:b}),(0,Qt.jsx)("span",{className:"speed-stat-label",children:"Best Streak"})]})]}),t>0&&(0,Qt.jsxs)("div",{className:"game-complete-highscore",children:["Best: ",t," pts"]}),(0,Qt.jsxs)("div",{className:"game-complete-actions",children:[(0,Qt.jsx)("button",{className:"game-btn game-btn-primary",onClick:N,children:"Play Again"}),(0,Qt.jsx)("button",{className:"game-btn game-btn-secondary",onClick:i,children:"Back to Games"})]})]})}return I?(0,Qt.jsxs)("div",{className:"speed-game",children:[(0,Qt.jsxs)("div",{className:"speed-header",children:[(0,Qt.jsxs)("div",{className:"speed-timer ".concat(r<=10?"danger":""),children:[(0,Qt.jsx)("span",{className:"speed-timer-value",children:r}),(0,Qt.jsx)("span",{className:"speed-timer-label",children:"seconds"})]}),(0,Qt.jsxs)("div",{className:"speed-score-display",children:[(0,Qt.jsx)("span",{className:"speed-score-value",children:p}),(0,Qt.jsx)("span",{className:"speed-score-label",children:"points"})]}),x>1&&(0,Qt.jsxs)("div",{className:"speed-combo",children:[(0,Qt.jsx)(Jq,{size:20}),(0,Qt.jsxs)("span",{children:[x,"x"]})]})]}),(0,Qt.jsxs)("div",{className:"speed-card ".concat("correct"===A?"correct-flash":""," ").concat("wrong"===A?"wrong-flash":""),children:[(0,Qt.jsx)("div",{className:"speed-card-label",children:"Term"}),(0,Qt.jsx)("div",{className:"speed-card-term",children:I.term})]}),(0,Qt.jsxs)("div",{className:"speed-keywords",children:[(0,Qt.jsx)("div",{className:"speed-keywords-label",children:"Hit the keywords"}),(0,Qt.jsx)("div",{className:"speed-keywords-chips",children:B.map((e,t)=>(0,Qt.jsx)("span",{className:"speed-keyword-chip ".concat(Q.has(t)?"hit":""),children:e},t))})]}),_.length>0&&(0,Qt.jsxs)("div",{className:"speed-correct-answer",children:["Missed: ",_.join(", ")]}),(0,Qt.jsxs)("form",{className:"speed-input-area",onSubmit:L,children:[(0,Qt.jsx)("input",{ref:F,type:"text",className:"speed-input",placeholder:"Type what you remember...",value:h,onChange:e=>d(e.target.value),disabled:null!==A,autoComplete:"off",autoCorrect:"off",spellCheck:!1}),(0,Qt.jsx)("button",{type:"submit",className:"speed-submit-btn",disabled:!h.trim()||null!==A,children:"Enter"})]}),O>1&&(0,Qt.jsxs)("div",{className:"speed-streak",children:[(0,Qt.jsx)(Jq,{size:16}),O," streak!"]})]}):null}function bZ(e){let{flashcards:t,onClose:n}=e;const[i,r]=(0,s.useState)("picker"),[o,a]=(0,s.useState)(!1),l=(0,s.useCallback)(()=>{a(!0),setTimeout(()=>{n()},300)},[n]),c=(0,s.useCallback)(()=>{r("picker")},[]),u=(0,s.useCallback)((e,t)=>{},[]);(0,s.useEffect)(()=>{const e=e=>{"Escape"===e.key&&("picker"!==i?r("picker"):l())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[i,l]);const h=t.length>=4,d=t.length>=3,p=t.length>=1;return(0,Qt.jsxs)("div",{className:"learn-games-panel ".concat(o?"closing":""),children:[(0,Qt.jsxs)("div",{className:"learn-games-header",children:["picker"!==i&&(0,Qt.jsx)("button",{className:"learn-games-back-btn",onClick:c,title:"Back to games",children:(0,Qt.jsx)(lZ,{size:22})}),(0,Qt.jsxs)("h2",{className:"learn-games-title",children:["picker"===i&&"Learning Games","multiple-choice"===i&&"Multiple Choice","matching"===i&&"Matching","speed-round"===i&&"Speed Round"]}),(0,Qt.jsx)("button",{className:"learn-games-close-btn",onClick:l,title:"Close games",children:(0,Qt.jsx)(Xq,{size:24})})]}),(0,Qt.jsx)("div",{className:"learn-games-content",children:"picker"===i?(0,Qt.jsxs)("div",{className:"game-picker",children:[(0,Qt.jsxs)("div",{className:"game-picker-grid",children:[(0,Qt.jsxs)("button",{className:"game-picker-card ".concat(h?"":"disabled"),onClick:()=>h&&r("multiple-choice"),disabled:!h,children:[(0,Qt.jsx)("div",{className:"game-picker-icon mc-icon",children:(0,Qt.jsx)(cZ,{size:40})}),(0,Qt.jsx)("h3",{className:"game-picker-name",children:"Multiple Choice"}),(0,Qt.jsx)("p",{className:"game-picker-desc",children:"Pick the right answer"}),!h&&(0,Qt.jsx)("span",{className:"game-picker-requirement",children:"Need 4+ cards"})]}),(0,Qt.jsxs)("button",{className:"game-picker-card ".concat(d?"":"disabled"),onClick:()=>d&&r("matching"),disabled:!d,children:[(0,Qt.jsx)("div",{className:"game-picker-icon match-icon",children:(0,Qt.jsx)(sW,{size:40})}),(0,Qt.jsx)("h3",{className:"game-picker-name",children:"Matching"}),(0,Qt.jsx)("p",{className:"game-picker-desc",children:"Match terms to definitions"}),!d&&(0,Qt.jsx)("span",{className:"game-picker-requirement",children:"Need 3+ cards"})]}),(0,Qt.jsxs)("button",{className:"game-picker-card ".concat(p?"":"disabled"),onClick:()=>p&&r("speed-round"),disabled:!p,children:[(0,Qt.jsx)("div",{className:"game-picker-icon speed-icon",children:(0,Qt.jsx)(uZ,{size:40})}),(0,Qt.jsx)("h3",{className:"game-picker-name",children:"Speed Round"}),(0,Qt.jsx)("p",{className:"game-picker-desc",children:"Race against the clock"}),!p&&(0,Qt.jsx)("span",{className:"game-picker-requirement",children:"Need 1+ cards"})]})]}),(0,Qt.jsx)("div",{className:"game-picker-hint",children:(0,Qt.jsx)("span",{children:"Press Esc to close"})})]}):(0,Qt.jsx)("div",{className:"game-area",children:(()=>{switch(i){case"multiple-choice":return(0,Qt.jsx)(pZ,{flashcards:t,onComplete:u,onBack:c});case"matching":return(0,Qt.jsx)(mZ,{flashcards:t,onComplete:u,onBack:c});case"speed-round":return(0,Qt.jsx)(wZ,{flashcards:t,onComplete:u,onBack:c});default:return null}})()})})]})}const kZ=qz("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]]),xZ=qz("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),DZ=qz("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]);function SZ(e){let{currentMode:t,onModeChange:n}=e;return(0,Qt.jsxs)("div",{className:"mode-selector-toggle",children:[(0,Qt.jsx)("button",{className:"mode-toggle-button ".concat("markdown"===t?"active":""),onClick:()=>n("markdown"),title:"Markdown mode",children:(0,Qt.jsx)(kZ,{size:16})}),(0,Qt.jsx)("button",{className:"mode-toggle-button ".concat("wysiwyg"===t?"active":""),onClick:()=>n("wysiwyg"),title:"WYSIWYG mode",children:(0,Qt.jsx)(xZ,{size:16})}),(0,Qt.jsx)("button",{className:"mode-toggle-button ".concat("canvas"===t?"active":""),onClick:()=>n("canvas"),title:"Canvas mode",children:(0,Qt.jsx)(DZ,{size:16})})]})}const CZ=qz("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),AZ=qz("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),EZ=qz("scroll-text",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]),_Z=qz("gamepad-2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]),TZ=qz("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),PZ=qz("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),MZ=qz("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),FZ=qz("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);function RZ(e){let{flashcards:t,starredCards:n,onToggleStar:i,onStartStudy:r,onStartTutor:o,onStartGames:a,isAnimating:l=!1,tutorInstructions:c="",onTutorInstructionsChange:u}=e;const[h,d]=(0,s.useState)(new Set),[p,f]=(0,s.useState)(new Set),[m,g]=(0,s.useState)(!1),[v,y]=(0,s.useState)(new Set),[O,w]=(0,s.useState)(new Set),[b,k]=(0,s.useState)(!1),[x,D]=(0,s.useState)(null),S=(0,s.useRef)(null),C=(0,s.useRef)(null),A=(0,s.useRef)(!1);(0,s.useEffect)(()=>{const e=e=>{S.current&&!S.current.contains(e.target)&&k(!1)};return b&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[b]),(0,s.useEffect)(()=>{if(!A.current&&t.length>0){const e=new Set(t.map(e=>e.section||"Unsorted"));y(e),A.current=!0}},[t]);const E=e=>{const t=new Set(h);if(t.has(e.id)){t.delete(e.id);const n=new Set(p);n.delete(e.id),f(n)}else t.add(e.id);d(t)},_=m?t.filter(e=>n.has(e.id)):t,T={};_.forEach(e=>{const t=e.section||"Unsorted";T[t]||(T[t]=[]),T[t].push(e)});const P=()=>0===O.size?_.map(e=>e.id):_.filter(e=>O.has(e.section||"Unsorted")).map(e=>e.id);return(0,Qt.jsxs)("div",{className:"flashcard-sidebar ".concat(l?"animating":""),children:[(0,Qt.jsxs)("div",{className:"flashcard-header",children:[(0,Qt.jsxs)("div",{className:"flashcard-title-row",children:[(0,Qt.jsx)("h3",{children:"Flashcards"}),(0,Qt.jsx)("span",{className:"flashcard-count",children:m?"".concat(t.filter(e=>n.has(e.id)).length," starred"):"".concat(t.length," cards")})]}),t.length>0&&(0,Qt.jsxs)("div",{className:"toolbar-row",children:[(0,Qt.jsxs)("button",{className:"study-button",onClick:()=>r(P()),title:O.size>0?"Study ".concat(O.size," selected section(s)"):"Study all cards",children:[(0,Qt.jsx)(CZ,{size:20,fill:"currentColor"}),"Learn",O.size>0?" (".concat(O.size,")"):""]}),(0,Qt.jsxs)("div",{ref:S,className:"tutor-button-group",children:[(0,Qt.jsxs)("button",{className:"study-button tutor-button",onClick:()=>o(P()),title:O.size>0?"Quiz on ".concat(O.size," selected section(s)"):"Quiz on all cards",children:[(0,Qt.jsx)(AZ,{size:20}),"Tutor"]}),(0,Qt.jsx)("button",{ref:C,className:"tutor-config-button ".concat(b?"active":""),onClick:()=>{if(!b&&C.current){const e=C.current.getBoundingClientRect();D({top:e.bottom+8,left:e.right-280})}k(!b)},title:"Sample questions for tutor",children:(0,Qt.jsx)(EZ,{size:14})}),b&&x&&(0,Qt.jsxs)("div",{className:"sidebar-menu-dropdown",style:{position:"fixed",top:x.top,left:x.left},children:[(0,Qt.jsx)("label",{className:"sidebar-menu-label",children:"Sample Questions for Tutor"}),(0,Qt.jsx)("textarea",{className:"tutor-instructions-textarea",value:c,onChange:e=>null===u||void 0===u?void 0:u(e.target.value),placeholder:"Add sample questions to guide the tutor...\n\nExamples:\n- Compare and contrast X and Y\n- Give a real-world example of...\n- What are the 3 key principles of...",rows:6})]})]}),a&&(0,Qt.jsx)("button",{className:"toolbar-icon-button",onClick:()=>a(P()),title:"Learning games",children:(0,Qt.jsx)(_Z,{size:20})}),(0,Qt.jsx)("button",{className:"toolbar-icon-button ".concat(m?"active":""),onClick:()=>g(!m),title:m?"Show all cards":"Show starred only",children:(0,Qt.jsx)(Uq,{size:20,fill:m?"currentColor":"none"})})]})]}),0===t.length?(0,Qt.jsx)("p",{className:"sidebar-placeholder",children:"Use ## headings in the editor to create flashcards"}):m&&0===_.length?(0,Qt.jsx)("p",{className:"sidebar-placeholder",children:"No starred cards yet. Click the star icon on a card to add it to your favorites!"}):(0,Qt.jsx)(Qt.Fragment,{children:Object.entries(T).map(e=>{let[t,r]=e;const s=v.has(t),o=r.filter(e=>n.has(e.id)).length,a=o>0;return(0,Qt.jsxs)("div",{className:"flashcard-section-group",children:[(0,Qt.jsxs)("div",{className:"flashcard-section ".concat(O.has(t)?"selected":""),onClick:()=>(e=>{const t=new Set(O);t.has(e)?t.delete(e):t.add(e),w(t)})(t),children:[(0,Qt.jsx)("span",{className:"section-name",children:t}),a&&(0,Qt.jsxs)("span",{className:"section-starred",children:[(0,Qt.jsx)(Uq,{size:14,fill:"#F59E0B",color:"#F59E0B"}),(0,Qt.jsx)("span",{className:"section-starred-count",children:o})]}),(0,Qt.jsxs)("button",{className:"section-card-count ".concat(s?"collapsed":""),onClick:e=>{e.stopPropagation(),(e=>{const t=new Set(v);t.has(e)?t.delete(e):t.add(e),y(t)})(t)},title:s?"Show ".concat(r.length," cards"):"Hide cards",children:[r.length,s?(0,Qt.jsx)(TZ,{size:12}):(0,Qt.jsx)(PZ,{size:12})]})]}),!s&&(0,Qt.jsx)("div",{className:"flashcard-list",children:r.map(e=>(0,Qt.jsx)("div",{children:h.has(e.id)?(0,Qt.jsxs)("div",{className:"sidebar-card-preview",children:[(0,Qt.jsxs)("div",{className:"sidebar-preview-card ".concat(p.has(e.id)?"flipped":""),onClick:t=>{t.stopPropagation(),(e=>{const t=new Set(p);t.has(e)?t.delete(e):t.add(e),f(t)})(e.id)},children:[(0,Qt.jsxs)("div",{className:"sidebar-preview-card-front",children:[(0,Qt.jsxs)("div",{className:"card-header-row",children:[(0,Qt.jsx)("button",{className:"preview-back-button",onClick:t=>{t.stopPropagation(),E(e)},children:(0,Qt.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"2px",pointerEvents:"none"},children:[(0,Qt.jsx)(MZ,{size:14}),"Back"]})}),(0,Qt.jsx)("div",{className:"card-label",children:"Term"})]}),(0,Qt.jsx)("div",{className:"card-content",children:e.term})]}),(0,Qt.jsxs)("div",{className:"sidebar-preview-card-back",children:[(0,Qt.jsxs)("div",{className:"card-header-row",children:[(0,Qt.jsx)("button",{className:"preview-back-button",onClick:t=>{t.stopPropagation(),E(e)},children:(0,Qt.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"2px",pointerEvents:"none"},children:[(0,Qt.jsx)(MZ,{size:14}),"Back"]})}),(0,Qt.jsx)("div",{className:"card-label",children:"Definition"})]}),(0,Qt.jsx)("div",{className:"card-content card-content-markdown",children:(0,Qt.jsx)(_q,{children:e.definition})})]})]}),(0,Qt.jsx)("div",{className:"preview-hint",children:"Click to flip"})]}):(0,Qt.jsx)("div",{className:"flashcard ".concat(n.has(e.id)?"starred":""),onClick:()=>E(e),children:(0,Qt.jsxs)("div",{className:"flashcard-content-wrapper",children:[(0,Qt.jsxs)("div",{className:"flashcard-top-row",children:[(0,Qt.jsx)("div",{className:"flashcard-term",children:e.term}),(0,Qt.jsxs)("div",{className:"flashcard-icons",children:[(0,Qt.jsx)("button",{className:"icon-button edit",onClick:t=>{t.stopPropagation(),window.dispatchEvent(new CustomEvent("scrollToLine",{detail:{lineNumber:e.lineNumber}}))},title:"Edit in editor",children:(0,Qt.jsx)(FZ,{size:18})}),(0,Qt.jsx)("button",{className:"icon-button star ".concat(n.has(e.id)?"starred":""),onClick:t=>i(e.id,t),title:n.has(e.id)?"Unstar":"Star",children:(0,Qt.jsx)(Uq,{size:18,fill:n.has(e.id)?"currentColor":"none"})})]})]}),e.definition&&(0,Qt.jsx)("div",{className:"flashcard-definition",children:(0,Qt.jsx)(_q,{children:e.definition})})]})})},e.id))})]},t)})})]})}const NZ=qz("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),IZ=qz("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),BZ=qz("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),QZ=qz("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),LZ=qz("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),jZ=qz("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),$Z=qz("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),zZ=qz("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),WZ=qz("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),VZ=qz("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),UZ=qz("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),XZ=qz("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),qZ=qz("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),ZZ=qz("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]),HZ=qz("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);function YZ(e,t,n){t||(t=[]);var i=t.length++;return Object.defineProperty({},"_",{set:function(r){t[i]=r,e.apply(n,t)}})}function GZ(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KZ(e,t,n){GZ(e,t),t.set(e,n)}function JZ(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function eH(e,t,n){return n(JZ(e,t))}function tH(e,t){return e.get(JZ(e,t))}function nH(e,t,n){return e.set(JZ(e,t),n),n}function iH(e,t){GZ(e,t),t.add(e)}function rH(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return rH=function(e){this.s=e,this.n=e.next},rH.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new rH(e)}var sH,oH,aH,lH,cH,uH,hH,dH,pH,fH,mH,gH,vH,yH,OH,wH,bH,kH;const xH="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type),DH=[.001,0,0,.001,0,0],SH=1.35,CH=1,AH=2,EH=4,_H=16,TH=32,PH=64,MH=128,FH=256,RH={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},NH="pdfjs_internal_editor_",IH={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},BH={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},QH=1,LH=2,jH=0,$H=1,zH=2,WH=3,VH=3,UH=4,XH={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},qH={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ZH=1,HH=2,YH=3,GH=4,KH=5,JH={ERRORS:0,WARNINGS:1,INFOS:5},eY={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},tY=0,nY=1,iY=2,rY=3,sY=4;let oY=JH.WARNINGS;function aY(e){Number.isInteger(e)&&(oY=e)}function lY(){return oY}function cY(e){oY>=JH.INFOS&&console.info("Info: ".concat(e))}function uY(e){oY>=JH.WARNINGS&&console.warn("Warning: ".concat(e))}function hY(e){throw new Error(e)}function dY(e,t){e||hY(t)}function pY(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;if(n&&"string"===typeof e){if(n.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);(null===t||void 0===t?void 0:t.length)>=2&&(e="http://".concat(e))}if(n.tryConvertEncoding)try{e=decodeURIComponent(escape(e))}catch(r){}}const i=t?URL.parse(e,t):URL.parse(e);return function(e){switch(null===e||void 0===e?void 0:e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i)?i:null}function fY(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=URL.parse(e);return i?(i.hash=t,i.href):n&&pY(e,"http://example.com")?e.split("#",1)[0]+"".concat(t?"#".concat(t):""):""}function mY(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.defineProperty(e,t,{value:n,enumerable:!i,configurable:!0,writable:!1}),n}const gY=function(){function e(e,t){this.message=e,this.name=t}return e.prototype=new Error,e.constructor=e,e}();class vY extends gY{constructor(e,t){super(e,"PasswordException"),this.code=t}}class yY extends gY{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class OY extends gY{constructor(e){super(e,"InvalidPDFException")}}class wY extends gY{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class bY extends gY{constructor(e){super(e,"FormatError")}}class kY extends gY{constructor(e){super(e,"AbortException")}}function xY(e){"string"!==typeof e&&hY("Invalid argument for stringToBytes");const t=e.length,n=new Uint8Array(t);for(let i=0;i<t;++i)n[i]=255&e.charCodeAt(i);return n}class DY{static get isLittleEndian(){return mY(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}static get isEvalSupported(){return mY(this,"isEvalSupported",function(){try{return new Function(""),!0}catch(e){return!1}}())}static get isOffscreenCanvasSupported(){return mY(this,"isOffscreenCanvasSupported","undefined"!==typeof OffscreenCanvas)}static get isImageDecoderSupported(){return mY(this,"isImageDecoderSupported","undefined"!==typeof ImageDecoder)}static get isFloat16ArraySupported(){return mY(this,"isFloat16ArraySupported","undefined"!==typeof Float16Array)}static get isSanitizerSupported(){return mY(this,"isSanitizerSupported","undefined"!==typeof Sanitizer)}static get platform(){const{platform:e,userAgent:t}=navigator;return mY(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return mY(this,"isCSSRoundSupported",null===(e=globalThis.CSS)||void 0===e||null===(t=e.supports)||void 0===t?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const SY=Array.from(Array(256).keys(),e=>e.toString(16).padStart(2,"0"));class CY{static makeHexColor(e,t,n){return"#".concat(SY[e]).concat(SY[t]).concat(SY[n])}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=e[n],r=e[n+1];e[n]=i*t[0]+r*t[2]+t[4],e[n+1]=i*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5];for(let c=0;c<6;c+=2){const t=e[n+c],u=e[n+c+1];e[n+c]=t*i+u*s+a,e[n+c+1]=t*r+u*o+l}}static applyInverseTransform(e,t){const n=e[0],i=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-n*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,n){const i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=e[0],u=e[1],h=e[2],d=e[3];let p=i*c+a,f=p,m=i*h+a,g=m,v=o*u+l,y=v,O=o*d+l,w=O;if(0!==r||0!==s){const e=r*c,t=r*h,n=s*u,i=s*d;p+=n,g+=n,m+=i,f+=i,v+=e,w+=e,O+=t,y+=t}n[0]=Math.min(n[0],p,m,f,g),n[1]=Math.min(n[1],v,O,y,w),n[2]=Math.max(n[2],p,m,f,g),n[3]=Math.max(n[3],v,O,y,w)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],i=e[1],r=e[2],s=e[3],o=n**2+i**2,a=n*r+i*s,l=r**2+s**2,c=(o+l)/2,u=Math.sqrt(c**2-(o*l-a**2));t[0]=Math.sqrt(c+u||1),t[1]=Math.sqrt(c-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),s=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>s?null:[n,r,i,s]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,i,r){r[0]=Math.min(r[0],e,n),r[1]=Math.min(r[1],t,i),r[2]=Math.max(r[2],e,n),r[3]=Math.max(r[3],t,i)}static bezierBoundingBox(e,t,n,i,r,s,o,a,l){l[0]=Math.min(l[0],e,o),l[1]=Math.min(l[1],t,a),l[2]=Math.max(l[2],e,o),l[3]=Math.max(l[3],t,a),JZ(CY,this,EY).call(this,e,n,r,o,t,i,s,a,3*(3*(n-r)-e+o),6*(e-2*n+r),3*(n-e),l),JZ(CY,this,EY).call(this,e,n,r,o,t,i,s,a,3*(3*(i-s)-t+a),6*(t-2*i+s),3*(i-t),l)}}function AY(e,t,n,i,r,s,o,a,l,c){if(l<=0||l>=1)return;const u=1-l,h=l*l,d=h*l,p=u*(u*(u*e+3*l*t)+3*h*n)+d*i,f=u*(u*(u*r+3*l*s)+3*h*o)+d*a;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],f),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],f)}function EY(e,t,n,i,r,s,o,a,l,c,u,h){if(Math.abs(l)<1e-12)return void(Math.abs(c)>=1e-12&&JZ(sH,this,AY).call(this,e,t,n,i,r,s,o,a,-u/c,h));const d=c**2-4*u*l;if(d<0)return;const p=Math.sqrt(d),f=2*l;JZ(sH,this,AY).call(this,e,t,n,i,r,s,o,a,(-c+p)/f,h),JZ(sH,this,AY).call(this,e,t,n,i,r,s,o,a,(-c-p)/f,h)}sH=CY;let _Y=null,TY=null;function PY(){if("function"===typeof crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(32);return crypto.getRandomValues(e),function(e){"object"===typeof e&&void 0!==(null===e||void 0===e?void 0:e.length)||hY("Invalid argument for bytesToString");const t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);const i=[];for(let r=0;r<t;r+=n){const s=Math.min(r+n,t),o=e.subarray(r,s);i.push(String.fromCharCode.apply(null,o))}return i.join("")}(e)}const MY="pdfjs_internal_id_";function FY(e,t,n){return Math.min(Math.max(e,t),n)}"function"!==typeof Math.sumPrecise&&(Math.sumPrecise=function(e){return e.reduce((e,t)=>e+t,0)});class RY{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};return function e(n){var i;if(!n)return;let r=null;const s=n.name;if("#text"===s)r=n.value;else{if(!RY.shouldBuildText(s))return;null!==n&&void 0!==n&&null!==(i=n.attributes)&&void 0!==i&&i.textContent?r=n.attributes.textContent:n.value&&(r=n.value)}if(null!==r&&t.push({str:r}),n.children)for(const t of n.children)e(t)}(e),n}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}class NY{static setupStorage(e,t,n,i,r){const s=i.getValue(t,{value:null});switch(n.name){case"textarea":if(null!==s.value&&(e.textContent=s.value),"print"===r)break;e.addEventListener("input",e=>{i.setValue(t,{value:e.target.value})});break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(s.value===n.attributes.xfaOn?e.setAttribute("checked",!0):s.value===n.attributes.xfaOff&&e.removeAttribute("checked"),"print"===r)break;e.addEventListener("change",e=>{i.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})})}else{if(null!==s.value&&e.setAttribute("value",s.value),"print"===r)break;e.addEventListener("input",e=>{i.setValue(t,{value:e.target.value})})}break;case"select":if(null!==s.value){e.setAttribute("value",s.value);for(const e of n.children)e.attributes.value===s.value?e.attributes.selected=!0:e.attributes.hasOwnProperty("selected")&&delete e.attributes.selected}e.addEventListener("input",e=>{const n=e.target.options,r=-1===n.selectedIndex?"":n[n.selectedIndex].value;i.setValue(t,{value:r})})}}static setAttributes(e){let{html:t,element:n,storage:i=null,intent:r,linkService:s}=e;const{attributes:o}=n,a=t instanceof HTMLAnchorElement;"radio"===o.type&&(o.name="".concat(o.name,"-").concat(r));for(const[l,c]of Object.entries(o))if(null!==c&&void 0!==c)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!a||"href"!==l&&"newWindow"!==l)&&t.setAttribute(l,c)}a&&s.addLinkAttributes(t,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(t,o.dataId,n,i)}static render(e){const t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,r=e.intent||"display",s=document.createElement(i.name);i.attributes&&this.setAttributes({html:s,element:i,intent:r,linkService:n});const o="richText"!==r,a=e.div;if(a.append(s),e.viewport){const t="matrix(".concat(e.viewport.transform.join(","),")");a.style.transform=t}o&&a.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===i.children.length){if(i.value){const e=document.createTextNode(i.value);s.append(e),o&&RY.shouldBuildText(i.name)&&l.push(e)}return{textDivs:l}}const c=[[i,-1,s]];for(;c.length>0;){var u,h;const[e,i,s]=c.at(-1);if(i+1===e.children.length){c.pop();continue}const a=e.children[++c.at(-1)[1]];if(null===a)continue;const{name:d}=a;if("#text"===d){const e=document.createTextNode(a.value);l.push(e),s.append(e);continue}const p=null!==a&&void 0!==a&&null!==(u=a.attributes)&&void 0!==u&&u.xmlns?document.createElementNS(a.attributes.xmlns,d):document.createElement(d);if(s.append(p),a.attributes&&this.setAttributes({html:p,element:a,storage:t,intent:r,linkService:n}),(null===(h=a.children)||void 0===h?void 0:h.length)>0)c.push([a,-1,p]);else if(a.value){const e=document.createTextNode(a.value);o&&RY.shouldBuildText(d)&&l.push(e),p.append(e)}}for(const d of a.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:l}}static update(e){const t="matrix(".concat(e.viewport.transform.join(","),")");e.div.style.transform=t,e.div.hidden=!1}}const IY="http://www.w3.org/2000/svg";class BY{}async function QY(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(VY(e,document.baseURI)){const n=await fetch(e);if(!n.ok)throw new Error(n.statusText);switch(t){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise((n,i)=>{const r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE)if(200!==r.status&&0!==r.status)i(new Error(r.statusText));else{switch(t){case"arraybuffer":case"blob":case"json":return void n(r.response)}n(r.responseText)}},r.send(null)})}oH=BY,h(BY,"CSS",96),h(BY,"PDF",72),h(BY,"PDF_TO_CSS_UNITS",oH.CSS/oH.PDF);class LY{constructor(e){let{viewBox:t,userUnit:n,scale:i,rotation:r,offsetX:s=0,offsetY:o=0,dontFlip:a=!1}=e;this.viewBox=t,this.userUnit=n,this.scale=i,this.rotation=r,this.offsetX=s,this.offsetY=o,i*=n;const l=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let u,h,d,p,f,m,g,v;switch(r%=360,r<0&&(r+=360),r){case 180:u=-1,h=0,d=0,p=1;break;case 90:u=0,h=1,d=1,p=0;break;case 270:u=0,h=-1,d=-1,p=0;break;case 0:u=1,h=0,d=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(d=-d,p=-p),0===u?(f=Math.abs(c-t[1])*i+s,m=Math.abs(l-t[0])*i+o,g=(t[3]-t[1])*i,v=(t[2]-t[0])*i):(f=Math.abs(l-t[0])*i+s,m=Math.abs(c-t[1])*i+o,g=(t[2]-t[0])*i,v=(t[3]-t[1])*i),this.transform=[u*i,h*i,d*i,p*i,f-u*i*l-d*i*c,m-h*i*l-p*i*c],this.width=g,this.height=v}get rawDims(){const e=this.viewBox;return mY(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone(){let{scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new LY({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){const n=[e,t];return CY.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];CY.applyTransform(t,this.transform);const n=[e[2],e[3]];return CY.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return CY.applyInverseTransform(n,this.transform),n}}class jY extends gY{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(e,"RenderingCancelledException"),this.extraDelay=t}}function $Y(e){const t=e.length;let n=0;for(;n<t&&""===e[n].trim();)n++;return"data:"===e.substring(n,n+5).toLowerCase()}function zY(e){return"string"===typeof e&&/\.pdf$/i.test(e)}class WY{constructor(){h(this,"started",Object.create(null)),h(this,"times",[])}time(e){e in this.started&&uY("Timer is already running for ".concat(e)),this.started[e]=Date.now()}timeEnd(e){e in this.started||uY("Timer has not been started for ".concat(e)),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:r}of this.times)e.push("".concat(n.padEnd(t)," ").concat(r-i,"ms\n"));return e.join("")}}function VY(e,t){const n=t?URL.parse(e,t):URL.parse(e);return"http:"===(null===n||void 0===n?void 0:n.protocol)||"https:"===(null===n||void 0===n?void 0:n.protocol)}function UY(e){e.preventDefault()}function XY(e){e.preventDefault(),e.stopPropagation()}class qY{static toDateObject(e){if(e instanceof Date)return e;if(!e||"string"!==typeof e)return null;JZ(qY,this,ZY)._||(ZY._=JZ(qY,this,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?")));const t=JZ(qY,this,ZY)._.exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let s=parseInt(t[4],10);s=s>=0&&s<=23?s:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let a=parseInt(t[6],10);a=a>=0&&a<=59?a:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,"-"===l?(s+=c,o+=u):"+"===l&&(s-=c,o-=u),new Date(Date.UTC(n,i,r,s,o,a))}}var ZY={_:void 0};function HY(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map(e=>parseInt(e)):e.startsWith("rgba(")?e.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(uY('Not a valid color format: "'.concat(e,'"')),[0,0,0])}function YY(e){const{a:t,b:n,c:i,d:r,e:s,f:o}=e.getTransform();return[t,n,i,r,s,o]}function GY(e){const{a:t,b:n,c:i,d:r,e:s,f:o}=e.getTransform().invertSelf();return[t,n,i,r,s,o]}function KY(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t instanceof LY){const{pageWidth:i,pageHeight:r}=t.rawDims,{style:s}=e,o=DY.isCSSRoundSupported,a="var(--total-scale-factor) * ".concat(i,"px"),l="var(--total-scale-factor) * ".concat(r,"px"),c=o?"round(down, ".concat(a,", var(--scale-round-x))"):"calc(".concat(a,")"),u=o?"round(down, ".concat(l,", var(--scale-round-y))"):"calc(".concat(l,")");n&&t.rotation%180!==0?(s.width=u,s.height=c):(s.width=c,s.height=u)}i&&e.setAttribute("data-main-rotation",t.rotation)}class JY{constructor(){const{pixelRatio:e}=JY;this.sx=e,this.sy=e}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,s=1/0,o=1/0,a=1/0;(n=JY.capPixels(n,r))>0&&(s=Math.sqrt(n/(e*t))),-1!==i&&(o=i/e,a=i/t);const l=Math.min(s,o,a);return(this.sx>l||this.sy>l)&&(this.sx=l,this.sy=l,!0)}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const eG=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class tG{static get isDarkMode(){var e,t;return mY(this,"isDarkMode",!(null===(e=window)||void 0===e||null===(t=e.matchMedia)||void 0===t||!t.call(e,"(prefers-color-scheme: dark)").matches))}}function nG(e,t){const n=e[0]/255,i=e[1]/255,r=e[2]/255,s=Math.max(n,i,r),o=Math.min(n,i,r),a=(s+o)/2;if(s===o)t[0]=t[1]=0;else{const e=s-o;switch(t[1]=a<.5?e/(s+o):e/(2-s-o),s){case n:t[0]=60*((i-r)/e+(i<r?6:0));break;case i:t[0]=60*((r-n)/e+2);break;case r:t[0]=60*((n-i)/e+4)}}t[2]=a}function iG(e,t){const n=e[0],i=e[1],r=e[2],s=(1-Math.abs(2*r-1))*i,o=s*(1-Math.abs(n/60%2-1)),a=r-s/2;switch(Math.floor(n/60)){case 0:t[0]=s+a,t[1]=o+a,t[2]=a;break;case 1:t[0]=o+a,t[1]=s+a,t[2]=a;break;case 2:t[0]=a,t[1]=s+a,t[2]=o+a;break;case 3:t[0]=a,t[1]=o+a,t[2]=s+a;break;case 4:t[0]=o+a,t[1]=a,t[2]=s+a;break;case 5:case 6:t[0]=s+a,t[1]=a,t[2]=o+a}}function rG(e){return e<=.03928?e/12.92:((e+.055)/1.055)**2.4}function sG(e,t,n){iG(e,n),n.map(rG);const i=.2126*n[0]+.7152*n[1]+.0722*n[2];iG(t,n),n.map(rG);const r=.2126*n[0]+.7152*n[1]+.0722*n[2];return i>r?(i+.05)/(r+.05):(r+.05)/(i+.05)}const oG=new Map;function aG(e,t){let{html:n,dir:i,className:r}=e;const s=document.createDocumentFragment();if("string"===typeof n){const e=document.createElement("p");e.dir=i||"auto";const t=n.split(/(?:\r\n?|\n)/);for(let n=0,i=t.length;n<i;++n){const r=t[n];e.append(document.createTextNode(r)),n<i-1&&e.append(document.createElement("br"))}s.append(e)}else NY.render({xfaHtml:n,div:s,intent:"richText"});s.firstElementChild.classList.add("richText",r),t.append(s)}function lG(e){const t=new Path2D;if(!e)return t;for(let n=0,i=e.length;n<i;)switch(e[n++]){case tY:t.moveTo(e[n++],e[n++]);break;case nY:t.lineTo(e[n++],e[n++]);break;case iY:t.bezierCurveTo(e[n++],e[n++],e[n++],e[n++],e[n++],e[n++]);break;case rY:t.quadraticCurveTo(e[n++],e[n++],e[n++],e[n++]);break;case sY:t.closePath();break;default:uY("Unrecognized drawing path operator: ".concat(e[n-1]))}return t}var cG=new WeakSet;class uG{constructor(){iH(this,cG)}get pagesNumber(){return gG._}set pagesNumber(e){gG._!==e&&(gG._=e,0===e&&(fG._=null,pG._=null))}addListener(e){vG._.push(e)}removeListener(e){const t=vG._.indexOf(e);t>=0&&vG._.splice(t,1)}movePages(e,t,n){JZ(cG,this,dG).call(this,!0);const i=fG._,r=pG._;mG._.set(r);const s=t.length,o=new Uint32Array(s);let a=0;for(let d=0;d<s;d++){const e=t[d]-1;o[d]=i[e],e<n&&(a+=1)}const l=gG._;let c=n-a;const u=l-s;c=FY(c,0,u);for(let d=0,p=0;d<l;d++)e.has(d+1)||(i[p++]=i[d]);i.copyWithin(c+s,c,u),i.set(o,c);let h=!1;for(let d=0,p=l;d<p;d++){const e=i[d];h||(h=e!==d+1),r[e-1]=d+1}JZ(cG,this,hG).call(this),h||(this.pagesNumber=0)}hasBeenAltered(){return null!==fG._}getPageMappingForSaving(){return{pageIndices:pG._?pG._.map(e=>e-1):null}}getPrevPageNumber(e){return mG._[fG._[e-1]-1]}getPageNumber(e){var t,n;return null!==(t=null===(n=pG._)||void 0===n?void 0:n[e-1])&&void 0!==t?t:e}getPageId(e){var t,n;return null!==(t=null===(n=fG._)||void 0===n?void 0:n[e-1])&&void 0!==t?t:e}static get instance(){return mY(this,"instance",new uG)}getMapping(){return fG._.subarray(0,this.pagesNumber)}}function hG(){for(const e of vG._)e()}function dG(e){if(fG._)return;const t=gG._,n=new Uint32Array(3*t),i=fG._=n.subarray(0,t),r=pG._=n.subarray(t,2*t);if(e)for(let s=0;s<t;s++)i[s]=r[s]=s+1;mG._=n.subarray(2*t)}var pG={_:null},fG={_:null},mG={_:null},gG={_:0},vG={_:[]},yG=new WeakMap,OG=new WeakMap,wG=new WeakMap,bG=new WeakMap,kG=new WeakMap,xG=new WeakMap,DG=new WeakMap,SG=new WeakMap,CG=new WeakSet;class AG{constructor(e){iH(this,CG),KZ(this,yG,null),KZ(this,OG,null),KZ(this,wG,void 0),KZ(this,bG,null),KZ(this,kG,null),KZ(this,xG,null),KZ(this,DG,null),KZ(this,SG,null),nH(wG,this,e),FG._||(FG._=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=nH(yG,this,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=tH(wG,this)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",UY,{signal:t}),e.addEventListener("pointerdown",EG,{signal:t}));const n=nH(bG,this,document.createElement("div"));n.className="buttons",e.append(n);const i=tH(wG,this).toolbarPosition;if(i){const{style:t}=e,n="ltr"===tH(wG,this)._uiManager.direction?1-i[0]:i[0];t.insetInlineEnd="".concat(100*n,"%"),t.top="calc(".concat(100*i[1],"% + var(--editor-toolbar-vert-offset))")}return e}get div(){return tH(yG,this)}hide(){var e;tH(yG,this).classList.add("hidden"),null===(e=tH(OG,this))||void 0===e||e.hideDropdown()}show(){var e,t;tH(yG,this).classList.remove("hidden"),null===(e=tH(kG,this))||void 0===e||e.shown(),null===(t=tH(xG,this))||void 0===t||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=tH(wG,this),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",FG._[e]),JZ(CG,this,PG).call(this,n)&&n.addEventListener("click",e=>{t.delete()},{signal:t._signal}),tH(bG,this).append(n)}async addAltText(e){const t=await e.render();JZ(CG,this,PG).call(this,t),tH(bG,this).append(t,eH(CG,this,MG)),nH(kG,this,e)}addComment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(tH(xG,this))return;const n=e.renderForToolbar();if(!n)return;JZ(CG,this,PG).call(this,n);const i=nH(DG,this,eH(CG,this,MG));t?(tH(bG,this).insertBefore(n,t),tH(bG,this).insertBefore(i,t)):tH(bG,this).append(n,i),nH(xG,this,e),e.toolbar=this}addColorPicker(e){if(tH(OG,this))return;nH(OG,this,e);const t=e.renderButton();JZ(CG,this,PG).call(this,t),tH(bG,this).append(t,eH(CG,this,MG))}async addEditSignatureButton(e){const t=nH(SG,this,await e.renderEditButton(tH(wG,this)));JZ(CG,this,PG).call(this,t),tH(bG,this).append(t,eH(CG,this,MG))}removeButton(e){var t,n;if("comment"===e)null===(t=tH(xG,this))||void 0===t||t.removeToolbarCommentButton(),nH(xG,this,null),null===(n=tH(DG,this))||void 0===n||n.remove(),nH(DG,this,null)}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t)}}async addButtonBefore(e,t,n){if(!t&&"comment"===e)return;const i=tH(bG,this).querySelector(n);i&&"comment"===e&&this.addComment(t,i)}updateEditSignatureButton(e){tH(SG,this)&&(tH(SG,this).title=e)}remove(){var e;tH(yG,this).remove(),null===(e=tH(OG,this))||void 0===e||e.destroy(),nH(OG,this,null)}}function EG(e){e.stopPropagation()}function _G(e){tH(wG,this)._focusEventsAllowed=!1,XY(e)}function TG(e){tH(wG,this)._focusEventsAllowed=!0,XY(e)}function PG(e){const t=tH(wG,this)._uiManager._signal;return t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("focusin",JZ(CG,this,_G).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",JZ(CG,this,TG).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",UY,{signal:t}),!0)}function MG(e){const t=document.createElement("div");return t.className="divider",t}var FG={_:null},RG=new WeakMap,NG=new WeakMap,IG=new WeakMap,BG=new WeakSet;class QG{constructor(e){iH(this,BG),KZ(this,RG,null),KZ(this,NG,null),KZ(this,IG,void 0),nH(IG,this,e)}show(e,t,n){const[i,r]=JZ(BG,this,jG).call(this,t,n),{style:s}=tH(NG,this)||nH(NG,this,JZ(BG,this,LG).call(this));e.append(tH(NG,this)),s.insetInlineEnd="".concat(100*i,"%"),s.top="calc(".concat(100*r,"% + var(--editor-toolbar-vert-offset))")}hide(){tH(NG,this).remove()}}function LG(){const e=nH(NG,this,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=tH(IG,this)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",UY,{signal:t});const n=nH(RG,this,document.createElement("div"));return n.className="buttons",e.append(n),tH(IG,this).hasCommentManager()&&JZ(BG,this,$G).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{tH(IG,this).commentSelection("floating_button")}),JZ(BG,this,$G).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{tH(IG,this).highlightSelection("floating_button")}),e}function jG(e,t){let n=0,i=0;for(const r of e){const e=r.y+r.height;if(e<n)continue;const s=r.x+(t?r.width:0);e>n?(i=s,n=e):t?s>i&&(i=s):s<i&&(i=s)}return[t?1-i:i,n]}function $G(e,t,n,i){const r=document.createElement("button");r.classList.add("basic",e),r.tabIndex=0,r.setAttribute("data-l10n-id",t);const s=document.createElement("span");r.append(s),s.className="visuallyHidden",s.setAttribute("data-l10n-id",n);const o=tH(IG,this)._signal;o instanceof AbortSignal&&!o.aborted&&(r.addEventListener("contextmenu",UY,{signal:o}),r.addEventListener("click",i,{signal:o})),tH(RG,this).append(r)}function zG(e,t,n){for(const i of n)t.addEventListener(i,e[i].bind(e))}class WG{static initializeAndAddPointerId(e){(UG._||(UG._=new Set)).add(e)}static setPointer(e,t){var n;VG._||(VG._=t),null!==(n=qG._)&&void 0!==n||(qG._=e)}static setTimeStamp(e){XG._=e}static isSamePointerId(e){return VG._===e}static isSamePointerIdOrRemove(e){var t;return VG._===e||(null===(t=UG._)||void 0===t||t.delete(e),!1)}static isSamePointerType(e){return qG._===e}static isInitializedAndDifferentPointerType(e){return null!==qG._&&!WG.isSamePointerType(e)}static isSameTimeStamp(e){return XG._===e}static isUsingMultiplePointers(){var e;return(null===(e=UG._)||void 0===e?void 0:e.size)>=1}static clearPointerType(){qG._=null}static clearPointerIds(){VG._=NaN,UG._=null}static clearTimeStamp(){XG._=NaN}}var VG={_:NaN},UG={_:null},XG={_:NaN},qG={_:null},ZG=new WeakMap;class HG{constructor(){KZ(this,ZG,0)}get id(){var e,t;return"".concat(NH).concat((nH(ZG,this,(e=tH(ZG,this),t=e++,e)),t))}}var YG=new WeakMap,GG=new WeakMap,KG=new WeakMap,JG=new WeakSet;class eK{constructor(){iH(this,JG),KZ(this,YG,PY()),KZ(this,GG,0),KZ(this,KG,null)}static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),t=new Image;t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>';return mY(this,"_isSVGFittingCanvas",t.decode().then(()=>(e.drawImage(t,0,0,1,1,0,0,1,3),0===new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0])))}async getFromFile(e){const{lastModified:t,name:n,size:i,type:r}=e;return JZ(JG,this,tK).call(this,"".concat(t,"_").concat(n,"_").concat(i,"_").concat(r),e)}async getFromUrl(e){return JZ(JG,this,tK).call(this,e,e)}async getFromBlob(e,t){const n=await t;return JZ(JG,this,tK).call(this,e,n)}async getFromId(e){tH(KG,this)||nH(KG,this,new Map);const t=tH(KG,this).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:e}=t;return delete t.blobPromise,this.getFromBlob(t.id,e)}return this.getFromUrl(t.url)}getFromCanvas(e,t){var n,i,r;tH(KG,this)||nH(KG,this,new Map);let s=tH(KG,this).get(e);if(null!==(r=s)&&void 0!==r&&r.bitmap)return s.refCounter+=1,s;const o=new OffscreenCanvas(t.width,t.height);return o.getContext("2d").drawImage(t,0,0),s={bitmap:o.transferToImageBitmap(),id:"image_".concat(tH(YG,this),"_").concat((nH(GG,this,(n=tH(GG,this),i=n++,n)),i)),refCounter:1,isSvg:!1},tH(KG,this).set(e,s),tH(KG,this).set(s.id,s),s}getSvgUrl(e){const t=tH(KG,this).get(e);return null!==t&&void 0!==t&&t.isSvg?t.svgUrl:null}deleteId(e){var t;tH(KG,this)||nH(KG,this,new Map);const n=tH(KG,this).get(e);if(!n)return;if(n.refCounter-=1,0!==n.refCounter)return;const{bitmap:i}=n;if(!n.url&&!n.file){const e=new OffscreenCanvas(i.width,i.height);e.getContext("bitmaprenderer").transferFromImageBitmap(i),n.blobPromise=e.convertToBlob()}null===(t=i.close)||void 0===t||t.call(i),n.bitmap=null}isValidId(e){return e.startsWith("image_".concat(tH(YG,this),"_"))}}async function tK(e,t){var n;tH(KG,this)||nH(KG,this,new Map);let i=tH(KG,this).get(e);if(null===i)return null;if(null!==(n=i)&&void 0!==n&&n.bitmap)return i.refCounter+=1,i;try{var r,s;let e;if(i||(i={bitmap:null,id:"image_".concat(tH(YG,this),"_").concat((nH(GG,this,(r=tH(GG,this),s=r++,r)),s)),refCounter:0,isSvg:!1}),"string"===typeof t?(i.url=t,e=await QY(t,"blob")):t instanceof File?e=i.file=t:t instanceof Blob&&(e=t),"image/svg+xml"===e.type){const t=aH._isSVGFittingCanvas,n=new FileReader,r=new Image,s=new Promise((e,s)=>{r.onload=()=>{i.bitmap=r,i.isSvg=!0,e()},n.onload=async()=>{const e=i.svgUrl=n.result;r.src=await t?"".concat(e,"#svgView(preserveAspectRatio(none))"):e},r.onerror=n.onerror=s});n.readAsDataURL(e),await s}else i.bitmap=await createImageBitmap(e);i.refCounter=1}catch(Kre){uY(Kre),i=null}return tH(KG,this).set(e,i),i&&tH(KG,this).set(i.id,i),i}aH=eK;var nK=new WeakMap,iK=new WeakMap,rK=new WeakMap,sK=new WeakMap;class oK{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;KZ(this,nK,[]),KZ(this,iK,!1),KZ(this,rK,void 0),KZ(this,sK,-1),nH(rK,this,e)}add(e){let{cmd:t,undo:n,post:i,mustExec:r,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}=e;if(r&&t(),tH(iK,this))return;const l={cmd:t,undo:n,post:i,type:s};if(-1===tH(sK,this))return tH(nK,this).length>0&&(tH(nK,this).length=0),nH(sK,this,0),void tH(nK,this).push(l);if(o&&tH(nK,this)[tH(sK,this)].type===s)return a&&(l.undo=tH(nK,this)[tH(sK,this)].undo),void(tH(nK,this)[tH(sK,this)]=l);const c=tH(sK,this)+1;c===tH(rK,this)?tH(nK,this).splice(0,1):(nH(sK,this,c),c<tH(nK,this).length&&tH(nK,this).splice(c)),tH(nK,this).push(l)}undo(){if(-1===tH(sK,this))return;nH(iK,this,!0);const{undo:e,post:t}=tH(nK,this)[tH(sK,this)];e(),null===t||void 0===t||t(),nH(iK,this,!1),nH(sK,this,tH(sK,this)-1)}redo(){if(tH(sK,this)<tH(nK,this).length-1){nH(sK,this,tH(sK,this)+1),nH(iK,this,!0);const{cmd:e,post:t}=tH(nK,this)[tH(sK,this)];e(),null===t||void 0===t||t(),nH(iK,this,!1)}}hasSomethingToUndo(){return-1!==tH(sK,this)}hasSomethingToRedo(){return tH(sK,this)<tH(nK,this).length-1}cleanType(e){if(-1!==tH(sK,this)){for(let t=tH(sK,this);t>=0;t--)if(tH(nK,this)[t].type!==e)return tH(nK,this).splice(t+1,tH(sK,this)-t),void nH(sK,this,t);tH(nK,this).length=0,nH(sK,this,-1)}}destroy(){nH(nK,this,null)}}var aK=new WeakSet;class lK{constructor(e){iH(this,aK),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=DY.platform;for(const[n,i,r={}]of e)for(const e of n){const n=e.startsWith("mac+");t&&n?(this.callbacks.set(e.slice(4),{callback:i,options:r}),this.allKeys.add(e.split("+").at(-1))):t||n||(this.callbacks.set(e,{callback:i,options:r}),this.allKeys.add(e.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(JZ(aK,this,cK).call(this,t));if(!n)return;const{callback:i,options:{bubbles:r=!1,args:s=[],checker:o=null}}=n;o&&!o(e,t)||(i.bind(e,...s,t)(),r||XY(t))}}function cK(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}class uK{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return function(e){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const n of e.keys()){t.style.color=n;const i=window.getComputedStyle(t).color;e.set(n,HY(i))}t.remove()}(e),mY(this,"_colors",e)}convert(e){const t=HY(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,i]of this._colors)if(i.every((e,n)=>e===t[n]))return uK._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?CY.makeHexColor(...t):e}}h(uK,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));var hK=new WeakMap,dK=new WeakMap,pK=new WeakMap,fK=new WeakMap,mK=new WeakMap,gK=new WeakMap,vK=new WeakMap,yK=new WeakMap,OK=new WeakMap,wK=new WeakMap,bK=new WeakMap,kK=new WeakMap,xK=new WeakMap,DK=new WeakMap,SK=new WeakMap,CK=new WeakMap,AK=new WeakMap,EK=new WeakMap,_K=new WeakMap,TK=new WeakMap,PK=new WeakMap,MK=new WeakMap,FK=new WeakMap,RK=new WeakMap,NK=new WeakMap,IK=new WeakMap,BK=new WeakMap,QK=new WeakMap,LK=new WeakMap,jK=new WeakMap,$K=new WeakMap,zK=new WeakMap,WK=new WeakMap,VK=new WeakMap,UK=new WeakMap,XK=new WeakMap,qK=new WeakMap,ZK=new WeakMap,HK=new WeakMap,YK=new WeakMap,GK=new WeakMap,KK=new WeakMap,JK=new WeakMap,eJ=new WeakMap,tJ=new WeakMap,nJ=new WeakMap,iJ=new WeakMap,rJ=new WeakMap,sJ=new WeakMap,oJ=new WeakSet;class aJ{static get _keyboardManager(){const e=aJ.prototype,t=e=>tH(nJ,e).contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&e.hasSomethingToControl(),n=(e,t)=>{let{target:n}=t;if(n instanceof HTMLInputElement){const{type:e}=n;return"text"!==e&&"number"!==e}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return mY(this,"_keyboardManager",new lK([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:n}=t;return!(n instanceof HTMLButtonElement)&&tH(nJ,e).contains(n)&&!e.isEnterHandled}}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:n}=t;return!(n instanceof HTMLButtonElement)&&tH(nJ,e).contains(document.activeElement)}}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}constructor(e,t,n,i,r,s,o,a,l,c,u,d,p,f,m,g){iH(this,oJ),KZ(this,hK,new AbortController),KZ(this,dK,null),KZ(this,pK,null),KZ(this,fK,new Map),KZ(this,mK,new Map),KZ(this,gK,null),KZ(this,vK,null),KZ(this,yK,null),KZ(this,OK,new oK),KZ(this,wK,null),KZ(this,bK,null),KZ(this,kK,null),KZ(this,xK,0),KZ(this,DK,new Set),KZ(this,SK,null),KZ(this,CK,null),KZ(this,AK,new Set),h(this,"_editorUndoBar",null),KZ(this,EK,!1),KZ(this,_K,!1),KZ(this,TK,!1),KZ(this,PK,null),KZ(this,MK,null),KZ(this,FK,null),KZ(this,RK,null),KZ(this,NK,!1),KZ(this,IK,null),KZ(this,BK,new HG),KZ(this,QK,!1),KZ(this,LK,!1),KZ(this,jK,!1),KZ(this,$K,null),KZ(this,zK,null),KZ(this,WK,null),KZ(this,VK,null),KZ(this,UK,null),KZ(this,XK,IH.NONE),KZ(this,qK,new Set),KZ(this,ZK,null),KZ(this,HK,null),KZ(this,YK,null),KZ(this,GK,null),KZ(this,KK,null),KZ(this,JK,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),KZ(this,eJ,[0,0]),KZ(this,tJ,null),KZ(this,nJ,null),KZ(this,iJ,null),KZ(this,rJ,null),KZ(this,sJ,null);const v=this._signal=tH(hK,this).signal;nH(nJ,this,e),nH(iJ,this,t),nH(rJ,this,n),nH(gK,this,i),nH(wK,this,r),nH(HK,this,s),nH(KK,this,a),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:v}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),o._on("setpreference",this.onSetPreference.bind(this),{signal:v}),o._on("switchannotationeditorparams",e=>this.updateParams(e.type,e.value),{signal:v}),o._on("pagesedited",this.onPagesEdited.bind(this),{signal:v}),window.addEventListener("pointerdown",()=>{nH(LK,this,!0)},{capture:!0,signal:v}),window.addEventListener("pointerup",()=>{nH(LK,this,!1)},{capture:!0,signal:v}),JZ(oJ,this,pJ).call(this),JZ(oJ,this,wJ).call(this),JZ(oJ,this,gJ).call(this),nH(vK,this,a.annotationStorage),nH(PK,this,a.filterFactory),nH(YK,this,l),nH(RK,this,c||null),nH(EK,this,u),nH(_K,this,d),nH(TK,this,p),nH(UK,this,f||null),this.viewParameters={realScale:BY.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=!1!==g,null===r||void 0===r||r.setSidebarUiManager(this)}destroy(){var e,t,n,i,r,s,o,a,l;null===(e=tH(sJ,this))||void 0===e||e.resolve(),nH(sJ,this,null),null===(t=tH(hK,this))||void 0===t||t.abort(),nH(hK,this,null),this._signal=null;for(const c of tH(mK,this).values())c.destroy();tH(mK,this).clear(),tH(fK,this).clear(),tH(AK,this).clear(),null===(n=tH(VK,this))||void 0===n||n.clear(),nH(dK,this,null),tH(qK,this).clear(),tH(OK,this).destroy(),null===(i=tH(gK,this))||void 0===i||i.destroy(),null===(r=tH(wK,this))||void 0===r||r.destroy(),null===(s=tH(HK,this))||void 0===s||s.destroy(),null===(o=tH(IK,this))||void 0===o||o.hide(),nH(IK,this,null),null===(a=tH(WK,this))||void 0===a||a.destroy(),nH(WK,this,null),nH(pK,this,null),tH(MK,this)&&(clearTimeout(tH(MK,this)),nH(MK,this,null)),tH(tJ,this)&&(clearTimeout(tH(tJ,this)),nH(tJ,this,null)),null===(l=this._editorUndoBar)||void 0===l||l.destroy(),nH(KK,this,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return tH(UK,this)}get useNewAltTextFlow(){return tH(_K,this)}get useNewAltTextWhenAddingImage(){return tH(TK,this)}get hcmFilter(){return mY(this,"hcmFilter",tH(YK,this)?tH(PK,this).addHCMFilter(tH(YK,this).foreground,tH(YK,this).background):"none")}get direction(){return mY(this,"direction",getComputedStyle(tH(nJ,this)).direction)}get _highlightColors(){return mY(this,"_highlightColors",tH(RK,this)?new Map(tH(RK,this).split(",").map(e=>((e=e.split("=").map(e=>e.trim()))[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return mY(this,"highlightColors",null);const t=new Map,n=!!tH(YK,this);for(const[i,r]of e){const e=i.endsWith("_HCM");n&&e?t.set(i.replace("_HCM",""),r):n||e||t.set(i,r)}return mY(this,"highlightColors",t)}get highlightColorNames(){return mY(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),nH(kK,this,e)}setMainHighlightColorPicker(e){nH(WK,this,e)}editAltText(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===(t=tH(gK,this))||void 0===t||t.editAltText(this,e,n)}hasCommentManager(){return!!tH(wK,this)}editComment(e,t,n,i){var r;null===(r=tH(wK,this))||void 0===r||r.showDialog(this,e,t,n,i)}selectComment(e,t){const n=tH(mK,this).get(e),i=null===n||void 0===n?void 0:n.getEditorByUID(t);null===i||void 0===i||i.toggleComment(!0,!0)}updateComment(e){var t;null===(t=tH(wK,this))||void 0===t||t.updateComment(e.getData())}updatePopupColor(e){var t;null===(t=tH(wK,this))||void 0===t||t.updatePopupColor(e)}removeComment(e){var t;null===(t=tH(wK,this))||void 0===t||t.removeComments([e.uid])}deleteComment(e,t){const n=()=>{e.comment=t};this.addCommands({cmd:()=>{var t;null===(t=this._editorUndoBar)||void 0===t||t.show(n,"comment"),this.toggleComment(null),e.comment=null},undo:n,mustExec:!0})}toggleComment(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;null===(n=tH(wK,this))||void 0===n||n.toggleCommentPopup(e,t,i)}makeCommentColor(e,t){var n;return e&&(null===(n=tH(wK,this))||void 0===n?void 0:n.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return(null===(e=tH(wK,this))||void 0===e?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(tH(mK,this).has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),i=n=>{n.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await n}getSignature(e){var t;null===(t=tH(HK,this))||void 0===t||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return tH(HK,this)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference(e){let{name:t,value:n}=e;if("enableNewAltTextWhenAddingImage"===t)nH(TK,this,n)}onPagesEdited(e){let{pagesMapper:t}=e;for(const r of tH(fK,this).values())r.updatePageIndex(t.getPrevPageNumber(r.pageIndex+1)-1);const n=tH(mK,this),i=nH(mK,this,new Map);for(const[r,s]of n){const e=t.getPrevPageNumber(r+1)-1;-1!==e?(i.set(e,s),s.updatePageIndex(e)):s.destroy()}}onPageChanging(e){let{pageNumber:t}=e;nH(xK,this,t-1)}focusMainContainer(){tH(nJ,this).focus()}findParent(e,t){for(const n of tH(mK,this).values()){const{x:i,y:r,width:s,height:o}=n.div.getBoundingClientRect();if(e>=i&&e<=i+s&&t>=r&&t<=r+o)return n}return null}disableUserSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];tH(iJ,this).classList.toggle("noUserSelect",e)}addShouldRescale(e){tH(AK,this).add(e)}removeShouldRescale(e){tH(AK,this).delete(e)}onScaleChanging(e){var t;let{scale:n}=e;this.commitOrRemove(),this.viewParameters.realScale=n*BY.PDF_TO_CSS_UNITS;for(const i of tH(AK,this))i.onScaleChanging();null===(t=tH(kK,this))||void 0===t||t.onScaleChanging()}onRotationChanging(e){let{pagesRotation:t}=e;this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:o}=n,a=n.toString(),l=JZ(oJ,this,lJ).call(this,n).closest(".textLayer"),c=this.getSelectionBoxes(l);if(!c)return;n.empty();const u=JZ(oJ,this,cJ).call(this,l),h=tH(XK,this)===IH.NONE,d=()=>{const n=null===u||void 0===u?void 0:u.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:c,anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:o,text:a});h&&this.showAllEditors("highlight",!0,!0),t&&(null===n||void 0===n||n.editComment())};h?this.switchToMode(IH.HIGHLIGHT,d):d()}commentSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!tH(vK,this))return null;const t="".concat(NH).concat(e),n=tH(vK,this).getRawValue(t);return n&&tH(vK,this).remove(t),n}addToAnnotationStorage(e){e.isEmpty()||!tH(vK,this)||tH(vK,this).has(e.id)||tH(vK,this).setValue(e.id,e)}a11yAlert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=tH(rJ,this);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,tH(NK,this)&&(nH(NK,this,!1),JZ(oJ,this,dJ).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of tH(qK,this))if(t.div.contains(e)){nH(zK,this,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!tH(zK,this))return;const[e,t]=tH(zK,this);nH(zK,this,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){JZ(oJ,this,gJ).call(this),this.setEditingState(!0)}removeEditListeners(){JZ(oJ,this,vJ).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of tH(CK,this))if(n.isHandlingMimeForPasting(t))return e.dataTransfer.dropEffect="copy",void e.preventDefault()}drop(e){for(const t of e.dataTransfer.items)for(const n of tH(CK,this))if(n.isHandlingMimeForPasting(t.type))return n.paste(t,this.currentLayer),void e.preventDefault()}copy(e){var t;if(e.preventDefault(),null===(t=tH(dK,this))||void 0===t||t.commitOrRemove(),!this.hasSelection)return;const n=[];for(const i of tH(qK,this)){const e=i.serialize(!0);e&&n.push(e)}0!==n.length&&e.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const e of tH(CK,this))if(e.isHandlingMimeForPasting(s.type))return void e.paste(s,this.currentLayer);let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(r){return void uY('paste: "'.concat(r.message,'".'))}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const e=[];for(const s of n){const t=await i.deserialize(s);if(!t)return;e.push(t)}const t=()=>{for(const t of e)JZ(oJ,this,SJ).call(this,t);JZ(oJ,this,EJ).call(this,e)},r=()=>{for(const t of e)t.remove()};this.addCommands({cmd:t,undo:r,mustExec:!0})}catch(r){uY('paste: "'.concat(r.message,'".'))}}keydown(e){this.isShiftKeyDown||"Shift"!==e.key||(this.isShiftKeyDown=!0),tH(XK,this)===IH.NONE||this.isEditorHandlingKeyboard||aJ._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&"Shift"===e.key&&(this.isShiftKeyDown=!1,tH(NK,this)&&(nH(NK,this,!1),JZ(oJ,this,dJ).call(this,"main_toolbar")))}onEditingAction(e){let{name:t}=e;switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu")}}setEditingState(e){e?(JZ(oJ,this,fJ).call(this),JZ(oJ,this,yJ).call(this),JZ(oJ,this,bJ).call(this,{isEditing:tH(XK,this)!==IH.NONE,isEmpty:JZ(oJ,this,AJ).call(this),hasSomethingToUndo:tH(OK,this).hasSomethingToUndo(),hasSomethingToRedo:tH(OK,this).hasSomethingToRedo(),hasSelectedEditor:!1})):(JZ(oJ,this,mJ).call(this),JZ(oJ,this,OJ).call(this),JZ(oJ,this,bJ).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!tH(CK,this)){nH(CK,this,e);for(const e of tH(CK,this))JZ(oJ,this,kJ).call(this,e.defaultPropertiesToUpdate)}}getId(){return tH(BK,this).id}get currentLayer(){return tH(mK,this).get(tH(xK,this))}getLayer(e){return tH(mK,this).get(e)}get currentPageIndex(){return tH(xK,this)}addLayer(e){tH(mK,this).set(e.pageIndex,e),tH(QK,this)?e.enable():e.disable()}removeLayer(e){tH(mK,this).delete(e.pageIndex)}async updateMode(e){var t,n;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(tH(XK,this)!==e&&(!tH(sJ,this)||(await tH(sJ,this).promise,tH(sJ,this)))){var l,c;if(nH(sJ,this,Promise.withResolvers()),null===(t=tH(kK,this))||void 0===t||t.commitOrRemove(),tH(XK,this)===IH.POPUP)null===(l=tH(wK,this))||void 0===l||l.hideSidebar();if(null===(n=tH(wK,this))||void 0===n||n.destroyPopup(),nH(XK,this,e),e===IH.NONE){var u;this.setEditingState(!1),JZ(oJ,this,DJ).call(this);for(const e of tH(fK,this).values())e.hideStandaloneCommentButton();return null===(u=this._editorUndoBar)||void 0===u||u.hide(),this.toggleComment(null),void tH(sJ,this).resolve()}for(const e of tH(fK,this).values())e.addStandaloneCommentButton();if(e===IH.SIGNATURE)await(null===(c=tH(HK,this))||void 0===c?void 0:c.loadSignatures());r&&WG.clearPointerType(),this.setEditingState(!0),await JZ(oJ,this,xJ).call(this),this.unselectAll();for(const t of tH(mK,this).values())t.updateMode(e);if(e===IH.POPUP){var h;tH(pK,this)||nH(pK,this,await tH(KK,this).getAnnotationsByType(new Set(tH(CK,this).map(e=>e._editorType))));const e=new Set,t=[];for(const n of tH(fK,this).values()){const{annotationElementId:i,hasComment:r,deleted:s}=n;i&&e.add(i),r&&!s&&t.push(n.getData())}for(const n of tH(pK,this)){const{id:i,popupRef:r,contentsObj:s}=n;r&&null!==s&&void 0!==s&&s.str&&!e.has(i)&&!tH(DK,this).has(i)&&t.push(n)}null===(h=tH(wK,this))||void 0===h||h.showSidebar(t)}if(!i)return s&&this.addNewEditorFromKeyboard(),void tH(sJ,this).resolve();for(const e of tH(fK,this).values())e.uid===i?(this.setSelected(e),a?e.editComment():o?e.enterInEditMode():e.focus()):e.unselect();tH(sJ,this).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==tH(XK,this)&&this._eventBus.dispatch("switchannotationeditormode",p({source:this},e))}updateParams(e,t){if(tH(CK,this)){switch(e){case BH.CREATE:return void this.currentLayer.addNewEditor(t);case BH.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(tH(GK,this)||nH(GK,this,new Map)).set(e,t),this.showAllEditors("highlight",t)}if(this.hasSelection)for(const n of tH(qK,this))n.updateParams(e,t);else for(const n of tH(CK,this))n.updateDefaultParams(e,t)}}showAllEditors(e,t){var n,i;for(const r of tH(fK,this).values())r.editorType===e&&r.show(t);(null===(n=null===(i=tH(GK,this))||void 0===i?void 0:i.get(BH.HIGHLIGHT_SHOW_ALL))||void 0===n||n)!==t&&JZ(oJ,this,kJ).call(this,[[BH.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(tH(jK,this)!==e){nH(jK,this,e);for(const t of tH(mK,this).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of tH(fK,this).values())t.pageIndex===e&&(yield t)}getEditor(e){return tH(fK,this).get(e)}addEditor(e){tH(fK,this).set(e.id,e)}removeEditor(e){var t,n;(e.div.contains(document.activeElement)&&(tH(MK,this)&&clearTimeout(tH(MK,this)),nH(MK,this,setTimeout(()=>{this.focusMainContainer(),nH(MK,this,null)},0))),tH(fK,this).delete(e.id),e.annotationElementId)&&(null===(t=tH(VK,this))||void 0===t||t.delete(e.annotationElementId));(this.unselect(e),e.annotationElementId&&tH(DK,this).has(e.annotationElementId))||(null===(n=tH(vK,this))||void 0===n||n.remove(e.id))}addDeletedAnnotationElement(e){tH(DK,this).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return tH(DK,this).has(e)}removeDeletedAnnotationElement(e){tH(DK,this).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){tH(dK,this)!==e&&(nH(dK,this,e),e&&JZ(oJ,this,kJ).call(this,e.propertiesToUpdate))}updateUI(e){eH(oJ,this,CJ)===e&&JZ(oJ,this,kJ).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){JZ(oJ,this,kJ).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(tH(qK,this).has(e))return tH(qK,this).delete(e),e.unselect(),void JZ(oJ,this,bJ).call(this,{hasSelectedEditor:this.hasSelection});tH(qK,this).add(e),e.select(),JZ(oJ,this,kJ).call(this,e.propertiesToUpdate),JZ(oJ,this,bJ).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),null===(t=tH(kK,this))||void 0===t||t.commitOrRemove();for(const n of tH(qK,this))n!==e&&n.unselect();tH(qK,this).clear(),tH(qK,this).add(e),e.select(),JZ(oJ,this,kJ).call(this,e.propertiesToUpdate),JZ(oJ,this,bJ).call(this,{hasSelectedEditor:!0})}isSelected(e){return tH(qK,this).has(e)}get firstSelectedEditor(){return tH(qK,this).values().next().value}unselect(e){e.unselect(),tH(qK,this).delete(e),JZ(oJ,this,bJ).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==tH(qK,this).size}get isEnterHandled(){return 1===tH(qK,this).size&&this.firstSelectedEditor.isEnterHandled}undo(){var e;tH(OK,this).undo(),JZ(oJ,this,bJ).call(this,{hasSomethingToUndo:tH(OK,this).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:JZ(oJ,this,AJ).call(this)}),null===(e=this._editorUndoBar)||void 0===e||e.hide()}redo(){tH(OK,this).redo(),JZ(oJ,this,bJ).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:tH(OK,this).hasSomethingToRedo(),isEmpty:JZ(oJ,this,AJ).call(this)})}addCommands(e){tH(OK,this).add(e),JZ(oJ,this,bJ).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:JZ(oJ,this,AJ).call(this)})}cleanUndoStack(e){tH(OK,this).cleanType(e)}delete(){var e;this.commitOrRemove();const t=null===(e=this.currentLayer)||void 0===e?void 0:e.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const n=t?[t]:[...tH(qK,this)],i=()=>{for(const e of n)JZ(oJ,this,SJ).call(this,e)};this.addCommands({cmd:()=>{var e;null===(e=this._editorUndoBar)||void 0===e||e.show(i,1===n.length?n[0].editorType:n.length);for(const t of n)t.remove()},undo:i,mustExec:!0})}commitOrRemove(){var e;null===(e=tH(dK,this))||void 0===e||e.commitOrRemove()}hasSomethingToControl(){return tH(dK,this)||this.hasSelection}selectAll(){for(const e of tH(qK,this))e.commit();JZ(oJ,this,EJ).call(this,tH(fK,this).values())}unselectAll(){var e;if((!tH(dK,this)||(tH(dK,this).commitOrRemove(),tH(XK,this)===IH.NONE))&&(null===(e=tH(kK,this))||void 0===e||!e.commitOrRemove())&&this.hasSelection){for(const e of tH(qK,this))e.unselect();tH(qK,this).clear(),JZ(oJ,this,bJ).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.commitOrRemove(),!this.hasSelection)return;tH(eJ,this)[0]+=e,tH(eJ,this)[1]+=t;const[n,i]=tH(eJ,this),r=[...tH(qK,this)];tH(tJ,this)&&clearTimeout(tH(tJ,this)),nH(tJ,this,setTimeout(()=>{nH(tJ,this,null),tH(eJ,this)[0]=tH(eJ,this)[1]=0,this.addCommands({cmd:()=>{for(const e of r)tH(fK,this).has(e.id)&&(e.translateInPage(n,i),e.translationDone())},undo:()=>{for(const e of r)tH(fK,this).has(e.id)&&(e.translateInPage(-n,-i),e.translationDone())},mustExec:!1})},1e3));for(const s of r)s.translateInPage(e,t),s.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),nH(SK,this,new Map);for(const e of tH(qK,this))tH(SK,this).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!tH(SK,this))return!1;this.disableUserSelect(!1);const e=tH(SK,this);nH(SK,this,null);let t=!1;for(const[{x:i,y:r,pageIndex:s},o]of e)o.newX=i,o.newY=r,o.newPageIndex=s,t||(t=i!==o.savedX||r!==o.savedY||s!==o.savedPageIndex);if(!t)return!1;const n=(e,t,n,i)=>{if(tH(fK,this).has(e.id)){const r=tH(mK,this).get(i);r?e._setParentAndPosition(r,t,n):(e.pageIndex=i,e.x=t,e.y=n)}};return this.addCommands({cmd:()=>{for(const[t,{newX:i,newY:r,newPageIndex:s}]of e)n(t,i,r,s)},undo:()=>{for(const[t,{savedX:i,savedY:r,savedPageIndex:s}]of e)n(t,i,r,s)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(tH(SK,this))for(const n of tH(SK,this).keys())n.drag(e,t)}rebuild(e){if(null===e.parent){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return(null===(e=this.getActive())||void 0===e?void 0:e.shouldGetKeyboardEvents())||1===tH(qK,this).size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return tH(dK,this)===e}getActive(){return tH(dK,this)}getMode(){return tH(XK,this)}isEditingMode(){return tH(XK,this)!==IH.NONE}get imageManager(){return mY(this,"imageManager",new eK)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let l=0,c=t.rangeCount;l<c;l++)if(!e.contains(t.getRangeAt(l).commonAncestorContainer))return null;const{x:n,y:i,width:r,height:s}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(e,t,o,a)=>({x:(t-i)/s,y:1-(e+o-n)/r,width:a/s,height:o/r});break;case"180":o=(e,t,o,a)=>({x:1-(e+o-n)/r,y:1-(t+a-i)/s,width:o/r,height:a/s});break;case"270":o=(e,t,o,a)=>({x:1-(t+a-i)/s,y:(e-n)/r,width:a/s,height:o/r});break;default:o=(e,t,o,a)=>({x:(e-n)/r,y:(t-i)/s,width:o/r,height:a/s})}const a=[];for(let l=0,c=t.rangeCount;l<c;l++){const e=t.getRangeAt(l);if(!e.collapsed)for(const{x:t,y:n,width:i,height:r}of e.getClientRects())0!==i&&0!==r&&a.push(o(t,n,i,r))}return 0===a.length?null:a}addChangedExistingAnnotation(e){let{annotationElementId:t,id:n}=e;(tH(yK,this)||nH(yK,this,new Map)).set(t,n)}removeChangedExistingAnnotation(e){var t;let{annotationElementId:n}=e;null===(t=tH(yK,this))||void 0===t||t.delete(n)}renderAnnotationElement(e){var t;const n=null===(t=tH(yK,this))||void 0===t?void 0:t.get(e.data.id);if(!n)return;const i=tH(vK,this).getRawValue(n);i&&(tH(XK,this)!==IH.NONE||i.hasBeenModified)&&i.renderAnnotationElement(e)}setMissingCanvas(e,t,n){var i;const r=null===(i=tH(VK,this))||void 0===i?void 0:i.get(e);r&&(r.setCanvas(t,n),tH(VK,this).delete(e))}addMissingCanvas(e,t){(tH(VK,this)||nH(VK,this,new Map)).set(e,t)}}function lJ(e){let{anchorNode:t}=e;return t.nodeType===Node.TEXT_NODE?t.parentElement:t}function cJ(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of tH(mK,this).values())if(n.hasTextLayer(e))return n;return null}function uJ(){const e=document.getSelection();if(!e||e.isCollapsed)return;const t=JZ(oJ,this,lJ).call(this,e).closest(".textLayer"),n=this.getSelectionBoxes(t);n&&(tH(IK,this)||nH(IK,this,new QG(this)),tH(IK,this).show(t,n,"ltr"===this.direction))}function hJ(){var e;const t=document.getSelection();if(!t||t.isCollapsed){var n;if(tH(ZK,this))null===(n=tH(IK,this))||void 0===n||n.hide(),nH(ZK,this,null),JZ(oJ,this,bJ).call(this,{hasSelectedText:!1});return}const{anchorNode:i}=t;if(i===tH(ZK,this))return;const r=JZ(oJ,this,lJ).call(this,t).closest(".textLayer");var s;if(r){if(null===(e=tH(IK,this))||void 0===e||e.hide(),nH(ZK,this,i),JZ(oJ,this,bJ).call(this,{hasSelectedText:!0}),(tH(XK,this)===IH.HIGHLIGHT||tH(XK,this)===IH.NONE)&&(tH(XK,this)===IH.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),nH(NK,this,this.isShiftKeyDown),!this.isShiftKeyDown)){const e=tH(XK,this)===IH.HIGHLIGHT?JZ(oJ,this,cJ).call(this,r):null;if(null===e||void 0===e||e.toggleDrawing(),tH(LK,this)){const t=new AbortController,n=this.combinedSignal(t),i=n=>{"pointerup"===n.type&&0!==n.button||(t.abort(),null===e||void 0===e||e.toggleDrawing(!0),"pointerup"===n.type&&JZ(oJ,this,dJ).call(this,"main_toolbar"))};window.addEventListener("pointerup",i,{signal:n}),window.addEventListener("blur",i,{signal:n})}else null===e||void 0===e||e.toggleDrawing(!0),JZ(oJ,this,dJ).call(this,"main_toolbar")}}else tH(ZK,this)&&(null===(s=tH(IK,this))||void 0===s||s.hide(),nH(ZK,this,null),JZ(oJ,this,bJ).call(this,{hasSelectedText:!1}))}function dJ(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";tH(XK,this)===IH.HIGHLIGHT?this.highlightSelection(e):tH(EK,this)&&JZ(oJ,this,uJ).call(this)}function pJ(){document.addEventListener("selectionchange",JZ(oJ,this,hJ).bind(this),{signal:this._signal})}function fJ(){if(tH(FK,this))return;nH(FK,this,new AbortController);const e=this.combinedSignal(tH(FK,this));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}function mJ(){var e;null===(e=tH(FK,this))||void 0===e||e.abort(),nH(FK,this,null)}function gJ(){if(tH($K,this))return;nH($K,this,new AbortController);const e=this.combinedSignal(tH($K,this));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}function vJ(){var e;null===(e=tH($K,this))||void 0===e||e.abort(),nH($K,this,null)}function yJ(){if(tH(bK,this))return;nH(bK,this,new AbortController);const e=this.combinedSignal(tH(bK,this));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}function OJ(){var e;null===(e=tH(bK,this))||void 0===e||e.abort(),nH(bK,this,null)}function wJ(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}function bJ(e){const t=Object.entries(e).some(e=>{let[t,n]=e;return tH(JK,this)[t]!==n});t&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(tH(JK,this),e)}),tH(XK,this)===IH.HIGHLIGHT&&!1===e.hasSelectedEditor&&JZ(oJ,this,kJ).call(this,[[BH.HIGHLIGHT_FREE,!0]]))}function kJ(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}async function xJ(){if(!tH(QK,this)){nH(QK,this,!0);const e=[];for(const t of tH(mK,this).values())e.push(t.enable());await Promise.all(e);for(const t of tH(fK,this).values())t.enable()}}function DJ(){if(this.unselectAll(),tH(QK,this)){nH(QK,this,!1);for(const e of tH(mK,this).values())e.disable();for(const e of tH(fK,this).values())e.disable()}}function SJ(e){const t=tH(mK,this).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}function CJ(e){let t=null;for(t of tH(qK,e));return t}function AJ(){if(0===tH(fK,this).size)return!0;if(1===tH(fK,this).size)for(const e of tH(fK,this).values())return e.isEmpty();return!1}function EJ(e){for(const t of tH(qK,this))t.unselect();tH(qK,this).clear();for(const t of e)t.isEmpty()||(tH(qK,this).add(t),t.select());JZ(oJ,this,bJ).call(this,{hasSelectedEditor:this.hasSelection})}h(aJ,"TRANSLATE_SMALL",1),h(aJ,"TRANSLATE_BIG",10);var _J=new WeakMap,TJ=new WeakMap,PJ=new WeakMap,MJ=new WeakMap,FJ=new WeakMap,RJ=new WeakMap,NJ=new WeakMap,IJ=new WeakMap,BJ=new WeakMap,QJ=new WeakMap,LJ=new WeakMap,jJ=new WeakMap,$J=new WeakSet;class zJ{constructor(e){iH(this,$J),KZ(this,_J,null),KZ(this,TJ,!1),KZ(this,PJ,null),KZ(this,MJ,null),KZ(this,FJ,null),KZ(this,RJ,null),KZ(this,NJ,!1),KZ(this,IJ,null),KZ(this,BJ,null),KZ(this,QJ,null),KZ(this,LJ,null),KZ(this,jJ,!1),nH(BJ,this,e),nH(jJ,this,e._uiManager.useNewAltTextFlow),UJ._||(UJ._=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){var t;null!==(t=zJ._l10n)&&void 0!==t||(zJ._l10n=e)}async render(){const e=nH(PJ,this,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=nH(MJ,this,document.createElement("span"));e.append(t),tH(jJ,this)?(e.classList.add("new"),e.setAttribute("data-l10n-id",UJ._.missing),t.setAttribute("data-l10n-id",UJ._["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=tH(BJ,this)._uiManager._signal;e.addEventListener("contextmenu",UY,{signal:n}),e.addEventListener("pointerdown",e=>e.stopPropagation(),{signal:n});const i=e=>{e.preventDefault(),tH(BJ,this)._uiManager.editAltText(tH(BJ,this)),tH(jJ,this)&&tH(BJ,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:eH($J,this,WJ)}})};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(nH(NJ,this,!0),i(t))},{signal:n}),await JZ($J,this,VJ).call(this),e}finish(){tH(PJ,this)&&(tH(PJ,this).focus({focusVisible:tH(NJ,this)}),nH(NJ,this,!1))}isEmpty(){return tH(jJ,this)?null===tH(_J,this):!tH(_J,this)&&!tH(TJ,this)}hasData(){return tH(jJ,this)?null!==tH(_J,this)||!!tH(QJ,this):this.isEmpty()}get guessedText(){return tH(QJ,this)}async setGuessedText(e){null===tH(_J,this)&&(nH(QJ,this,e),nH(LJ,this,await zJ._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),JZ($J,this,VJ).call(this))}toggleAltTextBadge(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;if(!tH(jJ,this)||tH(_J,this))return null===(t=tH(IJ,this))||void 0===t||t.remove(),void nH(IJ,this,null);if(!tH(IJ,this)){const e=nH(IJ,this,document.createElement("div"));e.className="noAltTextBadge",tH(BJ,this).div.append(e)}tH(IJ,this).classList.toggle("hidden",!e)}serialize(e){let t=tH(_J,this);return e||tH(QJ,this)!==t||(t=tH(LJ,this)),{altText:t,decorative:tH(TJ,this),guessedText:tH(QJ,this),textWithDisclaimer:tH(LJ,this)}}get data(){return{altText:tH(_J,this),decorative:tH(TJ,this)}}set data(e){let{altText:t,decorative:n,guessedText:i,textWithDisclaimer:r,cancel:s=!1}=e;i&&(nH(QJ,this,i),nH(LJ,this,r)),tH(_J,this)===t&&tH(TJ,this)===n||(s||(nH(_J,this,t),nH(TJ,this,n)),JZ($J,this,VJ).call(this))}toggle(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];tH(PJ,this)&&(!e&&tH(RJ,this)&&(clearTimeout(tH(RJ,this)),nH(RJ,this,null)),tH(PJ,this).disabled=!e)}shown(){tH(BJ,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:eH($J,this,WJ)}})}destroy(){var e,t;null===(e=tH(PJ,this))||void 0===e||e.remove(),nH(PJ,this,null),nH(MJ,this,null),nH(FJ,this,null),null===(t=tH(IJ,this))||void 0===t||t.remove(),nH(IJ,this,null)}}function WJ(e){return(tH(_J,e)?"added":null===tH(_J,e)&&e.guessedText&&"review")||"missing"}async function VJ(){const e=tH(PJ,this);if(!e)return;if(tH(jJ,this)){var t,n;if(e.classList.toggle("done",!!tH(_J,this)),e.setAttribute("data-l10n-id",UJ._[eH($J,this,WJ)]),null===(t=tH(MJ,this))||void 0===t||t.setAttribute("data-l10n-id",UJ._["".concat(eH($J,this,WJ),"-label")]),!tH(_J,this))return void(null===(n=tH(FJ,this))||void 0===n||n.remove())}else{var i;if(!tH(_J,this)&&!tH(TJ,this))return e.classList.remove("done"),void(null===(i=tH(FJ,this))||void 0===i||i.remove());e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let r=tH(FJ,this);if(!r){nH(FJ,this,r=document.createElement("span")),r.className="tooltip",r.setAttribute("role","tooltip"),r.id="alt-text-tooltip-".concat(tH(BJ,this).id);const t=100,n=tH(BJ,this)._uiManager._signal;n.addEventListener("abort",()=>{clearTimeout(tH(RJ,this)),nH(RJ,this,null)},{once:!0}),e.addEventListener("mouseenter",()=>{nH(RJ,this,setTimeout(()=>{nH(RJ,this,null),tH(FJ,this).classList.add("show"),tH(BJ,this)._reportTelemetry({action:"alt_text_tooltip"})},t))},{signal:n}),e.addEventListener("mouseleave",()=>{var e;tH(RJ,this)&&(clearTimeout(tH(RJ,this)),nH(RJ,this,null)),null===(e=tH(FJ,this))||void 0===e||e.classList.remove("show")},{signal:n})}tH(TJ,this)?r.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(r.removeAttribute("data-l10n-id"),r.textContent=tH(_J,this)),r.parentNode||e.append(r);const s=tH(BJ,this).getElementForAltText();null===s||void 0===s||s.setAttribute("aria-describedby",r.id)}var UJ={_:null};h(zJ,"_l10n",null);var XJ=new WeakMap,qJ=new WeakMap,ZJ=new WeakMap,HJ=new WeakMap,YJ=new WeakMap,GJ=new WeakMap,KJ=new WeakMap,JJ=new WeakMap,e0=new WeakMap,t0=new WeakMap,n0=new WeakSet;class i0{constructor(e){iH(this,n0),KZ(this,XJ,null),KZ(this,qJ,null),KZ(this,ZJ,!1),KZ(this,HJ,null),KZ(this,YJ,null),KZ(this,GJ,null),KZ(this,KJ,null),KZ(this,JJ,null),KZ(this,e0,!1),KZ(this,t0,null),nH(HJ,this,e)}renderForToolbar(){const e=nH(qJ,this,document.createElement("button"));return e.className="comment",JZ(n0,this,r0).call(this,e,!1)}renderForStandalone(){const e=nH(XJ,this,document.createElement("button"));e.className="annotationCommentButton";const t=tH(HJ,this).commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd="calc(".concat(100*("ltr"===tH(HJ,this)._uiManager.direction?1-t[0]:t[0]),"% - var(--comment-button-dim))"),n.top="calc(".concat(100*t[1],"% - var(--comment-button-dim))");const i=tH(HJ,this).commentButtonColor;i&&(n.backgroundColor=i)}return JZ(n0,this,r0).call(this,e,!0)}focusButton(){setTimeout(()=>{var e,t;null===(e=null!==(t=tH(XJ,this))&&void 0!==t?t:tH(qJ,this))||void 0===e||e.focus()},0)}onUpdatedColor(){if(!tH(XJ,this))return;const e=tH(HJ,this).commentButtonColor;e&&(tH(XJ,this).style.backgroundColor=e),tH(HJ,this)._uiManager.updatePopupColor(tH(HJ,this))}get commentButtonWidth(){var e,t;return(null!==(e=null===(t=tH(XJ,this))||void 0===t?void 0:t.getBoundingClientRect().width)&&void 0!==e?e:0)/tH(HJ,this).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(tH(t0,this))return tH(t0,this);if(!tH(XJ,this))return null;const{x:e,y:t,height:n}=tH(XJ,this).getBoundingClientRect(),{x:i,y:r,width:s,height:o}=tH(HJ,this).parent.boundingClientRect;return[(e-i)/s,(t+n-r)/o]}set commentPopupPositionInLayer(e){nH(t0,this,e)}hasDefaultPopupPosition(){return null===tH(t0,this)}removeStandaloneCommentButton(){var e;null===(e=tH(XJ,this))||void 0===e||e.remove(),nH(XJ,this,null)}removeToolbarCommentButton(){var e;null===(e=tH(qJ,this))||void 0===e||e.remove(),nH(qJ,this,null)}setCommentButtonStates(e){let{selected:t,hasPopup:n}=e;tH(XJ,this)&&(tH(XJ,this).classList.toggle("selected",t),tH(XJ,this).ariaExpanded=n)}edit(e){const t=this.commentPopupPositionInLayer;let n,i;if(t)[n,i]=t;else{[n,i]=tH(HJ,this).commentButtonPosition;const{width:e,height:t,x:r,y:s}=tH(HJ,this);n=r+n*e,i=s+i*t}const r=tH(HJ,this).parent.boundingClientRect,{x:s,y:o,width:a,height:l}=r;tH(HJ,this)._uiManager.editComment(tH(HJ,this),s+n*a,o+i*l,p(p({},e),{},{parentDimensions:r}))}finish(){tH(qJ,this)&&(tH(qJ,this).focus({focusVisible:tH(ZJ,this)}),nH(ZJ,this,!1))}isDeleted(){return tH(e0,this)||""===tH(KJ,this)}isEmpty(){return null===tH(KJ,this)}hasBeenEdited(){return this.isDeleted()||tH(KJ,this)!==tH(YJ,this)}serialize(){return this.data}get data(){return{text:tH(KJ,this),richText:tH(GJ,this),date:tH(JJ,this),deleted:this.isDeleted()}}set data(e){if(e!==tH(KJ,this)&&nH(GJ,this,null),null===e)return nH(KJ,this,""),void nH(e0,this,!0);nH(KJ,this,e),nH(JJ,this,new Date),nH(e0,this,!1)}restoreData(e){let{text:t,richText:n,date:i}=e;nH(KJ,this,t),nH(GJ,this,n),nH(JJ,this,i),nH(e0,this,!1)}setInitialText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;nH(YJ,this,e),this.data=e,nH(JJ,this,null),nH(GJ,this,t)}shown(){}destroy(){var e,t;null===(e=tH(qJ,this))||void 0===e||e.remove(),nH(qJ,this,null),null===(t=tH(XJ,this))||void 0===t||t.remove(),nH(XJ,this,null),nH(KJ,this,""),nH(GJ,this,null),nH(JJ,this,null),nH(HJ,this,null),nH(ZJ,this,!1),nH(e0,this,!1)}}function r0(e,t){if(!tH(HJ,this)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[tH(HJ,this)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=tH(HJ,this)._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",UY,{signal:n}),t&&(e.addEventListener("focusin",e=>{tH(HJ,this)._focusEventsAllowed=!1,XY(e)},{capture:!0,signal:n}),e.addEventListener("focusout",e=>{tH(HJ,this)._focusEventsAllowed=!0,XY(e)},{capture:!0,signal:n})),e.addEventListener("pointerdown",e=>e.stopPropagation(),{signal:n});const i=t=>{t.preventDefault(),e===tH(qJ,this)?this.edit():tH(HJ,this).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(nH(ZJ,this,!0),i(t))},{signal:n}),e.addEventListener("pointerenter",()=>{tH(HJ,this).toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{tH(HJ,this).toggleComment(!1,!1)},{signal:n}),e}var s0=new WeakMap,o0=new WeakMap,a0=new WeakMap,l0=new WeakMap,c0=new WeakMap,u0=new WeakMap,h0=new WeakMap,d0=new WeakMap,p0=new WeakMap,f0=new WeakMap,m0=new WeakMap,g0=new WeakMap,v0=new WeakSet;class y0{constructor(e){let{container:t,isPinchingDisabled:n=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:s=null,onPinchEnd:o=null,signal:a}=e;iH(this,v0),KZ(this,s0,void 0),KZ(this,o0,!1),KZ(this,a0,null),KZ(this,l0,void 0),KZ(this,c0,void 0),KZ(this,u0,void 0),KZ(this,h0,void 0),KZ(this,d0,null),KZ(this,p0,void 0),KZ(this,f0,null),KZ(this,m0,void 0),KZ(this,g0,null),nH(s0,this,t),nH(a0,this,i),nH(l0,this,n),nH(c0,this,r),nH(u0,this,s),nH(h0,this,o),nH(m0,this,new AbortController),nH(p0,this,AbortSignal.any([a,tH(m0,this).signal])),t.addEventListener("touchstart",JZ(v0,this,O0).bind(this),{passive:!1,signal:tH(p0,this)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/JY.pixelRatio}destroy(){var e,t;null===(e=tH(m0,this))||void 0===e||e.abort(),nH(m0,this,null),null===(t=tH(d0,this))||void 0===t||t.abort(),nH(d0,this,null)}}function O0(e){var t,n;if(null!==(t=tH(l0,this))&&void 0!==t&&t.call(this))return;if(1===e.touches.length){if(tH(d0,this))return;const e=nH(d0,this,new AbortController),t=AbortSignal.any([tH(p0,this),e.signal]),n=tH(s0,this),i={capture:!0,signal:t,passive:!1},r=e=>{var t;"touch"===e.pointerType&&(null===(t=tH(d0,this))||void 0===t||t.abort(),nH(d0,this,null))};return n.addEventListener("pointerdown",e=>{"touch"===e.pointerType&&(XY(e),r(e))},i),n.addEventListener("pointerup",r,i),void n.addEventListener("pointercancel",r,i)}if(!tH(g0,this)){var i;nH(g0,this,new AbortController);const e=AbortSignal.any([tH(p0,this),tH(g0,this).signal]),t=tH(s0,this),n={signal:e,capture:!1,passive:!1};t.addEventListener("touchmove",JZ(v0,this,w0).bind(this),n);const r=JZ(v0,this,b0).bind(this);t.addEventListener("touchend",r,n),t.addEventListener("touchcancel",r,n),n.capture=!0,t.addEventListener("pointerdown",XY,n),t.addEventListener("pointermove",XY,n),t.addEventListener("pointercancel",XY,n),t.addEventListener("pointerup",XY,n),null===(i=tH(c0,this))||void 0===i||i.call(this)}if(XY(e),2!==e.touches.length||null!==(n=tH(a0,this))&&void 0!==n&&n.call(this))return void nH(f0,this,null);let[r,s]=e.touches;r.identifier>s.identifier&&([r,s]=[s,r]),nH(f0,this,{touch0X:r.screenX,touch0Y:r.screenY,touch1X:s.screenX,touch1Y:s.screenY})}function w0(e){var t;if(!tH(f0,this)||2!==e.touches.length)return;XY(e);let[n,i]=e.touches;n.identifier>i.identifier&&([n,i]=[i,n]);const{screenX:r,screenY:s}=n,{screenX:o,screenY:a}=i,l=tH(f0,this),{touch0X:c,touch0Y:u,touch1X:h,touch1Y:d}=l,p=h-c,f=d-u,m=o-r,g=a-s,v=Math.hypot(m,g)||1,y=Math.hypot(p,f)||1;if(!tH(o0,this)&&Math.abs(y-v)<=lH.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=r,l.touch0Y=s,l.touch1X=o,l.touch1Y=a,!tH(o0,this))return void nH(o0,this,!0);const O=[(r+o)/2,(s+a)/2];null===(t=tH(u0,this))||void 0===t||t.call(this,O,y,v)}function b0(e){if(!(e.touches.length>=2)){var t;if(tH(g0,this))tH(g0,this).abort(),nH(g0,this,null),null===(t=tH(h0,this))||void 0===t||t.call(this);tH(f0,this)&&(XY(e),nH(f0,this,null),nH(o0,this,!1))}}lH=y0;var k0=new WeakMap,x0=new WeakMap,D0=new WeakMap,S0=new WeakMap,C0=new WeakMap,A0=new WeakMap,E0=new WeakMap,_0=new WeakMap,T0=new WeakMap,P0=new WeakMap,M0=new WeakMap,F0=new WeakMap,R0=new WeakMap,N0=new WeakMap,I0=new WeakMap,B0=new WeakMap,Q0=new WeakMap,L0=new WeakMap,j0=new WeakMap,$0=new WeakMap,z0=new WeakMap,W0=new WeakMap,V0=new WeakMap,U0=new WeakMap,X0=new WeakMap,q0=new WeakMap,Z0=new WeakSet;class H0{static get _resizerKeyboardManager(){const e=H0.prototype._resizeWithKeyboard,t=aJ.TRANSLATE_SMALL,n=aJ.TRANSLATE_BIG;return mY(this,"_resizerKeyboardManager",new lK([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],H0.prototype._stopResizingWithKeyboard]]))}constructor(e){iH(this,Z0),KZ(this,k0,null),KZ(this,x0,null),KZ(this,D0,null),KZ(this,S0,null),KZ(this,C0,null),KZ(this,A0,!1),KZ(this,E0,null),KZ(this,_0,""),KZ(this,T0,null),KZ(this,P0,null),KZ(this,M0,null),KZ(this,F0,null),KZ(this,R0,null),KZ(this,N0,""),KZ(this,I0,!1),KZ(this,B0,null),KZ(this,Q0,!1),KZ(this,L0,!1),KZ(this,j0,!1),KZ(this,$0,null),KZ(this,z0,0),KZ(this,W0,0),KZ(this,V0,null),KZ(this,U0,null),h(this,"isSelected",!1),h(this,"_isCopy",!1),h(this,"_editToolbar",null),h(this,"_initialOptions",Object.create(null)),h(this,"_initialData",null),h(this,"_isVisible",!0),h(this,"_uiManager",null),h(this,"_focusEventsAllowed",!0),KZ(this,X0,!1),KZ(this,q0,H0._zIndex++),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:r,pageY:s}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[r,s];const[o,a]=this.parentDimensions;this.x=e.x/o,this.y=e.y/a,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(e){this.pageIndex=e}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return mY(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new m1({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){var n;if(null!==(n=H0._l10n)&&void 0!==n||(H0._l10n=e),H0._l10nResizer||(H0._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),-1!==H0._borderLineWidth)return;const i=getComputedStyle(document.documentElement);H0._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){hY("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return tH(X0,this)}set _isDraggable(e){var t;nH(X0,this,e),null===(t=this.div)||void 0===t||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=tH(q0,this)}setParent(e){var t;null!==e?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(JZ(Z0,this,f1).call(this),null===(t=tH(F0,this))||void 0===t||t.remove(),nH(F0,this,null));this.parent=e}focusin(e){this._focusEventsAllowed&&(tH(I0,this)?nH(I0,this,!1):this.parent.setSelected(this))}focusout(e){var t;if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const n=e.relatedTarget;null!==n&&void 0!==n&&n.closest("#".concat(this.id))||(e.preventDefault(),null!==(t=this.parent)&&void 0!==t&&t.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[r,s]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/r,this.y=(t+i)/s,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i),this._onTranslated()}translate(e,t){JZ(Z0,this,Y0).call(this,this.parentDimensions,e,t)}translateInPage(e,t){tH(B0,this)||nH(B0,this,[this.x,this.y,this.width,this.height]),JZ(Z0,this,Y0).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){tH(B0,this)||nH(B0,this,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:o}=this;const[a,l]=this.getBaseTranslation();s+=a,o+=l;const{style:c}=n;c.left="".concat((100*s).toFixed(2),"%"),c.top="".concat((100*o).toFixed(2),"%"),this._onTranslating(s,o),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!tH(B0,this)&&(tH(B0,this)[0]!==this.x||tH(B0,this)[1]!==this.y)}get _hasBeenResized(){return!!tH(B0,this)&&(tH(B0,this)[2]!==this.width||tH(B0,this)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=H0,i=n/e,r=n/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rotation;const{div:{style:t},pageDimensions:[n,i]}=this;let{x:r,y:s,width:o,height:a}=this;if(o*=n,a*=i,r*=n,s*=i,this._mustFixPosition)switch(e){case 0:r=FY(r,0,n-o),s=FY(s,0,i-a);break;case 90:r=FY(r,0,n-a),s=FY(s,o,i);break;case 180:r=FY(r,o,n),s=FY(s,a,i);break;case 270:r=FY(r,a,n),s=FY(s,0,i-o)}this.x=r/=n,this.y=s/=i;const[l,c]=this.getBaseTranslation();r+=l,s+=c,t.left="".concat((100*r).toFixed(2),"%"),t.top="".concat((100*s).toFixed(2),"%"),this.moveInDOM()}screenToPageTranslation(e,t){return G0.call(H0,e,t,this.parentRotation)}pageTranslationToScreen(e,t){return G0.call(H0,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width="".concat((100*t).toFixed(2),"%"),e.height="".concat((100*n).toFixed(2),"%")}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(1e4*e)/1e4}_onResizing(){}altTextFinish(){var e;null===(e=tH(D0,this))||void 0===e||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||tH(L0,this))return this._editToolbar;this._editToolbar=new AG(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;null===(e=this._editToolbar)||void 0===e||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;null===(e=this._editToolbar)||void 0===e||e.removeButton("comment")}removeEditToolbar(){var e,t;null===(e=this._editToolbar)||void 0===e||e.remove(),this._editToolbar=null,null===(t=tH(D0,this))||void 0===t||t.destroy()}addContainer(e){var t;const n=null===(t=this._editToolbar)||void 0===t?void 0:t.div;n?n.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return tH(D0,this)||(zJ.initialize(H0._l10n),nH(D0,this,new zJ(this)),tH(k0,this)&&(tH(D0,this).data=tH(k0,this),nH(k0,this,null))),tH(D0,this)}get altTextData(){var e;return null===(e=tH(D0,this))||void 0===e?void 0:e.data}set altTextData(e){tH(D0,this)&&(tH(D0,this).data=e)}get guessedAltText(){var e;return null===(e=tH(D0,this))||void 0===e?void 0:e.guessedText}async setGuessedAltText(e){var t;await(null===(t=tH(D0,this))||void 0===t?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return null===(t=tH(D0,this))||void 0===t?void 0:t.serialize(e)}hasAltText(){return!!tH(D0,this)&&!tH(D0,this).isEmpty()}hasAltTextData(){var e,t;return null!==(e=null===(t=tH(D0,this))||void 0===t?void 0:t.hasData())&&void 0!==e&&e}focusCommentButton(){var e;null===(e=tH(S0,this))||void 0===e||e.focusButton()}addCommentButton(){return this.canAddComment?tH(S0,this)||nH(S0,this,new i0(this)):null}addStandaloneCommentButton(){this._uiManager.hasCommentManager()&&(tH(C0,this)?this._uiManager.isEditingMode()&&tH(C0,this).classList.remove("hidden"):this.hasComment&&(nH(C0,this,tH(S0,this).renderForStandalone()),this.div.append(tH(C0,this))))}removeStandaloneCommentButton(){tH(S0,this).removeStandaloneCommentButton(),nH(C0,this,null)}hideStandaloneCommentButton(){var e;null===(e=tH(C0,this))||void 0===e||e.classList.add("hidden")}get comment(){var e;if(!tH(S0,this))return null;const{data:{richText:t,text:n,date:i,deleted:r}}=tH(S0,this);return{text:n,richText:t,date:i,deleted:r,color:this.getNonHCMColor(),opacity:null!==(e=this.opacity)&&void 0!==e?e:1}}set comment(e){tH(S0,this)||nH(S0,this,new i0(this)),"object"===typeof e&&null!==e?tH(S0,this).restoreData(e):tH(S0,this).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData(e){let{comment:t,popupRef:n,richText:i}=e;if(!n)return;if(tH(S0,this)||nH(S0,this,new i0(this)),tH(S0,this).setInitialText(t,i),!this.annotationElementId)return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){var e;return null===(e=tH(S0,this))||void 0===e?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return null===(e=tH(S0,this))||void 0===e?void 0:e.isDeleted()}get hasComment(){return!!tH(S0,this)&&!tH(S0,this).isEmpty()&&!tH(S0,this).isDeleted()}async editComment(e){tH(S0,this)||nH(S0,this,new i0(this)),tH(S0,this).edit(e)}toggleComment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){tH(S0,this).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const t=180,n=100,[,,,i]=e.rect,[r]=this.pageDimensions,[s]=this.pageTranslation,o=s+r+1,a=i-n,l=o+t;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,a,l,i]}}}updateFromAnnotationLayer(e){let{popup:{contents:t,deleted:n}}=e;tH(S0,this).data=n?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var e;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=tH(A0,this)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),JZ(Z0,this,c1).call(this);const[n,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth="".concat((100*i/n).toFixed(2),"%"),t.style.maxHeight="".concat((100*n/i).toFixed(2),"%"));const[r,s]=this.getInitialTranslation();return this.translate(r,s),zG(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(tH(U0,this)||nH(U0,this,new y0({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:JZ(Z0,this,r1).bind(this),onPinching:JZ(Z0,this,s1).bind(this),onPinchEnd:JZ(Z0,this,o1).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),null===(e=this._uiManager._editorUndoBar)||void 0===e||e.hide(),t}pointerdown(e){const{isMac:t}=DY.platform;0!==e.button||e.ctrlKey&&t?e.preventDefault():(nH(I0,this,!0),this._isDraggable?JZ(Z0,this,l1).call(this,e):JZ(Z0,this,a1).call(this,e))}_onStartDragging(){}_onStopDragging(){}moveInDOM(){tH($0,this)&&clearTimeout(tH($0,this)),nH($0,this,setTimeout(()=>{var e;nH($0,this,null),null===(e=this.parent)||void 0===e||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotation;const i=this.parentScale,[r,s]=this.pageDimensions,[o,a]=this.pageTranslation,l=e/i,c=t/i,u=this.x*r,h=this.y*s,d=this.width*r,p=this.height*s;switch(n){case 0:return[u+l+o,s-h-c-p+a,u+l+d+o,s-h-c+a];case 90:return[u+c+o,s-h+l+a,u+c+p+o,s-h+l+d+a];case 180:return[u-l-d+o,s-h+c+a,u-l+o,s-h+c+p+a];case 270:return[u-c-p+o,s-h-l-d+a,u-c+o,s-h-l+a];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,r,s]=e,o=r-n,a=s-i;switch(this.rotation){case 0:return[n,t-s,o,a];case 90:return[n,t-i,a,o];case 180:return[r,t-i,o,a];case 270:return[r,t-s,a,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&H0._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;null===(e=tH(S0,this))||void 0===e||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:i,deleted:r,richText:s},uid:o,pageIndex:a,creationDate:l,modificationDate:c}=this;return{id:o,pageIndex:a,rect:this.getPDFRect(),richText:s,contentsObj:{str:e},creationDate:l,modificationDate:n||c,popupRef:!r,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return!this.isInEditMode()&&(this.parent.setEditingState(!1),nH(L0,this,!0),!0)}disableEditMode(){return!!this.isInEditMode()&&(this.parent.setEditingState(!0),nH(L0,this,!1),!0)}isInEditMode(){return tH(L0,this)}shouldGetKeyboardEvents(){return tH(j0,this)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:s}=window;return t<s&&i>0&&e<r&&n>0}rebuild(){JZ(Z0,this,c1).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:(null===(e=this._initialData)||void 0===e?void 0:e.popupRef)||""}}serialize(){var e;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:(null===(e=this._initialData)||void 0===e?void 0:e.popupRef)||""}}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,nH(k0,i,e.accessibilityData),i._isCopy=e.isCopy||!1;const[r,s]=i.pageDimensions,[o,a,l,c]=i.getRectInCurrentCoords(e.rect,s);return i.x=o/r,i.y=a/s,i.width=l/r,i.height=c/s,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){var e,t,n;if(null===(e=tH(R0,this))||void 0===e||e.abort(),nH(R0,this,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),tH($0,this)&&(clearTimeout(tH($0,this)),nH($0,this,null)),JZ(Z0,this,f1).call(this),this.removeEditToolbar(),tH(V0,this)){for(const e of tH(V0,this).values())clearTimeout(e);nH(V0,this,null)}this.parent=null,null===(t=tH(U0,this))||void 0===t||t.destroy(),nH(U0,this,null),null===(n=tH(F0,this))||void 0===n||n.remove(),nH(F0,this,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(JZ(Z0,this,J0).call(this),tH(T0,this).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return"ltr"===this._uiManager.direction?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,i,r,s]=this.getPDFRect();return[H0._round(n+(r-n)*e),H0._round(i+(s-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return tH(S0,this).commentPopupPositionInLayer}set commentPopupPosition(e){tH(S0,this).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return tH(S0,this).hasDefaultPopupPosition()}get commentButtonWidth(){return tH(S0,this).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;null===(t=tH(S0,this))||void 0===t||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||"Enter"!==e.key)return;this._uiManager.setSelected(this),nH(M0,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=tH(T0,this).children;if(!tH(x0,this)){nH(x0,this,Array.from(t));const e=JZ(Z0,this,u1).bind(this),n=JZ(Z0,this,h1).bind(this),i=this._uiManager._signal;for(const t of tH(x0,this)){const r=t.getAttribute("data-resizer-name");t.setAttribute("role","spinbutton"),t.addEventListener("keydown",e,{signal:i}),t.addEventListener("blur",n,{signal:i}),t.addEventListener("focus",JZ(Z0,this,d1).bind(this,r),{signal:i}),t.setAttribute("data-l10n-id",H0._l10nResizer[r])}}const n=tH(x0,this)[0];let i=0;for(const s of t){if(s===n)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(tH(x0,this).length/4);if(r!==i){if(r<i)for(let t=0;t<i-r;t++)tH(T0,this).append(tH(T0,this).firstElementChild);else if(r>i)for(let t=0;t<r-i;t++)tH(T0,this).firstElementChild.before(tH(T0,this).lastElementChild);let e=0;for(const n of t){const t=tH(x0,this)[e++].getAttribute("data-resizer-name");n.setAttribute("data-l10n-id",H0._l10nResizer[t])}}JZ(Z0,this,p1).call(this,0),nH(j0,this,!0),tH(T0,this).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){tH(j0,this)&&JZ(Z0,this,i1).call(this,tH(N0,this),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){JZ(Z0,this,f1).call(this),this.div.focus()}select(){var e,t,n;this.isSelected&&this._editToolbar?this._editToolbar.show():(this.isSelected=!0,this.makeResizable(),null===(e=this.div)||void 0===e||e.classList.add("selectedEditor"),this._editToolbar?(null===(t=this._editToolbar)||void 0===t||t.show(),null===(n=tH(D0,this))||void 0===n||n.toggleAltTextBadge(!1)):this.addEditToolbar().then(()=>{var e,t;null!==(e=this.div)&&void 0!==e&&e.classList.contains("selectedEditor")&&(null===(t=this._editToolbar)||void 0===t||t.show())}))}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return null===(e=this.div)||void 0===e?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,n,i,r;this.isSelected&&(this.isSelected=!1,null===(e=tH(T0,this))||void 0===e||e.classList.add("hidden"),null===(t=this.div)||void 0===t||t.classList.remove("selectedEditor"),null!==(n=this.div)&&void 0!==n&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),null===(i=this._editToolbar)||void 0===i||i.hide(),null===(r=tH(D0,this))||void 0===r||r.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){"BUTTON"!==e.target.nodeName&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return tH(Q0,this)}set isEditing(e){nH(Q0,this,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){tH(V0,this)||nH(V0,this,new Map);const{action:t}=e;let n=tH(V0,this).get(t);return n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),tH(V0,this).delete(t),0===tH(V0,this).size&&nH(V0,this,null)},H0._telemetryTimeout),void tH(V0,this).set(t,n)}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),nH(A0,this,!1)}disable(){this.div&&(this.div.tabIndex=-1),nH(A0,this,!0)}updateFakeAnnotationElement(e){if(tH(F0,this)||this.deleted)return this.deleted?(tH(F0,this).remove(),void nH(F0,this,null)):void((this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&tH(F0,this).updateEdited({rect:this.getPDFRect(),popup:this.comment}));nH(F0,this,e.addFakeAnnotation(this))}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(t){if("CANVAS"===t.nodeName){const e=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.before(t)}}else t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;"DIV"===(null===t||void 0===t?void 0:t.nodeName)&&t.classList.contains("annotationContent")&&t.remove()}}function Y0(e,t,n){let[i,r]=e;[t,n]=this.screenToPageTranslation(t,n),this.x+=t/i,this.y+=n/r,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}function G0(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}function K0(e){switch(e){case 90:{const[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}}function J0(){if(tH(T0,this))return;nH(T0,this,document.createElement("div")),tH(T0,this).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const e=document.createElement("div");tH(T0,this).append(e),e.classList.add("resizer",n),e.setAttribute("data-resizer-name",n),e.addEventListener("pointerdown",JZ(Z0,this,e1).bind(this,n),{signal:t}),e.addEventListener("contextmenu",UY,{signal:t}),e.tabIndex=-1}this.div.prepend(tH(T0,this))}function e1(e,t){var n;t.preventDefault();const{isMac:i}=DY.platform;if(0!==t.button||t.ctrlKey&&i)return;null===(n=tH(D0,this))||void 0===n||n.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,nH(P0,this,[t.screenX,t.screenY]);const s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",JZ(Z0,this,i1).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",XY,{passive:!1,signal:o}),window.addEventListener("contextmenu",UY,{signal:o}),nH(M0,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var e;s.abort(),this.parent.togglePointerEvents(!0),null===(e=tH(D0,this))||void 0===e||e.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=a,this.div.style.cursor=l,JZ(Z0,this,n1).call(this)};window.addEventListener("pointerup",c,{signal:o}),window.addEventListener("blur",c,{signal:o})}function t1(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}function n1(){if(!tH(M0,this))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=tH(M0,this);nH(M0,this,null);const r=this.x,s=this.y,o=this.width,a=this.height;r===e&&s===t&&o===n&&a===i||this.addCommands({cmd:JZ(Z0,this,t1).bind(this,r,s,o,a),undo:JZ(Z0,this,t1).bind(this,e,t,n,i),mustExec:!0})}function i1(e,t){const[n,i]=this.parentDimensions,r=this.x,s=this.y,o=this.width,a=this.height,l=cH.MIN_SIZE/n,c=cH.MIN_SIZE/i,u=JZ(Z0,this,K0).call(this,this.rotation),h=(e,t)=>[u[0]*e+u[2]*t,u[1]*e+u[3]*t],d=JZ(Z0,this,K0).call(this,360-this.rotation);let p,f,m=!1,g=!1;switch(e){case"topLeft":m=!0,p=(e,t)=>[0,0],f=(e,t)=>[e,t];break;case"topMiddle":p=(e,t)=>[e/2,0],f=(e,t)=>[e/2,t];break;case"topRight":m=!0,p=(e,t)=>[e,0],f=(e,t)=>[0,t];break;case"middleRight":g=!0,p=(e,t)=>[e,t/2],f=(e,t)=>[0,t/2];break;case"bottomRight":m=!0,p=(e,t)=>[e,t],f=(e,t)=>[0,0];break;case"bottomMiddle":p=(e,t)=>[e/2,t],f=(e,t)=>[e/2,0];break;case"bottomLeft":m=!0,p=(e,t)=>[0,t],f=(e,t)=>[e,0];break;case"middleLeft":g=!0,p=(e,t)=>[0,t/2],f=(e,t)=>[e,t/2]}const v=p(o,a),y=f(o,a);let O=h(...y);const w=cH._round(r+O[0]),b=cH._round(s+O[1]);let k,x,D=1,S=1;if(t.fromKeyboard)({deltaX:k,deltaY:x}=t);else{const{screenX:e,screenY:n}=t,[i,r]=tH(P0,this);[k,x]=this.screenToPageTranslation(e-i,n-r),tH(P0,this)[0]=e,tH(P0,this)[1]=n}var C,A;if([k,x]=(C=k/n,A=x/i,[d[0]*C+d[2]*A,d[1]*C+d[3]*A]),m){const e=Math.hypot(o,a);D=S=Math.max(Math.min(Math.hypot(y[0]-v[0]-k,y[1]-v[1]-x)/e,1/o,1/a),l/o,c/a)}else g?D=FY(Math.abs(y[0]-v[0]-k),l,1)/o:S=FY(Math.abs(y[1]-v[1]-x),c,1)/a;const E=cH._round(o*D),_=cH._round(a*S);O=h(...f(E,_));const T=w-O[0],P=b-O[1];tH(B0,this)||nH(B0,this,[this.x,this.y,this.width,this.height]),this.width=E,this.height=_,this.x=T,this.y=P,this.setDims(),this.fixAndSetPosition(),this._onResizing()}function r1(){var e;nH(M0,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),null===(e=tH(D0,this))||void 0===e||e.toggle(!1),this.parent.togglePointerEvents(!1)}function s1(e,t,n){let i=n/t*.7+1-.7;if(1===i)return;const r=JZ(Z0,this,K0).call(this,this.rotation),s=(e,t)=>[r[0]*e+r[2]*t,r[1]*e+r[3]*t],[o,a]=this.parentDimensions,l=this.x,c=this.y,u=this.width,h=this.height,d=cH.MIN_SIZE/o,p=cH.MIN_SIZE/a;i=Math.max(Math.min(i,1/u,1/h),d/u,p/h);const f=cH._round(u*i),m=cH._round(h*i);if(f===u&&m===h)return;tH(B0,this)||nH(B0,this,[l,c,u,h]);const g=s(u/2,h/2),v=cH._round(l+g[0]),y=cH._round(c+g[1]),O=s(f/2,m/2);this.x=v-O[0],this.y=y-O[1],this.width=f,this.height=m,this.setDims(),this.fixAndSetPosition(),this._onResizing()}function o1(){var e;null===(e=tH(D0,this))||void 0===e||e.toggle(!0),this.parent.togglePointerEvents(!0),JZ(Z0,this,n1).call(this)}function a1(e){const{isMac:t}=DY.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}function l1(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),s={capture:!0,passive:!1,signal:r},o=e=>{i.abort(),nH(E0,this,null),nH(I0,this,!1),this._uiManager.endDragSession()||JZ(Z0,this,a1).call(this,e),n&&this._onStopDragging()};t&&(nH(z0,this,e.clientX),nH(W0,this,e.clientY),nH(E0,this,e.pointerId),nH(_0,this,e.pointerType),window.addEventListener("pointermove",e=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:t,clientY:i,pointerId:r}=e;if(r!==tH(E0,this))return void XY(e);const[s,o]=this.screenToPageTranslation(t-tH(z0,this),i-tH(W0,this));nH(z0,this,t),nH(W0,this,i),this._uiManager.dragSelectedEditors(s,o)},s),window.addEventListener("touchmove",XY,s),window.addEventListener("pointerdown",e=>{e.pointerType===tH(_0,this)&&(tH(U0,this)||e.isPrimary)&&o(e),XY(e)},s));const a=e=>{tH(E0,this)&&tH(E0,this)!==e.pointerId?XY(e):o(e)};window.addEventListener("pointerup",a,{signal:r}),window.addEventListener("blur",a,{signal:r})}function c1(){if(tH(R0,this)||!this.div)return;nH(R0,this,new AbortController);const e=this._uiManager.combinedSignal(tH(R0,this));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}function u1(e){cH._resizerKeyboardManager.exec(this,e)}function h1(e){var t;tH(j0,this)&&(null===(t=e.relatedTarget)||void 0===t?void 0:t.parentNode)!==tH(T0,this)&&JZ(Z0,this,f1).call(this)}function d1(e){nH(N0,this,tH(j0,this)?e:"")}function p1(e){if(tH(x0,this))for(const t of tH(x0,this))t.tabIndex=e}function f1(){nH(j0,this,!1),JZ(Z0,this,p1).call(this,-1),JZ(Z0,this,n1).call(this)}cH=H0,h(H0,"_l10n",null),h(H0,"_l10nResizer",null),h(H0,"_borderLineWidth",-1),h(H0,"_colorManager",new uK),h(H0,"_zIndex",1),h(H0,"_telemetryTimeout",1e3);class m1 extends H0{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const g1=3285377520,v1=4294901760,y1=65535;class O1{constructor(e){this.h1=e?4294967295&e:g1,this.h2=e?4294967295&e:g1}update(e){let t,n;if("string"===typeof e){t=new Uint8Array(2*e.length),n=0;for(let i=0,r=e.length;i<r;i++){const r=e.charCodeAt(i);r<=255?t[n++]=r:(t[n++]=r>>>8,t[n++]=255&r)}}else{if(!ArrayBuffer.isView(e))throw new Error("Invalid data format, must be a string or TypedArray.");t=e.slice(),n=t.byteLength}const i=n>>2,r=n-4*i,s=new Uint32Array(t.buffer,0,i);let o=0,a=0,l=this.h1,c=this.h2;const u=3432918353,h=461845907,d=11601,p=13715;for(let f=0;f<i;f++)1&f?(o=s[f],o=o*u&v1|o*d&y1,o=o<<15|o>>>17,o=o*h&v1|o*p&y1,l^=o,l=l<<13|l>>>19,l=5*l+3864292196):(a=s[f],a=a*u&v1|a*d&y1,a=a<<15|a>>>17,a=a*h&v1|a*p&y1,c^=a,c=c<<13|c>>>19,c=5*c+3864292196);switch(o=0,r){case 3:o^=t[4*i+2]<<16;case 2:o^=t[4*i+1]<<8;case 1:o^=t[4*i],o=o*u&v1|o*d&y1,o=o<<15|o>>>17,o=o*h&v1|o*p&y1,1&i?l^=o:c^=o}this.h1=l,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&v1|36045*e&y1,t=4283543511*t&v1|(2950163797*(t<<16|e>>>16)&v1)>>>16,e^=t>>>1,e=444984403*e&v1|60499*e&y1,t=3301882366*t&v1|(3120437893*(t<<16|e>>>16)&v1)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const w1=Object.freeze({map:null,hash:"",transfer:void 0});var b1=new WeakMap,k1=new WeakMap,x1=new WeakMap,D1=new WeakMap,S1=new WeakSet;class C1{constructor(){iH(this,S1),KZ(this,b1,!1),KZ(this,k1,null),KZ(this,x1,null),KZ(this,D1,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=tH(D1,this).get(e);return void 0===n?t:Object.assign(t,n)}getRawValue(e){return tH(D1,this).get(e)}remove(e){const t=tH(D1,this).get(e);if(void 0!==t&&(t instanceof H0&&tH(x1,this).delete(t.annotationElementId),tH(D1,this).delete(e),0===tH(D1,this).size&&this.resetModified(),"function"===typeof this.onAnnotationEditor)){for(const e of tH(D1,this).values())if(e instanceof H0)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=tH(D1,this).get(e);let i=!1;if(void 0!==n)for(const[r,s]of Object.entries(t))n[r]!==s&&(i=!0,n[r]=s);else i=!0,tH(D1,this).set(e,t);i&&JZ(S1,this,A1).call(this),t instanceof H0&&((tH(x1,this)||nH(x1,this,new Map)).set(t.annotationElementId,t),"function"===typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type))}has(e){return tH(D1,this).has(e)}get size(){return tH(D1,this).size}resetModified(){tH(b1,this)&&(nH(b1,this,!1),"function"===typeof this.onResetModified&&this.onResetModified())}get print(){return new _1(this)}get serializable(){if(0===tH(D1,this).size)return w1;const e=new Map,t=new O1,n=[],i=Object.create(null);let r=!1;for(const[s,o]of tH(D1,this)){const n=o instanceof H0?o.serialize(!1,i):o;o.page&&(o.pageIndex=o.page._pageIndex,delete o.page),n&&(e.set(s,n),t.update("".concat(s,":").concat(JSON.stringify(n))),r||(r=!!n.bitmap))}if(r)for(const s of e.values())s.bitmap&&n.push(s.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:w1}get editorStats(){let e=null;const t=new Map;let n=0,i=0;for(const o of tH(D1,this).values()){var r;if(!(o instanceof H0)){o.popup&&(o.popup.deleted?i+=1:n+=1);continue}o.isCommentDeleted?i+=1:o.hasEditedComment&&(n+=1);const a=o.telemetryFinalData;if(!a)continue;const{type:l}=a;t.has(l)||t.set(l,Object.getPrototypeOf(o).constructor),e||(e=Object.create(null));const c=(r=e)[l]||(r[l]=new Map);for(const[e,t]of Object.entries(a)){var s;if("type"===e)continue;let n=c.get(e);n||(n=new Map,c.set(e,n));const i=null!==(s=n.get(t))&&void 0!==s?s:0;n.set(t,i+1)}}if((i>0||n>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:n}),!e)return null;for(const[o,a]of t)e[o]=a.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){nH(k1,this,null)}updateEditor(e,t){var n;const i=null===(n=tH(x1,this))||void 0===n?void 0:n.get(e);return!!i&&(i.updateFromAnnotationLayer(t),!0)}getEditor(e){var t;return(null===(t=tH(x1,this))||void 0===t?void 0:t.get(e))||null}get modifiedIds(){if(tH(k1,this))return tH(k1,this);const e=[];if(tH(x1,this))for(const t of tH(x1,this).values())t.serialize()&&e.push(t.annotationElementId);return nH(k1,this,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return tH(D1,this).entries()}}function A1(){tH(b1,this)||(nH(b1,this,!0),"function"===typeof this.onSetModified&&this.onSetModified())}var E1=new WeakMap;class _1 extends C1{constructor(e){super(),KZ(this,E1,void 0);const{map:t,hash:n,transfer:i}=e.serializable,r=structuredClone(t,i?{transfer:i}:null);nH(E1,this,{map:r,hash:n,transfer:i})}get print(){hY("Should not call PrintAnnotationStorage.print")}get serializable(){return tH(E1,this)}get modifiedIds(){return mY(this,"modifiedIds",{ids:new Set,hash:""})}}var T1=new WeakMap;class P1{constructor(e){let{ownerDocument:t=globalThis.document,styleElement:n=null}=e;KZ(this,T1,new Set),this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),tH(T1,this).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(e){let{systemFontInfo:t,disableFontFace:n,_inspectFont:i}=e;if(t&&!tH(T1,this).has(t.loadedName)){if(dY(!n,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:e,src:n,style:s}=t,o=new FontFace(e,n,s);this.addNativeFontFace(o);try{await o.load(),tH(T1,this).add(e),null===i||void 0===i||i(t)}catch(r){uY("Cannot load system font: ".concat(t.baseFontName,", installing it could help to improve PDF rendering.")),this.removeNativeFontFace(o)}return}hY("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo)return void await this.loadSystemFont(e);if(this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(n){throw uY("Failed to load font '".concat(t.family,"': '").concat(n,"'.")),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(t=>{const n=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){var e;return mY(this,"isFontLoadingAPISupported",!(null===(e=this._document)||void 0===e||!e.fonts))}get isSyncFontLoadingSupported(){return mY(this,"isSyncFontLoadingSupported",xH||DY.platform.isFirefox)}_queueLoadingCallback(e){const{loadingRequests:t}=this,n={done:!1,complete:function(){for(dY(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.length>0&&t[0].done;){const e=t.shift();setTimeout(e.callback,0)}},callback:e};return t.push(n),n}get _loadTestFont(){return mY(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t){function n(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function i(e,t,n,i){return e.substring(0,t)+i+e.substring(t+n)}let r,s;const o=this._document.createElement("canvas");o.width=1,o.height=1;const a=o.getContext("2d");let l=0;const c="lt".concat(Date.now()).concat(this.loadTestFontId++);let u=this._loadTestFont;u=i(u,976,c.length,c);const h=1482184792;let d=n(u,16);for(r=0,s=c.length-3;r<s;r+=4)d=d-h+n(c,r)|0;r<c.length&&(d=d-h+n(c+"XXX",r)|0),u=i(u,16,4,function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}(d));const p="url(data:font/opentype;base64,".concat(btoa(u),");"),f='@font-face {font-family:"'.concat(c,'";src:').concat(p,"}");this.insertRule(f);const m=this._document.createElement("div");m.style.visibility="hidden",m.style.width=m.style.height="10px",m.style.position="absolute",m.style.top=m.style.left="0px";for(const g of[e.loadedName,c]){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=g,m.append(e)}this._document.body.append(m),function e(t,n){if(++l>30)return uY("Load test font never loaded."),void n();a.font="30px "+t,a.fillText(".",0,20),a.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(c,()=>{m.remove(),t.complete()})}}var M1=new WeakMap;class F1{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;KZ(this,M1,void 0),this.compiledGlyphs=Object.create(null),nH(M1,this,e),this._inspectFont=t,n&&Object.assign(this,n),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style="oblique ".concat(this.cssFontInfo.italicAngle,"deg")),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return null===(e=this._inspectFont)||void 0===e||e.call(this,this),t}createFontFaceRule(){var e;if(!this.data||this.disableFontFace)return null;const t="url(data:".concat(this.mimetype,";base64,").concat(this.data.toBase64(),");");let n;if(this.cssFontInfo){let e="font-weight: ".concat(this.cssFontInfo.fontWeight,";");this.cssFontInfo.italicAngle&&(e+="font-style: oblique ".concat(this.cssFontInfo.italicAngle,"deg;")),n='@font-face {font-family:"'.concat(this.cssFontInfo.fontFamily,'";').concat(e,"src:").concat(t,"}")}else n='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(t,"}");return null===(e=this._inspectFont)||void 0===e||e.call(this,this,t),n}getPathGenerator(e,t){var n;if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let r;try{r=e.get(i)}catch(o){uY('getPathGenerator - ignoring character: "'.concat(o,'".'))}const s=lG(null===(n=r)||void 0===n?void 0:n.path);return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=s}get black(){return tH(M1,this).black}get bold(){return tH(M1,this).bold}get disableFontFace(){var e;return null!==(e=tH(M1,this).disableFontFace)&&void 0!==e&&e}set disableFontFace(e){mY(this,"disableFontFace",!!e)}get fontExtraProperties(){var e;return null!==(e=tH(M1,this).fontExtraProperties)&&void 0!==e&&e}get isInvalidPDFjsFont(){return tH(M1,this).isInvalidPDFjsFont}get isType3Font(){return tH(M1,this).isType3Font}get italic(){return tH(M1,this).italic}get missingFile(){return tH(M1,this).missingFile}get remeasure(){return tH(M1,this).remeasure}get vertical(){return tH(M1,this).vertical}get ascent(){return tH(M1,this).ascent}get defaultWidth(){return tH(M1,this).defaultWidth}get descent(){return tH(M1,this).descent}get bbox(){return tH(M1,this).bbox}set bbox(e){mY(this,"bbox",e)}get fontMatrix(){return tH(M1,this).fontMatrix}get fallbackName(){return tH(M1,this).fallbackName}get loadedName(){return tH(M1,this).loadedName}get mimetype(){return tH(M1,this).mimetype}get name(){return tH(M1,this).name}get data(){return tH(M1,this).data}clearData(){tH(M1,this).clearData()}get cssFontInfo(){return tH(M1,this).cssFontInfo}get systemFontInfo(){return tH(M1,this).systemFontInfo}get defaultVMetrics(){return tH(M1,this).defaultVMetrics}}var R1=new WeakMap,N1=new WeakMap,I1=new WeakMap,B1=new WeakSet;class Q1{static write(e){const t=new TextEncoder,n={};let i=0;for(const l of Q1.strings){const r=t.encode(e[l]);n[l]=r,i+=4+r.length}const r=new ArrayBuffer(i),s=new Uint8Array(r),o=new DataView(r);let a=0;for(const l of Q1.strings){const e=n[l],t=e.length;o.setUint32(a,t),s.set(e,a+4),a+=4+t}return dY(a===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}constructor(e){iH(this,B1),KZ(this,R1,void 0),KZ(this,N1,void 0),KZ(this,I1,void 0),nH(R1,this,e),nH(N1,this,new DataView(tH(R1,this))),nH(I1,this,new TextDecoder)}get fontFamily(){return JZ(B1,this,L1).call(this,0)}get fontWeight(){return JZ(B1,this,L1).call(this,1)}get italicAngle(){return JZ(B1,this,L1).call(this,2)}}function L1(e){dY(e<uH.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=tH(N1,this).getUint32(t)+4;const n=tH(N1,this).getUint32(t);return tH(I1,this).decode(new Uint8Array(tH(R1,this),t+4,n))}uH=Q1,h(Q1,"strings",["fontFamily","fontWeight","italicAngle"]);var j1=new WeakMap,$1=new WeakMap,z1=new WeakMap,W1=new WeakSet;class V1{static write(e){const t=new TextEncoder,n={};let i=0;for(const h of V1.strings){const r=t.encode(e[h]);n[h]=r,i+=4+r.length}i+=4;let r,s,o=1+i;e.style&&(r=t.encode(e.style.style),s=t.encode(e.style.weight),o+=4+r.length+4+s.length);const a=new ArrayBuffer(o),l=new Uint8Array(a),c=new DataView(a);let u=0;c.setUint8(u++,e.guessFallback?1:0),c.setUint32(u,0),u+=4,i=0;for(const h of V1.strings){const e=n[h],t=e.length;i+=4+t,c.setUint32(u,t),l.set(e,u+4),u+=4+t}return c.setUint32(u-i-4,i),e.style&&(c.setUint32(u,r.length),l.set(r,u+4),u+=4+r.length,c.setUint32(u,s.length),l.set(s,u+4),u+=4+s.length),dY(u<=a.byteLength,"SubstitionInfo.write: Buffer overflow"),a.transferToFixedLength(u)}constructor(e){iH(this,W1),KZ(this,j1,void 0),KZ(this,$1,void 0),KZ(this,z1,void 0),nH(j1,this,e),nH($1,this,new DataView(tH(j1,this))),nH(z1,this,new TextDecoder)}get guessFallback(){return 0!==tH($1,this).getUint8(0)}get css(){return JZ(W1,this,U1).call(this,0)}get loadedName(){return JZ(W1,this,U1).call(this,1)}get baseFontName(){return JZ(W1,this,U1).call(this,2)}get src(){return JZ(W1,this,U1).call(this,3)}get style(){let e=1;e+=4+tH($1,this).getUint32(e);const t=tH($1,this).getUint32(e),n=tH(z1,this).decode(new Uint8Array(tH(j1,this),e+4,t));e+=4+t;const i=tH($1,this).getUint32(e);return{style:n,weight:tH(z1,this).decode(new Uint8Array(tH(j1,this),e+4,i))}}}function U1(e){dY(e<hH.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=tH($1,this).getUint32(t)+4;const n=tH($1,this).getUint32(t);return tH(z1,this).decode(new Uint8Array(tH(j1,this),t+4,n))}hH=V1,h(V1,"strings",["css","loadedName","baseFontName","src"]);var X1=new WeakMap,q1=new WeakMap,Z1=new WeakMap,H1=new WeakSet;class Y1{constructor(e){let{data:t,extra:n}=e;iH(this,H1),KZ(this,X1,void 0),KZ(this,q1,void 0),KZ(this,Z1,void 0),nH(X1,this,t),nH(q1,this,new TextDecoder),nH(Z1,this,new DataView(tH(X1,this))),n&&Object.assign(this,n)}get black(){return JZ(H1,this,G1).call(this,0)}get bold(){return JZ(H1,this,G1).call(this,1)}get disableFontFace(){return JZ(H1,this,G1).call(this,2)}get fontExtraProperties(){return JZ(H1,this,G1).call(this,3)}get isInvalidPDFjsFont(){return JZ(H1,this,G1).call(this,4)}get isType3Font(){return JZ(H1,this,G1).call(this,5)}get italic(){return JZ(H1,this,G1).call(this,6)}get missingFile(){return JZ(H1,this,G1).call(this,7)}get remeasure(){return JZ(H1,this,G1).call(this,8)}get vertical(){return JZ(H1,this,G1).call(this,9)}get ascent(){return JZ(H1,this,K1).call(this,0)}get defaultWidth(){return JZ(H1,this,K1).call(this,1)}get descent(){return JZ(H1,this,K1).call(this,2)}get bbox(){let e=t2._;if(0===tH(Z1,this).getUint8(e))return;e+=1;const t=[];for(let n=0;n<4;n++)t.push(tH(Z1,this).getInt16(e,!0)),e+=2;return t}get fontMatrix(){let e=n2._;if(0===tH(Z1,this).getUint8(e))return;e+=1;const t=[];for(let n=0;n<6;n++)t.push(tH(Z1,this).getFloat64(e,!0)),e+=8;return t}get defaultVMetrics(){let e=i2._;if(0===tH(Z1,this).getUint8(e))return;e+=1;const t=[];for(let n=0;n<3;n++)t.push(tH(Z1,this).getInt16(e,!0)),e+=2;return t}get fallbackName(){return JZ(H1,this,J1).call(this,0)}get loadedName(){return JZ(H1,this,J1).call(this,1)}get mimetype(){return JZ(H1,this,J1).call(this,2)}get name(){return JZ(H1,this,J1).call(this,3)}get data(){let e=r2._;e+=4+tH(Z1,this).getUint32(e);e+=4+tH(Z1,this).getUint32(e);e+=4+tH(Z1,this).getUint32(e);const t=tH(Z1,this).getUint32(e);if(0!==t)return new Uint8Array(tH(X1,this),e+4,t)}clearData(){let e=r2._;e+=4+tH(Z1,this).getUint32(e);e+=4+tH(Z1,this).getUint32(e);e+=4+tH(Z1,this).getUint32(e);const t=tH(Z1,this).getUint32(e);new Uint8Array(tH(X1,this),e+4,t).fill(0),tH(Z1,this).setUint32(e,0)}get cssFontInfo(){let e=r2._;e+=4+tH(Z1,this).getUint32(e);e+=4+tH(Z1,this).getUint32(e);const t=tH(Z1,this).getUint32(e);if(0===t)return null;const n=new Uint8Array(t);return n.set(new Uint8Array(tH(X1,this),e+4,t)),new Q1(n.buffer)}get systemFontInfo(){let e=r2._;e+=4+tH(Z1,this).getUint32(e);const t=tH(Z1,this).getUint32(e);if(0===t)return null;const n=new Uint8Array(t);return n.set(new Uint8Array(tH(X1,this),e+4,t)),new V1(n.buffer)}static write(e){const t=e.systemFontInfo?V1.write(e.systemFontInfo):null,n=e.cssFontInfo?Q1.write(e.cssFontInfo):null,i=new TextEncoder,r={};let s=0;for(const f of Y1.strings)r[f]=i.encode(e[f]),s+=4+r[f].length;const o=r2._+4+s+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),a=new ArrayBuffer(o),l=new Uint8Array(a),c=new DataView(a);let u=0;const h=Y1.bools.length;let d=0,p=0;for(let f=0;f<h;f++){const t=e[Y1.bools[f]];d|=(void 0===t?0:t?2:1)<<p,p+=2,8!==p&&f!==h-1||(c.setUint8(u++,d),d=0,p=0)}dY(u===e2._,"FontInfo.write: Boolean properties offset mismatch");for(const f of Y1.numbers)c.setFloat64(u,e[f]),u+=8;if(dY(u===t2._,"FontInfo.write: Number properties offset mismatch"),e.bbox){c.setUint8(u++,4);for(const t of e.bbox)c.setInt16(u,t,!0),u+=2}else c.setUint8(u++,0),u+=8;if(dY(u===n2._,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){c.setUint8(u++,6);for(const t of e.fontMatrix)c.setFloat64(u,t,!0),u+=8}else c.setUint8(u++,0),u+=48;if(dY(u===i2._,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){c.setUint8(u++,1);for(const t of e.defaultVMetrics)c.setInt16(u,t,!0),u+=2}else c.setUint8(u++,0),u+=6;dY(u===r2._,"FontInfo.write: DefaultVMetrics properties offset mismatch"),c.setUint32(r2._,0),u+=4;for(const f of Y1.strings){const e=r[f],t=e.length;c.setUint32(u,t),l.set(e,u+4),u+=4+t}if(c.setUint32(r2._,u-r2._-4),t){const e=t.byteLength;c.setUint32(u,e),dY(u+4+e<=a.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),l.set(new Uint8Array(t),u+4),u+=4+e}else c.setUint32(u,0),u+=4;if(n){const e=n.byteLength;c.setUint32(u,e),dY(u+4+e<=a.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),l.set(new Uint8Array(n),u+4),u+=4+e}else c.setUint32(u,0),u+=4;return void 0===e.data?(c.setUint32(u,0),u+=4):(c.setUint32(u,e.data.length),l.set(e.data,u+4),u+=4+e.data.length),dY(u<=a.byteLength,"FontInfo.write: Buffer overflow"),a.transferToFixedLength(u)}}function G1(e){dY(e<dH.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=2*e%8,i=tH(Z1,this).getUint8(t)>>n&3;return 0===i?void 0:2===i}function K1(e){return dY(e<dH.numbers.length,"Invalid number index"),tH(Z1,this).getFloat64(e2._+8*e)}function J1(e){dY(e<dH.strings.length,"Invalid string index");let t=r2._+4;for(let r=0;r<e;r++)t+=tH(Z1,this).getUint32(t)+4;const n=tH(Z1,this).getUint32(t),i=new Uint8Array(n);return i.set(new Uint8Array(tH(X1,this),t+4,n)),tH(q1,this).decode(i)}dH=Y1,h(Y1,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),h(Y1,"numbers",["ascent","defaultWidth","descent"]),h(Y1,"strings",["fallbackName","loadedName","mimetype","name"]);var e2={_:Math.ceil(2*dH.bools.length/8)},t2={_:JZ(dH,dH,e2)._+8*dH.numbers.length},n2={_:JZ(dH,dH,t2)._+1+8},i2={_:JZ(dH,dH,n2)._+1+48},r2={_:JZ(dH,dH,i2)._+1+6};class s2{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,i=[],r=[],s=[],o=[],a=null,l=null;switch(e[0]){case"RadialAxial":t="axial"===e[1]?1:2,n=e[2],s=e[3],1===t?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,a=e[1],i=e[2],r=e[3],o=e[4]||[],n=e[6],l=e[7];break;default:throw new Error("Unsupported pattern type: ".concat(e[0]))}const c=Math.floor(i.length/2),u=Math.floor(r.length/3),h=s.length,d=o.length;let p=0;for(const y of o)p+=1,p=4*Math.ceil(p/4),p+=4+4*y.coords.length,p+=4+4*y.colors.length,void 0!==y.verticesPerRow&&(p+=4);const f=new ArrayBuffer(20+8*c+3*u+8*h+(n?16:0)+(l?3:0)+p),m=new DataView(f),g=new Uint8Array(f);m.setUint8(o2._,t),m.setUint8(a2._,n?1:0),m.setUint8(l2._,l?1:0),m.setUint8(c2._,a),m.setUint32(u2._,c,!0),m.setUint32(h2._,u,!0),m.setUint32(d2._,h,!0),m.setUint32(p2._,d,!0);let v=20;new Float32Array(f,v,2*c).set(i),v+=8*c,g.set(r,v),v+=3*u;for(const[y,O]of s)m.setFloat32(v,y,!0),v+=4,m.setUint32(v,parseInt(O.slice(1),16),!0),v+=4;if(n)for(const y of n)m.setFloat32(v,y,!0),v+=4;l&&(g.set(l,v),v+=3);for(let y=0;y<o.length;y++){const e=o[y];m.setUint8(v,e.type),v+=1,v=4*Math.ceil(v/4),m.setUint32(v,e.coords.length,!0),v+=4;new Int32Array(f,v,e.coords.length).set(e.coords),v+=4*e.coords.length,m.setUint32(v,e.colors.length,!0),v+=4;new Int32Array(f,v,e.colors.length).set(e.colors),v+=4*e.colors.length,void 0!==e.verticesPerRow&&(m.setUint32(v,e.verticesPerRow,!0),v+=4)}return f}getIR(){const e=this.view,t=this.data[o2._],n=!!this.data[a2._],i=!!this.data[l2._],r=e.getUint32(u2._,!0),s=e.getUint32(h2._,!0),o=e.getUint32(d2._,!0),a=e.getUint32(p2._,!0);let l=20;const c=new Float32Array(this.buffer,l,2*r);l+=8*r;const u=new Uint8Array(this.buffer,l,3*s);l+=3*s;const h=[];for(let m=0;m<o;++m){const t=e.getFloat32(l,!0);l+=4;const n=e.getUint32(l,!0);l+=4,h.push([t,"#".concat(n.toString(16).padStart(6,"0"))])}let d=null;if(n){d=[];for(let t=0;t<4;++t)d.push(e.getFloat32(l,!0)),l+=4}let p=null;i&&(p=new Uint8Array(this.buffer,l,3),l+=3);const f=[];for(let m=0;m<a;++m){const t=e.getUint8(l);l+=1,l=4*Math.ceil(l/4);const n=e.getUint32(l,!0);l+=4;const i=new Int32Array(this.buffer,l,n);l+=4*n;const r=e.getUint32(l,!0);l+=4;const s=new Int32Array(this.buffer,l,r);l+=4*r;const o={type:t,coords:i,colors:s};t===LH&&(o.verticesPerRow=e.getUint32(l,!0),l+=4),f.push(o)}if(1===t)return["RadialAxial","axial",d,h,Array.from(c.slice(0,2)),Array.from(c.slice(2,4)),null,null];if(2===t)return["RadialAxial","radial",d,h,[c[0],c[1]],[c[3],c[4]],c[2],c[5]];if(3===t){const e=this.data[c2._];let t=null;if(c.length>0){let e=c[0],n=c[0],i=c[1],r=c[1];for(let t=0;t<c.length;t+=2){const s=c[t],o=c[t+1];e=e>s?s:e,i=i>o?o:i,n=n<s?s:n,r=r<o?o:r}t=[e,i,n,r]}return["Mesh",e,c,u,f,t,d,p]}throw new Error("Unsupported pattern kind: ".concat(t))}}var o2={_:0},a2={_:1},l2={_:2},c2={_:3},u2={_:4},h2={_:8},d2={_:12},p2={_:16},f2=new WeakMap;class m2{static write(e){let t,n;return DY.isFloat16ArraySupported?(n=new ArrayBuffer(2*e.length),t=new Float16Array(n)):(n=new ArrayBuffer(4*e.length),t=new Float32Array(n)),t.set(e),n}constructor(e){KZ(this,f2,void 0),nH(f2,this,e)}get path(){return DY.isFloat16ArraySupported?new Float16Array(tH(f2,this)):new Float32Array(tH(f2,this))}}function g2(e){if("string"!==typeof e)return null;if(e.endsWith("/"))return e;throw new Error('Invalid factory url: "'.concat(e,'" must include trailing slash.'))}const v2=e=>"object"===typeof e&&Number.isInteger(null===e||void 0===e?void 0:e.num)&&e.num>=0&&Number.isInteger(null===e||void 0===e?void 0:e.gen)&&e.gen>=0,y2=function(e,t,n){if(!Array.isArray(n)||n.length<2)return!1;const[i,r,...s]=n;if(!e(i)&&!Number.isInteger(i))return!1;if(!t(r))return!1;const o=s.length;let a=!0;switch(r.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return 0===o;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(4!==o)return!1;a=!1;break;default:return!1}for(const l of s)if(!("number"===typeof l||a&&null===l))return!1;return!0}.bind(null,v2,e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name));var O2=new WeakMap,w2=new WeakMap;class b2{constructor(){KZ(this,O2,new Map),KZ(this,w2,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};tH(w2,this).then(()=>{for(const[e]of tH(O2,this))e.call(this,n)})}addEventListener(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=null;if((null===n||void 0===n?void 0:n.signal)instanceof AbortSignal){const{signal:r}=n;if(r.aborted)return void uY("LoopbackPort - cannot use an `aborted` signal.");const s=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",s),r.addEventListener("abort",s)}tH(O2,this).set(t,i)}removeEventListener(e,t){const n=tH(O2,this).get(t);null===n||void 0===n||n(),tH(O2,this).delete(t)}terminate(){for(const[,e]of tH(O2,this))null===e||void 0===e||e();tH(O2,this).clear()}}const k2=1,x2=2,D2=1,S2=2,C2=3,A2=4,E2=5,_2=6,T2=7,P2=8;function M2(){}function F2(e){if(e instanceof kY||e instanceof OY||e instanceof vY||e instanceof wY||e instanceof yY)return e;switch(e instanceof Error||"object"===typeof e&&null!==e||hY('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new kY(e.message);case"InvalidPDFException":return new OY(e.message);case"PasswordException":return new vY(e.message,e.code);case"ResponseException":return new wY(e.message,e.status,e.missing);case"UnknownErrorException":return new yY(e.message,e.details)}return new yY(e.message,e.toString())}var R2=new WeakMap,N2=new WeakSet;class I2{constructor(e,t,n){iH(this,N2),KZ(this,R2,new AbortController),this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",JZ(N2,this,B2).bind(this),{signal:tH(R2,this).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error('There is already an actionName called "'.concat(e,'"'));n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(s){r.reject(s)}return r.promise}sendWithStream(e,t,n,i){const r=this.streamId++,s=this.sourceName,o=this.targetName,a=this.comObj;return new ReadableStream({start:n=>{const l=Promise.withResolvers();return this.streamControllers[r]={controller:n,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},a.postMessage({sourceName:s,targetName:o,action:e,streamId:r,data:t,desiredSize:n.desiredSize},i),l.promise},pull:e=>{const t=Promise.withResolvers();return this.streamControllers[r].pullCall=t,a.postMessage({sourceName:s,targetName:o,stream:_2,streamId:r,desiredSize:e.desiredSize}),t.promise},cancel:e=>{dY(e instanceof Error,"cancel must have a valid reason");const t=Promise.withResolvers();return this.streamControllers[r].cancelCall=t,this.streamControllers[r].isClosed=!0,a.postMessage({sourceName:s,targetName:o,stream:D2,streamId:r,reason:F2(e)}),t.promise}},n)}destroy(){var e;null===(e=tH(R2,this))||void 0===e||e.abort(),nH(R2,this,null)}}function B2(e){let{data:t}=e;if(t.targetName!==this.sourceName)return;if(t.stream)return void JZ(N2,this,L2).call(this,t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error("Cannot resolve callback ".concat(e));if(delete this.callbackCapabilities[e],t.callback===k2)n.resolve(t.data);else{if(t.callback!==x2)throw new Error("Unexpected callback case");n.reject(F2(t.reason))}return}const n=this.actionHandler[t.action];if(!n)throw new Error("Unknown action from worker: ".concat(t.action));if(t.callbackId){const e=this.sourceName,i=t.sourceName,r=this.comObj;return void Promise.try(n,t.data).then(function(n){r.postMessage({sourceName:e,targetName:i,callback:k2,callbackId:t.callbackId,data:n})},function(n){r.postMessage({sourceName:e,targetName:i,callback:x2,callbackId:t.callbackId,reason:F2(n)})})}t.streamId?JZ(N2,this,Q2).call(this,t):n(t.data)}function Q2(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,r=this.comObj,s=this,o=this.actionHandler[e.action],a={enqueue(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const a=this.desiredSize;this.desiredSize-=s,a>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:n,targetName:i,stream:A2,streamId:t,chunk:e},o)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:i,stream:C2,streamId:t}),delete s.streamSinks[t])},error(e){dY(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:i,stream:E2,streamId:t,reason:F2(e)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};a.sinkCapability.resolve(),a.ready=a.sinkCapability.promise,this.streamSinks[t]=a,Promise.try(o,e.data,a).then(function(){r.postMessage({sourceName:n,targetName:i,stream:P2,streamId:t,success:!0})},function(e){r.postMessage({sourceName:n,targetName:i,stream:P2,streamId:t,reason:F2(e)})})}function L2(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,r=this.comObj,s=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case P2:e.success?s.startCall.resolve():s.startCall.reject(F2(e.reason));break;case T2:e.success?s.pullCall.resolve():s.pullCall.reject(F2(e.reason));break;case _2:if(!o){r.postMessage({sourceName:n,targetName:i,stream:T2,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||M2).then(function(){r.postMessage({sourceName:n,targetName:i,stream:T2,streamId:t,success:!0})},function(e){r.postMessage({sourceName:n,targetName:i,stream:T2,streamId:t,reason:F2(e)})});break;case A2:if(dY(s,"enqueue should have stream controller"),s.isClosed)break;s.controller.enqueue(e.chunk);break;case C2:if(dY(s,"close should have stream controller"),s.isClosed)break;s.isClosed=!0,s.controller.close(),JZ(N2,this,j2).call(this,s,t);break;case E2:dY(s,"error should have stream controller"),s.controller.error(F2(e.reason)),JZ(N2,this,j2).call(this,s,t);break;case S2:e.success?s.cancelCall.resolve():s.cancelCall.reject(F2(e.reason)),JZ(N2,this,j2).call(this,s,t);break;case D2:if(!o)break;const a=F2(e.reason);Promise.try(o.onCancel||M2,a).then(function(){r.postMessage({sourceName:n,targetName:i,stream:S2,streamId:t,success:!0})},function(e){r.postMessage({sourceName:n,targetName:i,stream:S2,streamId:t,reason:F2(e)})}),o.sinkCapability.reject(a),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async function j2(e,t){var n,i,r;await Promise.allSettled([null===(n=e.startCall)||void 0===n?void 0:n.promise,null===(i=e.pullCall)||void 0===i?void 0:i.promise,null===(r=e.cancelCall)||void 0===r?void 0:r.promise]),delete this.streamControllers[t]}var $2=new WeakMap;class z2{constructor(e){let{enableHWA:t=!1}=e;KZ(this,$2,!1),nH($2,this,t)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!tH($2,this)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){hY("Abstract method `_createCanvas` called.")}}class W2 extends z2{constructor(e){let{ownerDocument:t=globalThis.document,enableHWA:n=!1}=e;super({enableHWA:n}),this._document=t}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class V2{constructor(e){let{baseUrl:t=null,isCompressed:n=!0}=e;this.baseUrl=t,this.isCompressed=n}async fetch(e){let{name:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const n=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(n).then(e=>({cMapData:e,isCompressed:this.isCompressed})).catch(e=>{throw new Error("Unable to load ".concat(this.isCompressed?"binary ":"","CMap at: ").concat(n))})}async _fetch(e){hY("Abstract method `_fetch` called.")}}class U2 extends V2{async _fetch(e){const t=await QY(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):xY(t)}}class X2{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,r){return"none"}destroy(){}}var q2=new WeakMap,Z2=new WeakMap,H2=new WeakMap,Y2=new WeakMap,G2=new WeakMap,K2=new WeakMap,J2=new WeakMap,e3=new WeakSet;class t3 extends X2{constructor(e){let{docId:t,ownerDocument:n=globalThis.document}=e;super(),iH(this,e3),KZ(this,q2,void 0),KZ(this,Z2,void 0),KZ(this,H2,void 0),KZ(this,Y2,void 0),KZ(this,G2,void 0),KZ(this,K2,void 0),KZ(this,J2,0),nH(Y2,this,t),nH(G2,this,n)}addFilter(e){var t,n;if(!e)return"none";let i=eH(e3,this,n3).get(e);if(i)return i;const[r,s,o]=JZ(e3,this,s3).call(this,e),a=1===e.length?r:"".concat(r).concat(s).concat(o);if(i=eH(e3,this,n3).get(a),i)return eH(e3,this,n3).set(e,i),i;const l="g_".concat(tH(Y2,this),"_transfer_map_").concat((nH(J2,this,(t=tH(J2,this),n=t++,t)),n)),c=JZ(e3,this,o3).call(this,l);eH(e3,this,n3).set(e,c),eH(e3,this,n3).set(a,c);const u=JZ(e3,this,c3).call(this,l);return JZ(e3,this,h3).call(this,r,s,o,u),c}addHCMFilter(e,t){var n;const i="".concat(e,"-").concat(t),r="base";let s=eH(e3,this,i3).get(r);if((null===(n=s)||void 0===n?void 0:n.key)===i)return s.url;var o;s?(null===(o=s.filter)||void 0===o||o.remove(),s.key=i,s.url="none",s.filter=null):(s={key:i,url:"none",filter:null},eH(e3,this,i3).set(r,s));if(!e||!t)return s.url;const a=JZ(e3,this,p3).call(this,e);e=CY.makeHexColor(...a);const l=JZ(e3,this,p3).call(this,t);if(t=CY.makeHexColor(...l),eH(e3,this,r3).style.color="","#000000"===e&&"#ffffff"===t||e===t)return s.url;const c=new Array(256);for(let f=0;f<=255;f++){const e=f/255;c[f]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const u=c.join(","),h="g_".concat(tH(Y2,this),"_hcm_filter"),d=s.filter=JZ(e3,this,c3).call(this,h);JZ(e3,this,h3).call(this,u,u,u,d),JZ(e3,this,l3).call(this,d);const p=(e,t)=>{const n=a[e]/255,i=l[e]/255,r=new Array(t+1);for(let s=0;s<=t;s++)r[s]=n+s/t*(i-n);return r.join(",")};return JZ(e3,this,h3).call(this,p(0,5),p(1,5),p(2,5),d),s.url=JZ(e3,this,o3).call(this,h),s.url}addAlphaFilter(e){var t,n;let i=eH(e3,this,n3).get(e);if(i)return i;const[r]=JZ(e3,this,s3).call(this,[e]),s="alpha_".concat(r);if(i=eH(e3,this,n3).get(s),i)return eH(e3,this,n3).set(e,i),i;const o="g_".concat(tH(Y2,this),"_alpha_map_").concat((nH(J2,this,(t=tH(J2,this),n=t++,t)),n)),a=JZ(e3,this,o3).call(this,o);eH(e3,this,n3).set(e,a),eH(e3,this,n3).set(s,a);const l=JZ(e3,this,c3).call(this,o);return JZ(e3,this,d3).call(this,r,l),a}addLuminosityFilter(e){var t,n;let i,r,s=eH(e3,this,n3).get(e||"luminosity");if(s)return s;if(e?([i]=JZ(e3,this,s3).call(this,[e]),r="luminosity_".concat(i)):r="luminosity",s=eH(e3,this,n3).get(r),s)return eH(e3,this,n3).set(e,s),s;const o="g_".concat(tH(Y2,this),"_luminosity_map_").concat((nH(J2,this,(t=tH(J2,this),n=t++,t)),n)),a=JZ(e3,this,o3).call(this,o);eH(e3,this,n3).set(e,a),eH(e3,this,n3).set(r,a);const l=JZ(e3,this,c3).call(this,o);return JZ(e3,this,a3).call(this,l),e&&JZ(e3,this,d3).call(this,i,l),a}addHighlightHCMFilter(e,t,n,i,r){var s;const o="".concat(t,"-").concat(n,"-").concat(i,"-").concat(r);let a=eH(e3,this,i3).get(e);if((null===(s=a)||void 0===s?void 0:s.key)===o)return a.url;var l;a?(null===(l=a.filter)||void 0===l||l.remove(),a.key=o,a.url="none",a.filter=null):(a={key:o,url:"none",filter:null},eH(e3,this,i3).set(e,a));if(!t||!n)return a.url;const[c,u]=[t,n].map(JZ(e3,this,p3).bind(this));let h=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[p,f]=[i,r].map(JZ(e3,this,p3).bind(this));d<h&&([h,d,p,f]=[d,h,f,p]),eH(e3,this,r3).style.color="";const m=(e,t,n)=>{const i=new Array(256),r=(d-h)/n,s=e/255,o=(t-e)/(255*n);let a=0;for(let l=0;l<=n;l++){const e=Math.round(h+l*r),t=s+l*o;for(let n=a;n<=e;n++)i[n]=t;a=e+1}for(let l=a;l<256;l++)i[l]=i[a-1];return i.join(",")},g="g_".concat(tH(Y2,this),"_hcm_").concat(e,"_filter"),v=a.filter=JZ(e3,this,c3).call(this,g);return JZ(e3,this,l3).call(this,v),JZ(e3,this,h3).call(this,m(p[0],f[0],5),m(p[1],f[1],5),m(p[2],f[2],5),v),a.url=JZ(e3,this,o3).call(this,g),a.url}destroy(){var e,t,n,i;arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&null!==(e=tH(K2,this))&&void 0!==e&&e.size||(null===(t=tH(H2,this))||void 0===t||t.parentNode.parentNode.remove(),nH(H2,this,null),null===(n=tH(Z2,this))||void 0===n||n.clear(),nH(Z2,this,null),null===(i=tH(K2,this))||void 0===i||i.clear(),nH(K2,this,null),nH(J2,this,0))}}function n3(e){return tH(Z2,e)||nH(Z2,e,new Map)}function i3(e){return tH(K2,e)||nH(K2,e,new Map)}function r3(e){if(!tH(H2,e)){const t=tH(G2,e).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=tH(G2,e).createElementNS(IY,"svg");i.setAttribute("width",0),i.setAttribute("height",0),nH(H2,e,tH(G2,e).createElementNS(IY,"defs")),t.append(i),i.append(tH(H2,e)),tH(G2,e).body.append(t)}return tH(H2,e)}function s3(e){if(1===e.length){const t=e[0],n=new Array(256);for(let e=0;e<256;e++)n[e]=t[e]/255;const i=n.join(",");return[i,i,i]}const[t,n,i]=e,r=new Array(256),s=new Array(256),o=new Array(256);for(let a=0;a<256;a++)r[a]=t[a]/255,s[a]=n[a]/255,o[a]=i[a]/255;return[r.join(","),s.join(","),o.join(",")]}function o3(e){if(void 0===tH(q2,this)){nH(q2,this,"");const e=tH(G2,this).URL;e!==tH(G2,this).baseURI&&($Y(e)?uY('#createUrl: ignore "data:"-URL for performance reasons.'):nH(q2,this,fY(e,"")))}return"url(".concat(tH(q2,this),"#").concat(e,")")}function a3(e){const t=tH(G2,this).createElementNS(IY,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}function l3(e){const t=tH(G2,this).createElementNS(IY,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}function c3(e){const t=tH(G2,this).createElementNS(IY,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),eH(e3,this,r3).append(t),t}function u3(e,t,n){const i=tH(G2,this).createElementNS(IY,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),e.append(i)}function h3(e,t,n,i){const r=tH(G2,this).createElementNS(IY,"feComponentTransfer");i.append(r),JZ(e3,this,u3).call(this,r,"feFuncR",e),JZ(e3,this,u3).call(this,r,"feFuncG",t),JZ(e3,this,u3).call(this,r,"feFuncB",n)}function d3(e,t){const n=tH(G2,this).createElementNS(IY,"feComponentTransfer");t.append(n),JZ(e3,this,u3).call(this,n,"feFuncA",e)}function p3(e){return eH(e3,this,r3).style.color=e,HY(getComputedStyle(eH(e3,this,r3)).getPropertyValue("color"))}class f3{constructor(e){let{baseUrl:t=null}=e;this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const n="".concat(this.baseUrl).concat(t);return this._fetch(n).catch(e=>{throw new Error("Unable to load font data at: ".concat(n))})}async _fetch(e){hY("Abstract method `_fetch` called.")}}class m3 extends f3{async _fetch(e){const t=await QY(e,"arraybuffer");return new Uint8Array(t)}}class g3{constructor(e){let{baseUrl:t=null}=e;this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const n="".concat(this.baseUrl).concat(t);return this._fetch(n).catch(e=>{throw new Error("Unable to load wasm data at: ".concat(n))})}async _fetch(e){hY("Abstract method `_fetch` called.")}}class v3 extends g3{async _fetch(e){const t=await QY(e,"arraybuffer");return new Uint8Array(t)}}async function y3(e){const t=process.getBuiltinModule("fs"),n=await t.promises.readFile(e);return new Uint8Array(n)}xH&&uY("Please use the `legacy` build in Node.js environments.");class O3 extends X2{}class w3 extends z2{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire("file:///Users/andyt/Stuff/hci-demos/flashy/node_modules/pdfjs-dist/build/pdf.mjs")("@napi-rs/canvas").createCanvas(e,t)}}class b3 extends V2{async _fetch(e){return y3(e)}}class k3 extends f3{async _fetch(e){return y3(e)}}class x3 extends g3{async _fetch(e){return y3(e)}}const D3="__forcedDependency",{floor:S3,ceil:C3}=Math;function A3(e,t,n,i,r,s){e[4*t+0]=Math.min(e[4*t+0],n),e[4*t+1]=Math.min(e[4*t+1],i),e[4*t+2]=Math.max(e[4*t+2],r),e[4*t+3]=Math.max(e[4*t+3],s)}const E3=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var _3=new WeakMap,T3=new WeakMap;class P3{constructor(e,t){KZ(this,_3,void 0),KZ(this,T3,void 0),nH(_3,this,e),nH(T3,this,t)}get length(){return tH(_3,this).length}isEmpty(e){return tH(_3,this)[e]===E3}minX(e){return tH(T3,this)[4*e+0]/256}minY(e){return tH(T3,this)[4*e+1]/256}maxX(e){return(tH(T3,this)[4*e+2]+1)/256}maxY(e){return(tH(T3,this)[4*e+3]+1)/256}}const M3=(e,t)=>{if(!e)return;let n=e.get(t);return n||(n={dependencies:new Set,isRenderingOperation:!1},e.set(t,n)),n};var F3=new WeakMap,R3=new WeakMap,N3=new WeakMap,I3=new WeakMap,B3=new WeakMap,Q3=new WeakMap,L3=new WeakMap,j3=new WeakMap,$3=new WeakMap,z3=new WeakMap,W3=new WeakMap,V3=new WeakMap,U3=new WeakMap,X3=new WeakMap,q3=new WeakMap,Z3=new WeakMap,H3=new WeakMap,Y3=new WeakSet;class G3{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];iH(this,Y3),KZ(this,F3,{__proto__:null}),KZ(this,R3,{__proto__:null,transform:[],moveText:[],sameLineText:[],[D3]:[]}),KZ(this,N3,new Map),KZ(this,I3,[]),KZ(this,B3,[]),KZ(this,Q3,[[1,0,0,1,0,0]]),KZ(this,L3,[-1/0,-1/0,1/0,1/0]),KZ(this,j3,new Float64Array([1/0,1/0,-1/0,-1/0])),KZ(this,$3,-1),KZ(this,z3,new Set),KZ(this,W3,new Map),KZ(this,V3,new Map),KZ(this,U3,void 0),KZ(this,X3,void 0),KZ(this,q3,void 0),KZ(this,Z3,void 0),KZ(this,H3,void 0),nH(U3,this,e.width),nH(X3,this,e.height),JZ(Y3,this,K3).call(this,t),n&&nH(H3,this,new Map)}growOperationsCount(e){e>=tH(Z3,this).length&&JZ(Y3,this,K3).call(this,e,tH(Z3,this))}save(e){return nH(F3,this,{__proto__:tH(F3,this)}),nH(R3,this,{__proto__:tH(R3,this),transform:{__proto__:tH(R3,this).transform},moveText:{__proto__:tH(R3,this).moveText},sameLineText:{__proto__:tH(R3,this).sameLineText},[D3]:{__proto__:tH(R3,this)[D3]}}),nH(L3,this,{__proto__:tH(L3,this)}),tH(I3,this).push(e),this}restore(e){const t=Object.getPrototypeOf(tH(F3,this));if(null===t)return this;nH(F3,this,t),nH(R3,this,Object.getPrototypeOf(tH(R3,this))),nH(L3,this,Object.getPrototypeOf(tH(L3,this)));const n=tH(I3,this).pop();var i;void 0!==n&&(null===(i=M3(tH(H3,this),e))||void 0===i||i.dependencies.add(n),tH(Z3,this)[e]=tH(Z3,this)[n]);return this}recordOpenMarker(e){return tH(I3,this).push(e),this}getOpenMarker(){return 0===tH(I3,this).length?null:tH(I3,this).at(-1)}recordCloseMarker(e){const t=tH(I3,this).pop();var n;void 0!==t&&(null===(n=M3(tH(H3,this),e))||void 0===n||n.dependencies.add(t),tH(Z3,this)[e]=tH(Z3,this)[t]);return this}beginMarkedContent(e){return tH(B3,this).push(e),this}endMarkedContent(e){const t=tH(B3,this).pop();var n;void 0!==t&&(null===(n=M3(tH(H3,this),e))||void 0===n||n.dependencies.add(t),tH(Z3,this)[e]=tH(Z3,this)[t]);return this}pushBaseTransform(e){return tH(Q3,this).push(CY.multiplyByDOMMatrix(tH(Q3,this).at(-1),e.getTransform())),this}popBaseTransform(){return tH(Q3,this).length>1&&tH(Q3,this).pop(),this}recordSimpleData(e,t){return tH(F3,this)[e]=t,this}recordIncrementalData(e,t){return tH(R3,this)[e].push(t),this}resetIncrementalData(e,t){return tH(R3,this)[e].length=0,this}recordNamedData(e,t){return tH(N3,this).set(e,t),this}recordSimpleDataFromNamed(e,t,n){var i;tH(F3,this)[e]=null!==(i=tH(N3,this).get(t))&&void 0!==i?i:n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(D3,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in tH(F3,this)&&this.recordFutureForcedDependency(t,tH(F3,this)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of tH(z3,this))this.recordFutureForcedDependency(D3,e);return this}resetBBox(e){return tH($3,this)!==e&&(nH($3,this,e),tH(j3,this)[0]=1/0,tH(j3,this)[1]=1/0,tH(j3,this)[2]=-1/0,tH(j3,this)[3]=-1/0),this}recordClipBox(e,t,n,i,r,s){const o=CY.multiplyByDOMMatrix(tH(Q3,this).at(-1),t.getTransform()),a=[1/0,1/0,-1/0,-1/0];CY.axialAlignedBoundingBox([n,r,i,s],o,a);const l=CY.intersect(tH(L3,this),a);return l?(tH(L3,this)[0]=l[0],tH(L3,this)[1]=l[1],tH(L3,this)[2]=l[2],tH(L3,this)[3]=l[3]):(tH(L3,this)[0]=tH(L3,this)[1]=1/0,tH(L3,this)[2]=tH(L3,this)[3]=-1/0),this}recordBBox(e,t,n,i,r,s){const o=tH(L3,this);if(o[0]===1/0)return this;const a=CY.multiplyByDOMMatrix(tH(Q3,this).at(-1),t.getTransform());if(o[0]===-1/0)return CY.axialAlignedBoundingBox([n,r,i,s],a,tH(j3,this)),this;const l=[1/0,1/0,-1/0,-1/0];return CY.axialAlignedBoundingBox([n,r,i,s],a,l),tH(j3,this)[0]=Math.min(tH(j3,this)[0],Math.max(l[0],o[0])),tH(j3,this)[1]=Math.min(tH(j3,this)[1],Math.max(l[1],o[1])),tH(j3,this)[2]=Math.max(tH(j3,this)[2],Math.min(l[2],o[2])),tH(j3,this)[3]=Math.max(tH(j3,this)[3],Math.min(l[3],o[3])),this}recordCharacterBBox(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;const a=n.bbox;let l,c;if(a&&(l=a[2]!==a[0]&&a[3]!==a[1]&&tH(V3,this).get(n),!1!==l&&(c=[0,0,0,0],CY.axialAlignedBoundingBox(a,n.fontMatrix,c),1===i&&0===r&&0===s||CY.scaleMinMax([i,0,0,-i,r,s],c),l)))return this.recordBBox(e,t,c[0],c[2],c[1],c[3]);if(!o)return this.recordFullPageBBox(e);const u=o();return a&&c&&void 0===l&&(l=c[0]<=r-u.actualBoundingBoxLeft&&c[2]>=r+u.actualBoundingBoxRight&&c[1]<=s-u.actualBoundingBoxAscent&&c[3]>=s+u.actualBoundingBoxDescent,tH(V3,this).set(n,l),l)?this.recordBBox(e,t,c[0],c[2],c[1],c[3]):this.recordBBox(e,t,r-u.actualBoundingBoxLeft,r+u.actualBoundingBoxRight,s-u.actualBoundingBoxAscent,s+u.actualBoundingBoxDescent)}recordFullPageBBox(e){return tH(j3,this)[0]=Math.max(0,tH(L3,this)[0]),tH(j3,this)[1]=Math.max(0,tH(L3,this)[1]),tH(j3,this)[2]=Math.min(tH(U3,this),tH(L3,this)[2]),tH(j3,this)[3]=Math.min(tH(X3,this),tH(L3,this)[3]),this}getSimpleIndex(e){return tH(F3,this)[e]}recordDependencies(e,t){const n=tH(z3,this),i=tH(F3,this),r=tH(R3,this);for(const s of t)s in tH(F3,this)?n.add(i[s]):s in r&&r[s].forEach(n.add,n);return this}recordNamedDependency(e,t){return tH(N3,this).has(t)&&tH(z3,this).add(tH(N3,this).get(t)),this}recordOperation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.recordDependencies(e,[D3]),tH(H3,this)){const t=M3(tH(H3,this),e),{dependencies:n}=t;tH(z3,this).forEach(n.add,n),tH(I3,this).forEach(n.add,n),tH(B3,this).forEach(n.add,n),n.delete(e),t.isRenderingOperation=!0}if(tH($3,this)===e){const n=S3(256*tH(j3,this)[0]/tH(U3,this)),i=S3(256*tH(j3,this)[1]/tH(X3,this)),r=C3(256*tH(j3,this)[2]/tH(U3,this)),s=C3(256*tH(j3,this)[3]/tH(X3,this));A3(tH(q3,this),e,n,i,r,s);for(const t of tH(z3,this))t!==e&&A3(tH(q3,this),t,n,i,r,s);for(const t of tH(I3,this))t!==e&&A3(tH(q3,this),t,n,i,r,s);for(const t of tH(B3,this))t!==e&&A3(tH(q3,this),t,n,i,r,s);t||(tH(z3,this).clear(),nH($3,this,-1))}return this}recordShowTextOperation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Array.from(tH(z3,this));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of n)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return tH($3,this)===e&&(nH($3,this,-1),tH(L3,this)[0]=Math.max(tH(L3,this)[0],tH(j3,this)[0]),tH(L3,this)[1]=Math.max(tH(L3,this)[1],tH(j3,this)[1]),tH(L3,this)[2]=Math.min(tH(L3,this)[2],tH(j3,this)[2]),tH(L3,this)[3]=Math.min(tH(L3,this)[3],tH(j3,this)[3]),t||tH(z3,this).clear()),this}_takePendingDependencies(){const e=tH(z3,this);return nH(z3,this,new Set),e}_extractOperation(e){const t=tH(W3,this).get(e);return tH(W3,this).delete(e),t}_pushPendingDependencies(e){for(const t of e)tH(z3,this).add(t)}take(){return tH(V3,this).clear(),new P3(tH(Z3,this),tH(q3,this))}takeDebugMetadata(){return tH(H3,this)}}function K3(e,t){const n=new ArrayBuffer(4*e);nH(q3,this,new Uint8ClampedArray(n)),nH(Z3,this,new Uint32Array(n)),t&&t.length>0?(tH(Z3,this).set(t),tH(Z3,this).fill(E3,t.length)):tH(Z3,this).fill(E3)}var J3=new WeakMap,e5=new WeakMap,t5=new WeakMap,n5=new WeakMap,i5=new WeakMap;class r5{constructor(e,t,n){if(KZ(this,J3,void 0),KZ(this,e5,void 0),KZ(this,t5,void 0),KZ(this,n5,0),KZ(this,i5,0),e instanceof r5&&tH(t5,e)===!!n)return e;nH(J3,this,e),nH(e5,this,t),nH(t5,this,!!n)}growOperationsCount(){throw new Error("Unreachable")}save(e){var t;return nH(i5,this,(t=tH(i5,this),t++,t)),tH(J3,this).save(tH(e5,this)),this}restore(e){var t;tH(i5,this)>0&&(tH(J3,this).restore(tH(e5,this)),nH(i5,this,(t=tH(i5,this),t--,t)));return this}recordOpenMarker(e){var t;return nH(n5,this,(t=tH(n5,this),t++,t)),this}getOpenMarker(){return tH(n5,this)>0?tH(e5,this):tH(J3,this).getOpenMarker()}recordCloseMarker(e){var t;return nH(n5,this,(t=tH(n5,this),t--,t)),this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return tH(J3,this).pushBaseTransform(e),this}popBaseTransform(){return tH(J3,this).popBaseTransform(),this}recordSimpleData(e,t){return tH(J3,this).recordSimpleData(e,tH(e5,this)),this}recordIncrementalData(e,t){return tH(J3,this).recordIncrementalData(e,tH(e5,this)),this}resetIncrementalData(e,t){return tH(J3,this).resetIncrementalData(e,tH(e5,this)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return tH(J3,this).recordSimpleDataFromNamed(e,t,tH(e5,this)),this}recordFutureForcedDependency(e,t){return tH(J3,this).recordFutureForcedDependency(e,tH(e5,this)),this}inheritSimpleDataAsFutureForcedDependencies(e){return tH(J3,this).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return tH(J3,this).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return tH(t5,this)||tH(J3,this).resetBBox(tH(e5,this)),this}recordClipBox(e,t,n,i,r,s){return tH(t5,this)||tH(J3,this).recordClipBox(tH(e5,this),t,n,i,r,s),this}recordBBox(e,t,n,i,r,s){return tH(t5,this)||tH(J3,this).recordBBox(tH(e5,this),t,n,i,r,s),this}recordCharacterBBox(e,t,n,i,r,s,o){return tH(t5,this)||tH(J3,this).recordCharacterBBox(tH(e5,this),t,n,i,r,s,o),this}recordFullPageBBox(e){return tH(t5,this)||tH(J3,this).recordFullPageBBox(tH(e5,this)),this}getSimpleIndex(e){return tH(J3,this).getSimpleIndex(e)}recordDependencies(e,t){return tH(J3,this).recordDependencies(tH(e5,this),t),this}recordNamedDependency(e,t){return tH(J3,this).recordNamedDependency(tH(e5,this),t),this}recordOperation(e){return tH(J3,this).recordOperation(tH(e5,this),!0),this}recordShowTextOperation(e){return tH(J3,this).recordShowTextOperation(tH(e5,this),!0),this}bboxToClipBoxDropOperation(e){return tH(t5,this)||tH(J3,this).bboxToClipBoxDropOperation(tH(e5,this),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const s5=["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],o5=["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],a5=["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],l5=["filter","fillColor","fillAlpha"],c5=["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],u5=["transform"],h5=["transform","fillColor"],d5="Fill",p5="Stroke",f5="Shading";function m5(e,t){if(!t)return;const n=t[2]-t[0],i=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],n,i),e.clip(r)}class g5{isModifyingCurrentTransform(){return!1}getPattern(){hY("Abstract method `getPattern` called.")}}class v5 extends g5{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return 0===this._p0[0]&&0===this._p0[1]&&(!this.isRadial()||0===this._p1[0]&&0===this._p1[1])}isRadial(){return"radial"===this._type}_createGradient(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this._p0,r=this._p1;if(n&&(i=i.slice(),r=r.slice(),CY.applyTransform(i,n),CY.applyTransform(r,n)),"axial"===this._type)t=e.createLinearGradient(i[0],i[1],r[0],r[1]);else if("radial"===this._type){let s=this._r0,o=this._r1;if(n){const e=new Float32Array(2);CY.singularValueDecompose2dScale(n,e),s*=e[0],o*=e[0]}t=e.createRadialGradient(i[0],i[1],s,r[0],r[1],o)}for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,n,i){let r;if(i===p5||i===d5){if(this.isOriginBased()){let i=CY.transform(n,t.baseTransform);this.matrix&&(i=CY.transform(i,this.matrix));const r=.001,s=Math.hypot(i[0],i[1]),o=Math.hypot(i[2],i[3]),a=(i[0]*i[2]+i[1]*i[3])/(s*o);if(Math.abs(a)<r){if(!this.isRadial())return this._createGradient(e,i);if(Math.abs(s-o)<r)return this._createGradient(e,i)}}const s=t.current.getClippedPathBoundingBox(i,YY(e))||[0,0,0,0],o=Math.ceil(s[2]-s[0])||1,a=Math.ceil(s[3]-s[1])||1,l=t.cachedCanvases.getCanvas("pattern",o,a),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-s[0],-s[1]),n=CY.transform(n,[1,0,0,1,s[0],s[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),m5(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),r=e.createPattern(l.canvas,"no-repeat");const u=new DOMMatrix(n);r.setTransform(u)}else m5(e,this._bbox),r=this._createGradient(e);return r}}function y5(e,t,n,i,r,s,o,a){const l=t.coords,c=t.colors,u=e.data,h=4*e.width;let d;l[n+1]>l[i+1]&&(d=n,n=i,i=d,d=s,s=o,o=d),l[i+1]>l[r+1]&&(d=i,i=r,r=d,d=o,o=a,a=d),l[n+1]>l[i+1]&&(d=n,n=i,i=d,d=s,s=o,o=d);const p=(l[n]+t.offsetX)*t.scaleX,f=(l[n+1]+t.offsetY)*t.scaleY,m=(l[i]+t.offsetX)*t.scaleX,g=(l[i+1]+t.offsetY)*t.scaleY,v=(l[r]+t.offsetX)*t.scaleX,y=(l[r+1]+t.offsetY)*t.scaleY;if(f>=y)return;const O=c[s],w=c[s+1],b=c[s+2],k=c[o],x=c[o+1],D=c[o+2],S=c[a],C=c[a+1],A=c[a+2],E=Math.round(f),_=Math.round(y);let T,P,M,F,R,N,I,B;for(let Q=E;Q<=_;Q++){if(Q<g){const e=Q<f?0:(f-Q)/(f-g);T=p-(p-m)*e,P=O-(O-k)*e,M=w-(w-x)*e,F=b-(b-D)*e}else{let e;e=Q>y?1:g===y?0:(g-Q)/(g-y),T=m-(m-v)*e,P=k-(k-S)*e,M=x-(x-C)*e,F=D-(D-A)*e}let e;e=Q<f?0:Q>y?1:(f-Q)/(f-y),R=p-(p-v)*e,N=O-(O-S)*e,I=w-(w-C)*e,B=b-(b-A)*e;const t=Math.round(Math.min(T,R)),n=Math.round(Math.max(T,R));let i=h*Q+4*t;for(let r=t;r<=n;r++)e=(T-r)/(T-R),e<0?e=0:e>1&&(e=1),u[i++]=P-(P-N)*e|0,u[i++]=M-(M-I)*e|0,u[i++]=F-(F-B)*e|0,u[i++]=255}}function O5(e,t,n){const i=t.coords,r=t.colors;let s,o;switch(t.type){case LH:const a=t.verticesPerRow,l=Math.floor(i.length/a)-1,c=a-1;for(s=0;s<l;s++){let t=s*a;for(let s=0;s<c;s++,t++)y5(e,n,i[t],i[t+1],i[t+a],r[t],r[t+1],r[t+a]),y5(e,n,i[t+a+1],i[t+1],i[t+a],r[t+a+1],r[t+1],r[t+a])}break;case QH:for(s=0,o=i.length;s<o;s+=3)y5(e,n,i[s],i[s+1],i[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}class w5 extends g5{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const i=Math.floor(this._bounds[0]),r=Math.floor(this._bounds[1]),s=Math.ceil(this._bounds[2])-i,o=Math.ceil(this._bounds[3])-r,a=Math.min(Math.ceil(Math.abs(s*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(o*e[1]*1.1)),3e3),c=s/a,u=o/l,h={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-r,scaleX:1/c,scaleY:1/u},d=a+4,p=l+4,f=n.getCanvas("mesh",d,p),m=f.context,g=m.createImageData(a,l);if(t){const e=g.data;for(let n=0,i=e.length;n<i;n+=4)e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=255}for(const v of this._figures)O5(g,v,h);m.putImageData(g,2,2);return{canvas:f.canvas,offsetX:i-2*c,offsetY:r-2*u,scaleX:c,scaleY:u}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,i){m5(e,this._bbox);const r=new Float32Array(2);if(i===f5)CY.singularValueDecompose2dScale(YY(e),r);else if(this.matrix){CY.singularValueDecompose2dScale(this.matrix,r);const[e,n]=r;CY.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=e,r[1]*=n}else CY.singularValueDecompose2dScale(t.baseTransform,r);const s=this._createMeshCanvas(r,i===f5?null:this._background,t.cachedCanvases);return i!==f5&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(s.offsetX,s.offsetY),e.scale(s.scaleX,s.scaleY),e.createPattern(s.canvas,"no-repeat")}}class b5 extends g5{getPattern(){return"hotpink"}}const k5=1,x5=2;class D5{constructor(e,t,n,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e,t){var n,i;const{bbox:r,operatorList:s,paintType:o,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:u,ystep:h}=this;u=Math.abs(u),h=Math.abs(h),cY("TilingType: "+a);const d=r[0],p=r[1],f=r[2],m=r[3],g=f-d,v=m-p,y=new Float32Array(2);CY.singularValueDecompose2dScale(this.matrix,y);const[O,w]=y;CY.singularValueDecompose2dScale(this.baseTransform,y);const b=O*y[0],k=w*y[1];let x=g,D=v,S=!1,C=!1;const A=Math.ceil(u*b),E=Math.ceil(h*k);A>=Math.ceil(g*b)?x=u:S=!0,E>=Math.ceil(v*k)?D=h:C=!0;const _=this.getSizeAndScale(x,this.ctx.canvas.width,b),T=this.getSizeAndScale(D,this.ctx.canvas.height,k),P=e.cachedCanvases.getCanvas("pattern",_.size,T.size),M=P.context,F=c.createCanvasGraphics(M,t);if(F.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(F,o,l),M.translate(-_.scale*d,-T.scale*p),F.transform(0,_.scale,0,0,T.scale,0,0),M.save(),null===(n=F.dependencyTracker)||void 0===n||n.save(),this.clipBbox(F,d,p,f,m),F.baseTransform=YY(F.ctx),F.executeOperatorList(s),F.endDrawing(),null===(i=F.dependencyTracker)||void 0===i||i.restore(),M.restore(),S||C){const t=P.canvas;S&&(x=u),C&&(D=h);const n=this.getSizeAndScale(x,this.ctx.canvas.width,b),i=this.getSizeAndScale(D,this.ctx.canvas.height,k),r=n.size,s=i.size,o=e.cachedCanvases.getCanvas("pattern-workaround",r,s),a=o.context,l=S?Math.floor(g/u):0,c=C?Math.floor(v/h):0;for(let e=0;e<=l;e++)for(let n=0;n<=c;n++)a.drawImage(t,r*e,s*n,r,s,0,0,r,s);return{canvas:o.canvas,scaleX:n.scale,scaleY:i.scale,offsetX:d,offsetY:p}}return{canvas:P.canvas,scaleX:_.scale,scaleY:T.scale,offsetX:d,offsetY:p}}getSizeAndScale(e,t,n){const i=Math.max(D5.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*n);return r>=i?r=i:n=r/e,{scale:n,size:r}}clipBbox(e,t,n,i,r){const s=i-t,o=r-n;e.ctx.rect(t,n,s,o),CY.axialAlignedBoundingBox([t,n,i,r],YY(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,r=e.current;switch(t){case k5:const{fillStyle:e,strokeStyle:s}=this.ctx;i.fillStyle=r.fillColor=e,i.strokeStyle=r.strokeColor=s;break;case x5:i.fillStyle=i.strokeStyle=n,r.fillColor=r.strokeColor=n;break;default:throw new bY("Unsupported paint type: ".concat(t))}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,i,r){let s=n;i!==f5&&(s=CY.transform(s,t.baseTransform),this.matrix&&(s=CY.transform(s,this.matrix)));const o=this.createPatternCanvas(t,r);let a=new DOMMatrix(s);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const l=e.createPattern(o.canvas,"repeat");return l.setTransform(a),l}}function S5(e){let{src:t,srcPos:n=0,dest:i,width:r,height:s,nonBlackColor:o=4294967295,inverseDecode:a=!1}=e;const l=DY.isLittleEndian?4278190080:255,[c,u]=a?[o,l]:[l,o],h=r>>3,d=7&r,p=t.length;i=new Uint32Array(i.buffer);let f=0;for(let m=0;m<s;m++){for(const r=n+h;n<r;n++){const e=n<p?t[n]:255;i[f++]=128&e?u:c,i[f++]=64&e?u:c,i[f++]=32&e?u:c,i[f++]=16&e?u:c,i[f++]=8&e?u:c,i[f++]=4&e?u:c,i[f++]=2&e?u:c,i[f++]=1&e?u:c}if(0===d)continue;const e=n<p?t[n++]:255;for(let t=0;t<d;t++)i[f++]=e&1<<7-t?u:c}return{srcPos:n,destPos:f}}h(D5,"MAX_PATTERN_SIZE",3e3);const C5=16,A5=new DOMMatrix,E5=new Float32Array(2),_5=new Float32Array([1/0,1/0,-1/0,-1/0]);class T5{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return void 0!==this.cache[e]?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function P5(e,t,n,i,r,s,o,a,l,c){const[u,h,d,p,f,m]=YY(e);if(0===h&&0===d){const g=o*u+f,v=Math.round(g),y=a*p+m,O=Math.round(y),w=(o+l)*u+f,b=Math.abs(Math.round(w)-v)||1,k=(a+c)*p+m,x=Math.abs(Math.round(k)-O)||1;return e.setTransform(Math.sign(u),0,0,Math.sign(p),v,O),e.drawImage(t,n,i,r,s,0,0,b,x),e.setTransform(u,h,d,p,f,m),[b,x]}if(0===u&&0===p){const g=a*d+f,v=Math.round(g),y=o*h+m,O=Math.round(y),w=(a+c)*d+f,b=Math.abs(Math.round(w)-v)||1,k=(o+l)*h+m,x=Math.abs(Math.round(k)-O)||1;return e.setTransform(0,Math.sign(h),Math.sign(d),0,v,O),e.drawImage(t,n,i,r,s,0,0,x,b),e.setTransform(u,h,d,p,f,m),[x,b]}e.drawImage(t,n,i,r,s,o,a,l,c);return[Math.hypot(u,h)*l,Math.hypot(d,p)*c]}class M5{constructor(e,t,n){h(this,"alphaIsShape",!1),h(this,"fontSize",0),h(this,"fontSizeScale",1),h(this,"textMatrix",null),h(this,"textMatrixScale",1),h(this,"fontMatrix",DH),h(this,"leading",0),h(this,"x",0),h(this,"y",0),h(this,"lineX",0),h(this,"lineY",0),h(this,"charSpacing",0),h(this,"wordSpacing",0),h(this,"textHScale",1),h(this,"textRenderingMode",jH),h(this,"textRise",0),h(this,"fillColor","#000000"),h(this,"strokeColor","#000000"),h(this,"patternFill",!1),h(this,"patternStroke",!1),h(this,"fillAlpha",1),h(this,"strokeAlpha",1),h(this,"lineWidth",1),h(this,"activeSMask",null),h(this,"transferMaps","none"),null===n||void 0===n||n(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=_5.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.minMax.slice();if(e===p5){t||hY("Stroke bounding box must include transform."),CY.singularValueDecompose2dScale(t,E5);const e=E5[0]*this.lineWidth/2,i=E5[1]*this.lineWidth/2;n[0]-=e,n[1]-=i,n[2]+=e,n[3]+=i}return n}updateClipFromPath(){const e=CY.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(_5,0)}getClippedPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return CY.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function F5(e,t){if(t instanceof ImageData)return void e.putImageData(t,0,0);const n=t.height,i=t.width,r=n%C5,s=(n-r)/C5,o=0===r?s:s+1,a=e.createImageData(i,C5);let l,c=0;const u=t.data,h=a.data;let d,p,f,m;if(t.kind===XH.GRAYSCALE_1BPP){const t=u.byteLength,n=new Uint32Array(h.buffer,0,h.byteLength>>2),m=n.length,g=i+7>>3,v=4294967295,y=DY.isLittleEndian?4278190080:255;for(d=0;d<o;d++){for(f=d<s?C5:r,l=0,p=0;p<f;p++){const e=t-c;let r=0;const s=e>g?i:8*e-7,o=-8&s;let a=0,h=0;for(;r<o;r+=8)h=u[c++],n[l++]=128&h?v:y,n[l++]=64&h?v:y,n[l++]=32&h?v:y,n[l++]=16&h?v:y,n[l++]=8&h?v:y,n[l++]=4&h?v:y,n[l++]=2&h?v:y,n[l++]=1&h?v:y;for(;r<s;r++)0===a&&(h=u[c++],a=128),n[l++]=h&a?v:y,a>>=1}for(;l<m;)n[l++]=0;e.putImageData(a,0,d*C5)}}else if(t.kind===XH.RGBA_32BPP){for(p=0,m=i*C5*4,d=0;d<s;d++)h.set(u.subarray(c,c+m)),c+=m,e.putImageData(a,0,p),p+=C5;d<o&&(m=i*r*4,h.set(u.subarray(c,c+m)),e.putImageData(a,0,p))}else{if(t.kind!==XH.RGB_24BPP)throw new Error("bad image kind: ".concat(t.kind));for(f=C5,m=i*f,d=0;d<o;d++){for(d>=s&&(f=r,m=i*f),l=0,p=m;p--;)h[l++]=u[c++],h[l++]=u[c++],h[l++]=u[c++],h[l++]=255;e.putImageData(a,0,d*C5)}}}function R5(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const n=t.height,i=t.width,r=n%C5,s=(n-r)/C5,o=0===r?s:s+1,a=e.createImageData(i,C5);let l=0;const c=t.data,u=a.data;for(let h=0;h<o;h++){const t=h<s?C5:r;({srcPos:l}=S5({src:c,srcPos:l,dest:u,width:i,height:t,nonBlackColor:0})),e.putImageData(a,0,h*C5)}}function N5(e,t){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of n)void 0!==e[i]&&(t[i]=e[i]);void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function I5(e){e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0);const{filter:t}=e;"none"!==t&&""!==t&&(e.filter="none")}function B5(e,t){if(t)return!0;CY.singularValueDecompose2dScale(e,E5);const n=Math.fround(JY.pixelRatio*BY.PDF_TO_CSS_UNITS);return E5[0]<=n&&E5[1]<=n}const Q5=["butt","round","square"],L5=["miter","round","bevel"],j5={},$5={};var z5=new WeakSet;class W5{constructor(e,t,n,i,r,s,o,a,l){let{optionalContentConfig:c,markedContentStack:u=null}=s;iH(this,z5),this.ctx=e,this.current=new M5(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new T5(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=a,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=null!==l&&void 0!==l?l:null}getObject(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;var i;return"string"===typeof t?(null===(i=this.dependencyTracker)||void 0===i||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing(e){let{transform:t,viewport:n,transparency:i=!1,background:r=null}=e;const s=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=a,i){const e=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...YY(this.compositeCtx))}this.ctx.save(),I5(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=YY(this.ctx)}executeOperatorList(e,t,n,i,r){const s=e.argsArray,o=e.fnArray;let a=t||0;const l=s.length;if(l===a)return a;const c=l-a>10&&"function"===typeof n,u=c?Date.now()+15:0;let h=0;const d=this.commonObjs,p=this.objs;let f,m;for(;;){if(void 0!==i&&a===i.nextBreakPoint)return i.breakIt(a,n),a;var g;if(!r||r(a))if(f=o[a],m=null!==(g=s[a])&&void 0!==g?g:null,f!==eY.dependency)null===m?this[f](a):this[f](a,...m);else for(const e of m){var v;null===(v=this.dependencyTracker)||void 0===v||v.recordNamedData(e,a);const t=e.startsWith("g_")?d:p;if(!t.has(e))return t.get(e,n),a}if(a++,a===l)return a;if(c&&++h>10){if(Date.now()>u)return n(),a;h=0}}}endDrawing(){JZ(z5,this,V5).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),JZ(z5,this,U5).call(this)}_scaleImage(e,t){var n,i;const r=null!==(n=e.width)&&void 0!==n?n:e.displayWidth,s=null!==(i=e.height)&&void 0!==i?i:e.displayHeight;let o,a,l=Math.max(Math.hypot(t[0],t[1]),1),c=Math.max(Math.hypot(t[2],t[3]),1),u=r,h=s,d="prescale1";for(;l>2&&u>1||c>2&&h>1;){let t=u,n=h;l>2&&u>1&&(t=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/t),c>2&&h>1&&(n=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/n),o=this.cachedCanvases.getCanvas(d,t,n),a=o.context,a.clearRect(0,0,t,n),a.drawImage(e,0,0,u,h,0,0,t,n),e=o.canvas,u=t,h=n,d="prescale1"===d?"prescale2":"prescale1"}return{img:e,paintWidth:u,paintHeight:h}}_createMaskCanvas(e,t){var n;const i=this.ctx,{width:r,height:s}=t,o=this.current.fillColor,a=this.current.patternFill,l=YY(i);let c,u,h,d;if((t.bitmap||t.data)&&t.count>1){const n=t.bitmap||t.data.buffer;u=JSON.stringify(a?l:[l.slice(0,4),o]),c=this._cachedBitmapsMap.get(n),c||(c=new Map,this._cachedBitmapsMap.set(n,c));const i=c.get(u);if(i&&!a){var p;const t=Math.round(Math.min(l[0],l[2])+l[4]),n=Math.round(Math.min(l[1],l[3])+l[5]);return null===(p=this.dependencyTracker)||void 0===p||p.recordDependencies(e,h5),{canvas:i,offsetX:t,offsetY:n}}h=i}h||(d=this.cachedCanvases.getCanvas("maskCanvas",r,s),R5(d.context,t));let f=CY.transform(l,[1/r,0,0,-1/s,0,0]);f=CY.transform(f,[1,0,0,1,0,-s]);const m=_5.slice();CY.axialAlignedBoundingBox([0,0,r,s],f,m);const[g,v,y,O]=m,w=Math.round(y-g)||1,b=Math.round(O-v)||1,k=this.cachedCanvases.getCanvas("fillCanvas",w,b),x=k.context,D=g,S=v;x.translate(-D,-S),x.transform(...f),h||(h=this._scaleImage(d.canvas,GY(x)),h=h.img,c&&a&&c.set(u,h)),x.imageSmoothingEnabled=B5(YY(x),t.interpolate),P5(x,h,0,0,h.width,h.height,0,0,r,s),x.globalCompositeOperation="source-in";const C=CY.transform(GY(x),[1,0,0,1,-D,-S]);return x.fillStyle=a?o.getPattern(i,this,C,d5,e):o,x.fillRect(0,0,r,s),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,k.canvas)),null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,h5),{canvas:k.canvas,offsetX:Math.round(D),offsetY:Math.round(S)}}setLineWidth(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("lineCap",e),this.ctx.lineCap=Q5[t]}setLineJoin(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("lineJoin",e),this.ctx.lineJoin=L5[t]}setMiterLimit(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){var i;null===(i=this.dependencyTracker)||void 0===i||i.recordSimpleData("dash",e);const r=this.ctx;void 0!==r.setLineDash&&(r.setLineDash(t),r.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var n,i,r,s,o;for(const[a,l]of t)switch(a){case"LW":this.setLineWidth(e,l);break;case"LC":this.setLineCap(e,l);break;case"LJ":this.setLineJoin(e,l);break;case"ML":this.setMiterLimit(e,l);break;case"D":this.setDash(e,l[0],l[1]);break;case"RI":this.setRenderingIntent(e,l);break;case"FL":this.setFlatness(e,l);break;case"Font":this.setFont(e,l[0],l[1]);break;case"CA":null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=l;break;case"ca":null===(i=this.dependencyTracker)||void 0===i||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=l;break;case"BM":null===(r=this.dependencyTracker)||void 0===r||r.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=l;break;case"SMask":null===(s=this.dependencyTracker)||void 0===s||s.recordSimpleData("SMask",e),this.current.activeSMask=l?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":null===(o=this.dependencyTracker)||void 0===o||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(l)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,t,n);this.suspendedCtx=this.ctx;const s=this.ctx=r.context;s.setTransform(this.suspendedCtx.getTransform()),N5(this.suspendedCtx,s),function(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},e.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},e.transform=function(e,n,i,r,s,o){t.transform(e,n,i,r,s,o),this.__originalTransform(e,n,i,r,s,o)},e.setTransform=function(e,n,i,r,s,o){t.setTransform(e,n,i,r,s,o),this.__originalSetTransform(e,n,i,r,s,o)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},e.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},e.bezierCurveTo=function(e,n,i,r,s,o){t.bezierCurveTo(e,n,i,r,s,o),this.__originalBezierCurveTo(e,n,i,r,s,o)},e.rect=function(e,n,i,r){t.rect(e,n,i,r),this.__originalRect(e,n,i,r)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(s,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),N5(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const r=i[0],s=i[1],o=i[2]-r,a=i[3]-s;0!==o&&0!==a&&(this.genericComposeSMask(t.context,n,o,a,t.subtype,t.backdrop,t.transferMap,r,s,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,r,s,o,a,l,c,u){let h=e.canvas,d=a-c,p=l-u;if(s)if(d<0||p<0||d+n>h.width||p+i>h.height){const e=this.cachedCanvases.getCanvas("maskExtension",n,i),t=e.context;t.drawImage(h,-d,-p),t.globalCompositeOperation="destination-atop",t.fillStyle=s,t.fillRect(0,0,n,i),t.globalCompositeOperation="source-over",h=e.canvas,d=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const t=new Path2D;t.rect(d,p,n,i),e.clip(t),e.globalCompositeOperation="destination-atop",e.fillStyle=s,e.fillRect(d,p,n,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),"Alpha"===r&&o?t.filter=this.filterFactory.addAlphaFilter(o):"Luminosity"===r&&(t.filter=this.filterFactory.addLuminosityFilter(o));const f=new Path2D;f.rect(a,l,n,i),t.clip(f),t.globalCompositeOperation="destination-in",t.drawImage(h,d,p,n,i,a,l,n,i),t.restore()}save(e){var t;this.inSMaskMode&&N5(this.ctx,this.suspendedCtx),this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone(),null===(t=this.dependencyTracker)||void 0===t||t.save(e)}restore(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.restore(e),0!==this.stateStack.length?(this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&N5(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null):this.inSMaskMode&&this.endSMaskMode()}transform(e,t,n,i,r,s,o){var a;null===(a=this.dependencyTracker)||void 0===a||a.recordIncrementalData("transform",e),this.ctx.transform(t,n,i,r,s,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,i){let[r]=n;if(!i)return r||(r=n[0]=new Path2D),void this[t](e,r);if(null!==this.dependencyTracker){const n=t===eY.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-n,i[2]+n,i[1]-n,i[3]+n).recordDependencies(e,["transform"])}r instanceof Path2D||(r=n[0]=lG(r)),CY.axialAlignedBoundingBox(i,YY(this.ctx),this.current.minMax),this[t](e,r),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t){var n;let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this.ctx,s=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if("object"===typeof s&&null!==s&&void 0!==s&&s.getPattern){const n=s.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=s.getPattern(r,this,GY(r),p5,e),n){const e=new Path2D;e.addPath(t,r.getTransform().invertSelf().multiplySelf(n)),t=e}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,s5),i&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(p5,YY(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t){var n;let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this.ctx,s=this.current.fillColor;let o=!1;if(this.current.patternFill){var a;const n=s.isModifyingCurrentTransform()?r.getTransform():null;if(null===(a=this.dependencyTracker)||void 0===a||a.save(e),r.save(),r.fillStyle=s.getPattern(r,this,GY(r),d5,e),n){const e=new Path2D;e.addPath(t,r.getTransform().invertSelf().multiplySelf(n)),t=e}o=!0}const l=this.current.getClippedPathBoundingBox();var c;(this.contentVisible&&null!==l&&(this.pendingEOFill?(r.fill(t,"evenodd"),this.pendingEOFill=!1):r.fill(t)),null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,o5),o)&&(r.restore(),null===(c=this.dependencyTracker)||void 0===c||c.restore(e));i&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var n;this.ctx.fill(t),null===(n=this.dependencyTracker)||void 0===n||n.recordDependencies(e,l5).recordOperation(e)}clip(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=j5}eoClip(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=$5}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,null===(t=this.dependencyTracker)||void 0===t||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:n}=this;void 0!==t&&n.recordFutureForcedDependency("textClip",n.getOpenMarker()).recordFutureForcedDependency("textClip",e),n.recordCloseMarker(e)}if(void 0!==t){const e=new Path2D,i=n.getTransform().invertSelf();for(const{transform:n,x:r,y:s,fontSize:o,path:a}of t)a&&e.addPath(a,new DOMMatrix(n).preMultiplySelf(i).translate(r,s).scale(o,-o));n.clip(e)}delete this.pendingTextPaths}setCharSpacing(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){var i,r;null===(i=this.dependencyTracker)||void 0===i||i.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),o=this.current;if(!s)throw new Error("Can't find font for ".concat(t));if(o.fontMatrix=s.fontMatrix||DH,0!==o.fontMatrix[0]&&0!==o.fontMatrix[3]||uY("Invalid font matrix for font "+t),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const a=s.loadedName||"sans-serif",l=(null===(r=s.systemFontInfo)||void 0===r?void 0:r.css)||'"'.concat(a,'", ').concat(s.fallbackName);let c="normal";s.black?c="900":s.bold&&(c="bold");const u=s.italic?"italic":"normal";let h=n;n<16?h=16:n>100&&(h=100),this.current.fontSizeScale=n/h,this.ctx.font="".concat(u," ").concat(c," ").concat(h,"px ").concat(l)}setTextRenderingMode(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){var i;null===(i=this.dependencyTracker)||void 0===i||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:i}=this;i.textMatrix=t,i.textMatrixScale=Math.hypot(t[0],t[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(e){var t,n;this.moveText(e,0,this.current.leading),null===(t=this.dependencyTracker)||void 0===t||t.recordIncrementalData("moveText",null!==(n=this.dependencyTracker.getSimpleIndex("leading"))&&void 0!==n?n:e)}paintChar(e,t,n,i,r,s){const o=this.ctx,a=this.current,l=a.font,c=a.textRenderingMode,u=a.fontSize/a.fontSizeScale,h=c&VH,d=!!(c&UH),p=a.patternFill&&!l.missingFile,f=a.patternStroke&&!l.missingFile;let m;if((l.disableFontFace||d||p||f)&&!l.missingFile&&(m=l.getPathGenerator(this.commonObjs,t)),m&&(l.disableFontFace||p||f)){var g;let t;if(o.save(),o.translate(n,i),o.scale(u,-u),null===(g=this.dependencyTracker)||void 0===g||g.recordCharacterBBox(e,o,l),h===jH||h===zH)if(r){t=o.getTransform(),o.setTransform(...r);const e=JZ(z5,this,X5).call(this,m,t,r);o.fill(e)}else o.fill(m);if(h===$H||h===zH)if(s){t||(t=o.getTransform()),o.setTransform(...s);const{a:e,b:n,c:i,d:r}=t,a=CY.inverseTransform(s),l=CY.transform([e,n,i,r,0,0],a);CY.singularValueDecompose2dScale(l,E5),o.lineWidth*=Math.max(E5[0],E5[1])/u,o.stroke(JZ(z5,this,X5).call(this,m,t,s))}else o.lineWidth/=u,o.stroke(m);o.restore()}else{var v;if(h===jH||h===zH)o.fillText(t,n,i),null===(v=this.dependencyTracker)||void 0===v||v.recordCharacterBBox(e,o,l,u,n,i,()=>o.measureText(t));if(h===$H||h===zH){var y;if(this.dependencyTracker)null===(y=this.dependencyTracker)||void 0===y||y.recordCharacterBBox(e,o,l,u,n,i,()=>o.measureText(t)).recordDependencies(e,s5);o.strokeText(t,n,i)}}if(d){var O;(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:YY(o),x:n,y:i,fontSize:u,path:m}),null===(O=this.dependencyTracker)||void 0===O||O.recordCharacterBBox(e,o,l,u,n,i)}}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return mY(this,"isFontSubpixelAAEnabled",n)}showText(e,t){var n;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,c5).resetBBox(e),this.current.textRenderingMode&UH&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,r=i.font;var s;if(r.isType3Font)return this.showType3Text(e,t),void(null===(s=this.dependencyTracker)||void 0===s||s.recordShowTextOperation(e));const o=i.fontSize;var a;if(0===o)return void(null===(a=this.dependencyTracker)||void 0===a||a.recordOperation(e));const l=this.ctx,c=i.fontSizeScale,u=i.charSpacing,h=i.wordSpacing,d=i.fontDirection,p=i.textHScale*d,f=t.length,m=r.vertical,g=m?1:-1,v=r.defaultVMetrics,y=o*i.fontMatrix[0],O=i.textRenderingMode===jH&&!r.disableFontFace&&!i.patternFill;let w,b;l.save(),i.textMatrix&&l.transform(...i.textMatrix),l.translate(i.x,i.y+i.textRise),d>0?l.scale(p,-1):l.scale(p,1);const k=i.textRenderingMode&VH,x=k===$H||k===zH;if((k===jH||k===zH)&&i.patternFill){l.save();const t=i.fillColor.getPattern(l,this,GY(l),d5,e);w=YY(l),l.restore(),l.fillStyle=t}if(x&&i.patternStroke){l.save();const t=i.strokeColor.getPattern(l,this,GY(l),p5,e);b=YY(l),l.restore(),l.strokeStyle=t}let D=i.lineWidth;const S=i.textMatrixScale;if(0===S||0===D?x&&(D=this.getSinglePixelWidth()):D/=S,1!==c&&(l.scale(c,c),D/=c),l.lineWidth=D,r.isInvalidPDFjsFont){const n=[];let r=0;for(const e of t)n.push(e.unicode),r+=e.width;const s=n.join("");if(l.fillText(s,0,0),null!==this.dependencyTracker){const t=l.measureText(s);this.dependencyTracker.recordBBox(e,this.ctx,-t.actualBoundingBoxLeft,t.actualBoundingBoxRight,-t.actualBoundingBoxAscent,t.actualBoundingBoxDescent).recordShowTextOperation(e)}return i.x+=r*y*p,l.restore(),void this.compose()}let C,A=0;for(C=0;C<f;++C){const n=t[C];if("number"===typeof n){A+=g*n*o/1e3;continue}let i=!1;const s=(n.isSpace?h:0)+u,a=n.fontChar,p=n.accent;let f,k,x,D=n.width;if(m){const e=n.vmetric||v,t=-(n.vmetric?e[1]:.5*D)*y,i=e[2]*y;D=e?-e[0]:D,f=t/c,k=(A+i)/c}else f=A/c,k=0;if(r.remeasure&&D>0){x=l.measureText(a);const e=1e3*x.width/o*c;if(D<e&&this.isFontSubpixelAAEnabled){const t=D/e;i=!0,l.save(),l.scale(t,1),f/=t}else D!==e&&(f+=(D-e)/2e3*o/c)}var E;if(this.contentVisible&&(n.isInFont||r.missingFile))if(O&&!p)l.fillText(a,f,k),null===(E=this.dependencyTracker)||void 0===E||E.recordCharacterBBox(e,l,x?{bbox:null}:r,o/c,f,k,()=>null!==x&&void 0!==x?x:l.measureText(a));else if(this.paintChar(e,a,f,k,w,b),p){const t=f+o*p.offset.x/c,n=k-o*p.offset.y/c;this.paintChar(e,p.fontChar,t,n,w,b)}A+=m?D*y-s*d:D*y+s*d,i&&l.restore()}m?i.y-=A:i.x+=A*p,l.restore(),this.compose(),null===(n=this.dependencyTracker)||void 0===n||n.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,i=this.current,r=i.font,s=i.fontSize,o=i.fontDirection,a=r.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,u=i.textHScale*o,h=i.fontMatrix||DH,d=t.length;let p,f,m,g;if(i.textRenderingMode===WH||0===s)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),i.textMatrix&&n.transform(...i.textMatrix),n.translate(i.x,i.y+i.textRise),n.scale(u,o);const v=this.dependencyTracker;for(this.dependencyTracker=v?new r5(v,e):null,p=0;p<d;++p){if(f=t[p],"number"===typeof f){g=a*f*s/1e3,this.ctx.translate(g,0),i.x+=g*u;continue}const e=(f.isSpace?c:0)+l,o=r.charProcOperatorList[f.operatorListId];o?this.contentVisible&&(this.save(),n.scale(s,s),n.transform(...h),this.executeOperatorList(o),this.restore()):uY('Type3 character "'.concat(f.operatorListId,'" is not available.'));const d=[f.width,0];CY.applyTransform(d,h),m=d[0]*s+e,n.translate(m,0),i.x+=m*u}n.restore(),v&&(this.dependencyTracker=v)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,i,r,s,o){var a;const l=new Path2D;l.rect(i,r,s-i,o-r),this.ctx.clip(l),null===(a=this.dependencyTracker)||void 0===a||a.recordBBox(e,this.ctx,i,s,r,o).recordClipBox(e,this.ctx,i,s,r,o),this.endPath(e)}getColorN_Pattern(e,t){let n;if("TilingPattern"===t[0]){const e=this.baseTransform||YY(this.ctx),i={createCanvasGraphics:(e,t)=>new W5(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new r5(this.dependencyTracker,t,!0):null)};n=new D5(t,this.ctx,i,e)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("strokeColor",e);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.current.strokeColor=this.getColorN_Pattern(e,i),this.current.patternStroke=!0}setFillColorN(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("fillColor",e);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.current.fillColor=this.getColorN_Pattern(e,i),this.current.patternFill=!0}setStrokeRGBColor(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=function(e){switch(e[0]){case"RadialAxial":return new v5(e);case"Mesh":return new w5(e);case"Dummy":return new b5}throw new Error("Unknown IR type: ".concat(e[0]))}(this.getObject(e,t)),this.cachedPatterns.set(t,n)),i&&(n.matrix=i),n}shadingFill(e,t){var n;if(!this.contentVisible)return;const i=this.ctx;this.save(e);const r=this._getPattern(e,t);i.fillStyle=r.getPattern(i,this,GY(i),f5,e);const s=GY(i);if(s){const{width:e,height:t}=i.canvas,n=_5.slice();CY.axialAlignedBoundingBox([0,0,e,t],s,n);const[r,o,a,l]=n;this.ctx.fillRect(r,o,a-r,l-o)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,u5).recordDependencies(e,o5).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){hY("Should not call beginInlineImage")}beginImageData(){hY("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=YY(this.ctx),n)){var i;CY.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[t,r,s,o]=n,a=new Path2D;a.rect(t,r,s-t,o-r),this.ctx.clip(a),null===(i=this.dependencyTracker)||void 0===i||i.recordClipBox(e,this.ctx,t,s,r,o),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var n;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;t.isolated||cY("TODO: Support non-isolated groups."),t.knockout&&uY("Knockout groups not supported.");const r=YY(i);if(t.matrix&&i.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=_5.slice();CY.axialAlignedBoundingBox(t.bbox,YY(i),s);const o=[0,0,i.canvas.width,i.canvas.height];s=CY.intersect(s,o)||[0,0,0,0];const a=Math.floor(s[0]),l=Math.floor(s[1]),c=Math.max(Math.ceil(s[2])-a,1),u=Math.max(Math.ceil(s[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,u]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,c,u),p=d.context;p.translate(-a,-l),p.transform(...r);let f=new Path2D;const[m,g,v,y]=t.bbox;if(f.rect(m,g,v-m,y-g),t.matrix){const e=new Path2D;e.addPath(f,new DOMMatrix(t.matrix)),f=e}p.clip(f),t.smask&&this.smaskStack.push({canvas:d.canvas,context:p,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),t.smask&&!this.dependencyTracker||(i.setTransform(1,0,0,1,0,0),i.translate(a,l),i.save()),N5(i,p),this.ctx=p,null===(n=this.dependencyTracker)||void 0===n||n.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(e,t){var n;if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,null===(n=this.dependencyTracker)||void 0===n||n.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const t=YY(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...t);const n=_5.slice();CY.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],t,n),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,n,i,r,s){if(JZ(z5,this,V5).call(this),I5(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const r=n[2]-n[0],o=n[3]-n[1];if(s&&this.annotationCanvasMap){(i=i.slice())[4]-=n[0],i[5]-=n[1],(n=n.slice())[0]=n[1]=0,n[2]=r,n[3]=o,CY.singularValueDecompose2dScale(YY(this.ctx),E5);const{viewportScale:e}=this,s=Math.ceil(r*this.outputScaleX*e),a=Math.ceil(o*this.outputScaleY*e);this.annotationCanvas=this.canvasFactory.create(s,a);const{canvas:l,context:c}=this.annotationCanvas;this.annotationCanvasMap.set(t,l),this.annotationCanvas.savedCtx=this.ctx,this.ctx=c,this.ctx.save(),this.ctx.setTransform(E5[0],0,0,-E5[1],0,o*E5[1]),I5(this.ctx)}else{I5(this.ctx),this.endPath(e);const t=new Path2D;t.rect(n[0],n[1],r,o),this.ctx.clip(t)}}this.current=new M5(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...r)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),JZ(z5,this,U5).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var n;if(!this.contentVisible)return;const i=t.count;(t=this.getObject(e,t.data,t)).count=i;const r=this.ctx,s=this._createMaskCanvas(e,t),o=s.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,s.offsetX,s.offsetY),null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordBBox(e,this.ctx,s.offsetX,s.offsetX+o.width,s.offsetY,s.offsetY+o.height).recordOperation(e),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n){var i,r;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const c=this.ctx;c.save();const u=YY(c);c.transform(n,s,o,a,0,0);const h=this._createMaskCanvas(e,t);c.setTransform(1,0,0,1,h.offsetX-u[4],h.offsetY-u[5]),null===(i=this.dependencyTracker)||void 0===i||i.resetBBox(e);for(let p=0,f=l.length;p<f;p+=2){var d;const t=CY.transform(u,[n,s,o,a,l[p],l[p+1]]);c.drawImage(h.canvas,t[4],t[5]),null===(d=this.dependencyTracker)||void 0===d||d.recordBBox(e,this.ctx,t[4],t[4]+h.canvas.width,t[5],t[5]+h.canvas.height)}c.restore(),this.compose(),null===(r=this.dependencyTracker)||void 0===r||r.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var n,i;if(!this.contentVisible)return;const r=this.ctx,s=this.current.fillColor,o=this.current.patternFill;null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordDependencies(e,h5);for(const l of t){var a;const{data:t,width:n,height:i,transform:c}=l,u=this.cachedCanvases.getCanvas("maskCanvas",n,i),h=u.context;h.save();R5(h,this.getObject(e,t,l)),h.globalCompositeOperation="source-in",h.fillStyle=o?s.getPattern(h,this,GY(r),d5,e):s,h.fillRect(0,0,n,i),h.restore(),r.save(),r.transform(...c),r.scale(1,-1),P5(r,u.canvas,0,0,n,i,0,-1,1,1),null===(a=this.dependencyTracker)||void 0===a||a.recordBBox(e,r,0,n,0,i),r.restore()}this.compose(),null===(i=this.dependencyTracker)||void 0===i||i.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);n?this.paintInlineImageXObject(e,n):uY("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,n,i,r){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s)return void uY("Dependent image isn't ready yet");const o=s.width,a=s.height,l=[];for(let c=0,u=r.length;c<u;c+=2)l.push({transform:[n,0,0,i,r[c],r[c+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(e,s,l)}applyTransferMapsToCanvas(e){return"none"!==this.current.transferMaps&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if("none"===this.current.transferMaps)return e.bitmap;const{bitmap:t,width:n,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",n,i),s=r.context;return s.filter=this.current.transferMaps,s.drawImage(t,0,0),s.filter="none",r.canvas}paintInlineImageXObject(e,t){var n;if(!this.contentVisible)return;const i=t.width,r=t.height,s=this.ctx;this.save(e);const{filter:o}=s;let a;if("none"!==o&&""!==o&&(s.filter="none"),s.scale(1/i,-1/r),t.bitmap)a=this.applyTransferMapsToBitmap(t);else if("function"===typeof HTMLElement&&t instanceof HTMLElement||!t.data)a=t;else{const e=this.cachedCanvases.getCanvas("inlineImage",i,r).context;F5(e,t),a=this.applyTransferMapsToCanvas(e)}const l=this._scaleImage(a,GY(s));s.imageSmoothingEnabled=B5(YY(s),t.interpolate),null===(n=this.dependencyTracker)||void 0===n||n.resetBBox(e).recordBBox(e,s,0,i,-r,0).recordDependencies(e,a5).recordOperation(e),P5(s,l.img,0,0,l.paintWidth,l.paintHeight,0,-r,i,r),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){var i,r;if(!this.contentVisible)return;const s=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const e=t.width,n=t.height,i=this.cachedCanvases.getCanvas("inlineImage",e,n).context;F5(i,t),o=this.applyTransferMapsToCanvas(i)}null===(i=this.dependencyTracker)||void 0===i||i.resetBBox(e);for(const l of n){var a;s.save(),s.transform(...l.transform),s.scale(1,-1),P5(s,o,l.x,l.y,l.w,l.h,0,-1,1,1),null===(a=this.dependencyTracker)||void 0===a||a.recordBBox(e,s,0,1,-1,0),s.restore()}null===(r=this.dependencyTracker)||void 0===r||r.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&(null===(t=this.dependencyTracker)||void 0===t||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,o5).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){var n;null===(n=this.dependencyTracker)||void 0===n||n.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){var i;null===(i=this.dependencyTracker)||void 0===i||i.beginMarkedContent(e),"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;null===(t=this.dependencyTracker)||void 0===t||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const r=this.ctx;var s,o;this.pendingClip?(i||(this.pendingClip===$5?r.clip(t,"evenodd"):r.clip(t)),this.pendingClip=null,null===(s=this.dependencyTracker)||void 0===s||s.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):null===(o=this.dependencyTracker)||void 0===o||o.recordOperation(e);this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=YY(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:r}=this.ctx.getTransform();let s,o;if(0===n&&0===i){const n=Math.abs(t),i=Math.abs(r);if(n===i)if(0===e)s=o=1/n;else{const t=n*e;s=o=t<1?1/t:1}else if(0===e)s=1/n,o=1/i;else{const t=n*e,r=i*e;s=t<1?1/t:1,o=r<1?1/r:1}}else{const a=Math.abs(t*r-n*i),l=Math.hypot(t,n),c=Math.hypot(i,r);if(0===e)s=c/a,o=l/a;else{const t=e*a;s=c>t?c/t:1,o=l>t?l/t:1}}this._cachedScaleForStroking[0]=s,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:i}}=this,[r,s]=this.getScaleForStroking();if(r===s)return n.lineWidth=(i||1)*r,void n.stroke(e);const o=n.getLineDash();t&&n.save(),n.scale(r,s),A5.a=1/r,A5.d=1/s;const a=new Path2D;if(a.addPath(e,A5),o.length>0){const e=Math.max(r,s);n.setLineDash(o.map(t=>t/e)),n.lineDashOffset/=e}n.lineWidth=i||1,n.stroke(a),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}function V5(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}function U5(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==e){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}function X5(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i}for(const os in eY)void 0!==W5.prototype[os]&&(W5.prototype[eY[os]]=W5.prototype[os]);class q5{static get workerPort(){return JZ(q5,this,Z5)._}static set workerPort(e){if(!("undefined"!==typeof Worker&&e instanceof Worker)&&null!==e)throw new Error("Invalid `workerPort` type.");Z5._=JZ(q5,this,e)}static get workerSrc(){return JZ(q5,this,H5)._}static set workerSrc(e){if("string"!==typeof e)throw new Error("Invalid `workerSrc` type.");H5._=JZ(q5,this,e)}}var Z5={_:null},H5={_:""},Y5=new WeakMap,G5=new WeakMap;class K5{constructor(e){let{parsedData:t,rawData:n}=e;KZ(this,Y5,void 0),KZ(this,G5,void 0),nH(Y5,this,t),nH(G5,this,n)}getRaw(){return tH(G5,this)}get(e){var t;return null!==(t=tH(Y5,this).get(e))&&void 0!==t?t:null}[Symbol.iterator](){return tH(Y5,this).entries()}}const J5=Symbol("INTERNAL");var e4=new WeakMap,t4=new WeakMap,n4=new WeakMap,i4=new WeakMap;class r4{constructor(e,t){let{name:n,intent:i,usage:r,rbGroups:s}=t;KZ(this,e4,!1),KZ(this,t4,!1),KZ(this,n4,!1),KZ(this,i4,!0),nH(e4,this,!!(e&AH)),nH(t4,this,!!(e&EH)),this.name=n,this.intent=i,this.usage=r,this.rbGroups=s}get visible(){if(tH(n4,this))return tH(i4,this);if(!tH(i4,this))return!1;const{print:e,view:t}=this.usage;return tH(e4,this)?"OFF"!==(null===t||void 0===t?void 0:t.viewState):!tH(t4,this)||"OFF"!==(null===e||void 0===e?void 0:e.printState)}_setVisible(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e!==J5&&hY("Internal method `_setVisible` called."),nH(n4,this,n),nH(i4,this,t)}}var s4=new WeakMap,o4=new WeakMap,a4=new WeakMap,l4=new WeakMap,c4=new WeakSet;class u4{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:AH;if(iH(this,c4),KZ(this,s4,null),KZ(this,o4,new Map),KZ(this,a4,null),KZ(this,l4,null),this.renderingIntent=t,this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,nH(l4,this,e.order);for(const n of e.groups)tH(o4,this).set(n.id,new r4(t,n));if("OFF"===e.baseState)for(const e of tH(o4,this).values())e._setVisible(J5,!1);for(const t of e.on)tH(o4,this).get(t)._setVisible(J5,!0);for(const t of e.off)tH(o4,this).get(t)._setVisible(J5,!1);nH(a4,this,this.getHash())}}isVisible(e){if(0===tH(o4,this).size)return!0;if(!e)return cY("Optional content group not defined."),!0;if("OCG"===e.type)return tH(o4,this).has(e.id)?tH(o4,this).get(e.id).visible:(uY("Optional content group not found: ".concat(e.id)),!0);if("OCMD"===e.type){if(e.expression)return JZ(c4,this,h4).call(this,e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!tH(o4,this).has(t))return uY("Optional content group not found: ".concat(t)),!0;if(tH(o4,this).get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!tH(o4,this).has(t))return uY("Optional content group not found: ".concat(t)),!0;if(!tH(o4,this).get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!tH(o4,this).has(t))return uY("Optional content group not found: ".concat(t)),!0;if(!tH(o4,this).get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!tH(o4,this).has(t))return uY("Optional content group not found: ".concat(t)),!0;if(tH(o4,this).get(t).visible)return!1}return!0}return uY("Unknown optional content policy ".concat(e.policy,".")),!0}return uY("Unknown group type ".concat(e.type,".")),!0}setVisibility(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=tH(o4,this).get(e);if(i){if(n&&t&&i.rbGroups.length)for(const t of i.rbGroups)for(const n of t){var r;if(n!==e)null===(r=tH(o4,this).get(n))||void 0===r||r._setVisible(J5,!1,!0)}i._setVisible(J5,!!t,!0),nH(s4,this,null)}else uY("Optional content group not found: ".concat(e))}setOCGState(e){let t,{state:n,preserveRB:i}=e;for(const r of n){switch(r){case"ON":case"OFF":case"Toggle":t=r;continue}const e=tH(o4,this).get(r);if(e)switch(t){case"ON":this.setVisibility(r,!0,i);break;case"OFF":this.setVisibility(r,!1,i);break;case"Toggle":this.setVisibility(r,!e.visible,i)}}nH(s4,this,null)}get hasInitialVisibility(){return null===tH(a4,this)||this.getHash()===tH(a4,this)}getOrder(){return tH(o4,this).size?tH(l4,this)?tH(l4,this).slice():[...tH(o4,this).keys()]:null}getGroup(e){return tH(o4,this).get(e)||null}getHash(){if(null!==tH(s4,this))return tH(s4,this);const e=new O1;for(const[t,n]of tH(o4,this))e.update("".concat(t,":").concat(n.visible));return nH(s4,this,e.hexdigest())}[Symbol.iterator](){return tH(o4,this).entries()}}function h4(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const t=e[i];let r;if(Array.isArray(t))r=JZ(c4,this,h4).call(this,t);else{if(!tH(o4,this).has(t))return uY("Optional content group not found: ".concat(t)),!0;r=tH(o4,this).get(t).visible}switch(n){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return"And"===n}var d4=new WeakMap,p4=new WeakMap;class f4{constructor(e,t,n){KZ(this,d4,null),KZ(this,p4,null),h(this,"_fullReader",null),h(this,"_rangeReaders",new Set),h(this,"_source",null),this._source=e,nH(d4,this,t),nH(p4,this,n)}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}getFullReader(){return dY(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new(tH(d4,this))(this)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new(tH(p4,this))(this,e,t);return this._rangeReaders.add(n),n}cancelAllRequests(e){var t;null===(t=this._fullReader)||void 0===t||t.cancel(e);for(const n of new Set(this._rangeReaders))n.cancel(e)}}class m4{constructor(e){h(this,"onProgress",null),h(this,"_contentLength",0),h(this,"_filename",null),h(this,"_headersCapability",Promise.withResolvers()),h(this,"_isRangeSupported",!1),h(this,"_isStreamingSupported",!1),h(this,"_loaded",0),h(this,"_stream",null),this._stream=e}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){hY("Abstract method `read` called")}cancel(e){hY("Abstract method `cancel` called")}}class g4{constructor(e,t,n){h(this,"_stream",null),this._stream=e}async read(){hY("Abstract method `read` called")}cancel(e){hY("Abstract method `cancel` called")}}function v4(e){return e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}var y4=new WeakSet;class O4 extends f4{constructor(e){super(e,b4,k4),iH(this,y4),h(this,"_progressiveDone",!1),h(this,"_queuedChunks",[]);const{pdfDataRangeTransport:t}=e,{initialData:n,progressiveDone:i}=t;if((null===n||void 0===n?void 0:n.length)>0){const e=v4(n);this._queuedChunks.push(e)}this._progressiveDone=i,t.addRangeListener((e,t)=>{JZ(y4,this,w4).call(this,e,t)}),t.addProgressListener((e,t)=>{var n,i;void 0!==t&&(null===(n=this._fullReader)||void 0===n||null===(i=n.onProgress)||void 0===i||i.call(n,{loaded:e,total:t}))}),t.addProgressiveReadListener(e=>{JZ(y4,this,w4).call(this,void 0,e)}),t.addProgressiveDoneListener(()=>{var e;null===(e=this._fullReader)||void 0===e||e.progressiveDone(),this._progressiveDone=!0}),t.transportReady()}getFullReader(){const e=super.getFullReader();return this._queuedChunks=null,e}getRangeReader(e,t){const n=super.getRangeReader(e,t);return n&&(n.onDone=()=>this._rangeReaders.delete(n),this._source.pdfDataRangeTransport.requestDataRange(e,t)),n}cancelAllRequests(e){super.cancelAllRequests(e),this._source.pdfDataRangeTransport.abort()}}function w4(e,t){const n=v4(t);if(void 0===e)this._fullReader?this._fullReader._enqueue(n):this._queuedChunks.push(n);else{const t=this._rangeReaders.keys().find(t=>t._begin===e);dY(t,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),t._enqueue(n)}}class b4 extends m4{constructor(e){super(e),h(this,"_done",!1),h(this,"_queuedChunks",null),h(this,"_requests",[]);const{pdfDataRangeTransport:t,disableRange:n,disableStream:i}=e._source,{length:r,contentDispositionFilename:s}=t;this._queuedChunks=e._queuedChunks||[];for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._done=e._progressiveDone,this._contentLength=r,this._isStreamingSupported=!i,this._isRangeSupported=!n,zY(s)&&(this._filename=s),this._headersCapability.resolve()}_enqueue(e){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunks.push(e);this._loaded+=e.byteLength}}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class k4 extends g4{constructor(e,t,n){super(e,t,n),h(this,"onDone",null),h(this,"_begin",-1),h(this,"_done",!1),h(this,"_queuedChunk",null),h(this,"_requests",[]),this._begin=t}_enqueue(e){var t;if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,null===(t=this.onDone)||void 0===t||t.call(this)}}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){var t;this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,null===(t=this.onDone)||void 0===t||t.call(this)}}function x4(e,t){const n=new Headers;if(!e||!t||"object"!==typeof t)return n;for(const i in t){const e=t[i];void 0!==e&&n.append(i,e)}return n}function D4(e){var t,n;return null!==(t=null===(n=URL.parse(e))||void 0===n?void 0:n.origin)&&void 0!==t?t:null}function S4(e){let{responseHeaders:t,isHttp:n,rangeChunkSize:i,disableRange:r}=e;const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(t.get("Content-Length"),10);if(!Number.isInteger(o))return s;if(s.suggestedLength=o,o<=2*i)return s;if(r||!n)return s;if("bytes"!==t.get("Accept-Ranges"))return s;return"identity"!==(t.get("Content-Encoding")||"identity")||(s.allowRangeRequests=!0),s}function C4(e){const t=e.get("Content-Disposition");if(t){let e=function(e){let t=!0,n=i("filename\\*","i").exec(e);if(n){n=n[1];let e=o(n);return e=unescape(e),e=a(e),e=l(e),s(e)}if(n=function(e){const t=[];let n;const r=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=r.exec(e));){let[,e,i,r]=n;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[i,r]}const s=[];for(let i=0;i<t.length&&i in t;++i){let[e,n]=t[i];n=o(n),e&&(n=unescape(n),0===i&&(n=a(n))),s.push(n)}return s.join("")}(e),n)return s(l(n));if(n=i("filename","i").exec(e),n){n=n[1];let e=o(n);return e=l(e),s(e)}function i(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function r(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const i=new TextDecoder(e,{fatal:!0}),r=xY(n);n=i.decode(r),t=!1}catch(i){}}return n}function s(e){return t&&/[\x80-\xff]/.test(e)&&(e=r("utf-8",e),t&&(e=r("iso-8859-1",e))),e}function o(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const n=t[e].indexOf('"');-1!==n&&(t[e]=t[e].slice(0,n),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,"$1")}e=t.join('"')}return e}function a(e){const t=e.indexOf("'");return-1===t?e:r(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function l(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(e,t,n,i){if("q"===n||"Q"===n)return r(t,i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}));try{i=atob(i)}catch(s){}return r(t,i)})}return""}(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch(n){}if(zY(e))return e}return null}function A4(e,t){return new wY("Unexpected server response (".concat(e,') while retrieving PDF "').concat(t,'".'),e,404===e||0===e&&t.startsWith("file:"))}function E4(e,t){if(e!==t)throw new Error('Expected range response-origin "'.concat(e,'" to match "').concat(t,'".'))}function _4(e,t,n,i){return fetch(e,{method:"GET",headers:t,signal:i.signal,mode:"cors",credentials:n?"include":"same-origin",redirect:"follow"})}function T4(e,t){if(200!==e&&206!==e)throw A4(e,t)}function P4(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:(uY("getArrayBuffer - unexpected data format: ".concat(e)),new Uint8Array(e).buffer)}class M4 extends f4{constructor(e){super(e,F4,R4),h(this,"_responseOrigin",null),this.isHttp=/^https?:/i.test(e.url),this.headers=x4(this.isHttp,e.httpHeaders)}}class F4 extends m4{constructor(e){super(e),h(this,"_abortController",new AbortController),h(this,"_reader",null);const{disableRange:t,disableStream:n,length:i,rangeChunkSize:r,url:s,withCredentials:o}=e._source;this._contentLength=i,this._isStreamingSupported=!n,this._isRangeSupported=!t;const a=new Headers(e.headers);_4(s,a,o,this._abortController).then(n=>{e._responseOrigin=D4(n.url),T4(n.status,s),this._reader=n.body.getReader();const i=n.headers,{allowRangeRequests:o,suggestedLength:a}=S4({responseHeaders:i,isHttp:e.isHttp,rangeChunkSize:r,disableRange:t});this._isRangeSupported=o,this._contentLength=a||this._contentLength,this._filename=C4(i),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new kY("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){var e;await this._headersCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:P4(t),done:!1})}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e),this._abortController.abort()}}class R4 extends g4{constructor(e,t,n){super(e,t,n),h(this,"_abortController",new AbortController),h(this,"_readCapability",Promise.withResolvers()),h(this,"_reader",null);const{url:i,withCredentials:r}=e._source,s=new Headers(e.headers);s.append("Range","bytes=".concat(t,"-").concat(n-1)),_4(i,s,r,this._abortController).then(t=>{E4(D4(t.url),e._responseOrigin),T4(t.status,i),this._reader=t.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:{value:P4(e),done:!1}}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e),this._abortController.abort()}}var N4=new WeakMap,I4=new WeakSet;class B4 extends f4{constructor(e){super(e,$4,q4),iH(this,I4),KZ(this,N4,new WeakMap),h(this,"_responseOrigin",null),this.url=e.url,this.isHttp=/^https?:/i.test(this.url),this.headers=x4(this.isHttp,e.httpHeaders)}_request(e){const t=new XMLHttpRequest,n={validateStatus:null,onHeadersReceived:e.onHeadersReceived,onDone:e.onDone,onError:e.onError,onProgress:e.onProgress};tH(N4,this).set(t,n),t.open("GET",this.url),t.withCredentials=this._source.withCredentials;for(const[i,r]of this.headers)t.setRequestHeader(i,r);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range","bytes=".concat(e.begin,"-").concat(e.end-1)),n.validateStatus=e=>206===e||200===e):n.validateStatus=e=>200===e,t.responseType="arraybuffer",dY(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>e.onError(t.status),t.onreadystatechange=JZ(I4,this,L4).bind(this,t),t.onprogress=JZ(I4,this,Q4).bind(this,t),t.send(null),t}_abortRequest(e){tH(N4,this).has(e)&&(tH(N4,this).delete(e),e.abort())}getRangeReader(e,t){const n=super.getRangeReader(e,t);return n&&(n.onClosed=()=>this._rangeReaders.delete(n)),n}}function Q4(e,t){var n;const i=tH(N4,this).get(e);null===i||void 0===i||null===(n=i.onProgress)||void 0===n||n.call(i,t)}function L4(e,t){const n=tH(N4,this).get(e);if(!n)return;if(e.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==e.readyState)return;if(!tH(N4,this).has(e))return;if(tH(N4,this).delete(e),0===e.status&&this.isHttp)return void n.onError(e.status);const i=e.status||200;if(!n.validateStatus(i))return void n.onError(e.status);const r="string"!==typeof(s=e.response)?s:xY(s).buffer;var s;if(206===i){const t=e.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(t)?n.onDone(r):(uY('Missing or invalid "Content-Range" header.'),n.onError(0))}else r?n.onDone(r):n.onError(e.status)}var j4=new WeakSet;class $4 extends m4{constructor(e){super(e),iH(this,j4),h(this,"_cachedChunks",[]),h(this,"_done",!1),h(this,"_requests",[]),h(this,"_storedError",null);const{length:t}=e._source;this._contentLength=t,this._fullRequestXhr=e._request({onHeadersReceived:JZ(j4,this,z4).bind(this),onDone:JZ(j4,this,W4).bind(this),onError:JZ(j4,this,V4).bind(this),onProgress:JZ(j4,this,U4).bind(this)})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}function z4(){const e=this._stream,{disableRange:t,rangeChunkSize:n}=e._source,i=this._fullRequestXhr;e._responseOrigin=D4(i.responseURL);const r=i.getAllResponseHeaders(),s=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(e=>{const[t,...n]=e.split(": ");return[t,n.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:a}=S4({responseHeaders:s,isHttp:e.isHttp,rangeChunkSize:n,disableRange:t});o&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=C4(s),this._isRangeSupported&&e._abortRequest(i),this._headersCapability.resolve()}function W4(e){if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._cachedChunks.push(e);if(this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}function V4(e){this._storedError=A4(e,this._stream.url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}function U4(e){var t;null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}var X4=new WeakSet;class q4 extends g4{constructor(e,t,n){super(e,t,n),iH(this,X4),h(this,"onClosed",null),h(this,"_done",!1),h(this,"_queuedChunk",null),h(this,"_requests",[]),h(this,"_storedError",null),this._requestXhr=e._request({begin:t,end:n,onHeadersReceived:JZ(X4,this,Z4).bind(this),onDone:JZ(X4,this,H4).bind(this),onError:JZ(X4,this,Y4).bind(this),onProgress:null})}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){var t;this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),null===(t=this.onClosed)||void 0===t||t.call(this)}}function Z4(){var e;const t=D4(null===(e=this._requestXhr)||void 0===e?void 0:e.responseURL);try{E4(t,this._stream._responseOrigin)}catch(n){this._storedError=n,JZ(X4,this,Y4).call(this,0)}}function H4(e){var t;if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunk=e;this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,null===(t=this.onClosed)||void 0===t||t.call(this)}function Y4(e){var t;null!==(t=this._storedError)&&void 0!==t||(this._storedError=A4(e,this._stream.url));for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}const G4=/^[a-z][a-z0-9\-+.]+:/i;function K4(e){const{Readable:t}=process.getBuiltinModule("stream");if("function"===typeof t.toWeb)return t.toWeb(e);return process.getBuiltinModule("module").createRequire("file:///Users/andyt/Stuff/hci-demos/flashy/node_modules/pdfjs-dist/build/pdf.mjs")("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(e)}function J4(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:(uY("getArrayBuffer - unexpected data format: ".concat(e)),new Uint8Array(e).buffer)}class e8 extends f4{constructor(e){super(e,t8,n8),this.url=function(e){if(G4.test(e))return new URL(e);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(e))}(e.url),dY("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs.")}}class t8 extends m4{constructor(e){super(e),h(this,"_reader",null);const{disableRange:t,disableStream:n,length:i,rangeChunkSize:r}=e._source;this._contentLength=i,this._isStreamingSupported=!n,this._isRangeSupported=!t;const s=e.url,o=process.getBuiltinModule("fs");o.promises.lstat(s).then(e=>{const t=K4(o.createReadStream(s));this._reader=t.getReader();const{size:n}=e;n<=2*r&&(this._isRangeSupported=!1),this._contentLength=n,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new kY("Streaming is disabled.")),this._headersCapability.resolve()}).catch(e=>{"ENOENT"===e.code&&(e=A4(0,s.href)),this._headersCapability.reject(e)})}async read(){var e;await this._headersCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.length,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:J4(t),done:!1})}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e)}}class n8 extends g4{constructor(e,t,n){super(e,t,n),h(this,"_readCapability",Promise.withResolvers()),h(this,"_reader",null);const i=e.url,r=process.getBuiltinModule("fs");try{const e=K4(r.createReadStream(i,{start:t,end:n-1}));this._reader=e.getReader(),this._readCapability.resolve()}catch(s){this._readCapability.reject(s)}}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:{value:J4(e),done:!1}}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e)}}const i8=Symbol("INITIAL_DATA");var r8=new WeakMap,s8=new WeakSet;class o8{constructor(){iH(this,s8),KZ(this,r8,Object.create(null))}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){const n=JZ(s8,this,a8).call(this,e);return n.promise.then(()=>t(n.data)),null}const n=tH(r8,this)[e];if(!n||n.data===i8)throw new Error("Requesting object that isn't resolved yet ".concat(e,"."));return n.data}has(e){const t=tH(r8,this)[e];return!!t&&t.data!==i8}delete(e){const t=tH(r8,this)[e];return!(!t||t.data===i8)&&(delete tH(r8,this)[e],!0)}resolve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=JZ(s8,this,a8).call(this,e);n.data=t,n.resolve()}clear(){for(const t in tH(r8,this)){var e;const{data:n}=tH(r8,this)[t];null===n||void 0===n||null===(e=n.bitmap)||void 0===e||e.close()}nH(r8,this,Object.create(null))}*[Symbol.iterator](){for(const e in tH(r8,this)){const{data:t}=tH(r8,this)[e];t!==i8&&(yield[e,t])}}}function a8(e){var t;return(t=tH(r8,this))[e]||(t[e]=p(p({},Promise.withResolvers()),{},{data:i8}))}var l8=new WeakMap,c8=new WeakMap,u8=new WeakMap,h8=new WeakMap,d8=new WeakMap,p8=new WeakMap,f8=new WeakMap,m8=new WeakMap,g8=new WeakMap,v8=new WeakMap,y8=new WeakMap,O8=new WeakMap,w8=new WeakMap,b8=new WeakMap,k8=new WeakMap,x8=new WeakMap,D8=new WeakMap,S8=new WeakMap,C8=new WeakSet;class A8{constructor(e){var t;let{textContentSource:n,container:i,viewport:r}=e;if(iH(this,C8),KZ(this,l8,Promise.withResolvers()),KZ(this,c8,null),KZ(this,u8,!1),KZ(this,h8,!(null===(t=globalThis.FontInspector)||void 0===t||!t.enabled)),KZ(this,d8,null),KZ(this,p8,null),KZ(this,f8,0),KZ(this,m8,0),KZ(this,g8,null),KZ(this,v8,null),KZ(this,y8,0),KZ(this,O8,0),KZ(this,w8,Object.create(null)),KZ(this,b8,[]),KZ(this,k8,null),KZ(this,x8,[]),KZ(this,D8,new WeakMap),KZ(this,S8,null),n instanceof ReadableStream)nH(k8,this,n);else{if("object"!==typeof n)throw new Error('No "textContentSource" parameter specified.');nH(k8,this,new ReadableStream({start(e){e.enqueue(n),e.close()}}))}nH(c8,this,nH(v8,this,i)),nH(O8,this,r.scale*JY.pixelRatio),nH(y8,this,r.rotation),nH(p8,this,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:o,pageX:a,pageY:l}=r.rawDims;nH(S8,this,[1,0,0,-1,-a,l+o]),nH(m8,this,s),nH(f8,this,o),F8.call(A8),i.style.setProperty("--min-font-size",Q8._),KY(i,r),tH(l8,this).promise.finally(()=>{L8._.delete(this),nH(p8,this,null),nH(w8,this,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=DY.platform;return mY(this,"fontFamilyMap",new Map([["sans-serif","".concat(e&&t?"Calibri, ":"","sans-serif")],["monospace","".concat(e&&t?"Lucida Console, ":"","monospace")]]))}render(){const e=()=>{tH(g8,this).read().then(t=>{var n;let{value:i,done:r}=t;r?tH(l8,this).resolve():(null!==(n=tH(d8,this))&&void 0!==n||nH(d8,this,i.lang),Object.assign(tH(w8,this),i.styles),JZ(C8,this,E8).call(this,i.items),e())},tH(l8,this).reject)};return nH(g8,this,tH(k8,this).getReader()),L8._.add(this),e(),tH(l8,this).promise}update(e){let{viewport:t,onBefore:n=null}=e;const i=t.scale*JY.pixelRatio,r=t.rotation;if(r!==tH(y8,this)&&(null===n||void 0===n||n(),nH(y8,this,r),KY(tH(v8,this),{rotation:r})),i!==tH(O8,this)){null===n||void 0===n||n(),nH(O8,this,i);const e={div:null,properties:null,ctx:P8.call(A8,tH(d8,this))};for(const t of tH(x8,this))e.properties=tH(D8,this).get(t),e.div=t,JZ(C8,this,T8).call(this,e)}}cancel(){var e;const t=new kY("TextLayer task cancelled.");null===(e=tH(g8,this))||void 0===e||e.cancel(t).catch(()=>{}),nH(g8,this,null),tH(l8,this).reject(t)}get textDivs(){return tH(x8,this)}get textContentItemsStr(){return tH(b8,this)}static cleanup(){if(!(JZ(A8,this,L8)._.size>0)){JZ(A8,this,N8)._.clear();for(const{canvas:e}of JZ(A8,this,I8)._.values())e.remove();JZ(A8,this,I8)._.clear()}}}function E8(e){var t,n;if(tH(u8,this))return;null!==(n=(t=tH(p8,this)).ctx)&&void 0!==n||(t.ctx=P8.call(pH,tH(d8,this)));const i=tH(x8,this),r=tH(b8,this);for(const s of e){if(i.length>1e5)return uY("Ignoring additional textDivs for performance reasons."),void nH(u8,this,!0);if(void 0!==s.str)r.push(s.str),JZ(C8,this,_8).call(this,s);else if("beginMarkedContentProps"===s.type||"beginMarkedContent"===s.type){const e=tH(c8,this);nH(c8,this,document.createElement("span")),tH(c8,this).classList.add("markedContent"),s.id&&tH(c8,this).setAttribute("id","".concat(s.id)),"Artifact"===s.tag&&(tH(c8,this).ariaHidden=!0),e.append(tH(c8,this))}else"endMarkedContent"===s.type&&nH(c8,this,tH(c8,this).parentNode)}}function _8(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==e.str,hasEOL:e.hasEOL,fontSize:0};tH(x8,this).push(t);const i=CY.transform(tH(S8,this),e.transform);let r=Math.atan2(i[1],i[0]);const s=tH(w8,this)[e.fontName];s.vertical&&(r+=Math.PI/2);let o=tH(h8,this)&&s.fontSubstitution||s.fontFamily;o=pH.fontFamilyMap.get(o)||o;const a=Math.hypot(i[2],i[3]),l=a*R8.call(pH,o,s,tH(d8,this));let c,u;0===r?(c=i[4],u=i[5]-l):(c=i[4]+l*Math.sin(r),u=i[5]-l*Math.cos(r));const h=t.style;h.left="".concat((100*c/tH(m8,this)).toFixed(2),"%"),h.top="".concat((100*u/tH(f8,this)).toFixed(2),"%"),h.setProperty("--font-height","".concat(a.toFixed(2),"px")),h.fontFamily=o,n.fontSize=a,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,tH(h8,this)&&(t.dataset.fontName=s.fontSubstitutionLoadedName||e.fontName),0!==r&&(n.angle=r*(180/Math.PI));let d=!1;if(e.str.length>1)d=!0;else if(" "!==e.str&&e.transform[0]!==e.transform[3]){const t=Math.abs(e.transform[0]),n=Math.abs(e.transform[3]);t!==n&&Math.max(t,n)/Math.min(t,n)>1.5&&(d=!0)}if(d&&(n.canvasWidth=s.vertical?e.height:e.width),tH(D8,this).set(t,n),tH(p8,this).div=t,tH(p8,this).properties=n,JZ(C8,this,T8).call(this,tH(p8,this)),n.hasText&&tH(c8,this).append(t),n.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),tH(c8,this).append(e)}}function T8(e){const{div:t,properties:n,ctx:i}=e,{style:r}=t;if(0!==n.canvasWidth&&n.hasText){const{fontFamily:e}=r,{canvasWidth:s,fontSize:o}=n;M8.call(pH,i,o*tH(O8,this),e);const{width:a}=i.measureText(t.textContent);a>0&&r.setProperty("--scale-x",s*tH(O8,this)/a)}0!==n.angle&&r.setProperty("--rotate","".concat(n.angle,"deg"))}function P8(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=JZ(pH,this,I8)._.get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),JZ(pH,this,I8)._.set(e,t),JZ(pH,this,B8)._.set(t,{size:0,family:""})}return t}function M8(e,t,n){const i=JZ(pH,this,B8)._.get(e);t===i.size&&n===i.family||(e.font="".concat(t,"px ").concat(n),i.size=t,i.family=n)}function F8(){if(null!==JZ(pH,this,Q8)._)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),Q8._=JZ(pH,this,e.getBoundingClientRect().height),e.remove()}function R8(e,t,n){const i=JZ(pH,this,N8)._.get(e);if(i)return i;const r=JZ(pH,this,P8).call(this,n);r.canvas.width=r.canvas.height=30,JZ(pH,this,M8).call(this,r,30,e);const s=r.measureText(""),o=s.fontBoundingBoxAscent,a=Math.abs(s.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let l=.8;return o?l=o/(o+a):(DY.platform.isFirefox&&uY("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?l=t.ascent:t.descent&&(l=1+t.descent)),JZ(pH,this,N8)._.set(e,l),l}pH=A8;var N8={_:new Map},I8={_:new Map},B8={_:new WeakMap},Q8={_:null},L8={_:new Set};function j8(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"string"===typeof n||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const i=new $8,{docId:r}=i,s=n.url?function(e){if(e instanceof URL)return e.href;if("string"===typeof e){if(xH)return e;const t=URL.parse(e,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(n.url):null,o=n.data?function(e){if(xH&&"undefined"!==typeof Buffer&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if("string"===typeof e)return xY(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||"object"===typeof e&&!isNaN(null===e||void 0===e?void 0:e.length))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(n.data):null,a=n.httpHeaders||null,l=!0===n.withCredentials,c=null!==(e=n.password)&&void 0!==e?e:null,u=n.range instanceof Z8?n.range:null,h=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:65536;let d=n.worker instanceof o6?n.worker:null;const p=n.verbosity,f="string"!==typeof n.docBaseUrl||$Y(n.docBaseUrl)?null:n.docBaseUrl,m=g2(n.cMapUrl),g=!1!==n.cMapPacked,v=n.CMapReaderFactory||(xH?b3:U2),y=g2(n.iccUrl),O=g2(n.standardFontDataUrl),w=n.StandardFontDataFactory||(xH?k3:m3),b=g2(n.wasmUrl),k=n.WasmFactory||(xH?x3:v3),x=!0!==n.stopAtErrors,D=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,S=!1!==n.isEvalSupported,C="boolean"===typeof n.isOffscreenCanvasSupported?n.isOffscreenCanvasSupported:!xH,A="boolean"===typeof n.isImageDecoderSupported?n.isImageDecoderSupported:!xH&&(DY.platform.isFirefox||!globalThis.chrome),E=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,_="boolean"===typeof n.disableFontFace?n.disableFontFace:xH,T=!0===n.fontExtraProperties,P=!0===n.enableXfa,M=n.ownerDocument||globalThis.document,F=!0===n.disableRange,R=!0===n.disableStream,N=!0===n.disableAutoFetch,I=!0===n.pdfBug,B=n.CanvasFactory||(xH?w3:W2),Q=n.FilterFactory||(xH?O3:t3),L=!0===n.enableHWA,j=!1!==n.useWasm,$=u?u.length:null!==(t=n.length)&&void 0!==t?t:NaN,z="boolean"===typeof n.useSystemFonts?n.useSystemFonts:!xH&&!_,W="boolean"===typeof n.useWorkerFetch?n.useWorkerFetch:!!(v===U2&&w===m3&&k===v3&&m&&O&&b&&VY(m,document.baseURI)&&VY(O,document.baseURI)&&VY(b,document.baseURI));aY(p);const V={canvasFactory:new B({ownerDocument:M,enableHWA:L}),filterFactory:new Q({docId:r,ownerDocument:M}),cMapReaderFactory:W?null:new v({baseUrl:m,isCompressed:g}),standardFontDataFactory:W?null:new w({baseUrl:O}),wasmFactory:W?null:new k({baseUrl:b})};d||(d=o6.create({verbosity:p,port:q5.workerPort}),i._worker=d);const U={docId:r,apiVersion:"5.4.624",data:o,password:c,disableAutoFetch:N,rangeChunkSize:h,length:$,docBaseUrl:f,enableXfa:P,evaluatorOptions:{maxImageSize:D,disableFontFace:_,ignoreErrors:x,isEvalSupported:S,isOffscreenCanvasSupported:C,isImageDecoderSupported:A,canvasMaxAreaInBytes:E,fontExtraProperties:T,useSystemFonts:z,useWasm:j,useWorkerFetch:W,cMapUrl:m,iccUrl:y,standardFontDataUrl:O,wasmUrl:b}},X={ownerDocument:M,pdfBug:I,styleElement:null,enableHWA:L,loadingParams:{disableAutoFetch:N,enableXfa:P}};return d.promise.then(function(){if(i.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const e=d.messageHandler.sendWithPromise("GetDocRequest",U,o?[o.buffer]:null);let t;if(u)t=new O4({pdfDataRangeTransport:u,disableRange:F,disableStream:R});else if(!o){if(!s)throw new Error("getDocument - no `url` parameter provided.");const e=VY(s)?M4:xH?e8:B4;t=new e({url:s,length:$,httpHeaders:a,withCredentials:l,rangeChunkSize:h,disableRange:F,disableStream:R})}return e.then(e=>{if(i.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const n=new I2(r,e,d.port),s=new D6(n,i,t,X,V);i._transport=s,n.send("Ready",null)})}).catch(i._capability.reject),i}class $8{constructor(){h(this,"_capability",Promise.withResolvers()),h(this,"_transport",null),h(this,"_worker",null),h(this,"docId","d".concat((z8._=(fH=z8._,mH=fH++,fH),mH))),h(this,"destroyed",!1),h(this,"onPassword",null),h(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e;this.destroyed=!0;try{var t,n;null!==(t=this._worker)&&void 0!==t&&t.port&&(this._worker._pendingDestroy=!0),await(null===(n=this._transport)||void 0===n?void 0:n.destroy())}catch(r){var i;throw null!==(i=this._worker)&&void 0!==i&&i.port&&delete this._worker._pendingDestroy,r}this._transport=null,null===(e=this._worker)||void 0===e||e.destroy(),this._worker=null}async getData(){return this._transport.getData()}}var z8={_:0},W8=new WeakMap,V8=new WeakMap,U8=new WeakMap,X8=new WeakMap,q8=new WeakMap;class Z8{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;KZ(this,W8,Promise.withResolvers()),KZ(this,V8,[]),KZ(this,U8,[]),KZ(this,X8,[]),KZ(this,q8,[]),this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(e){tH(q8,this).push(e)}addProgressListener(e){tH(X8,this).push(e)}addProgressiveReadListener(e){tH(U8,this).push(e)}addProgressiveDoneListener(e){tH(V8,this).push(e)}onDataRange(e,t){for(const n of tH(q8,this))n(e,t)}onDataProgress(e,t){tH(W8,this).promise.then(()=>{for(const n of tH(X8,this))n(e,t)})}onDataProgressiveRead(e){tH(W8,this).promise.then(()=>{for(const t of tH(U8,this))t(e)})}onDataProgressiveDone(){tH(W8,this).promise.then(()=>{for(const e of tH(V8,this))e()})}transportReady(){tH(W8,this).resolve()}requestDataRange(e,t){hY("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class H8{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return mY(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Y8=new WeakMap,G8=new WeakMap,K8=new WeakSet;class J8{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];iH(this,K8),KZ(this,Y8,!1),KZ(this,G8,uG.instance),this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new WY:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new o8,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(e){this._pageIndex=e-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new LY({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:r})}getAnnotations(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return mY(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return(null===(e=this._transport._htmlForXfa)||void 0===e?void 0:e.children[this._pageIndex])||null}render(e){var t,n,i;let{canvasContext:r,canvas:s=r.canvas,viewport:o,intent:a="display",annotationMode:l=RH.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:d=null,pageColors:p=null,printAnnotationStorage:f=null,isEditing:m=!1,recordOperations:g=!1,operationsFilter:v=null}=e;null===(t=this._stats)||void 0===t||t.time("Overall");const y=this._transport.getRenderingIntent(a,l,f,m),{renderingIntent:O,cacheKey:w}=y;nH(Y8,this,!1),h||(h=this._transport.getOptionalContentConfig(O));let b=this._intentStates.get(w);b||(b=Object.create(null),this._intentStates.set(w,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const k=!!(O&EH);var x;b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(x=this._stats)||void 0===x||x.time("Page Request"),this._pumpOperatorList(y));const D=Boolean(this._pdfBug&&(null===(n=globalThis.StepperManager)||void 0===n?void 0:n.enabled)),S=!this.recordedBBoxes&&(g||D),C=e=>{if(b.renderTasks.delete(A),S){var t;const e=null===(t=A.gfx)||void 0===t?void 0:t.dependencyTracker.take();e&&(A.stepper&&A.stepper.setOperatorBBoxes(e,A.gfx.dependencyTracker.takeDebugMetadata()),g&&(this.recordedBBoxes=e))}var n;(k&&nH(Y8,this,!0),JZ(K8,this,e6).call(this),e?(A.capability.reject(e),this._abortOperatorList({intentState:b,reason:e instanceof Error?e:new Error(e)})):A.capability.resolve(),this._stats)&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),null!==(n=globalThis.Stats)&&void 0!==n&&n.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},A=new T6({callback:C,params:{canvas:s,canvasContext:r,dependencyTracker:S?new G3(s,b.operatorList.length,D):null,viewport:o,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:v});((i=b).renderTasks||(i.renderTasks=new Set)).add(A);const E=A.task;return Promise.all([b.displayReadyCapability.promise,h]).then(e=>{var t;let[n,i]=e;if(this.destroyed)C();else{if(null===(t=this._stats)||void 0===t||t.time("Rendering"),!(i.renderingIntent&O))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");A.initializeGraphics({transparency:n,optionalContentConfig:i}),A.operatorListChanged()}}).catch(C),E}getOperatorList(){let{intent:e="display",annotationMode:t=RH.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this._transport.getRenderingIntent(e,t,n,i,!0);let s,o=this._intentStates.get(r.cacheKey);var a,l;(o||(o=Object.create(null),this._intentStates.set(r.cacheKey,o)),o.opListReadCapability)||(s=Object.create(null),s.operatorListChanged=function(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(s))},o.opListReadCapability=Promise.withResolvers(),((a=o).renderTasks||(a.renderTasks=new Set)).add(s),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(l=this._stats)||void 0===l||l.time("Page Request"),this._pumpOperatorList(r));return o.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:e=!1,disableNormalization:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:tH(G8,this).getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:!0===e,disableNormalization:!0===t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(e=>RY.textContent(e));const t=this.streamTextContent(e);return new Promise(function(e,n){const i=t.getReader(),r={items:[],styles:Object.create(null),lang:null};!function t(){i.read().then(function(n){var i;let{value:s,done:o}=n;o?e(r):(null!==(i=r.lang)&&void 0!==i||(r.lang=s.lang),Object.assign(r.styles,s.styles),r.items.push(...s.items),t())},n)}()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),nH(Y8,this,!1),Promise.all(e)}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];nH(Y8,this,!0);const t=JZ(K8,this,e6).call(this);return e&&t&&this._stats&&(this._stats=new WY),t}_startRenderPage(e,t){var n,i;const r=this._intentStates.get(t);r&&(null===(n=this._stats)||void 0===n||n.timeEnd("Page Request"),null===(i=r.displayReadyCapability)||void 0===i||i.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&JZ(K8,this,e6).call(this)}_pumpOperatorList(e){let{renderingIntent:t,cacheKey:n,annotationStorageSerializable:i,modifiedIds:r}=e;const{map:s,transfer:o}=i,a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:tH(G8,this).getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:t,cacheKey:n,annotationStorage:s,modifiedIds:r},o).getReader(),l=this._intentStates.get(n);l.streamReader=a;const c=()=>{a.read().then(e=>{let{value:t,done:n}=e;n?l.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,l),c())},e=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const e of l.renderTasks)e.operatorListChanged();JZ(K8,this,e6).call(this)}if(l.displayReadyCapability)l.displayReadyCapability.reject(e);else{if(!l.opListReadCapability)throw e;l.opListReadCapability.reject(e)}}})};c()}_abortOperatorList(e){let{intentState:t,reason:n,force:i=!1}=e;if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(n instanceof jY){let e=100;return n.extraDelay>0&&n.extraDelay<1e3&&(e+=n.extraDelay),void(t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:n,force:!0})},e))}}if(t.streamReader.cancel(new kY(n.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[e,n]of this._intentStates)if(n===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}function e6(){if(!tH(Y8,this)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),nH(Y8,this,!1),!0}var t6=new WeakMap,n6=new WeakMap,i6=new WeakMap,r6=new WeakMap,s6=new WeakSet;class o6{constructor(){let{name:e=null,port:t=null,verbosity:n=lY()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(iH(this,s6),KZ(this,t6,Promise.withResolvers()),KZ(this,n6,null),KZ(this,i6,null),KZ(this,r6,null),this.name=e,this.destroyed=!1,this.verbosity=n,t){if(f6._.has(t))throw new Error("Cannot use more than one PDFWorker per port.");f6._.set(t,this),JZ(s6,this,l6).call(this,t)}else JZ(s6,this,c6).call(this)}get promise(){return tH(t6,this).promise}get port(){return tH(i6,this)}get messageHandler(){return tH(n6,this)}destroy(){var e,t;this.destroyed=!0,null===(e=tH(r6,this))||void 0===e||e.terminate(),nH(r6,this,null),f6._.delete(tH(i6,this)),nH(i6,this,null),null===(t=tH(n6,this))||void 0===t||t.destroy(),nH(n6,this,null)}static create(e){const t=JZ(o6,this,f6)._.get(null===e||void 0===e?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new o6(e)}static get workerSrc(){if(q5.workerSrc)return q5.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return mY(this,"_setupFakeWorkerGlobal",(async()=>{if(eH(o6,this,h6))return eH(o6,this,h6);return(await import(this.workerSrc)).WorkerMessageHandler})())}}function a6(){tH(t6,this).resolve(),tH(n6,this).send("configure",{verbosity:this.verbosity})}function l6(e){nH(i6,this,e),nH(n6,this,new I2("main","worker",e)),tH(n6,this).on("ready",()=>{}),JZ(s6,this,a6).call(this)}function c6(){if(p6._||h6(gH))return void JZ(s6,this,u6).call(this);let{workerSrc:e}=gH;try{gH._isSameOrigin(window.location,e)||(e=gH._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new I2("main","worker",t),i=()=>{r.abort(),n.destroy(),t.terminate(),this.destroyed?tH(t6,this).reject(new Error("Worker was destroyed")):JZ(s6,this,u6).call(this)},r=new AbortController;t.addEventListener("error",()=>{tH(r6,this)||i()},{signal:r.signal}),n.on("test",e=>{r.abort(),!this.destroyed&&e?(nH(n6,this,n),nH(i6,this,t),nH(r6,this,t),JZ(s6,this,a6).call(this)):i()}),n.on("ready",e=>{if(r.abort(),this.destroyed)i();else try{s()}catch(t){JZ(s6,this,u6).call(this)}});const s=()=>{const e=new Uint8Array;n.send("test",e,[e.buffer])};return void s()}catch(t){cY("The worker has been disabled.")}JZ(s6,this,u6).call(this)}function u6(){p6._||(uY("Setting up fake worker."),p6._=!0),gH._setupFakeWorkerGlobal.then(e=>{var t,n;if(this.destroyed)return void tH(t6,this).reject(new Error("Worker was destroyed"));const i=new b2;nH(i6,this,i);const r="fake".concat((d6._=(t=d6._,n=t++,t),n)),s=new I2(r+"_worker",r,i);e.setup(s,i),nH(n6,this,new I2(r,r+"_worker",i)),JZ(s6,this,a6).call(this)}).catch(e=>{tH(t6,this).reject(new Error('Setting up fake worker failed: "'.concat(e.message,'".')))})}function h6(e){try{var t;return(null===(t=globalThis.pdfjsWorker)||void 0===t?void 0:t.WorkerMessageHandler)||null}catch(n){return null}}gH=o6;var d6={_:0},p6={_:!1},f6={_:new WeakMap};xH&&(p6._=JZ(gH,gH,!0),q5.workerSrc||(q5.workerSrc="./pdf.worker.mjs")),gH._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(null===n||void 0===n||!n.origin||"null"===n.origin)return!1;const i=new URL(t,n);return n.origin===i.origin},gH._createCDNWrapper=e=>{const t='await import("'.concat(e,'");');return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},gH.fromPort=e=>{var t;if(t="`PDFWorker.fromPort` - please use `PDFWorker.create` instead.",console.log("Deprecated API usage: "+t),null===e||void 0===e||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return gH.create(e)};var m6=new WeakMap,g6=new WeakMap,v6=new WeakMap,y6=new WeakMap,O6=new WeakMap,w6=new WeakMap,b6=new WeakMap,k6=new WeakMap,x6=new WeakSet;class D6{constructor(e,t,n,i,r){iH(this,x6),h(this,"downloadInfoCapability",Promise.withResolvers()),KZ(this,m6,null),KZ(this,g6,new Map),KZ(this,v6,null),KZ(this,y6,new Map),KZ(this,O6,new Map),KZ(this,w6,new Map),KZ(this,b6,null),KZ(this,k6,uG.instance),this.messageHandler=e,this.loadingTask=t,nH(v6,this,n),this.commonObjs=new o8,this.fontLoader=new P1({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.enableHWA=i.enableHWA,this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),tH(k6,this).addListener(JZ(x6,this,S6).bind(this))}get annotationStorage(){return mY(this,"annotationStorage",new C1)}getRenderingIntent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:RH.ENABLE,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=AH,o=w1;switch(e){case"any":s=CH;break;case"display":break;case"print":s=EH;break;default:uY("getRenderingIntent - invalid intent: ".concat(e))}const a=s&EH&&n instanceof _1?n:this.annotationStorage;switch(t){case RH.DISABLE:s+=PH;break;case RH.ENABLE:break;case RH.ENABLE_FORMS:s+=_H;break;case RH.ENABLE_STORAGE:s+=TH,o=a.serializable;break;default:uY("getRenderingIntent - invalid annotationMode: ".concat(t))}i&&(s+=MH),r&&(s+=FH);const{ids:l,hash:c}=a.modifiedIds;return{renderingIntent:s,cacheKey:[s,o.hash,c].join("_"),annotationStorageSerializable:o,modifiedIds:l}}destroy(){var e;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),null===(e=tH(b6,this))||void 0===e||e.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of tH(y6,this).values())t.push(i._destroy());tH(y6,this).clear(),tH(O6,this).clear(),tH(w6,this).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then(()=>{var e,t;this.commonObjs.clear(),this.fontLoader.clear(),tH(g6,this).clear(),this.filterFactory.destroy(),A8.cleanup(),null===(e=tH(v6,this))||void 0===e||e.cancelAllRequests(new kY("Worker was terminated.")),null===(t=this.messageHandler)||void 0===t||t.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(e,t)=>{dY(tH(v6,this),"GetReader - no `BasePDFStream` instance available."),nH(m6,this,tH(v6,this).getFullReader()),tH(m6,this).onProgress=e=>JZ(x6,this,A6).call(this,e),t.onPull=()=>{tH(m6,this).read().then(function(e){let{value:n,done:i}=e;i?t.close():(dY(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{tH(m6,this).cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on("ReaderHeadersReady",async e=>{await tH(m6,this).headersReady;const{isStreamingSupported:t,isRangeSupported:n,contentLength:i}=tH(m6,this);return t&&n&&(tH(m6,this).onProgress=null),{isStreamingSupported:t,isRangeSupported:n,contentLength:i}}),e.on("GetRangeReader",(e,t)=>{dY(tH(v6,this),"GetRangeReader - no `BasePDFStream` instance available.");const n=tH(v6,this).getRangeReader(e.begin,e.end);n?(t.onPull=()=>{n.read().then(function(e){let{value:n,done:i}=e;i?t.close():(dY(n instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{n.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}):t.close()}),e.on("GetDoc",e=>{let{pdfInfo:n}=e;tH(k6,this).pagesNumber=n.numPages,this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new H8(n,this))}),e.on("DocException",e=>{t._capability.reject(F2(e))}),e.on("PasswordRequest",e=>{nH(b6,this,Promise.withResolvers());try{if(!t.onPassword)throw F2(e);const n=e=>{e instanceof Error?tH(b6,this).reject(e):tH(b6,this).resolve({password:e})};t.onPassword(n,e.code)}catch(n){tH(b6,this).reject(n)}return tH(b6,this).promise}),e.on("DataLoaded",e=>{JZ(x6,this,A6).call(this,{loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),e.on("StartRenderPage",e=>{if(this.destroyed)return;tH(y6,this).get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),e.on("commonobj",t=>{var n;let[i,r,s]=t;if(this.destroyed)return null;if(this.commonObjs.has(i))return null;switch(r){case"Font":if("error"in s){const e=s.error;uY("Error during font loading: ".concat(e)),this.commonObjs.resolve(i,e);break}const t=new Y1(s),o=this._params.pdfBug&&null!==(n=globalThis.FontInspector)&&void 0!==n&&n.enabled?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,a=new F1(t,o,s.extra,s.charProcOperatorList);this.fontLoader.bind(a).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!a.fontExtraProperties&&a.data&&a.clearData(),this.commonObjs.resolve(i,a)});break;case"CopyLocalImage":const{imageRef:l}=s;dY(l,"The imageRef must be defined.");for(const e of tH(y6,this).values())for(const[,t]of e.objs)if((null===t||void 0===t?void 0:t.ref)===l)return t.dataLen?(this.commonObjs.resolve(i,structuredClone(t)),t.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new m2(s));break;case"Image":this.commonObjs.resolve(i,s);break;case"Pattern":const c=new s2(s);this.commonObjs.resolve(i,c.getIR());break;default:throw new Error("Got unknown common object type ".concat(r))}return null}),e.on("obj",e=>{let[t,n,i,r]=e;if(this.destroyed)return;const s=tH(y6,this).get(n);var o;if(!s.objs.has(t))if(0!==s._intentStates.size)switch(i){case"Image":case"Pattern":s.objs.resolve(t,r);break;default:throw new Error("Got unknown object type ".concat(i))}else null===r||void 0===r||null===(o=r.bitmap)||void 0===o||o.close()}),e.on("DocProgress",e=>{this.destroyed||JZ(x6,this,A6).call(this,e)}),e.on("FetchBinaryData",async e=>{if(this.destroyed)throw new Error("Worker was destroyed.");const t=this[e.type];if(!t)throw new Error("".concat(e.type," not initialized, see the `useWorkerFetch` parameter."));return t.fetch(e)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var e,t;this.annotationStorage.size<=0&&uY("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:n,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:n,filename:null!==(e=null===(t=tH(m6,this))||void 0===t?void 0:t.filename)&&void 0!==e?e:null},i).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>tH(k6,this).pagesNumber)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=tH(k6,this).getPageId(e)-1,i=tH(O6,this).get(t);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(e=>{if(this.destroyed)throw new Error("Transport destroyed");e.refStr&&tH(w6,this).set(e.refStr,n);const i=new J8(t,e,this,this._params.pdfBug);return tH(y6,this).set(t,i),i});return tH(O6,this).set(t,r),r}async getPageIndex(e){if(!v2(e))throw new Error("Invalid pageIndex request.");const t=await this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen});return tH(k6,this).getPageNumber(t+1)-1}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:tH(k6,this).getPageId(e+1)-1,intent:t})}getFieldObjects(){return JZ(x6,this,C6).call(this,"GetFieldObjects")}hasJSActions(){return JZ(x6,this,C6).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!==typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return JZ(x6,this,C6).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:tH(k6,this).getPageId(e+1)-1})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:tH(k6,this).getPageId(e+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return JZ(x6,this,C6).call(this,"GetOptionalContentConfig").then(t=>new u4(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=tH(g6,this).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(e=>{var t,n,i,r;return{info:e[0],metadata:e[1]?new K5(e[1]):null,contentDispositionFilename:null!==(t=null===(n=tH(m6,this))||void 0===n?void 0:n.filename)&&void 0!==t?t:null,contentLength:null!==(i=null===(r=tH(m6,this))||void 0===r?void 0:r.contentLength)&&void 0!==i?i:null,hasStructTree:e[2]}});return tH(g6,this).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of tH(y6,this).values()){if(!e.cleanup())throw new Error("startCleanup: Page ".concat(e.pageNumber," is currently rendering."))}this.commonObjs.clear(),e||this.fontLoader.clear(),tH(g6,this).clear(),this.filterFactory.destroy(!0),A8.cleanup()}}cachedPageNumber(e){if(!v2(e))return null;const t=0===e.gen?"".concat(e.num,"R"):"".concat(e.num,"R").concat(e.gen),n=tH(w6,this).get(t);return n>=0?tH(k6,this).getPageNumber(n+1):null}}function S6(){const e=new Map,t=new Map;for(let n=0,i=tH(k6,this).pagesNumber;n<i;n++){const i=tH(k6,this).getPrevPageNumber(n+1)-1,r=tH(y6,this).get(i);r&&e.set(n,r);const s=tH(O6,this).get(i);s&&t.set(n,s)}nH(y6,this,e),nH(O6,this,t)}function C6(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=tH(g6,this).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return tH(g6,this).set(e,i),i}function A6(e){var t,n;let{loaded:i,total:r}=e;null===(t=(n=this.loadingTask).onProgress)||void 0===t||t.call(n,{loaded:i,total:r,percent:FY(Math.round(i/r*100),0,100)})}class E6{constructor(e){h(this,"_internalRenderTask",null),h(this,"onContinue",null),h(this,"onError",null),this._internalRenderTask=e}get promise(){return this._internalRenderTask.capability.promise}cancel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._internalRenderTask.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this._internalRenderTask.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this._internalRenderTask;return e.form||e.canvas&&(null===t||void 0===t?void 0:t.size)>0}}var _6=new WeakMap;class T6{constructor(e){let{callback:t,params:n,objs:i,commonObjs:r,annotationCanvasMap:s,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:h=!1,pageColors:d=null,enableHWA:p=!1,operationsFilter:f=null}=e;KZ(this,_6,null),this.callback=t,this.params=n,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=h,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===u&&"undefined"!==typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new E6(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvas,this._canvasContext=n.canvas?null:n.canvasContext,this._enableHWA=p,this._dependencyTracker=n.dependencyTracker,this._operationsFilter=f}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics(e){var t,n;let{transparency:i=!1,optionalContentConfig:r}=e;if(this.cancelled)return;if(this._canvas){if(P6._.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");P6._.add(this._canvas)}this._pdfBug&&null!==(t=globalThis.StepperManager)&&void 0!==t&&t.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:o,background:a,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new W5(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:r},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:o,viewport:s,transparency:i,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,null===(n=this.graphicsReadyCallback)||void 0===n||n.call(this)}cancel(){var e,t,n;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.running=!1,this.cancelled=!0,null===(e=this.gfx)||void 0===e||e.endDrawing(),tH(_6,this)&&(window.cancelAnimationFrame(tH(_6,this)),nH(_6,this,null)),P6._.delete(this._canvas),i||(i=new jY("Rendering cancelled, page ".concat(this._pageIndex+1),r)),this.callback(i),null===(t=(n=this.task).onError)||void 0===t||t.call(n,i)}operatorListChanged(){var e,t;this.graphicsReady?(null===(e=this.gfx.dependencyTracker)||void 0===e||e.growOperationsCount(this.operatorList.fnArray.length),null===(t=this.stepper)||void 0===t||t.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?nH(_6,this,window.requestAnimationFrame(()=>{nH(_6,this,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),P6._.delete(this._canvas),this.callback())))}}var P6={_:new WeakSet};const M6="5.4.624";var F6=new WeakMap,R6=new WeakMap,N6=new WeakMap,I6=new WeakMap,B6=new WeakMap,Q6=new WeakMap,L6=new WeakMap,j6=new WeakMap,$6=new WeakMap,z6=new WeakMap,W6=new WeakSet;class V6{static get _keyboardManager(){return mY(this,"_keyboardManager",new lK([[["Escape","mac+Escape"],V6.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],V6.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],V6.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],V6.prototype._moveToPrevious],[["Home","mac+Home"],V6.prototype._moveToBeginning],[["End","mac+End"],V6.prototype._moveToEnd]]))}constructor(e){var t,n;let{editor:i=null,uiManager:r=null}=e;iH(this,W6),KZ(this,F6,null),KZ(this,R6,null),KZ(this,N6,void 0),KZ(this,I6,null),KZ(this,B6,!1),KZ(this,Q6,!1),KZ(this,L6,null),KZ(this,j6,void 0),KZ(this,$6,null),KZ(this,z6,null),i?(nH(Q6,this,!1),nH(L6,this,i)):nH(Q6,this,!0),nH(z6,this,(null===i||void 0===i?void 0:i._uiManager)||r),nH(j6,this,tH(z6,this)._eventBus),nH(N6,this,(null===i||void 0===i||null===(t=i.color)||void 0===t?void 0:t.toUpperCase())||(null===(n=tH(z6,this))||void 0===n?void 0:n.highlightColors.values().next().value)||"#FFFF98"),G6._||(G6._=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}renderButton(){const e=nH(F6,this,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",tH(L6,this)&&(e.ariaControls="".concat(tH(L6,this).id,"_colorpicker_dropdown"));const t=tH(z6,this)._signal;e.addEventListener("click",JZ(W6,this,Z6).bind(this),{signal:t}),e.addEventListener("keydown",JZ(W6,this,q6).bind(this),{signal:t});const n=nH(R6,this,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=tH(N6,this),e.append(n),e}renderMainDropdown(){const e=nH(I6,this,JZ(W6,this,U6).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===tH(F6,this))return void JZ(W6,this,Z6).call(this,e);const t=e.target.getAttribute("data-color");t&&JZ(W6,this,X6).call(this,t,e)}_moveToNext(e){var t,n;eH(W6,this,Y6)?e.target!==tH(F6,this)?null===(t=e.target.nextSibling)||void 0===t||t.focus():null===(n=tH(I6,this).firstElementChild)||void 0===n||n.focus():JZ(W6,this,Z6).call(this,e)}_moveToPrevious(e){var t,n;e.target!==(null===(t=tH(I6,this))||void 0===t?void 0:t.firstElementChild)&&e.target!==tH(F6,this)?(eH(W6,this,Y6)||JZ(W6,this,Z6).call(this,e),null===(n=e.target.previousSibling)||void 0===n||n.focus()):eH(W6,this,Y6)&&this._hideDropdownFromKeyboard()}_moveToBeginning(e){var t;eH(W6,this,Y6)?null===(t=tH(I6,this).firstElementChild)||void 0===t||t.focus():JZ(W6,this,Z6).call(this,e)}_moveToEnd(e){var t;eH(W6,this,Y6)?null===(t=tH(I6,this).lastElementChild)||void 0===t||t.focus():JZ(W6,this,Z6).call(this,e)}hideDropdown(){var e,t;null===(e=tH(I6,this))||void 0===e||e.classList.add("hidden"),tH(F6,this).ariaExpanded="false",null===(t=tH($6,this))||void 0===t||t.abort(),nH($6,this,null)}_hideDropdownFromKeyboard(){var e;tH(Q6,this)||(eH(W6,this,Y6)?(this.hideDropdown(),tH(F6,this).focus({preventScroll:!0,focusVisible:tH(B6,this)})):null===(e=tH(L6,this))||void 0===e||e.unselect())}updateColor(e){if(tH(R6,this)&&(tH(R6,this).style.backgroundColor=e),!tH(I6,this))return;const t=tH(z6,this).highlightColors.values();for(const n of tH(I6,this).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;null===(e=tH(F6,this))||void 0===e||e.remove(),nH(F6,this,null),nH(R6,this,null),null===(t=tH(I6,this))||void 0===t||t.remove(),nH(I6,this,null)}}function U6(){const e=document.createElement("div"),t=tH(z6,this)._signal;e.addEventListener("contextmenu",UY,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),tH(L6,this)&&(e.id="".concat(tH(L6,this).id,"_colorpicker_dropdown"));for(const[n,i]of tH(z6,this).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=n,r.setAttribute("data-l10n-id",G6._[n]);const s=document.createElement("span");r.append(s),s.className="swatch",s.style.backgroundColor=i,r.ariaSelected=i===tH(N6,this),r.addEventListener("click",JZ(W6,this,X6).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",JZ(W6,this,q6).bind(this),{signal:t}),e}function X6(e,t){t.stopPropagation(),tH(j6,this).dispatch("switchannotationeditorparams",{source:this,type:BH.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}function q6(e){vH._keyboardManager.exec(this,e)}function Z6(e){if(eH(W6,this,Y6))return void this.hideDropdown();if(nH(B6,this,0===e.detail),tH($6,this)||(nH($6,this,new AbortController),window.addEventListener("pointerdown",JZ(W6,this,H6).bind(this),{signal:tH(z6,this).combinedSignal(tH($6,this))})),tH(F6,this).ariaExpanded="true",tH(I6,this))return void tH(I6,this).classList.remove("hidden");const t=nH(I6,this,JZ(W6,this,U6).call(this));tH(F6,this).append(t)}function H6(e){var t;null!==(t=tH(I6,this))&&void 0!==t&&t.contains(e.target)||this.hideDropdown()}function Y6(e){return tH(I6,e)&&!tH(I6,e).classList.contains("hidden")}vH=V6;var G6={_:null},K6=new WeakMap,J6=new WeakMap,e9=new WeakMap;class t9{constructor(e){KZ(this,K6,null),KZ(this,J6,null),KZ(this,e9,null),nH(J6,this,e),nH(e9,this,e._uiManager),n9._||(n9._=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(tH(K6,this))return tH(K6,this);const{editorType:e,colorType:t,color:n}=tH(J6,this),i=nH(K6,this,document.createElement("input"));return i.type="color",i.value=n||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",n9._[e]),i.addEventListener("input",()=>{tH(e9,this).updateParams(t,i.value)},{signal:tH(e9,this)._signal}),i}update(e){tH(K6,this)&&(tH(K6,this).value=e)}destroy(){var e;null===(e=tH(K6,this))||void 0===e||e.remove(),nH(K6,this,null)}hideDropdown(){}}var n9={_:null};function i9(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}function r9(e){return Math.max(0,Math.min(255,255*e))}class s9{static CMYK_G(e){let[t,n,i,r]=e;return["G",1-Math.min(1,.3*t+.59*i+.11*n+r)]}static G_CMYK(e){let[t]=e;return["CMYK",0,0,0,1-t]}static G_RGB(e){let[t]=e;return["RGB",t,t,t]}static G_rgb(e){let[t]=e;return t=r9(t),[t,t,t]}static G_HTML(e){let[t]=e;const n=i9(t);return"#".concat(n).concat(n).concat(n)}static RGB_G(e){let[t,n,i]=e;return["G",.3*t+.59*n+.11*i]}static RGB_rgb(e){return e.map(r9)}static RGB_HTML(e){return"#".concat(e.map(i9).join(""))}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(e){let[t,n,i,r]=e;return["RGB",1-Math.min(1,t+r),1-Math.min(1,i+r),1-Math.min(1,n+r)]}static CMYK_rgb(e){let[t,n,i,r]=e;return[r9(1-Math.min(1,t+r)),r9(1-Math.min(1,i+r)),r9(1-Math.min(1,n+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK(e){let[t,n,i]=e;const r=1-t,s=1-n,o=1-i;return["CMYK",r,s,o,Math.min(r,s,o)]}}class o9{create(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width","".concat(e,"px")),i.setAttribute("height","".concat(t,"px"))),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox","0 0 ".concat(e," ").concat(t)),i}createElement(e){if("string"!==typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){hY("Abstract method `_createSVG` called.")}}class a9 extends o9{_createSVG(e){return document.createElementNS(IY,e)}}const l9=new WeakSet,c9=60*(new Date).getTimezoneOffset()*1e3;class u9{static create(e){switch(e.data.annotationType){case qH.LINK:return new O9(e);case qH.TEXT:return new x9(e);case qH.WIDGET:switch(e.data.fieldType){case"Tx":return new S9(e);case"Btn":return e.data.radioButton?new E9(e):e.data.checkBox?new A9(e):new _9(e);case"Ch":return new T9(e);case"Sig":return new C9(e)}return new D9(e);case qH.POPUP:return new M9(e);case qH.FREETEXT:return new b7(e);case qH.LINE:return new x7(e);case qH.SQUARE:return new S7(e);case qH.CIRCLE:return new A7(e);case qH.POLYLINE:return new _7(e);case qH.CARET:return new P7(e);case qH.INK:return new N7(e);case qH.POLYGON:return new T7(e);case qH.HIGHLIGHT:return new B7(e);case qH.UNDERLINE:return new Q7(e);case qH.SQUIGGLY:return new L7(e);case qH.STRIKEOUT:return new j7(e);case qH.STAMP:return new $7(e);case qH.FILEATTACHMENT:return new V7(e);default:return new m9(e)}}}var h9=new WeakMap,d9=new WeakMap,p9=new WeakMap,f9=new WeakSet;class m9{constructor(e){let{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};iH(this,f9),KZ(this,h9,null),KZ(this,d9,!1),KZ(this,p9,null),this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData(e){let{contentsObj:t,richText:n}=e;return!!(null!==t&&void 0!==t&&t.str||null!==n&&void 0!==n&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return m9._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var e;const{data:t}=this,n=null===(e=this.annotationStorage)||void 0===e?void 0:e.getEditor(t.id);return n?n.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var e;const t=null===(e=this.annotationStorage)||void 0===e?void 0:e.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:n,inkLists:i,rect:r}=this.data;let s=-1/0,o=-1/0;if((null===n||void 0===n?void 0:n.length)>=8){for(let e=0;e<n.length;e+=8)n[e+1]>o?(o=n[e+1],s=n[e+2]):n[e+1]===o&&(s=Math.max(s,n[e+2]));return[s,o]}if((null===i||void 0===i?void 0:i.length)>=1){for(const e of i)for(let t=0,n=e.length;t<n;t+=2)e[t+1]>o?(o=e[t+1],s=e[t]):e[t+1]===o&&(s=Math.max(s,e[t]));if(s!==1/0)return[s,o]}return r?[r[2],r[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:i,pageX:r,pageY:s}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-r)/n,e[1]=100*(e[1]-s)/i,e}get commentText(){var e,t;const{data:n}=this;return(null===(e=this.annotationStorage.getRawValue("".concat(NH).concat(n.id)))||void 0===e||null===(e=e.popup)||void 0===e?void 0:e.contents)||(null===(t=n.contentsObj)||void 0===t?void 0:t.str)||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue("".concat(NH).concat(t.id),{id:t.id,annotationType:t.annotationType,page:this.parent.page,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;null===(e=(null===(t=tH(p9,this))||void 0===t?void 0:t.popup)||this.popup)||void 0===e||e.remove(),nH(p9,this,this.popup=null)}updateEdited(e){var t;if(!this.container)return;e.rect&&(tH(h9,this)||nH(h9,this,{rect:this.data.rect.slice(0)}));const{rect:n,popup:i}=e;n&&JZ(f9,this,g9).call(this,n);let r=(null===(t=tH(p9,this))||void 0===t?void 0:t.popup)||this.popup;!r&&null!==i&&void 0!==i&&i.text&&(this._createPopup(i),r=tH(p9,this).popup),r&&(r.updateEdited(e),null!==i&&void 0!==i&&i.deleted&&(r.remove(),nH(p9,this,null),this.popup=null))}resetEdited(){var e;tH(h9,this)&&(JZ(f9,this,g9).call(this,tH(h9,this).rect),null===(e=tH(p9,this))||void 0===e||e.popup.resetEdited(),nH(h9,this,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof D9||this instanceof O9||(r.tabIndex=0);const{style:s}=r;if(s.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof M9){const{rotation:e}=t;return t.hasOwnCanvas||0===e||this.setRotation(e,r),r}const{width:o,height:a}=this;if(!e&&t.borderStyle.width>0){s.borderWidth="".concat(t.borderStyle.width,"px");const e=t.borderStyle.horizontalCornerRadius,n=t.borderStyle.verticalCornerRadius;if(e>0||n>0){const t="calc(".concat(e,"px * var(--total-scale-factor)) / calc(").concat(n,"px * var(--total-scale-factor))");s.borderRadius=t}else if(this instanceof E9){const e="calc(".concat(o,"px * var(--total-scale-factor)) / calc(").concat(a,"px * var(--total-scale-factor))");s.borderRadius=e}switch(t.borderStyle.style){case ZH:s.borderStyle="solid";break;case HH:s.borderStyle="dashed";break;case YH:uY("Unimplemented border style: beveled");break;case GH:uY("Unimplemented border style: inset");break;case KH:s.borderBottomStyle="solid"}const i=t.borderColor||null;i?(nH(d9,this,!0),s.borderColor=CY.makeHexColor(0|i[0],0|i[1],0|i[2])):s.borderWidth=0}const l=CY.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:c,pageHeight:u,pageX:h,pageY:d}=i.rawDims;s.left="".concat(100*(l[0]-h)/c,"%"),s.top="".concat(100*(l[1]-d)/u,"%");const{rotation:p}=t;return t.hasOwnCanvas||0===p?(s.width="".concat(100*o/c,"%"),s.height="".concat(100*a/u,"%")):this.setRotation(p,r),r}setRotation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:s}=this;e%180!==0&&([r,s]=[s,r]),t.style.width="".concat(100*r/n,"%"),t.style.height="".concat(100*s/i,"%"),t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,n)=>{const i=n.detail[e],r=i[0],s=i.slice(1);n.target.style[t]=s9["".concat(r,"_HTML")](s),this.annotationStorage.setValue(this.data.id,{[t]:s9["".concat(r,"_rgb")](s)})};return mY(this,"_commonActions",{display:e=>{const{display:t}=e.detail,n=t%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===t||2===t})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:t}=e.detail;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||n[i];null===r||void 0===r||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,r]of Object.entries(t)){const s=n[i];if(s){s({detail:{[i]:r},target:e}),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,r]=this.data.rect.map(e=>Math.fround(e));if(8===e.length){const[s,o,a,l]=e.subarray(2,6);if(i===s&&r===o&&t===a&&n===l)return}const{style:s}=this.container;let o;if(tH(d9,this)){const{borderColor:e,borderWidth:t}=s;s.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">','<g fill="transparent" stroke="'.concat(e,'" stroke-width="').concat(t,'">')],this.container.classList.add("hasBorder")}const a=i-t,l=r-n,{svgFactory:c}=this,u=c.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0),u.role="none";const h=c.createElement("defs");u.append(h);const d=c.createElement("clipPath"),p="clippath_".concat(this.data.id);d.setAttribute("id",p),d.setAttribute("clipPathUnits","objectBoundingBox"),h.append(d);for(let m=2,g=e.length;m<g;m+=8){var f;const n=e[m],i=e[m+1],s=e[m+2],u=e[m+3],h=c.createElement("rect"),p=(s-t)/a,g=(r-i)/l,v=(n-s)/a,y=(i-u)/l;h.setAttribute("x",p),h.setAttribute("y",g),h.setAttribute("width",v),h.setAttribute("height",y),d.append(h),null===(f=o)||void 0===f||f.push('<rect vector-effect="non-scaling-stroke" x="'.concat(p,'" y="').concat(g,'" width="').concat(v,'" height="').concat(y,'"/>'))}tH(d9,this)&&(o.push("</g></svg>')"),s.backgroundImage=o.join("")),this.container.append(u),this.container.style.clipPath="url(#".concat(p,")")}_createPopup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const{data:t}=this;let n,i;e?(n={str:e.text},i=e.date):(n=t.contentsObj,i=t.modificationDate),nH(p9,this,new M9({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:"popup_".concat(t.id),rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(tH(p9,this)||this.popup||this.data.popupRef)}get extraPopupElement(){return tH(p9,this)}render(){hY("Abstract method `AnnotationElement.render` called")}_getElementsByName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:e,id:r,exportValues:s}of i){if(-1===e)continue;if(r===t)continue;const i="string"===typeof s?s:null,o=document.querySelector('[data-element-id="'.concat(r,'"]'));!o||l9.has(o)?n.push({id:r,exportValue:i,domElement:o}):uY("_getElementsByName - element not allowed: ".concat(r))}return n}for(const i of document.getElementsByName(e)){const{exportValue:e}=i,r=i.getAttribute("data-element-id");r!==t&&(l9.has(i)&&n.push({id:r,exportValue:e,domElement:i}))}return n}show(){var e;this.container&&(this.container.hidden=!1),null===(e=this.popup)||void 0===e||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),null===(e=this.popup)||void 0===e||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}function g9(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:s,pageX:o,pageY:a}}}}=this;null===n||void 0===n||n.splice(0,4,...e),t.left="".concat(100*(e[0]-o)/r,"%"),t.top="".concat(100*(s-e[3]+a)/s,"%"),0===i?(t.width="".concat(100*(e[2]-e[0])/r,"%"),t.height="".concat(100*(e[3]-e[1])/s,"%")):this.setRotation(i)}class v9 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var y9=new WeakSet;class O9 extends m9{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,{isRenderable:!0,ignoreBorder:!(null===t||void 0===t||!t.ignoreBorder),createQuadrilaterals:!0}),iH(this,y9),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),i=!0):e.attachment?(JZ(y9,this,b9).call(this,n,e.attachment,e.overlaidText,e.attachmentDest),i=!0):e.setOCGState?(JZ(y9,this,k9).call(this,n,e.setOCGState,e.overlaidText),i=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),i=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&(this.contentElement=n,this.container.append(n)),this.container}_bindLink(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&JZ(y9,this,w9).call(this),n&&(e.title=n)}_bindNamedAction(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),JZ(y9,this,w9).call(this)}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const r=n.get(i);r&&(e[r]=()=>{var e;return null===(e=this.linkService.eventBus)||void 0===e||e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1})}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),JZ(y9,this,w9).call(this)}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),JZ(y9,this,w9).call(this),!this._fieldObjects)return uY('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(e.onclick=()=>!1));e.onclick=()=>{null===n||void 0===n||n();const{fields:e,refs:i,include:r}=t,s=[];if(0!==e.length||0!==i.length){const t=new Set(i);for(const n of e){const e=this._fieldObjects[n]||[];for(const{id:n}of e)t.add(n)}for(const e of Object.values(this._fieldObjects))for(const n of e)t.has(n.id)===r&&s.push(n)}else for(const t of Object.values(this._fieldObjects))s.push(...t);const o=this.annotationStorage,a=[];for(const t of s){const{id:e}=t;switch(a.push(e),t.type){case"text":{const n=t.defaultValue||"";o.setValue(e,{value:n});break}case"checkbox":case"radiobutton":{const n=t.defaultValue===t.exportValues;o.setValue(e,{value:n});break}case"combobox":case"listbox":{const n=t.defaultValue||"";o.setValue(e,{value:n});break}default:continue}const n=document.querySelector('[data-element-id="'.concat(e,'"]'));n&&(l9.has(n)?n.dispatchEvent(new Event("resetform")):uY("_bindResetFormAction - element not allowed: ".concat(e)))}var l;this.enableScripting&&(null===(l=this.linkService.eventBus)||void 0===l||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:a,name:"ResetForm"}}));return!1}}}function w9(){this.container.setAttribute("data-internal-link","")}function b9(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>{var e;return null===(e=this.downloadManager)||void 0===e||e.openOrDownloadData(t.content,t.filename,i),!1},JZ(y9,this,w9).call(this)}function k9(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),JZ(y9,this,w9).call(this)}class x9 extends m9{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class D9 extends m9{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&("CANVAS"===(null===(t=e.previousSibling)||void 0===t?void 0:t.nodeName)&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return DY.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,r){n.includes("mouse")?e.addEventListener(n,e=>{var t;null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})}):e.addEventListener(n,e=>{var s;if("blur"===n){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if("focus"===n){if(t.focused)return;t.focused=!0}r&&(null===(s=this.linkService.eventBus)||void 0===s||s.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(e)}}))})}_setEventListeners(e,t,n,i){for(const[a,l]of n){var r,s,o;if("Action"===l||null!==(r=this.data.actions)&&void 0!==r&&r[l])"Focus"!==l&&"Blur"!==l||t||(t={focused:!1}),this._setEventListener(e,t,a,l,i),"Focus"!==l||null!==(s=this.data.actions)&&void 0!==s&&s.Blur?"Blur"!==l||null!==(o=this.data.actions)&&void 0!==o&&o.Focus||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null)}}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":CY.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||9,r=e.style;let s;const o=e=>Math.round(10*e)/10;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=e/(Math.round(e/(SH*i))||1);s=Math.min(i,o(t/SH))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);s=Math.min(i,o(e/SH))}r.fontSize="calc(".concat(s,"px * var(--total-scale-factor))"),r.color=CY.makeHexColor(n[0],n[1],n[2]),null!==this.data.textAlignment&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class S9 extends D9{constructor(e){super(e,{isRenderable:e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,n,i){const r=this.annotationStorage;for(const s of this._getElementsByName(e.name,e.id))s.domElement&&(s.domElement[t]=n),r.setValue(s.id,{[i]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){var i;const s=e.getValue(t,{value:this.data.fieldValue});let o=s.value||"";const a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&o.length>a&&(o=o.slice(0,a));let l=s.formattedValue||(null===(i=this.data.textContent)||void 0===i?void 0:i.join("\n"))||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const c={userValue:o,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=null!==l&&void 0!==l?l:o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",null!==l&&void 0!==l?l:o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),l9.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:u,datetimeType:h,timeStep:d}=this.data,p=!!h&&this.enableScripting;u&&(n.title=u),this._setRequired(n,this.data.required),a&&(n.maxLength=a),n.addEventListener("input",i=>{e.setValue(t,{value:i.target.value}),this.setPropertyOnSiblings(n,"value",i.target.value,"value"),c.formattedValue=null}),n.addEventListener("resetform",e=>{var t;const i=null!==(t=this.data.defaultFieldValue)&&void 0!==t?t:"";n.value=c.userValue=i,c.formattedValue=null});let f=e=>{const{formattedValue:t}=c;null!==t&&void 0!==t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var r;n.addEventListener("focus",e=>{var t;if(c.focused)return;const{target:n}=e;if(p&&(n.type=h,d&&(n.step=d)),c.userValue){const e=c.userValue;if(p)if("time"===h){const t=new Date(e),i=[t.getHours(),t.getMinutes(),t.getSeconds()];n.value=i.map(e=>e.toString().padStart(2,"0")).join(":")}else n.value=new Date(e-c9).toISOString().split("date"===h?"T":".",1)[0];else n.value=e}c.lastCommittedValue=n.value,c.commitKey=1,null!==(t=this.data.actions)&&void 0!==t&&t.Focus||(c.focused=!0)}),n.addEventListener("updatefromsandbox",n=>{this.showElementAndHideCanvas(n.target);const i={value(n){var i;c.userValue=null!==(i=n.detail.value)&&void 0!==i?i:"",p||e.setValue(t,{value:c.userValue.toString()}),n.target.value=c.userValue},formattedValue(n){const{formattedValue:i}=n.detail;c.formattedValue=i,null!==i&&void 0!==i&&n.target!==document.activeElement&&(n.target.value=i);const r={formattedValue:i};p&&(r.value=i),e.setValue(t,r)},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:n=>{var i;const{charLimit:r}=n.detail,{target:s}=n;if(0===r)return void s.removeAttribute("maxLength");s.setAttribute("maxLength",r);let o=c.userValue;!o||o.length<=r||(o=o.slice(0,r),s.value=c.userValue=o,e.setValue(t,{value:o}),null===(i=this.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:o,willCommit:!0,commitKey:1,selStart:s.selectionStart,selEnd:s.selectionEnd}}))}};this._dispatchEventFromSandbox(i,n)}),n.addEventListener("keydown",e=>{var n;c.commitKey=1;let i=-1;if("Escape"===e.key?i=0:"Enter"!==e.key||this.data.multiLine?"Tab"===e.key&&(c.commitKey=3):i=2,-1===i)return;const{value:r}=e.target;c.lastCommittedValue!==r&&(c.lastCommittedValue=r,c.userValue=r,null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:r,willCommit:!0,commitKey:i,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))});const i=f;f=null,n.addEventListener("blur",e=>{var n;if(!c.focused||!e.relatedTarget)return;null!==(n=this.data.actions)&&void 0!==n&&n.Blur||(c.focused=!1);const{target:r}=e;let{value:s}=r;if(p){if(s&&"time"===h){const e=s.split(":").map(e=>parseInt(e,10));s=new Date(2e3,0,1,e[0],e[1],e[2]||0).valueOf(),r.step=""}else s.includes("T")||(s="".concat(s,"T00:00")),s=new Date(s).valueOf();r.type="text"}var o;(c.userValue=s,c.lastCommittedValue!==s)&&(null===(o=this.linkService.eventBus)||void 0===o||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:s,willCommit:!0,commitKey:c.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}));i(e)}),null!==(r=this.data.actions)&&void 0!==r&&r.Keystroke&&n.addEventListener("beforeinput",e=>{var n;c.lastCommittedValue=null;const{data:i,target:r}=e,{value:s,selectionStart:o,selectionEnd:a}=r;let l=o,u=a;switch(e.inputType){case"deleteWordBackward":{const e=s.substring(0,o).match(/\w*[^\w]*$/);e&&(l-=e[0].length);break}case"deleteWordForward":{const e=s.substring(o).match(/^[^\w]*\w*/);e&&(u+=e[0].length);break}case"deleteContentBackward":o===a&&(l-=1);break;case"deleteContentForward":o===a&&(u+=1)}e.preventDefault(),null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:s,change:i||"",willCommit:!1,selStart:l,selEnd:u}})}),this._setEventListeners(n,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.value)}if(f&&n.addEventListener("blur",f),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/a;n.classList.add("comb"),n.style.letterSpacing="calc(".concat(e,"px * var(--total-scale-factor) - 1ch)")}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class C9 extends D9{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class A9 extends D9{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;"string"===typeof i&&(i="Off"!==i,e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return l9.add(r),r.setAttribute("data-element-id",n),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",i=>{const{name:r,checked:s}=i.target;for(const o of this._getElementsByName(r,n)){const n=s&&o.exportValue===t.exportValue;o.domElement&&(o.domElement.checked=n),e.setValue(o.id,{value:n})}e.setValue(n,{value:s})}),r.addEventListener("resetform",e=>{const n=t.defaultFieldValue||"Off";e.target.checked=n===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",t=>{const i={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(n,{value:t.target.checked})}};this._dispatchEventFromSandbox(i,t)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class E9 extends D9{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if("string"===typeof i&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const s of this._getElementsByName(t.fieldName,n))e.setValue(s.id,{value:!1});const r=document.createElement("input");if(l9.add(r),r.setAttribute("data-element-id",n),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",t=>{const{name:i,checked:r}=t.target;for(const s of this._getElementsByName(i,n))e.setValue(s.id,{value:!1});e.setValue(n,{value:r})}),r.addEventListener("resetform",e=>{const n=t.defaultFieldValue;e.target.checked=null!==n&&void 0!==n&&n===t.buttonValue}),this.enableScripting&&this.hasJSActions){const i=t.buttonValue;r.addEventListener("updatefromsandbox",t=>{const r={value:t=>{const r=i===t.detail.value;for(const i of this._getElementsByName(t.target.name)){const t=r&&i.id===n;i.domElement&&(i.domElement.checked=t),e.setValue(i.id,{value:t})}}};this._dispatchEventFromSandbox(r,t)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class _9 extends O9{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",e=>{this._dispatchEventFromSandbox({},e)})),e}}class T9 extends D9{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");l9.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue;for(const n of i.options)n.selected=n.value===t});for(const c of this.data.options){const e=document.createElement("option");e.textContent=c.displayValue,e.value=c.exportValue,n.value.includes(c.exportValue)&&(e.setAttribute("selected",!0),r=!1),i.append(e)}let s=null;if(r){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),i.prepend(e),s=()=>{e.remove(),i.removeEventListener("input",s),s=null},i.addEventListener("input",s)}const o=e=>{const t=e?"value":"textContent",{options:n,multiple:r}=i;return r?Array.prototype.filter.call(n,e=>e.selected).map(e=>e[t]):-1===n.selectedIndex?null:n[n.selectedIndex][t]};let a=o(!1);const l=e=>{const t=e.target.options;return Array.prototype.map.call(t,e=>({displayValue:e.textContent,exportValue:e.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",n=>{const r={value(n){var r;null===(r=s)||void 0===r||r();const l=n.detail.value,c=new Set(Array.isArray(l)?l:[l]);for(const e of i.options)e.selected=c.has(e.value);e.setValue(t,{value:o(!0)}),a=o(!1)},multipleSelection(e){i.multiple=!0},remove(n){const r=i.options,s=n.detail.remove;if(r[s].selected=!1,i.remove(s),r.length>0){-1===Array.prototype.findIndex.call(r,e=>e.selected)&&(r[0].selected=!0)}e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},clear(n){for(;0!==i.length;)i.remove(0);e.setValue(t,{value:null,items:[]}),a=o(!1)},insert(n){const{index:r,displayValue:s,exportValue:c}=n.detail.insert,u=i.children[r],h=document.createElement("option");h.textContent=s,h.value=c,u?u.before(h):i.append(h),e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},items(n){const{items:r}=n.detail;for(;0!==i.length;)i.remove(0);for(const e of r){const{displayValue:t,exportValue:n}=e,r=document.createElement("option");r.textContent=t,r.value=n,i.append(r)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},indices(n){const i=new Set(n.detail.indices);for(const e of n.target.options)e.selected=i.has(e.index);e.setValue(t,{value:o(!0)}),a=o(!1)},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(r,n)}),i.addEventListener("input",n=>{var i;const r=o(!0),s=o(!1);e.setValue(t,{value:r}),n.preventDefault(),null===(i=this.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,change:s,changeEx:r,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],e=>e.target.value)):i.addEventListener("input",function(n){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var P9=new WeakSet;class M9 extends m9{constructor(e){const{data:t,elements:n,parent:i}=e,r=!!i._commentManager;if(super(e,{isRenderable:!r&&m9._hasPopupData(t)}),iH(this,P9),this.elements=n,r&&m9._hasPopupData(t)){const e=this.popup=JZ(P9,this,F9).call(this);for(const t of n)t.popup=e}else this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=JZ(P9,this,F9).call(this),n=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",n.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(e=>"".concat(MY).concat(e)).join(",")),this.container}}function F9(){return new a7({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}var R9=new WeakMap,N9=new WeakMap,I9=new WeakMap,B9=new WeakMap,Q9=new WeakMap,L9=new WeakMap,j9=new WeakMap,$9=new WeakMap,z9=new WeakMap,W9=new WeakMap,V9=new WeakMap,U9=new WeakMap,X9=new WeakMap,q9=new WeakMap,Z9=new WeakMap,H9=new WeakMap,Y9=new WeakMap,G9=new WeakMap,K9=new WeakMap,J9=new WeakMap,e7=new WeakMap,t7=new WeakMap,n7=new WeakMap,i7=new WeakMap,r7=new WeakMap,s7=new WeakMap,o7=new WeakSet;class a7{constructor(e){let{container:t,color:n,elements:i,titleObj:r,modificationDate:s,contentsObj:o,richText:a,parent:l,rect:c,parentRect:u,open:h,commentManager:d=null}=e;iH(this,o7),KZ(this,R9,null),KZ(this,N9,JZ(o7,this,g7).bind(this)),KZ(this,I9,JZ(o7,this,w7).bind(this)),KZ(this,B9,JZ(o7,this,O7).bind(this)),KZ(this,Q9,JZ(o7,this,y7).bind(this)),KZ(this,L9,null),KZ(this,j9,null),KZ(this,$9,null),KZ(this,z9,null),KZ(this,W9,null),KZ(this,V9,null),KZ(this,U9,null),KZ(this,X9,!1),KZ(this,q9,null),KZ(this,Z9,null),KZ(this,H9,null),KZ(this,Y9,null),KZ(this,G9,null),KZ(this,K9,null),KZ(this,J9,null),KZ(this,e7,null),KZ(this,t7,null),KZ(this,n7,null),KZ(this,i7,!1),KZ(this,r7,null),KZ(this,s7,null),nH(j9,this,t),nH(t7,this,r),nH($9,this,o),nH(e7,this,a),nH(V9,this,l),nH(L9,this,n),nH(J9,this,c),nH(U9,this,u),nH(W9,this,i),nH(R9,this,d),nH(r7,this,i[0]),nH(z9,this,qY.toDateObject(s)),this.trigger=i.flatMap(e=>e.getElementsToTriggerPopup()),d||(JZ(o7,this,l7).call(this),tH(j9,this).hidden=!0,h&&JZ(o7,this,y7).call(this))}renderCommentButton(){if(tH(Y9,this))return void(tH(Y9,this).parentNode||tH(r7,this).container.after(tH(Y9,this)));if(tH(G9,this)||JZ(o7,this,c7).call(this),!tH(G9,this))return;const{signal:e}=nH(Z9,this,new AbortController),t=tH(r7,this).hasOwnCommentButton,n=()=>{tH(R9,this).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{tH(R9,this).toggleCommentPopup(this,!1,!0,!t)},r=()=>{tH(R9,this).toggleCommentPopup(this,!1,!1)};if(t){nH(Y9,this,tH(r7,this).container);for(const t of this.trigger)t.ariaHasPopup="dialog",t.ariaControls="commentPopup",t.addEventListener("keydown",tH(N9,this),{signal:e}),t.addEventListener("click",n,{signal:e}),t.addEventListener("pointerenter",i,{signal:e}),t.addEventListener("pointerleave",r,{signal:e}),t.classList.add("popupTriggerArea")}else{const t=nH(Y9,this,document.createElement("button"));t.className="annotationCommentButton";const s=tH(r7,this).container;t.style.zIndex=s.style.zIndex+1,t.tabIndex=0,t.ariaHasPopup="dialog",t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button"),JZ(o7,this,h7).call(this),JZ(o7,this,u7).call(this),t.addEventListener("keydown",tH(N9,this),{signal:e}),t.addEventListener("click",n,{signal:e}),t.addEventListener("pointerenter",i,{signal:e}),t.addEventListener("pointerleave",r,{signal:e}),s.after(t)}}get commentButtonColor(){const{color:e,opacity:t}=tH(r7,this).commentData;return e?tH(V9,this)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;null===(e=tH(Y9,this))||void 0===e||e.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:i,modificationDate:r}=tH(r7,this).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:i,modificationDate:r}}get elementBeforePopup(){return tH(Y9,this)}get comment(){return tH(s7,this)||nH(s7,this,tH(r7,this).commentText),tH(s7,this)}set comment(e){e!==this.comment&&(tH(r7,this).commentText=nH(s7,this,e))}focus(){var e;null===(e=tH(r7,this).container)||void 0===e||e.focus()}get parentBoundingClientRect(){return tH(r7,this).layer.getBoundingClientRect()}setCommentButtonStates(e){let{selected:t,hasPopup:n}=e;tH(Y9,this)&&(tH(Y9,this).classList.toggle("selected",t),tH(Y9,this).ariaExpanded=n)}setSelectedCommentButton(e){tH(Y9,this).classList.toggle("selected",e)}get commentPopupPosition(){if(tH(K9,this))return tH(K9,this);const{x:e,y:t,height:n}=tH(Y9,this).getBoundingClientRect(),{x:i,y:r,width:s,height:o}=tH(r7,this).layer.getBoundingClientRect();return[(e-i)/s,(t+n-r)/o]}set commentPopupPosition(e){nH(K9,this,e)}hasDefaultPopupPosition(){return null===tH(K9,this)}get commentButtonPosition(){return tH(G9,this)}get commentButtonWidth(){return tH(Y9,this).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=tH(K9,this)||this.commentButtonPosition.map(e=>e/100),i=this.parentBoundingClientRect,{x:r,y:s,width:o,height:a}=i;tH(R9,this).showDialog(null,this,r+t*o,s+n*a,p(p({},e),{},{parentDimensions:i}))}render(){var e,t;if(tH(q9,this))return;const n=nH(q9,this,document.createElement("div"));if(n.className="popup",tH(L9,this)){const e=n.style.outlineColor=CY.makeHexColor(...tH(L9,this));n.style.backgroundColor="color-mix(in srgb, ".concat(e," 30%, white)")}const i=document.createElement("span");if(i.className="header",null!==(e=tH(t7,this))&&void 0!==e&&e.str){const e=document.createElement("span");e.className="title",i.append(e),({dir:e.dir,str:e.textContent}=tH(t7,this))}if(n.append(i),tH(z9,this)){const e=document.createElement("time");e.className="popupDate",e.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),e.setAttribute("data-l10n-args",JSON.stringify({dateObj:tH(z9,this).valueOf()})),e.dateTime=tH(z9,this).toISOString(),i.append(e)}aG({html:eH(o7,this,d7)||tH($9,this).str,dir:null===(t=tH($9,this))||void 0===t?void 0:t.dir,className:"popupContent"},n),tH(j9,this).append(n)}updateEdited(e){var t;let{rect:n,popup:i,deleted:r}=e;if(tH(R9,this))return r?(this.remove(),nH(s7,this,null)):i&&(i.deleted?this.remove():(JZ(o7,this,h7).call(this),nH(s7,this,i.text))),void(n&&(nH(G9,this,null),JZ(o7,this,c7).call(this),JZ(o7,this,u7).call(this)));r||null!==i&&void 0!==i&&i.deleted?this.remove():(JZ(o7,this,l7).call(this),tH(n7,this)||nH(n7,this,{contentsObj:tH($9,this),richText:tH(e7,this)}),n&&nH(H9,this,null),i&&i.text&&(nH(e7,this,JZ(o7,this,m7).call(this,i.text)),nH(z9,this,qY.toDateObject(i.date)),nH($9,this,null)),null===(t=tH(q9,this))||void 0===t||t.remove(),nH(q9,this,null))}resetEdited(){var e;tH(n7,this)&&(({contentsObj:YZ(nH,[$9,this])._,richText:YZ(nH,[e7,this])._}=tH(n7,this)),nH(n7,this,null),null===(e=tH(q9,this))||void 0===e||e.remove(),nH(q9,this,null),nH(H9,this,null))}remove(){var e,t,n;if(null===(e=tH(Z9,this))||void 0===e||e.abort(),nH(Z9,this,null),null===(t=tH(q9,this))||void 0===t||t.remove(),nH(q9,this,null),nH(i7,this,!1),nH(X9,this,!1),null===(n=tH(Y9,this))||void 0===n||n.remove(),nH(Y9,this,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){nH(i7,this,this.isVisible),tH(i7,this)&&(tH(j9,this).hidden=!0)}maybeShow(){tH(R9,this)||(JZ(o7,this,l7).call(this),tH(i7,this)&&(tH(q9,this)||JZ(o7,this,O7).call(this),nH(i7,this,!1),tH(j9,this).hidden=!1))}get isVisible(){return!tH(R9,this)&&!1===tH(j9,this).hidden}}function l7(){if(tH(Z9,this))return;nH(Z9,this,new AbortController);const{signal:e}=tH(Z9,this);for(const n of this.trigger)n.addEventListener("click",tH(Q9,this),{signal:e}),n.addEventListener("pointerenter",tH(B9,this),{signal:e}),n.addEventListener("pointerleave",tH(I9,this),{signal:e}),n.classList.add("popupTriggerArea");for(const n of tH(W9,this)){var t;null===(t=n.container)||void 0===t||t.addEventListener("keydown",tH(N9,this),{signal:e})}}function c7(){const e=tH(W9,this).find(e=>e.hasCommentButton);e&&nH(G9,this,e._normalizePoint(e.commentButtonPosition))}function u7(){if(tH(r7,this).extraPopupElement&&!tH(r7,this).editor)return;tH(Y9,this)||this.renderCommentButton();const[e,t]=tH(G9,this),{style:n}=tH(Y9,this);n.left="calc(".concat(e,"%)"),n.top="calc(".concat(t,"% - var(--comment-button-dim))")}function h7(){tH(r7,this).extraPopupElement||(tH(Y9,this)||this.renderCommentButton(),tH(Y9,this).style.backgroundColor=this.commentButtonColor||"")}function d7(e){const t=tH(e7,e),n=tH($9,e);return null===t||void 0===t||!t.str||null!==n&&void 0!==n&&n.str&&n.str!==t.str?null:tH(e7,e).html||null}function p7(e){var t;return(null===(t=eH(o7,e,d7))||void 0===t||null===(t=t.attributes)||void 0===t||null===(t=t.style)||void 0===t?void 0:t.fontSize)||0}function f7(e){var t;return(null===(t=eH(o7,e,d7))||void 0===t||null===(t=t.attributes)||void 0===t||null===(t=t.style)||void 0===t?void 0:t.color)||null}function m7(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:eH(o7,this,f7),fontSize:eH(o7,this,p7)?"calc(".concat(eH(o7,this,p7),"px * var(--total-scale-factor))"):""}};for(const r of e.split("\n"))t.push({name:"span",value:r,attributes:i});return n}function g7(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||("Enter"===e.key||"Escape"===e.key&&tH(X9,this))&&JZ(o7,this,y7).call(this)}function v7(){if(null!==tH(H9,this))return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:r}}}=tH(V9,this);let s=!!tH(U9,this),o=tH(s?U9:J9,this);for(const d of tH(W9,this))if(!o||null!==CY.intersect(d.data.rect,o)){o=d.data.rect,s=!0;break}const a=CY.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),l=s?o[2]-o[0]+5:0,c=a[0]+l,u=a[1];nH(H9,this,[100*(c-i)/t,100*(u-r)/n]);const{style:h}=tH(j9,this);h.left="".concat(tH(H9,this)[0],"%"),h.top="".concat(tH(H9,this)[1],"%")}function y7(){tH(R9,this)?tH(R9,this).toggleCommentPopup(this,!1):(nH(X9,this,!tH(X9,this)),tH(X9,this)?(JZ(o7,this,O7).call(this),tH(j9,this).addEventListener("click",tH(Q9,this)),tH(j9,this).addEventListener("keydown",tH(N9,this))):(JZ(o7,this,w7).call(this),tH(j9,this).removeEventListener("click",tH(Q9,this)),tH(j9,this).removeEventListener("keydown",tH(N9,this))))}function O7(){tH(q9,this)||this.render(),this.isVisible?tH(X9,this)&&tH(j9,this).classList.add("focused"):(JZ(o7,this,v7).call(this),tH(j9,this).hidden=!1,tH(j9,this).style.zIndex=parseInt(tH(j9,this).style.zIndex)+1e3)}function w7(){tH(j9,this).classList.remove("focused"),!tH(X9,this)&&this.isVisible&&(tH(j9,this).hidden=!0,tH(j9,this).style.zIndex=parseInt(tH(j9,this).style.zIndex)-1e3)}class b7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=IH.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var k7=new WeakMap;class x7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),KZ(this,k7,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),r=nH(k7,this,this.svgFactory.createElement("svg:line"));return r.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),r.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),r.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),r.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return tH(k7,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var D7=new WeakMap;class S7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),KZ(this,D7,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),r=e.borderStyle.width,s=nH(D7,this,this.svgFactory.createElement("svg:rect"));return s.setAttribute("x",r/2),s.setAttribute("y",r/2),s.setAttribute("width",t-r),s.setAttribute("height",n-r),s.setAttribute("stroke-width",r||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return tH(D7,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var C7=new WeakMap;class A7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),KZ(this,C7,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),r=e.borderStyle.width,s=nH(C7,this,this.svgFactory.createElement("svg:ellipse"));return s.setAttribute("cx",t/2),s.setAttribute("cy",n/2),s.setAttribute("rx",t/2-r/2),s.setAttribute("ry",n/2-r/2),s.setAttribute("stroke-width",r||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return tH(C7,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var E7=new WeakMap;class _7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),KZ(this,E7,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:i},width:r,height:s}=this;if(!t)return this.container;const o=this.svgFactory.create(r,s,!0);let a=[];for(let c=0,u=t.length;c<u;c+=2){const n=t[c]-e[0],i=e[3]-t[c+1];a.push("".concat(n,",").concat(i))}a=a.join(" ");const l=nH(E7,this,this.svgFactory.createElement(this.svgElementName));return l.setAttribute("points",a),l.setAttribute("stroke-width",n.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),o.append(l),this.container.append(o),!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return tH(E7,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}class T7 extends _7{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class P7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var M7=new WeakMap,F7=new WeakMap,R7=new WeakSet;class N7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),iH(this,R7),KZ(this,M7,null),KZ(this,F7,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?IH.HIGHLIGHT:IH.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:i,popupRef:r}}=this,{transform:s,width:o,height:a}=JZ(R7,this,I7).call(this,t,e),l=this.svgFactory.create(o,a,!0),c=nH(M7,this,this.svgFactory.createElement("svg:g"));l.append(c),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit",10),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),c.setAttribute("transform",s);for(let u=0,h=n.length;u<h;u++){const e=this.svgFactory.createElement(this.svgElementName);tH(F7,this).push(e),e.setAttribute("points",n[u].join(",")),c.append(e)}return!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(l),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:i}=e,r=tH(M7,this);if(t>=0&&r.setAttribute("stroke-width",t||1),n)for(let s=0,o=tH(F7,this).length;s<o;s++)tH(F7,this)[s].setAttribute("points",n[s].join(","));if(i){const{transform:e,width:t,height:n}=JZ(R7,this,I7).call(this,this.data.rotation,i);r.parentElement.setAttribute("viewBox","0 0 ".concat(t," ").concat(n)),r.setAttribute("transform",e)}}getElementsToTriggerPopup(){return tH(F7,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function I7(e,t){switch(e){case 90:return{transform:"rotate(90) translate(".concat(-t[0],",").concat(t[1],") scale(1,-1)"),width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:"rotate(180) translate(".concat(-t[2],",").concat(t[1],") scale(1,-1)"),width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:"rotate(270) translate(".concat(-t[2],",").concat(t[3],") scale(1,-1)"),width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:"translate(".concat(-t[0],",").concat(t[3],") scale(1,-1)"),width:t[2]-t[0],height:t[3]-t[1]}}}class B7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=IH.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const t=document.createElement("mark");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Q7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const t=document.createElement("u");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class L7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const t=document.createElement("u");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class j7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const t=document.createElement("s");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class $7 extends m9{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=IH.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var z7=new WeakMap,W7=new WeakSet;class V7 extends m9{constructor(e){var t;super(e,{isRenderable:!0}),iH(this,W7),KZ(this,z7,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("fileattachmentannotation",p({source:this},n))}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||0===t.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src="".concat(this.imageResourcesPath,"annotation-").concat(/paperclip/i.test(t.name)?"paperclip":"pushpin",".svg"),t.fillAlpha&&t.fillAlpha<1&&(n.style="filter: opacity(".concat(Math.round(100*t.fillAlpha),"%);"))),n.addEventListener("dblclick",JZ(W7,this,U7).bind(this)),nH(z7,this,n);const{isMac:i}=DY.platform;return e.addEventListener("keydown",e=>{"Enter"===e.key&&(i?e.metaKey:e.ctrlKey)&&JZ(W7,this,U7).call(this)}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return tH(z7,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function U7(){var e;null===(e=this.downloadManager)||void 0===e||e.openOrDownloadData(this.content,this.filename)}var X7=new WeakMap,q7=new WeakMap,Z7=new WeakMap,H7=new WeakMap,Y7=new WeakMap,G7=new WeakMap,K7=new WeakMap,J7=new WeakMap,eee=new WeakSet;class tee{constructor(e){let{div:t,accessibilityManager:n,annotationCanvasMap:i,annotationEditorUIManager:r,page:s,viewport:o,structTreeLayer:a,commentManager:l,linkService:c,annotationStorage:u}=e;iH(this,eee),KZ(this,X7,null),KZ(this,q7,null),KZ(this,Z7,null),KZ(this,H7,new Map),KZ(this,Y7,null),KZ(this,G7,null),KZ(this,K7,[]),KZ(this,J7,!1),this.div=t,nH(X7,this,n),nH(q7,this,i),nH(Y7,this,a||null),nH(G7,this,c||null),nH(Z7,this,u||new C1),this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=l||null}hasEditableAnnotations(){return tH(H7,this).size>0}async render(e){const{annotations:t}=e,n=this.div;KY(n,this.viewport);const i=new Map,r=[],s={data:null,layer:n,linkService:tH(G7,this),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new a9,annotationStorage:tH(Z7,this),enableComment:!0===e.enableComment,enableScripting:!0===e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const e=a.annotationType===qH.POPUP;if(e){const e=i.get(a.id);if(!e)continue;if(!this._commentManager){r.push(a);continue}s.elements=e}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;s.data=a;const t=u9.create(s);if(!t.isRenderable)continue;if(!e&&(tH(K7,this).push(t),a.popupRef)){const e=i.get(a.popupRef);e?e.push(t):i.set(a.popupRef,[t])}const n=t.render();var o;if(a.hidden&&(n.style.visibility="hidden"),t._isEditable)tH(H7,this).set(t.data.id,t),null===(o=this._annotationEditorUIManager)||void 0===o||o.renderAnnotationElement(t)}await JZ(eee,this,nee).call(this);for(const a of r){const e=s.elements=i.get(a.id);s.data=a;const t=u9.create(s);if(!t.isRenderable)continue;const n=t.render();t.contentElement.id="".concat(MY).concat(a.id),a.hidden&&(n.style.visibility="hidden"),e.at(-1).container.after(n)}JZ(eee,this,iee).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:tH(G7,this),svgFactory:new a9,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=tee._defaultBorderStyle),t.data=n;const e=u9.create(t);e.isRenderable&&(e.render(),e.contentElement.id="".concat(MY).concat(n.id),tH(K7,this).push(e))}await JZ(eee,this,nee).call(this)}update(e){let{viewport:t}=e;const n=this.div;this.viewport=t,KY(n,{rotation:t.rotation}),JZ(eee,this,iee).call(this),n.hidden=!1}getEditableAnnotations(){return Array.from(tH(H7,this).values())}getEditableAnnotation(e){return tH(H7,this).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:i}=e,r=new v9({data:{id:n,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:tH(G7,this),annotationStorage:tH(Z7,this)});return r.render(),r.contentElement.id="".concat(MY).concat(n),r.createOrUpdatePopup(),tH(K7,this).push(r),r}removeAnnotation(e){var t;const n=tH(K7,this).findIndex(t=>t.data.id===e);if(n<0)return;const[i]=tH(K7,this).splice(n,1);null===(t=tH(X7,this))||void 0===t||t.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(e){if(0!==e.length){for(const t of e)t.updateFakeAnnotationElement(this);JZ(eee,this,nee).call(this)}}togglePointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return mY(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ZH,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}async function nee(){if(0===tH(K7,this).length)return;this.div.replaceChildren();const e=[];if(!tH(J7,this)){nH(J7,this,!0);for(const{contentElement:n,data:{id:i}}of tH(K7,this)){var t;const r=n.id="".concat(MY).concat(i);e.push(null===(t=tH(Y7,this))||void 0===t?void 0:t.getAriaAttributes(r).then(e=>{if(e)for(const[t,i]of e)n.setAttribute(t,i)}))}}tH(K7,this).sort((e,t)=>{let{data:{rect:[n,i,r,s]}}=e,{data:{rect:[o,a,l,c]}}=t;if(n===r&&i===s)return 1;if(o===l&&a===c)return-1;const u=(i+s)/2,h=(a+c)/2;if(u>=c&&h<=i)return-1;if(h>=s&&u<=a)return 1;return(n+r)/2-(o+l)/2});const n=document.createDocumentFragment();for(const s of tH(K7,this)){var i,r;if(n.append(s.container),this._commentManager)null===(i=(null===(r=s.extraPopupElement)||void 0===r?void 0:r.popup)||s.popup)||void 0===i||i.renderCommentButton();else s.extraPopupElement&&n.append(s.extraPopupElement.render())}if(this.div.append(n),await Promise.all(e),tH(X7,this))for(const s of tH(K7,this))tH(X7,this).addPointerInTextLayer(s.contentElement,!1)}function iee(){if(!tH(q7,this))return;const e=this.div;for(const[n,i]of tH(q7,this)){const r=e.querySelector('[data-annotation-id="'.concat(n,'"]'));if(!r)continue;i.className="annotationContent";const{firstChild:s}=r;s?"CANVAS"===s.nodeName?s.replaceWith(i):s.classList.contains("annotationContent")?s.after(i):s.before(i):r.append(i);const o=tH(H7,this).get(n);var t;if(o)if(o._hasNoCanvas)null===(t=this._annotationEditorUIManager)||void 0===t||t.setMissingCanvas(n,r.id,i),o._hasNoCanvas=!1;else o.canvas=i}tH(q7,this).clear()}const ree=/\r\n?|\n/g;var see=new WeakMap,oee=new WeakMap,aee=new WeakMap,lee=new WeakMap,cee=new WeakSet;class uee extends H0{static get _keyboardManager(){const e=uee.prototype,t=e=>e.isEmpty(),n=aJ.TRANSLATE_SMALL,i=aJ.TRANSLATE_BIG;return mY(this,"_keyboardManager",new lK([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}constructor(e){super(p(p({},e),{},{name:"freeTextEditor"})),iH(this,cee),KZ(this,see,""),KZ(this,oee,"".concat(this.id,"-editor")),KZ(this,aee,null),KZ(this,lee,void 0),h(this,"_colorPicker",null),this.color=e.color||uee._defaultColor||H0._defaultLineColor,nH(lee,this,e.fontSize||uee._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){H0.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case BH.FREETEXT_SIZE:uee._defaultFontSize=t;break;case BH.FREETEXT_COLOR:uee._defaultColor=t}}updateParams(e,t){switch(e){case BH.FREETEXT_SIZE:JZ(cee,this,hee).call(this,t);break;case BH.FREETEXT_COLOR:JZ(cee,this,dee).call(this,t)}}static get defaultPropertiesToUpdate(){return[[BH.FREETEXT_SIZE,uee._defaultFontSize],[BH.FREETEXT_COLOR,uee._defaultColor||H0._defaultLineColor]]}get propertiesToUpdate(){return[[BH.FREETEXT_SIZE,tH(lee,this)],[BH.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new t9(this)),[["colorPicker",this._colorPicker]]}get colorType(){return BH.FREETEXT_COLOR}onUpdatedColor(){var e;this.editorDiv.style.color=this.color,null===(e=this._colorPicker)||void 0===e||e.update(this.color),super.onUpdatedColor()}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-uee._internalPadding*e,-(uee._internalPadding+tH(lee,this))*e]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),nH(aee,this,new AbortController);const e=this._uiManager.combinedSignal(tH(aee,this));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return!!super.disableEditMode()&&(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",tH(oee,this)),this._isDraggable=!0,null===(e=tH(aee,this))||void 0===e||e.abort(),nH(aee,this,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0)}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var t;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),null!==(t=this._initialOptions)&&void 0!==t&&t.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=tH(see,this),t=nH(see,this,JZ(cee,this,pee).call(this).trimEnd());if(e===t)return;const n=e=>{nH(see,this,e),e?(JZ(cee,this,gee).call(this),this._uiManager.rebuild(this),JZ(cee,this,fee).call(this)):this.remove()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),JZ(cee,this,fee).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){uee._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",tH(oee,this)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize="calc(".concat(tH(lee,this),"px * var(--total-scale-factor))"),n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:r}=this._initialData;let[s,o]=this.getInitialTranslation();[s,o]=this.pageTranslationToScreen(s,o);const[a,l]=this.pageDimensions,[c,u]=this.pageTranslation;let h,d;switch(this.rotation){case 0:h=e+(r[0]-c)/a,d=t+this.height-(r[1]-u)/l;break;case 90:h=e+(r[0]-c)/a,d=t-(r[1]-u)/l,[s,o]=[o,-s];break;case 180:h=e-this.width+(r[0]-c)/a,d=t-(r[1]-u)/l,[s,o]=[-s,-o];break;case 270:h=e+(r[0]-c-this.height*l)/a,d=t+(r[1]-u-this.width*a)/l,[s,o]=[-o,s]}this.setAt(h*n,d*i,s,o)}else this._moveAfterPaste(e,t);JZ(cee,this,gee).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(1===n.length&&"text/plain"===n[0])return;e.preventDefault();const i=yee.call(uee,t.getData("text")||"").replaceAll(ree,"\n");if(!i)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const s=r.getRangeAt(0);if(!i.includes("\n"))return s.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),void r.collapseToStart();const{startContainer:o,startOffset:a}=s,l=[],c=[];if(o.nodeType===Node.TEXT_NODE){const e=o.parentElement;if(c.push(o.nodeValue.slice(a).replaceAll(ree,"")),e!==this.editorDiv){let t=l;for(const n of this.editorDiv.childNodes)n!==e?t.push(mee.call(uee,n)):t=c}l.push(o.nodeValue.slice(0,a).replaceAll(ree,""))}else if(o===this.editorDiv){let e=l,t=0;for(const n of this.editorDiv.childNodes)t++===a&&(e=c),e.push(mee.call(uee,n))}nH(see,this,"".concat(l.join("\n")).concat(i).concat(c.join("\n"))),JZ(cee,this,gee).call(this);const u=new Range;let h=Math.sumPrecise(l.map(e=>e.length));for(const{firstChild:d}of this.editorDiv.childNodes)if(d.nodeType===Node.TEXT_NODE){const e=d.nodeValue.length;if(h<=e){u.setStart(d,h),u.setEnd(d,h);break}h-=e}r.removeAllRanges(),r.addRange(u)}get contentDiv(){return this.editorDiv}getPDFRect(){const e=uee._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let i=null;if(e instanceof b7){const{data:{defaultAppearanceData:{fontSize:t,fontColor:n},rect:r,rotation:s,id:o,popupRef:a,richText:l,contentsObj:c,creationDate:u,modificationDate:h},textContent:d,textPosition:p,parent:{page:{pageNumber:f}}}=e;if(!d||0===d.length)return null;i=e={annotationType:IH.FREETEXT,color:Array.from(n),fontSize:t,value:d.join("\n"),position:p,pageIndex:f-1,rect:r.slice(0),rotation:s,annotationElementId:o,id:o,deleted:!1,popupRef:a,comment:(null===c||void 0===c?void 0:c.str)||null,richText:l,creationDate:u,modificationDate:h}}const r=await super.deserialize(e,t,n);return nH(lee,r,e.fontSize),r.color=CY.makeHexColor(...e.color),nH(see,r,yee.call(uee,e.value)),r._initialData=i,e.comment&&r.setCommentData(e),r}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=H0._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:tH(lee,this),value:JZ(cee,this,vee).call(this)});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!JZ(cee,this,Oee).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize="calc(".concat(tH(lee,this),"px * var(--total-scale-factor))"),n.color=this.color,t.replaceChildren();for(const i of tH(see,this).split("\n")){const e=document.createElement("div");e.append(i?document.createTextNode(i):document.createElement("br")),t.append(e)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:tH(see,this)}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}function hee(e){const t=e=>{this.editorDiv.style.fontSize="calc(".concat(e,"px * var(--total-scale-factor))"),this.translate(0,-(e-tH(lee,this))*this.parentScale),nH(lee,this,e),JZ(cee,this,fee).call(this)},n=tH(lee,this);this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:BH.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function dee(e){const t=e=>{this.color=e,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:BH.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function pee(){const e=[];this.editorDiv.normalize();let t=null;for(const i of this.editorDiv.childNodes){var n;(null===(n=t)||void 0===n?void 0:n.nodeType)===Node.TEXT_NODE&&"BR"===i.nodeName||(e.push(mee.call(yH,i)),t=i)}return e.join("\n")}function fee(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:e,div:t}=this,i=t.style.display,r=t.classList.contains("hidden");t.classList.remove("hidden"),t.style.display="hidden",e.div.append(this.div),n=t.getBoundingClientRect(),t.remove(),t.style.display=i,t.classList.toggle("hidden",r)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}function mee(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(ree,"")}function gee(){if(this.editorDiv.replaceChildren(),tH(see,this))for(const e of tH(see,this).split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}function vee(){return tH(see,this).replaceAll("\xa0"," ")}function yee(e){return e.replaceAll(" ","\xa0")}function Oee(e){const{value:t,fontSize:n,color:i,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((e,t)=>e!==i[t])||e.pageIndex!==r}yH=uee,h(uee,"_freeTextDefaultContent",""),h(uee,"_internalPadding",0),h(uee,"_defaultColor",null),h(uee,"_defaultFontSize",10),h(uee,"_type","freetext"),h(uee,"_editorType",IH.FREETEXT);class wee{toSVGPath(){hY("Abstract method `toSVGPath` must be implemented.")}get box(){hY("Abstract getter `box` must be implemented.")}serialize(e,t){hY("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,r,s){s||(s=new Float32Array(e.length));for(let o=0,a=e.length;o<a;o+=2)s[o]=t+e[o]*i,s[o+1]=n+e[o+1]*r;return s}static _rescaleAndSwap(e,t,n,i,r,s){s||(s=new Float32Array(e.length));for(let o=0,a=e.length;o<a;o+=2)s[o]=t+e[o+1]*i,s[o+1]=n+e[o]*r;return s}static _translate(e,t,n,i){i||(i=new Float32Array(e.length));for(let r=0,s=e.length;r<s;r+=2)i[r]=t+e[r],i[r+1]=n+e[r+1];return i}static svgRound(e){return Math.round(1e4*e)}static _normalizePoint(e,t,n,i,r){switch(r){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,r,s){return[(e+5*n)/6,(t+5*i)/6,(5*n+r)/6,(5*i+s)/6,(n+r)/2,(i+s)/2]}}h(wee,"PRECISION",1e-4);var bee=new WeakMap,kee=new WeakMap,xee=new WeakMap,Dee=new WeakMap,See=new WeakMap,Cee=new WeakMap,Aee=new WeakMap,Eee=new WeakMap,_ee=new WeakMap,Tee=new WeakMap,Pee=new WeakMap,Mee=new WeakMap,Fee=new WeakMap,Ree=new WeakSet;class Nee{constructor(e,t,n,i,r){let{x:s,y:o}=e,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;iH(this,Ree),KZ(this,bee,void 0),KZ(this,kee,[]),KZ(this,xee,void 0),KZ(this,Dee,void 0),KZ(this,See,[]),KZ(this,Cee,new Float32Array(18)),KZ(this,Aee,void 0),KZ(this,Eee,void 0),KZ(this,_ee,void 0),KZ(this,Tee,void 0),KZ(this,Pee,void 0),KZ(this,Mee,void 0),KZ(this,Fee,[]),nH(bee,this,t),nH(Mee,this,i*n),nH(Dee,this,r),tH(Cee,this).set([NaN,NaN,NaN,NaN,s,o],6),nH(xee,this,a),nH(Tee,this,Wee._*n),nH(_ee,this,Vee._*n),nH(Pee,this,n),tH(Fee,this).push(s,o)}isEmpty(){return isNaN(tH(Cee,this)[8])}add(e){var t;let{x:n,y:i}=e;nH(Aee,this,n),nH(Eee,this,i);const[r,s,o,a]=tH(bee,this);let[l,c,u,h]=tH(Cee,this).subarray(8,12);const d=n-u,p=i-h,f=Math.hypot(d,p);if(f<tH(_ee,this))return!1;const m=f-tH(Tee,this),g=m/f,v=g*d,y=g*p;let O=l,w=c;l=u,c=h,u+=v,h+=y,null===(t=tH(Fee,this))||void 0===t||t.push(n,i);const b=v/m,k=-y/m*tH(Mee,this),x=b*tH(Mee,this);if(tH(Cee,this).set(tH(Cee,this).subarray(2,8),0),tH(Cee,this).set([u+k,h+x],4),tH(Cee,this).set(tH(Cee,this).subarray(14,18),12),tH(Cee,this).set([u-k,h-x],16),isNaN(tH(Cee,this)[6]))return 0===tH(See,this).length&&(tH(Cee,this).set([l+k,c+x],2),tH(See,this).push(NaN,NaN,NaN,NaN,(l+k-r)/o,(c+x-s)/a),tH(Cee,this).set([l-k,c-x],14),tH(kee,this).push(NaN,NaN,NaN,NaN,(l-k-r)/o,(c-x-s)/a)),tH(Cee,this).set([O,w,l,c,u,h],6),!this.isEmpty();tH(Cee,this).set([O,w,l,c,u,h],6);return Math.abs(Math.atan2(w-c,O-l)-Math.atan2(y,v))<Math.PI/2?([l,c,u,h]=tH(Cee,this).subarray(2,6),tH(See,this).push(NaN,NaN,NaN,NaN,((l+u)/2-r)/o,((c+h)/2-s)/a),[l,c,O,w]=tH(Cee,this).subarray(14,18),tH(kee,this).push(NaN,NaN,NaN,NaN,((O+l)/2-r)/o,((w+c)/2-s)/a),!0):([O,w,l,c,u,h]=tH(Cee,this).subarray(0,6),tH(See,this).push(((O+5*l)/6-r)/o,((w+5*c)/6-s)/a,((5*l+u)/6-r)/o,((5*c+h)/6-s)/a,((l+u)/2-r)/o,((c+h)/2-s)/a),[u,h,l,c,O,w]=tH(Cee,this).subarray(12,18),tH(kee,this).push(((O+5*l)/6-r)/o,((w+5*c)/6-s)/a,((5*l+u)/6-r)/o,((5*c+h)/6-s)/a,((l+u)/2-r)/o,((c+h)/2-s)/a),!0)}toSVGPath(){if(this.isEmpty())return"";const e=tH(See,this),t=tH(kee,this);if(isNaN(tH(Cee,this)[6])&&!this.isEmpty())return JZ(Ree,this,Bee).call(this);const n=[];n.push("M".concat(e[4]," ").concat(e[5]));for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push("L".concat(e[i+4]," ").concat(e[i+5])):n.push("C".concat(e[i]," ").concat(e[i+1]," ").concat(e[i+2]," ").concat(e[i+3]," ").concat(e[i+4]," ").concat(e[i+5]));JZ(Ree,this,Lee).call(this,n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push("L".concat(t[i+4]," ").concat(t[i+5])):n.push("C".concat(t[i]," ").concat(t[i+1]," ").concat(t[i+2]," ").concat(t[i+3]," ").concat(t[i+4]," ").concat(t[i+5]));return JZ(Ree,this,Qee).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,i,r,s){return new Jee(e,t,n,i,r,s)}getOutlines(){var e,t;const n=tH(See,this),i=tH(kee,this),r=tH(Cee,this),[s,o,a,l]=tH(bee,this),c=new Float32Array((null!==(e=null===(t=tH(Fee,this))||void 0===t?void 0:t.length)&&void 0!==e?e:0)+2);for(let d=0,p=c.length-2;d<p;d+=2)c[d]=(tH(Fee,this)[d]-s)/a,c[d+1]=(tH(Fee,this)[d+1]-o)/l;if(c[c.length-2]=(tH(Aee,this)-s)/a,c[c.length-1]=(tH(Eee,this)-o)/l,isNaN(r[6])&&!this.isEmpty())return JZ(Ree,this,jee).call(this,c);const u=new Float32Array(tH(See,this).length+24+tH(kee,this).length);let h=n.length;for(let d=0;d<h;d+=2)isNaN(n[d])?u[d]=u[d+1]=NaN:(u[d]=n[d],u[d+1]=n[d+1]);h=JZ(Ree,this,zee).call(this,u,h);for(let d=i.length-6;d>=6;d-=6)for(let e=0;e<6;e+=2)isNaN(i[d+e])?(u[h]=u[h+1]=NaN,h+=2):(u[h]=i[d+e],u[h+1]=i[d+e+1],h+=2);return JZ(Ree,this,$ee).call(this,u,h),this.newFreeDrawOutline(u,c,tH(bee,this),tH(Pee,this),tH(xee,this),tH(Dee,this))}}function Iee(){const e=tH(Cee,this).subarray(4,6),t=tH(Cee,this).subarray(16,18),[n,i,r,s]=tH(bee,this);return[(tH(Aee,this)+(e[0]-t[0])/2-n)/r,(tH(Eee,this)+(e[1]-t[1])/2-i)/s,(tH(Aee,this)+(t[0]-e[0])/2-n)/r,(tH(Eee,this)+(t[1]-e[1])/2-i)/s]}function Bee(){const[e,t,n,i]=tH(bee,this),[r,s,o,a]=JZ(Ree,this,Iee).call(this);return"M".concat((tH(Cee,this)[2]-e)/n," ").concat((tH(Cee,this)[3]-t)/i," L").concat((tH(Cee,this)[4]-e)/n," ").concat((tH(Cee,this)[5]-t)/i," L").concat(r," ").concat(s," L").concat(o," ").concat(a," L").concat((tH(Cee,this)[16]-e)/n," ").concat((tH(Cee,this)[17]-t)/i," L").concat((tH(Cee,this)[14]-e)/n," ").concat((tH(Cee,this)[15]-t)/i," Z")}function Qee(e){const t=tH(kee,this);e.push("L".concat(t[4]," ").concat(t[5]," Z"))}function Lee(e){const[t,n,i,r]=tH(bee,this),s=tH(Cee,this).subarray(4,6),o=tH(Cee,this).subarray(16,18),[a,l,c,u]=JZ(Ree,this,Iee).call(this);e.push("L".concat((s[0]-t)/i," ").concat((s[1]-n)/r," L").concat(a," ").concat(l," L").concat(c," ").concat(u," L").concat((o[0]-t)/i," ").concat((o[1]-n)/r))}function jee(e){const t=tH(Cee,this),[n,i,r,s]=tH(bee,this),[o,a,l,c]=JZ(Ree,this,Iee).call(this),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-n)/r,(t[3]-i)/s,NaN,NaN,NaN,NaN,(t[4]-n)/r,(t[5]-i)/s,NaN,NaN,NaN,NaN,o,a,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(t[16]-n)/r,(t[17]-i)/s,NaN,NaN,NaN,NaN,(t[14]-n)/r,(t[15]-i)/s],0),this.newFreeDrawOutline(u,e,tH(bee,this),tH(Pee,this),tH(xee,this),tH(Dee,this))}function $ee(e,t){const n=tH(kee,this);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+6}function zee(e,t){const n=tH(Cee,this).subarray(4,6),i=tH(Cee,this).subarray(16,18),[r,s,o,a]=tH(bee,this),[l,c,u,h]=JZ(Ree,this,Iee).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-r)/o,(n[1]-s)/a,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-s)/a],t),t+24}var Wee={_:8},Vee={_:Wee._+2},Uee=new WeakMap,Xee=new WeakMap,qee=new WeakMap,Zee=new WeakMap,Hee=new WeakMap,Yee=new WeakMap,Gee=new WeakMap,Kee=new WeakSet;class Jee extends wee{constructor(e,t,n,i,r,s){super(),iH(this,Kee),KZ(this,Uee,void 0),KZ(this,Xee,new Float32Array(4)),KZ(this,qee,void 0),KZ(this,Zee,void 0),KZ(this,Hee,void 0),KZ(this,Yee,void 0),KZ(this,Gee,void 0),nH(Gee,this,e),nH(Hee,this,t),nH(Uee,this,n),nH(Yee,this,i),nH(qee,this,r),nH(Zee,this,s),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],JZ(Kee,this,ete).call(this,s);const[o,a,l,c]=tH(Xee,this);for(let u=0,h=e.length;u<h;u+=2)e[u]=(e[u]-o)/l,e[u+1]=(e[u+1]-a)/c;for(let u=0,h=t.length;u<h;u+=2)t[u]=(t[u]-o)/l,t[u+1]=(t[u+1]-a)/c}toSVGPath(){const e=["M".concat(tH(Gee,this)[4]," ").concat(tH(Gee,this)[5])];for(let t=6,n=tH(Gee,this).length;t<n;t+=6)isNaN(tH(Gee,this)[t])?e.push("L".concat(tH(Gee,this)[t+4]," ").concat(tH(Gee,this)[t+5])):e.push("C".concat(tH(Gee,this)[t]," ").concat(tH(Gee,this)[t+1]," ").concat(tH(Gee,this)[t+2]," ").concat(tH(Gee,this)[t+3]," ").concat(tH(Gee,this)[t+4]," ").concat(tH(Gee,this)[t+5]));return e.push("Z"),e.join(" ")}serialize(e,t){let[n,i,r,s]=e;const o=r-n,a=s-i;let l,c;switch(t){case 0:l=wee._rescale(tH(Gee,this),n,s,o,-a),c=wee._rescale(tH(Hee,this),n,s,o,-a);break;case 90:l=wee._rescaleAndSwap(tH(Gee,this),n,i,o,a),c=wee._rescaleAndSwap(tH(Hee,this),n,i,o,a);break;case 180:l=wee._rescale(tH(Gee,this),r,i,-o,a),c=wee._rescale(tH(Hee,this),r,i,-o,a);break;case 270:l=wee._rescaleAndSwap(tH(Gee,this),r,s,-o,-a),c=wee._rescaleAndSwap(tH(Hee,this),r,s,-o,-a)}return{outline:Array.from(l),points:[Array.from(c)]}}get box(){return tH(Xee,this)}newOutliner(e,t,n,i,r){return new Nee(e,t,n,i,r,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}getNewOutline(e,t){const[n,i,r,s]=tH(Xee,this),[o,a,l,c]=tH(Uee,this),u=r*l,h=s*c,d=n*l+o,p=i*c+a,f=this.newOutliner({x:tH(Hee,this)[0]*u+d,y:tH(Hee,this)[1]*h+p},tH(Uee,this),tH(Yee,this),e,tH(Zee,this),null!==t&&void 0!==t?t:tH(qee,this));for(let m=2;m<tH(Hee,this).length;m+=2)f.add({x:tH(Hee,this)[m]*u+d,y:tH(Hee,this)[m+1]*h+p});return f.getOutlines()}}function ete(e){const t=tH(Gee,this);let n=t[4],i=t[5];const r=[n,i,n,i];let s=n,o=i,a=n,l=i;const c=e?Math.max:Math.min,u=new Float32Array(4);for(let d=6,p=t.length;d<p;d+=6){const e=t[d+4],h=t[d+5];isNaN(t[d])?(CY.pointBoundingBox(e,h,r),o>h?(s=e,o=h):o===h&&(s=c(s,e)),l<h?(a=e,l=h):l===h&&(a=c(a,e))):(u[0]=u[1]=1/0,u[2]=u[3]=-1/0,CY.bezierBoundingBox(n,i,...t.slice(d,d+6),u),CY.rectBoundingBox(u[0],u[1],u[2],u[3],r),o>u[1]?(s=u[0],o=u[1]):o===u[1]&&(s=c(s,u[0])),l<u[3]?(a=u[2],l=u[3]):l===u[3]&&(a=c(a,u[2]))),n=e,i=h}const h=tH(Xee,this);h[0]=r[0]-tH(qee,this),h[1]=r[1]-tH(qee,this),h[2]=r[2]-r[0]+2*tH(qee,this),h[3]=r[3]-r[1]+2*tH(qee,this),this.firstPoint=[s,o],this.lastPoint=[a,l]}var tte=new WeakMap,nte=new WeakMap,ite=new WeakMap,rte=new WeakMap,ste=new WeakMap,ote=new WeakSet;class ate{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];iH(this,ote),KZ(this,tte,void 0),KZ(this,nte,void 0),KZ(this,ite,void 0),KZ(this,rte,[]),KZ(this,ste,[]);const r=[1/0,1/0,-1/0,-1/0],s=1e-4;for(const{x:f,y:m,width:g,height:v}of e){const e=Math.floor((f-t)/s)*s,n=Math.ceil((f+g+t)/s)*s,i=Math.floor((m-t)/s)*s,o=Math.ceil((m+v+t)/s)*s,a=[e,i,o,!0],l=[n,i,o,!1];tH(rte,this).push(a,l),CY.rectBoundingBox(e,i,n,o,r)}const o=r[2]-r[0]+2*n,a=r[3]-r[1]+2*n,l=r[0]-n,c=r[1]-n;let u=i?-1/0:1/0,h=1/0;const d=tH(rte,this).at(i?-1:-2),p=[d[0],d[2]];for(const f of tH(rte,this)){const[e,t,n,r]=f;!r&&i?t<h?(h=t,u=e):t===h&&(u=Math.max(u,e)):r&&!i&&(t<h?(h=t,u=e):t===h&&(u=Math.min(u,e))),f[0]=(e-l)/o,f[1]=(t-c)/a,f[2]=(n-c)/a}nH(tte,this,new Float32Array([l,c,o,a])),nH(nte,this,[u,h]),nH(ite,this,p)}getOutlines(){tH(rte,this).sort((e,t)=>e[0]-t[0]||e[1]-t[1]||e[2]-t[2]);const e=[];for(const t of tH(rte,this))t[3]?(e.push(...JZ(ote,this,dte).call(this,t)),JZ(ote,this,ute).call(this,t)):(JZ(ote,this,hte).call(this,t),e.push(...JZ(ote,this,dte).call(this,t)));return JZ(ote,this,lte).call(this,e)}}function lte(e){const t=[],n=new Set;for(const s of e){const[e,n,i]=s;t.push([e,n,s],[e,i,s])}t.sort((e,t)=>e[1]-t[1]||e[0]-t[0]);for(let s=0,o=t.length;s<o;s+=2){const e=t[s][2],i=t[s+1][2];e.push(i),i.push(e),n.add(e),n.add(i)}const i=[];let r;for(;n.size>0;){const e=n.values().next().value;let[t,s,o,a,l]=e;n.delete(e);let c=t,u=s;for(r=[t,o],i.push(r);;){let e;if(n.has(a))e=a;else{if(!n.has(l))break;e=l}n.delete(e),[t,s,o,a,l]=e,c!==t&&(r.push(c,u,t,u===s?s:o),c=t),u=u===s?o:s}r.push(c,u)}return new mte(i,tH(tte,this),tH(nte,this),tH(ite,this))}function cte(e){const t=tH(ste,this);let n=0,i=t.length-1;for(;n<=i;){const r=n+i>>1,s=t[r][0];if(s===e)return r;s<e?n=r+1:i=r-1}return i+1}function ute(e){let[,t,n]=e;const i=JZ(ote,this,cte).call(this,t);tH(ste,this).splice(i,0,[t,n])}function hte(e){let[,t,n]=e;const i=JZ(ote,this,cte).call(this,t);for(let r=i;r<tH(ste,this).length;r++){const[e,i]=tH(ste,this)[r];if(e!==t)break;if(e===t&&i===n)return void tH(ste,this).splice(r,1)}for(let r=i-1;r>=0;r--){const[e,i]=tH(ste,this)[r];if(e!==t)break;if(e===t&&i===n)return void tH(ste,this).splice(r,1)}}function dte(e){const[t,n,i]=e,r=[[t,n,i]],s=JZ(ote,this,cte).call(this,i);for(let o=0;o<s;o++){const[e,n]=tH(ste,this)[o];for(let i=0,s=r.length;i<s;i++){const[,o,a]=r[i];if(!(n<=o||a<=e))if(o>=e)if(a>n)r[i][1]=n;else{if(1===s)return[];r.splice(i,1),i--,s--}else r[i][2]=e,a>n&&r.push([t,n,a])}}return r}var pte=new WeakMap,fte=new WeakMap;class mte extends wee{constructor(e,t,n,i){super(),KZ(this,pte,void 0),KZ(this,fte,void 0),nH(fte,this,e),nH(pte,this,t),this.firstPoint=n,this.lastPoint=i}toSVGPath(){const e=[];for(const t of tH(fte,this)){let[n,i]=t;e.push("M".concat(n," ").concat(i));for(let r=2;r<t.length;r+=2){const s=t[r],o=t[r+1];s===n?(e.push("V".concat(o)),i=o):o===i&&(e.push("H".concat(s)),n=s)}e.push("Z")}return e.join(" ")}serialize(e,t){let[n,i,r,s]=e;const o=[],a=r-n,l=s-i;for(const c of tH(fte,this)){const e=new Array(c.length);for(let t=0;t<c.length;t+=2)e[t]=n+c[t]*a,e[t+1]=s-c[t+1]*l;o.push(e)}return o}get box(){return tH(pte,this)}get classNamesForOutlining(){return["highlightOutline"]}}class gte extends Nee{newFreeDrawOutline(e,t,n,i,r,s){return new vte(e,t,n,i,r,s)}}class vte extends Jee{newOutliner(e,t,n,i,r){return new gte(e,t,n,i,r,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}}var yte=new WeakMap,Ote=new WeakMap,wte=new WeakMap,bte=new WeakMap,kte=new WeakMap,xte=new WeakMap,Dte=new WeakMap,Ste=new WeakMap,Cte=new WeakMap,Ate=new WeakMap,Ete=new WeakMap,_te=new WeakMap,Tte=new WeakMap,Pte=new WeakMap,Mte=new WeakMap,Fte=new WeakMap,Rte=new WeakMap,Nte=new WeakMap,Ite=new WeakSet;class Bte extends H0{static get _keyboardManager(){const e=Bte.prototype;return mY(this,"_keyboardManager",new lK([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super(p(p({},e),{},{name:"highlightEditor"})),iH(this,Ite),KZ(this,yte,null),KZ(this,Ote,0),KZ(this,wte,void 0),KZ(this,bte,null),KZ(this,kte,null),KZ(this,xte,null),KZ(this,Dte,null),KZ(this,Ste,0),KZ(this,Cte,null),KZ(this,Ate,null),KZ(this,Ete,null),KZ(this,_te,!1),KZ(this,Tte,null),KZ(this,Pte,null),KZ(this,Mte,null),KZ(this,Fte,""),KZ(this,Rte,void 0),KZ(this,Nte,""),this.color=e.color||Bte._defaultColor,nH(Rte,this,e.thickness||Bte._defaultThickness),this.opacity=e.opacity||Bte._defaultOpacity,nH(wte,this,e.boxes||null),nH(Nte,this,e.methodOfCreation||""),nH(Fte,this,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(nH(_te,this,!0),JZ(Ite,this,Lte).call(this,e),JZ(Ite,this,Vte).call(this)):tH(wte,this)&&(nH(yte,this,e.anchorNode),nH(Ote,this,e.anchorOffset),nH(Dte,this,e.focusNode),nH(Ste,this,e.focusOffset),JZ(Ite,this,Qte).call(this),JZ(Ite,this,Vte).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:tH(_te,this)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:tH(Rte,this),methodOfCreation:tH(Nte,this)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,t){var n;H0.initialize(e,t),Bte._defaultColor||(Bte._defaultColor=(null===(n=t.highlightColors)||void 0===n?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(e,t){switch(e){case BH.HIGHLIGHT_COLOR:Bte._defaultColor=t;break;case BH.HIGHLIGHT_THICKNESS:Bte._defaultThickness=t}}translateInPage(e,t){}get toolbarPosition(){return tH(Pte,this)}get commentButtonPosition(){return tH(Tte,this)}updateParams(e,t){switch(e){case BH.HIGHLIGHT_COLOR:JZ(Ite,this,jte).call(this,t);break;case BH.HIGHLIGHT_THICKNESS:JZ(Ite,this,$te).call(this,t)}}static get defaultPropertiesToUpdate(){return[[BH.HIGHLIGHT_COLOR,Bte._defaultColor],[BH.HIGHLIGHT_THICKNESS,Bte._defaultThickness]]}get propertiesToUpdate(){return[[BH.HIGHLIGHT_COLOR,this.color||Bte._defaultColor],[BH.HIGHLIGHT_THICKNESS,tH(Rte,this)||Bte._defaultThickness],[BH.HIGHLIGHT_FREE,tH(_te,this)]]}onUpdatedColor(){var e,t;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(tH(Ete,this),{root:{fill:this.color,"fill-opacity":this.opacity}}),null===(t=tH(kte,this))||void 0===t||t.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){if(this._uiManager.highlightColors){return[["colorPicker",nH(kte,this,new V6({editor:this}))]]}return super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(JZ(Ite,this,Zte).call(this))}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,JZ(Ite,this,Zte).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){JZ(Ite,this,Wte).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(JZ(Ite,this,Vte).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;if(this.parent&&!e)JZ(Ite,this,Wte).call(this);else if(e){var n;JZ(Ite,this,Vte).call(this,e),t=!this.parent&&(null===(n=this.div)||void 0===n?void 0:n.classList.contains("selectedEditor"))}super.setParent(e),this.show(this._isVisible),t&&this.select()}rotate(e){const{drawLayer:t}=this.parent;let n;tH(_te,this)?(e=(e-this.rotation+360)%360,n=Ute.call(Bte,tH(Ate,this).box,e)):n=Ute.call(Bte,[this.x,this.y,this.width,this.height],e),t.updateProperties(tH(Ete,this),{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(tH(Mte,this),{bbox:Ute.call(Bte,tH(xte,this).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();tH(Fte,this)&&(e.setAttribute("aria-label",tH(Fte,this)),e.setAttribute("role","mark")),tH(_te,this)?e.classList.add("free"):this.div.addEventListener("keydown",JZ(Ite,this,Xte).bind(this),{signal:this._uiManager._signal});const t=nH(Cte,this,document.createElement("div"));return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=tH(bte,this),this.setDims(),zG(this,tH(Cte,this),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(tH(Mte,this),{rootClass:{hovered:!0}}))}pointerleave(){var e;this.isSelected||(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(tH(Mte,this),{rootClass:{hovered:!1}}))}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:JZ(Ite,this,qte).call(this,!0);break;case 1:case 3:JZ(Ite,this,qte).call(this,!1)}}select(){var e;super.select(),tH(Mte,this)&&(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(tH(Mte,this),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),tH(Mte,this)&&(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(tH(Mte,this),{rootClass:{selected:!1}}),tH(_te,this)||JZ(Ite,this,qte).call(this,!1))}get _mustFixPosition(){return!tH(_te,this)}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(tH(Ete,this),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(tH(Mte,this),{rootClass:{hidden:!e}}))}static startHighlighting(e,t,n){let{target:i,x:r,y:s}=n;const{x:o,y:a,width:l,height:c}=i.getBoundingClientRect(),u=new AbortController,h=e.combinedSignal(u),d=t=>{u.abort(),JZ(Bte,this,Kte).call(this,e,t)};window.addEventListener("blur",d,{signal:h}),window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("pointerdown",XY,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",UY,{signal:h}),i.addEventListener("pointermove",JZ(Bte,this,Gte).bind(this,e),{signal:h}),this._freeHighlight=new gte({x:r,y:s},[o,a,l,c],e.scale,this._defaultThickness/2,t,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0))}static async deserialize(e,t,n){let i=null;if(e instanceof B7){const{data:{quadPoints:t,rect:n,rotation:r,id:s,color:o,opacity:a,popupRef:l,richText:c,contentsObj:u,creationDate:h,modificationDate:d},parent:{page:{pageNumber:p}}}=e;i=e={annotationType:IH.HIGHLIGHT,color:Array.from(o),opacity:a,quadPoints:t,boxes:null,pageIndex:p-1,rect:n.slice(0),rotation:r,annotationElementId:s,id:s,deleted:!1,popupRef:l,richText:c,comment:(null===u||void 0===u?void 0:u.str)||null,creationDate:h,modificationDate:d}}else if(e instanceof N7){const{data:{inkLists:t,rect:n,rotation:r,id:s,color:o,borderStyle:{rawWidth:a},popupRef:l,richText:c,contentsObj:u,creationDate:h,modificationDate:d},parent:{page:{pageNumber:p}}}=e;i=e={annotationType:IH.HIGHLIGHT,color:Array.from(o),thickness:a,inkLists:t,boxes:null,pageIndex:p-1,rect:n.slice(0),rotation:r,annotationElementId:s,id:s,deleted:!1,popupRef:l,richText:c,comment:(null===u||void 0===u?void 0:u.str)||null,creationDate:h,modificationDate:d}}const{color:r,quadPoints:s,inkLists:o,opacity:a}=e,l=await super.deserialize(e,t,n);l.color=CY.makeHexColor(...r),l.opacity=a||1,o&&nH(Rte,l,e.thickness),l._initialData=i,e.comment&&l.setCommentData(e);const[c,u]=l.pageDimensions,[h,d]=l.pageTranslation;if(s){const e=nH(wte,l,[]);for(let t=0;t<s.length;t+=8)e.push({x:(s[t]-h)/c,y:1-(s[t+1]-d)/u,width:(s[t+2]-s[t])/c,height:(s[t+1]-s[t+5])/u});JZ(Ite,l,Qte).call(l),JZ(Ite,l,Vte).call(l),l.rotate(l.rotation)}else if(o){nH(_te,l,!0);const e=o[0],n={x:e[0]-h,y:u-(e[1]-d)},i=new gte(n,[0,0,c,u],1,tH(Rte,l)/2,!0,.001);for(let t=0,o=e.length;t<o;t+=2)n.x=e[t]-h,n.y=u-(e[t+1]-d),i.add(n);const{id:r,clipPathId:s}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:l.color,"fill-opacity":l._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:i.toSVGPath()}},!0,!0);JZ(Ite,l,Lte).call(l,{highlightOutlines:i.getOutlines(),highlightId:r,clipPathId:s}),JZ(Ite,l,Vte).call(l),l.rotate(l.parentRotation)}return l}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=H0._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:tH(Rte,this),quadPoints:JZ(Ite,this,Hte).call(this),outlines:JZ(Ite,this,Yte).call(this,n.rect)}),this.addComment(n),this.annotationElementId&&!JZ(Ite,this,Jte).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}function Qte(){const e=new ate(tH(wte,this),.001);nH(Ate,this,e.getOutlines()),[this.x,this.y,this.width,this.height]=tH(Ate,this).box;const t=new ate(tH(wte,this),.0025,.001,"ltr"===this._uiManager.direction);nH(xte,this,t.getOutlines());const{firstPoint:n}=tH(Ate,this);nH(Tte,this,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]);const{lastPoint:i}=tH(xte,this);nH(Pte,this,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])}function Lte(e){let{highlightOutlines:t,highlightId:n,clipPathId:i}=e;nH(Ate,this,t);if(nH(xte,this,t.getNewOutline(tH(Rte,this)/2+1.5,.0025)),n>=0)nH(Ete,this,n),nH(bte,this,i),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),nH(Mte,this,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:tH(xte,this).box,path:{d:tH(xte,this).toSVGPath()}},!0));else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(tH(Ete,this),{bbox:Ute.call(OH,tH(Ate,this).box,(e-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(tH(Mte,this),{bbox:Ute.call(OH,tH(xte,this).box,e),path:{d:tH(xte,this).toSVGPath()}})}const[r,s,o,a]=t.box;switch(this.rotation){case 0:this.x=r,this.y=s,this.width=o,this.height=a;break;case 90:{const[e,t]=this.parentDimensions;this.x=s,this.y=1-r,this.width=o*t/e,this.height=a*e/t;break}case 180:this.x=1-r,this.y=1-s,this.width=o,this.height=a;break;case 270:{const[e,t]=this.parentDimensions;this.x=1-s,this.y=r,this.width=o*t/e,this.height=a*e/t;break}}const{firstPoint:l}=t;nH(Tte,this,[(l[0]-r)/o,(l[1]-s)/a]);const{lastPoint:c}=tH(xte,this);nH(Pte,this,[(c[0]-r)/o,(c[1]-s)/a])}function jte(e){const t=(e,t)=>{this.color=e,this.opacity=t,this.onUpdatedColor()},n=this.color,i=this.opacity;this.addCommands({cmd:t.bind(this,e,OH._defaultOpacity),undo:t.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:BH.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}function $te(e){const t=tH(Rte,this),n=e=>{nH(Rte,this,e),JZ(Ite,this,zte).call(this,e)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:BH.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}function zte(e){tH(_te,this)&&(JZ(Ite,this,Lte).call(this,{highlightOutlines:tH(Ate,this).getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}function Wte(){null!==tH(Ete,this)&&this.parent&&(this.parent.drawLayer.remove(tH(Ete,this)),nH(Ete,this,null),this.parent.drawLayer.remove(tH(Mte,this)),nH(Mte,this,null))}function Vte(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null===tH(Ete,this)&&(({id:YZ(nH,[Ete,this])._,clipPathId:YZ(nH,[bte,this])._}=e.drawLayer.draw({bbox:tH(Ate,this).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:tH(_te,this)},path:{d:tH(Ate,this).toSVGPath()}},!1,!0)),nH(Mte,this,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:tH(_te,this)},bbox:tH(xte,this).box,path:{d:tH(xte,this).toSVGPath()}},tH(_te,this))),tH(Cte,this)&&(tH(Cte,this).style.clipPath=tH(bte,this)))}function Ute(e,t){let[n,i,r,s]=e;switch(t){case 90:return[1-i-s,n,s,r];case 180:return[1-n-r,1-i-s,r,s];case 270:return[i,1-n-r,s,r]}return[n,i,r,s]}function Xte(e){OH._keyboardManager.exec(this,e)}function qte(e){if(!tH(yte,this))return;const t=window.getSelection();e?t.setPosition(tH(yte,this),tH(Ote,this)):t.setPosition(tH(Dte,this),tH(Ste,this))}function Zte(){return tH(_te,this)?this.rotation:0}function Hte(){if(tH(_te,this))return null;const[e,t]=this.pageDimensions,[n,i]=this.pageTranslation,r=tH(wte,this),s=new Float32Array(8*r.length);let o=0;for(const{x:a,y:l,width:c,height:u}of r){const r=a*e+n,h=(1-l)*t+i;s[o]=s[o+4]=r,s[o+1]=s[o+3]=h,s[o+2]=s[o+6]=r+c*e,s[o+5]=s[o+7]=h-u*t,o+=8}return s}function Yte(e){return tH(Ate,this).serialize(e,JZ(Ite,this,Zte).call(this))}function Gte(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}function Kte(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}function Jte(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((e,n)=>e!==t[n])}OH=Bte,h(Bte,"_defaultColor",null),h(Bte,"_defaultOpacity",1),h(Bte,"_defaultThickness",12),h(Bte,"_type","highlight"),h(Bte,"_editorType",IH.HIGHLIGHT),h(Bte,"_freeHighlightId",-1),h(Bte,"_freeHighlight",null),h(Bte,"_freeHighlightClipId","");var ene=new WeakMap;class tne{constructor(){KZ(this,ene,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){tH(ene,this)[e]=t}toSVGProperties(){const e=tH(ene,this);return nH(ene,this,Object.create(null)),{root:e}}reset(){nH(ene,this,Object.create(null))}updateAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;this.updateProperties(e)}clone(){hY("Not implemented")}}var nne=new WeakMap,ine=new WeakMap,rne=new WeakSet;class sne extends H0{constructor(e){super(e),iH(this,rne),KZ(this,nne,null),KZ(this,ine,void 0),h(this,"_colorPicker",null),h(this,"_drawId",null),nH(ine,this,e.mustBeCommitted||!1),this._addOutlines(e)}onUpdatedColor(){var e;null===(e=this._colorPicker)||void 0===e||e.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(JZ(rne,this,one).call(this,e),JZ(rne,this,cne).call(this))}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[i,r]of Object.entries(t))n.has(i)?Object.assign(e[i],r):e[i]=r;return e}static getDefaultDrawingOptions(e){hY("Not implemented")}static get typesMap(){hY("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(fne._.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)e.push([n,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,i]of this.constructor.typesMap)e.push([n,t[i]]);return e}_updateProperty(e,t,n){const i=this._drawingOptions,r=i[t],s=n=>{var r;i.updateProperty(t,n);const s=tH(nne,this).updateProperty(t,n);s&&JZ(rne,this,dne).call(this,s),null===(r=this.parent)||void 0===r||r.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:s.bind(this,n),undo:s.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,sne._mergeSVGProperties(tH(nne,this).getPathResizingSVGProperties(JZ(rne,this,hne).call(this)),{bbox:JZ(rne,this,pne).call(this)}))}_onResized(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,sne._mergeSVGProperties(tH(nne,this).getPathResizedSVGProperties(JZ(rne,this,hne).call(this)),{bbox:JZ(rne,this,pne).call(this)}))}_onTranslating(e,t){var n;null===(n=this.parent)||void 0===n||n.drawLayer.updateProperties(this._drawId,{bbox:JZ(rne,this,pne).call(this)})}_onTranslated(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,sne._mergeSVGProperties(tH(nne,this).getPathTranslatedSVGProperties(JZ(rne,this,hne).call(this),this.parentDimensions),{bbox:JZ(rne,this,pne).call(this)}))}_onStartDragging(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,tH(ine,this)&&(nH(ine,this,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){JZ(rne,this,lne).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(JZ(rne,this,cne).call(this),JZ(rne,this,dne).call(this,tH(nne,this).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;if(this.parent&&!e)this._uiManager.removeShouldRescale(this),JZ(rne,this,lne).call(this);else if(e){var n;this._uiManager.addShouldRescale(this),JZ(rne,this,cne).call(this,e),t=!this.parent&&(null===(n=this.div)||void 0===n?void 0:n.classList.contains("selectedEditor"))}super.setParent(e),t&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,sne._mergeSVGProperties({bbox:JZ(rne,this,pne).call(this)},tH(nne,this).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&JZ(rne,this,dne).call(this,tH(nne,this).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");return n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,i,r){hY("Not implemented")}static startDrawing(e,t,n,i){var r;const{target:s,offsetX:o,offsetY:a,pointerId:l,pointerType:c}=i;if(WG.isInitializedAndDifferentPointerType(c))return;const{viewport:{rotation:u}}=e,{width:h,height:d}=s.getBoundingClientRect(),p=mne._=new AbortController,f=e.combinedSignal(p);WG.setPointer(c,l),window.addEventListener("pointerup",e=>{WG.isSamePointerIdOrRemove(e.pointerId)&&this._endDraw(e)},{signal:f}),window.addEventListener("pointercancel",e=>{WG.isSamePointerIdOrRemove(e.pointerId)&&this._currentParent.endDrawingSession()},{signal:f}),window.addEventListener("pointerdown",e=>{WG.isSamePointerType(e.pointerType)&&(WG.initializeAndAddPointerId(e.pointerId),fne._.isCancellable()&&(fne._.removeLastElement(),fne._.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",UY,{signal:f}),s.addEventListener("pointermove",this._drawMove.bind(this),{signal:f}),s.addEventListener("touchmove",e=>{WG.isSameTimeStamp(e.timeStamp)&&XY(e)},{signal:f}),e.toggleDrawing(),null===(r=t._editorUndoBar)||void 0===r||r.hide(),fne._?e.drawLayer.updateProperties(this._currentDrawId,fne._.startNew(o,a,h,d,u)):(t.updateUIForDefaultProperties(this),fne._=this.createDrawerInstance(o,a,h,d,u),gne._=this.getDefaultDrawingOptions(),this._currentParent=e,({id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(gne._.toSVGProperties(),fne._.defaultSVGProperties),!0,!1)))}static _drawMove(e){if(WG.isSameTimeStamp(e.timeStamp),!fne._)return;const{offsetX:t,offsetY:n,pointerId:i}=e;WG.isSamePointerId(i)&&(WG.isUsingMultiplePointers()?this._endDraw(e):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,fne._.add(t,n)),WG.setTimeStamp(e.timeStamp),XY(e)))}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,fne._=null,gne._=null,WG.clearTimeStamp()),mne._&&(mne._.abort(),mne._=null,WG.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),(null===e||void 0===e?void 0:e.target)===t.div&&t.drawLayer.updateProperties(this._currentDrawId,fne._.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const e=fne._,n=this._currentDrawId,i=e.getLastElement();return void t.addCommands({cmd:()=>{t.drawLayer.updateProperties(n,e.setLastElement(i))},undo:()=>{t.drawLayer.updateProperties(n,e.removeLastElement())},mustExec:!1,type:BH.DRAW_STEP})}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(BH.DRAW_STEP),!fne._.isEmpty()){const{pageDimensions:[n,i],scale:r}=t,s=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:fne._.getOutlines(n*r,i*r,r,this._INNER_MARGIN),drawingOptions:gne._,mustBeCommitted:!e});return this._cleanup(!0),s}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,i,r,s){hY("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:i,pageHeight:r,pageX:s,pageY:o}}=t.viewport,a=this.deserializeDraw(s,o,i,r,this._INNER_MARGIN,e),l=await super.deserialize(e,t,n);return l.createDrawingOptions(e),JZ(rne,l,one).call(l,{drawOutlines:a}),JZ(rne,l,cne).call(l),l.onScaleChanging(),l.rotate(),l}serializeDraw(e){const[t,n]=this.pageTranslation,[i,r]=this.pageDimensions;return tH(nne,this).serialize([t,n,i,r],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}function one(e){let{drawOutlines:t,drawId:n,drawingOptions:i}=e;nH(nne,this,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-".concat(this.editorType,"-added-alert")),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=JZ(rne,this,ane).call(this,t,this.parent),JZ(rne,this,dne).call(this,t.box)}function ane(e,t){const{id:n}=t.drawLayer.draw(wH._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}function lne(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}function cne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null!==this._drawId&&this.parent===e||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=JZ(rne,this,ane).call(this,tH(nne,this),e)):this.parent.drawLayer.updateParent(this._drawId,e.drawLayer))}function une(e){let[t,n,i,r]=e;const{parentDimensions:[s,o],rotation:a}=this;switch(a){case 90:return[n,1-t,i*(o/s),r*(s/o)];case 180:return[1-t,1-n,i,r];case 270:return[1-n,t,i*(o/s),r*(s/o)];default:return[t,n,i,r]}}function hne(){const{x:e,y:t,width:n,height:i,parentDimensions:[r,s],rotation:o}=this;switch(o){case 90:return[1-t,e,n*(r/s),i*(s/r)];case 180:return[1-e,1-t,n,i];case 270:return[t,1-e,n*(r/s),i*(s/r)];default:return[e,t,n,i]}}function dne(e){[this.x,this.y,this.width,this.height]=JZ(rne,this,une).call(this,e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}function pne(){const{x:e,y:t,width:n,height:i,rotation:r,parentRotation:s,parentDimensions:[o,a]}=this;switch((4*r+s)/90){case 1:return[1-t-i,e,i,n];case 2:return[1-e-n,1-t-i,n,i];case 3:return[t,1-e-n,i,n];case 4:return[e,t-n*(o/a),i*(a/o),n*(o/a)];case 5:return[1-t,e,n*(o/a),i*(a/o)];case 6:return[1-e-i*(a/o),1-t,i*(a/o),n*(o/a)];case 7:return[t-n*(o/a),1-e-i*(a/o),n*(o/a),i*(a/o)];case 8:return[e-n,t-i,n,i];case 9:return[1-t,e-n,i,n];case 10:return[1-e,1-t,n,i];case 11:return[t-i,1-e,i,n];case 12:return[e-i*(a/o),t,i*(a/o),n*(o/a)];case 13:return[1-t-n*(o/a),e-i*(a/o),n*(o/a),i*(a/o)];case 14:return[1-e,1-t-n*(o/a),i*(a/o),n*(o/a)];case 15:return[t,1-e,n*(o/a),i*(a/o)];default:return[e,t,n,i]}}wH=sne,h(sne,"_currentDrawId",-1),h(sne,"_currentParent",null);var fne={_:null},mne={_:null},gne={_:null};h(sne,"_INNER_MARGIN",3);var vne=new WeakMap,yne=new WeakMap,One=new WeakMap,wne=new WeakMap,bne=new WeakMap,kne=new WeakMap,xne=new WeakMap,Dne=new WeakMap,Sne=new WeakMap,Cne=new WeakMap,Ane=new WeakMap,Ene=new WeakSet;class _ne{constructor(e,t,n,i,r,s){iH(this,Ene),KZ(this,vne,new Float64Array(6)),KZ(this,yne,void 0),KZ(this,One,void 0),KZ(this,wne,void 0),KZ(this,bne,void 0),KZ(this,kne,void 0),KZ(this,xne,""),KZ(this,Dne,0),KZ(this,Sne,new $ne),KZ(this,Cne,void 0),KZ(this,Ane,void 0),nH(Cne,this,n),nH(Ane,this,i),nH(wne,this,r),nH(bne,this,s),[e,t]=JZ(Ene,this,Tne).call(this,e,t);const o=nH(yne,this,[NaN,NaN,NaN,NaN,e,t]);nH(kne,this,[e,t]),nH(One,this,[{line:o,points:tH(kne,this)}]),tH(vne,this).set(o,0)}updateProperty(e,t){"stroke-width"===e&&nH(bne,this,t)}isEmpty(){return!tH(One,this)||0===tH(One,this).length}isCancellable(){return tH(kne,this).length<=10}add(e,t){[e,t]=JZ(Ene,this,Tne).call(this,e,t);const[n,i,r,s]=tH(vne,this).subarray(2,6),o=e-r,a=t-s;return Math.hypot(tH(Cne,this)*o,tH(Ane,this)*a)<=2?null:(tH(kne,this).push(e,t),isNaN(n)?(tH(vne,this).set([r,s,e,t],2),tH(yne,this).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(tH(vne,this)[0])&&tH(yne,this).splice(6,6),tH(vne,this).set([n,i,r,s,e,t],0),tH(yne,this).push(...wee.createBezierPoints(n,i,r,s,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(2===tH(kne,this).length?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,r){nH(Cne,this,n),nH(Ane,this,i),nH(wne,this,r),[e,t]=JZ(Ene,this,Tne).call(this,e,t);const s=nH(yne,this,[NaN,NaN,NaN,NaN,e,t]);nH(kne,this,[e,t]);const o=tH(One,this).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),tH(One,this).push({line:s,points:tH(kne,this)}),tH(vne,this).set(s,0),nH(Dne,this,0),this.toSVGPath(),null}getLastElement(){return tH(One,this).at(-1)}setLastElement(e){return tH(One,this)?(tH(One,this).push(e),nH(yne,this,e.line),nH(kne,this,e.points),nH(Dne,this,0),{path:{d:this.toSVGPath()}}):tH(Sne,this).setLastElement(e)}removeLastElement(){if(!tH(One,this))return tH(Sne,this).removeLastElement();tH(One,this).pop(),nH(xne,this,"");for(let e=0,t=tH(One,this).length;e<t;e++){const{line:t,points:n}=tH(One,this)[e];nH(yne,this,t),nH(kne,this,n),nH(Dne,this,0),this.toSVGPath()}return{path:{d:tH(xne,this)}}}toSVGPath(){const e=wee.svgRound(tH(yne,this)[4]),t=wee.svgRound(tH(yne,this)[5]);if(2===tH(kne,this).length)return nH(xne,this,"".concat(tH(xne,this)," M ").concat(e," ").concat(t," Z")),tH(xne,this);if(tH(kne,this).length<=6){const n=tH(xne,this).lastIndexOf("M");nH(xne,this,"".concat(tH(xne,this).slice(0,n)," M ").concat(e," ").concat(t)),nH(Dne,this,6)}if(4===tH(kne,this).length){const e=wee.svgRound(tH(yne,this)[10]),t=wee.svgRound(tH(yne,this)[11]);return nH(xne,this,"".concat(tH(xne,this)," L ").concat(e," ").concat(t)),nH(Dne,this,12),tH(xne,this)}const n=[];0===tH(Dne,this)&&(n.push("M ".concat(e," ").concat(t)),nH(Dne,this,6));for(let i=tH(Dne,this),r=tH(yne,this).length;i<r;i+=6){const[e,t,r,s,o,a]=tH(yne,this).slice(i,i+6).map(wee.svgRound);n.push("C".concat(e," ").concat(t," ").concat(r," ").concat(s," ").concat(o," ").concat(a))}return nH(xne,this,tH(xne,this)+n.join(" ")),nH(Dne,this,tH(yne,this).length),tH(xne,this)}getOutlines(e,t,n,i){const r=tH(One,this).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),tH(Sne,this).build(tH(One,this),e,t,n,tH(wne,this),tH(bne,this),i),nH(vne,this,null),nH(yne,this,null),nH(One,this,null),nH(xne,this,null),tH(Sne,this)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}function Tne(e,t){return wee._normalizePoint(e,t,tH(Cne,this),tH(Ane,this),tH(wne,this))}var Pne=new WeakMap,Mne=new WeakMap,Fne=new WeakMap,Rne=new WeakMap,Nne=new WeakMap,Ine=new WeakMap,Bne=new WeakMap,Qne=new WeakMap,Lne=new WeakMap,jne=new WeakSet;class $ne extends wee{constructor(){super(...arguments),iH(this,jne),KZ(this,Pne,void 0),KZ(this,Mne,0),KZ(this,Fne,void 0),KZ(this,Rne,void 0),KZ(this,Nne,void 0),KZ(this,Ine,void 0),KZ(this,Bne,void 0),KZ(this,Qne,void 0),KZ(this,Lne,void 0)}build(e,t,n,i,r,s,o){nH(Nne,this,t),nH(Ine,this,n),nH(Bne,this,i),nH(Qne,this,r),nH(Lne,this,s),nH(Fne,this,null!==o&&void 0!==o?o:0),nH(Rne,this,e),JZ(jne,this,Vne).call(this)}get thickness(){return tH(Lne,this)}setLastElement(e){return tH(Rne,this).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return tH(Rne,this).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of tH(Rne,this))if(e.push("M".concat(wee.svgRound(t[4])," ").concat(wee.svgRound(t[5]))),6!==t.length)if(12===t.length&&isNaN(t[6]))e.push("L".concat(wee.svgRound(t[10])," ").concat(wee.svgRound(t[11])));else for(let n=6,i=t.length;n<i;n+=6){const[i,r,s,o,a,l]=t.subarray(n,n+6).map(wee.svgRound);e.push("C".concat(i," ").concat(r," ").concat(s," ").concat(o," ").concat(a," ").concat(l))}else e.push("Z");return e.join("")}serialize(e,t){let[n,i,r,s]=e;const o=[],a=[],[l,c,u,h]=JZ(jne,this,Wne).call(this);let d,p,f,m,g,v,y,O,w;switch(tH(Qne,this)){case 0:w=wee._rescale,d=n,p=i+s,f=r,m=-s,g=n+l*r,v=i+(1-c-h)*s,y=n+(l+u)*r,O=i+(1-c)*s;break;case 90:w=wee._rescaleAndSwap,d=n,p=i,f=r,m=s,g=n+c*r,v=i+l*s,y=n+(c+h)*r,O=i+(l+u)*s;break;case 180:w=wee._rescale,d=n+r,p=i,f=-r,m=s,g=n+(1-l-u)*r,v=i+c*s,y=n+(1-l)*r,O=i+(c+h)*s;break;case 270:w=wee._rescaleAndSwap,d=n+r,p=i+s,f=-r,m=-s,g=n+(1-c-h)*r,v=i+(1-l-u)*s,y=n+(1-c)*r,O=i+(1-l)*s}for(const{line:b,points:k}of tH(Rne,this))o.push(w(b,d,p,f,m,t?new Array(b.length):null)),a.push(w(k,d,p,f,m,t?new Array(k.length):null));return{lines:o,points:a,rect:[g,v,y,O]}}static deserialize(e,t,n,i,r,s){let{paths:{lines:o,points:a},rotation:l,thickness:c}=s;const u=[];let h,d,p,f,m;switch(l){case 0:m=wee._rescale,h=-e/n,d=t/i+1,p=1/n,f=-1/i;break;case 90:m=wee._rescaleAndSwap,h=-t/i,d=-e/n,p=1/i,f=1/n;break;case 180:m=wee._rescale,h=e/n+1,d=-t/i,p=-1/n,f=1/i;break;case 270:m=wee._rescaleAndSwap,h=t/i+1,d=e/n+1,p=-1/i,f=-1/n}if(!o){o=[];for(const e of a){const t=e.length;if(2===t){o.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1]]));continue}if(4===t){o.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1],NaN,NaN,NaN,NaN,e[2],e[3]]));continue}const n=new Float32Array(3*(t-2));o.push(n);let[i,r,s,a]=e.subarray(0,4);n.set([NaN,NaN,NaN,NaN,i,r],0);for(let o=4;o<t;o+=2){const t=e[o],l=e[o+1];n.set(wee.createBezierPoints(i,r,s,a,t,l),3*(o-2)),[i,r,s,a]=[s,a,t,l]}}}for(let v=0,y=o.length;v<y;v++)u.push({line:m(o[v].map(e=>null!==e&&void 0!==e?e:NaN),h,d,p,f),points:m(a[v].map(e=>null!==e&&void 0!==e?e:NaN),h,d,p,f)});const g=new this.prototype.constructor;return g.build(u,n,i,1,l,c,r),g}get box(){return tH(Pne,this)}updateProperty(e,t){return"stroke-width"===e?JZ(jne,this,Une).call(this,t):null}updateParentDimensions(e,t){let[n,i]=e;const[r,s]=JZ(jne,this,zne).call(this);nH(Nne,this,n),nH(Ine,this,i),nH(Bne,this,t);const[o,a]=JZ(jne,this,zne).call(this),l=o-r,c=a-s,u=tH(Pne,this);return u[0]-=l,u[1]-=c,u[2]+=2*l,u[3]+=2*c,u}updateRotation(e){return nH(Mne,this,e),{path:{transform:this.rotationTransform}}}get viewBox(){return tH(Pne,this).map(wee.svgRound).join(" ")}get defaultProperties(){const[e,t]=tH(Pne,this);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(wee.svgRound(e)," ").concat(wee.svgRound(t))}}}get rotationTransform(){const[,,e,t]=tH(Pne,this);let n=0,i=0,r=0,s=0,o=0,a=0;switch(tH(Mne,this)){case 90:i=t/e,r=-e/t,o=e;break;case 180:n=-1,s=-1,o=e,a=t;break;case 270:i=-t/e,r=e/t,a=t;break;default:return""}return"matrix(".concat(n," ").concat(i," ").concat(r," ").concat(s," ").concat(wee.svgRound(o)," ").concat(wee.svgRound(a),")")}getPathResizingSVGProperties(e){let[t,n,i,r]=e;const[s,o]=JZ(jne,this,zne).call(this),[a,l,c,u]=tH(Pne,this);if(Math.abs(c-s)<=wee.PRECISION||Math.abs(u-o)<=wee.PRECISION){const e=t+i/2-(a+c/2),s=n+r/2-(l+u/2);return{path:{"transform-origin":"".concat(wee.svgRound(t)," ").concat(wee.svgRound(n)),transform:"".concat(this.rotationTransform," translate(").concat(e," ").concat(s,")")}}}const h=(i-2*s)/(c-2*s),d=(r-2*o)/(u-2*o),p=c/i,f=u/r;return{path:{"transform-origin":"".concat(wee.svgRound(a)," ").concat(wee.svgRound(l)),transform:"".concat(this.rotationTransform," scale(").concat(p," ").concat(f,") ")+"translate(".concat(wee.svgRound(s)," ").concat(wee.svgRound(o),") scale(").concat(h," ").concat(d,") ")+"translate(".concat(wee.svgRound(-s)," ").concat(wee.svgRound(-o),")")}}}getPathResizedSVGProperties(e){let[t,n,i,r]=e;const[s,o]=JZ(jne,this,zne).call(this),a=tH(Pne,this),[l,c,u,h]=a;if(a[0]=t,a[1]=n,a[2]=i,a[3]=r,Math.abs(u-s)<=wee.PRECISION||Math.abs(h-o)<=wee.PRECISION){const e=t+i/2-(l+u/2),s=n+r/2-(c+h/2);for(const{line:t,points:n}of tH(Rne,this))wee._translate(t,e,s,t),wee._translate(n,e,s,n);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(wee.svgRound(t)," ").concat(wee.svgRound(n)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}const d=(i-2*s)/(u-2*s),p=(r-2*o)/(h-2*o),f=-d*(l+s)+t+s,m=-p*(c+o)+n+o;if(1!==d||1!==p||0!==f||0!==m)for(const{line:g,points:v}of tH(Rne,this))wee._rescale(g,f,m,d,p,g),wee._rescale(v,f,m,d,p,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(wee.svgRound(t)," ").concat(wee.svgRound(n)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties(e,t){let[n,i]=e;const[r,s]=t,o=tH(Pne,this),a=n-o[0],l=i-o[1];if(tH(Nne,this)===r&&tH(Ine,this)===s)for(const{line:c,points:u}of tH(Rne,this))wee._translate(c,a,l,c),wee._translate(u,a,l,u);else{const e=tH(Nne,this)/r,t=tH(Ine,this)/s;nH(Nne,this,r),nH(Ine,this,s);for(const{line:n,points:i}of tH(Rne,this))wee._rescale(n,a,l,e,t,n),wee._rescale(i,a,l,e,t,i);o[2]*=e,o[3]*=t}return o[0]=n,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":"".concat(wee.svgRound(n)," ").concat(wee.svgRound(i))}}}get defaultSVGProperties(){const e=tH(Pne,this);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":"".concat(wee.svgRound(e[0])," ").concat(wee.svgRound(e[1])),transform:this.rotationTransform||null},bbox:e}}}function zne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tH(Lne,this);const t=tH(Fne,this)+e/2*tH(Bne,this);return tH(Qne,this)%180===0?[t/tH(Nne,this),t/tH(Ine,this)]:[t/tH(Ine,this),t/tH(Nne,this)]}function Wne(){const[e,t,n,i]=tH(Pne,this),[r,s]=JZ(jne,this,zne).call(this,0);return[e+r,t+s,n-2*r,i-2*s]}function Vne(){const e=nH(Pne,this,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of tH(Rne,this)){if(i.length<=12){for(let t=4,n=i.length;t<n;t+=6)CY.pointBoundingBox(i[t],i[t+1],e);continue}let t=i[4],n=i[5];for(let r=6,s=i.length;r<s;r+=6){const[s,o,a,l,c,u]=i.subarray(r,r+6);CY.bezierBoundingBox(t,n,s,o,a,l,c,u,e),t=c,n=u}}const[t,n]=JZ(jne,this,zne).call(this);e[0]=FY(e[0]-t,0,1),e[1]=FY(e[1]-n,0,1),e[2]=FY(e[2]+t,0,1),e[3]=FY(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}function Une(e){const[t,n]=JZ(jne,this,zne).call(this);nH(Lne,this,e);const[i,r]=JZ(jne,this,zne).call(this),[s,o]=[i-t,r-n],a=tH(Pne,this);return a[0]-=s,a[1]-=o,a[2]+=2*s,a[3]+=2*o,a}class Xne extends tne{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:H0._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){"stroke-width"===e&&(null!==t&&void 0!==t||(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Xne(this._viewParameters);return e.updateAll(this),e}}var qne=new WeakSet;class Zne extends sne{constructor(e){super(p(p({},e),{},{name:"inkEditor"})),iH(this,qne),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){H0.initialize(e,t),this._defaultDrawingOptions=new Xne(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return mY(this,"typesMap",new Map([[BH.INK_THICKNESS,"stroke-width"],[BH.INK_COLOR,"stroke"],[BH.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,i,r){return new _ne(e,t,n,i,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,i,r,s){return $ne.deserialize(e,t,n,i,r,s)}static async deserialize(e,t,n){let i=null;if(e instanceof N7){const{data:{inkLists:t,rect:n,rotation:r,id:s,color:o,opacity:a,borderStyle:{rawWidth:l},popupRef:c,richText:u,contentsObj:h,creationDate:d,modificationDate:p},parent:{page:{pageNumber:f}}}=e;i=e={annotationType:IH.INK,color:Array.from(o),thickness:l,opacity:a,paths:{points:t},boxes:null,pageIndex:f-1,rect:n.slice(0),rotation:r,annotationElementId:s,id:s,deleted:!1,popupRef:c,richText:u,comment:(null===h||void 0===h?void 0:h.str)||null,creationDate:d,modificationDate:p}}const r=await super.deserialize(e,t,n);return r._initialData=i,e.comment&&r.setCommentData(e),r}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new t9(this)),[["colorPicker",this._colorPicker]]}get colorType(){return BH.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions(e){let{color:t,thickness:n,opacity:i}=e;this._drawingOptions=Zne.getDefaultDrawingOptions({stroke:CY.makeHexColor(...t),"stroke-width":n,"stroke-opacity":i})}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":r,"stroke-width":s}}=this,o=Object.assign(super.serialize(e),{color:H0._colorManager.convert(i),opacity:r,thickness:s,paths:{lines:t,points:n}});return this.addComment(o),e?(o.isCopy=!0,o):this.annotationElementId&&!JZ(qne,this,Hne).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}function Hne(e){const{color:t,thickness:n,opacity:i,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((e,n)=>e!==t[n])||e.thickness!==n||e.opacity!==i||e.pageIndex!==r}h(Zne,"_type","ink"),h(Zne,"_editorType",IH.INK),h(Zne,"_defaultDrawingOptions",null);class Yne extends $ne{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}class Gne{static extractContoursFromText(e,t,n,i,r,s){let{fontFamily:o,fontStyle:a,fontWeight:l}=t,c=new OffscreenCanvas(1,1),u=c.getContext("2d",{alpha:!1});const h=u.font="".concat(a," ").concat(l," ").concat(200,"px ").concat(o),{actualBoundingBoxLeft:d,actualBoundingBoxRight:p,actualBoundingBoxAscent:f,actualBoundingBoxDescent:m,fontBoundingBoxAscent:g,fontBoundingBoxDescent:v,width:y}=u.measureText(e),O=1.5,w=Math.ceil(Math.max(Math.abs(d)+Math.abs(p)||0,y)*O),b=Math.ceil(Math.max(Math.abs(f)+Math.abs(m)||200,Math.abs(g)+Math.abs(v)||200)*O);c=new OffscreenCanvas(w,b),u=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),u.font=h,u.filter="grayscale(1)",u.fillStyle="white",u.fillRect(0,0,w,b),u.fillStyle="black",u.fillText(e,.5*w/2,1.5*b/2);const k=JZ(Gne,this,oie).call(this,u.getImageData(0,0,w,b).data),x=JZ(Gne,this,sie).call(this,k),D=JZ(Gne,this,aie).call(this,x),S=JZ(Gne,this,tie).call(this,k,w,b,D);return this.processDrawnLines({lines:{curves:S,width:w,height:b},pageWidth:n,pageHeight:i,rotation:r,innerMargin:s,mustSmooth:!0,areContours:!0})}static process(e,t,n,i,r){const[s,o,a]=JZ(Gne,this,lie).call(this,e),[l,c]=JZ(Gne,this,rie).call(this,s,o,a,Math.hypot(o,a)*JZ(Gne,this,cie)._.sigmaSFactor,JZ(Gne,this,cie)._.sigmaR,JZ(Gne,this,cie)._.kernelSize),u=JZ(Gne,this,aie).call(this,c),h=JZ(Gne,this,tie).call(this,l,o,a,u);return this.processDrawnLines({lines:{curves:h,width:o,height:a},pageWidth:t,pageHeight:n,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines(e){var t;let{lines:n,pageWidth:i,pageHeight:r,rotation:s,innerMargin:o,mustSmooth:a,areContours:l}=e;s%180!==0&&([i,r]=[r,i]);const{curves:c,width:u,height:h}=n,d=null!==(t=n.thickness)&&void 0!==t?t:0,p=[],f=Math.min(i/u,r/h),m=f/i,g=f/r,v=[];for(const{points:O}of c){const e=a?JZ(Gne,this,iie).call(this,O):O;if(!e)continue;v.push(e);const t=e.length,n=new Float32Array(t),i=new Float32Array(3*(2===t?2:t-2));if(p.push({line:i,points:n}),2===t){n[0]=e[0]*m,n[1]=e[1]*g,i.set([NaN,NaN,NaN,NaN,n[0],n[1]],0);continue}let[r,s,o,l]=e;r*=m,s*=g,o*=m,l*=g,n.set([r,s,o,l],0),i.set([NaN,NaN,NaN,NaN,r,s],0);for(let a=4;a<t;a+=2){const t=n[a]=e[a]*m,c=n[a+1]=e[a+1]*g;i.set(wee.createBezierPoints(r,s,o,l,t,c),3*(a-2)),[r,s,o,l]=[o,l,t,c]}}if(0===p.length)return null;const y=l?new Yne:new $ne;return y.build(p,i,r,1,s,l?0:d,o),{outline:y,newCurves:v,areContours:l,thickness:d,width:u,height:h}}static async compressSignature(e){let t,{outlines:n,areContours:i,thickness:r,width:s,height:o}=e,a=1/0,l=-1/0,c=0;for(const y of n){c+=y.length;for(let e=2,t=y.length;e<t;e++){const t=y[e]-y[e-2];a=Math.min(a,t),l=Math.max(l,t)}}t=a>=-128&&l<=127?Int8Array:a>=-32768&&l<=32767?Int16Array:Int32Array;const u=n.length,h=8+3*u,d=new Uint32Array(h);let p=0;d[p++]=h*Uint32Array.BYTES_PER_ELEMENT+(c-2*u)*t.BYTES_PER_ELEMENT,d[p++]=0,d[p++]=s,d[p++]=o,d[p++]=i?0:1,d[p++]=Math.max(0,Math.floor(null!==r&&void 0!==r?r:0)),d[p++]=u,d[p++]=t.BYTES_PER_ELEMENT;for(const y of n)d[p++]=y.length-2,d[p++]=y[0],d[p++]=y[1];const f=new CompressionStream("deflate-raw"),m=f.writable.getWriter();await m.ready,m.write(d);const g=t.prototype.constructor;for(const y of n){const e=new g(y.length-2);for(let t=2,n=y.length;t<n;t++)e[t-2]=y[t]-y[t-2];m.write(e)}m.close();const v=await new Response(f.readable).arrayBuffer();return new Uint8Array(v).toBase64()}static async decompressSignature(e){try{const a=Uint8Array.fromBase64(e),{readable:l,writable:c}=new DecompressionStream("deflate-raw"),u=c.getWriter();await u.ready,u.write(a).then(async()=>{await u.ready,await u.close()}).catch(()=>{});let h=null,d=0;var t,n=!1,i=!1;try{for(var r,s=function(e){var t,n,i,r=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new rH(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}(l);n=!(r=await s.next()).done;n=!1){const e=r.value;h||(h=new Uint8Array(new Uint32Array(e.buffer,0,4)[0])),h.set(e,d),d+=e.length}}catch(o){i=!0,t=o}finally{try{n&&null!=s.return&&await s.return()}finally{if(i)throw t}}const p=new Uint32Array(h.buffer,0,h.length>>2),f=p[1];if(0!==f)throw new Error("Invalid version: ".concat(f));const m=p[2],g=p[3],v=0===p[4],y=p[5],O=p[6],w=p[7],b=[],k=(8+3*O)*Uint32Array.BYTES_PER_ELEMENT;let x;switch(w){case Int8Array.BYTES_PER_ELEMENT:x=new Int8Array(h.buffer,k);break;case Int16Array.BYTES_PER_ELEMENT:x=new Int16Array(h.buffer,k);break;case Int32Array.BYTES_PER_ELEMENT:x=new Int32Array(h.buffer,k)}d=0;for(let e=0;e<O;e++){const t=p[3*e+8],n=new Float32Array(t+2);b.push(n);for(let i=0;i<2;i++)n[i]=p[3*e+8+i+1];for(let e=0;e<t;e++)n[e+2]=n[e]+x[d++]}return{areContours:v,thickness:y,outlines:b,width:m,height:g}}catch(Kre){return uY("decompressSignature: ".concat(Kre)),null}}}function Kne(e,t,n,i){return i-=t,0===(n-=e)?i>0?0:4:1===n?i+6:2-i}function Jne(e,t,n,i,r,s,o){const a=JZ(bH,this,Kne).call(this,n,i,r,s);for(let l=0;l<8;l++){const r=(-l+a-o+16)%8;if(0!==e[(n+JZ(bH,this,uie)._[2*r])*t+(i+JZ(bH,this,uie)._[2*r+1])])return r}return-1}function eie(e,t,n,i,r,s,o){const a=JZ(bH,this,Kne).call(this,n,i,r,s);for(let l=0;l<8;l++){const r=(l+a+o+16)%8;if(0!==e[(n+JZ(bH,this,uie)._[2*r])*t+(i+JZ(bH,this,uie)._[2*r+1])])return r}return-1}function tie(e,t,n,i){const r=e.length,s=new Int32Array(r);for(let c=0;c<r;c++)s[c]=e[c]<=i?1:0;for(let c=1;c<n-1;c++)s[c*t]=s[c*t+t-1]=0;for(let c=0;c<t;c++)s[c]=s[t*n-1-c]=0;let o,a=1;const l=[];for(let c=1;c<n-1;c++){o=1;for(let e=1;e<t-1;e++){const n=c*t+e,i=s[n];if(0===i)continue;let r=c,u=e;if(1===i&&0===s[n-1])a+=1,u-=1;else{if(!(i>=1&&0===s[n+1])){1!==i&&(o=Math.abs(i));continue}a+=1,u+=1,i>1&&(o=i)}const h=[e,c],d=u===e+1,p={isHole:d,points:h,id:a,parent:0};let f;l.push(p);for(const e of l)if(e.id===o){f=e;break}f?f.isHole?p.parent=d?f.parent:o:p.parent=d?o:f.parent:p.parent=d?o:0;const m=JZ(bH,this,Jne).call(this,s,t,c,e,r,u,0);if(-1===m){s[n]=-a,1!==s[n]&&(o=Math.abs(s[n]));continue}let g=JZ(bH,this,uie)._[2*m],v=JZ(bH,this,uie)._[2*m+1];const y=c+g,O=e+v;r=y,u=O;let w=c,b=e;for(;;){const i=JZ(bH,this,eie).call(this,s,t,w,b,r,u,1);g=JZ(bH,this,uie)._[2*i],v=JZ(bH,this,uie)._[2*i+1];const l=w+g,d=b+v;h.push(d,l);const p=w*t+b;if(0===s[p+1]?s[p]=-a:1===s[p]&&(s[p]=a),l===c&&d===e&&w===y&&b===O){1!==s[n]&&(o=Math.abs(s[n]));break}r=w,u=b,w=l,b=d}}}return l}function nie(e,t,n,i){if(n-t<=4){for(let r=t;r<n-2;r+=2)i.push(e[r],e[r+1]);return}const r=e[t],s=e[t+1],o=e[n-4]-r,a=e[n-3]-s,l=Math.hypot(o,a),c=o/l,u=a/l,h=c*s-u*r,d=a/o,p=1/l,f=Math.atan(d),m=Math.cos(f),g=Math.sin(f),v=p*(Math.abs(m)+Math.abs(g)),y=p*(1-v+v**2),O=Math.max(Math.atan(Math.abs(g+m)*y),Math.atan(Math.abs(g-m)*y));let w=0,b=t;for(let k=t+2;k<n-2;k+=2){const t=Math.abs(h-c*e[k+1]+u*e[k]);t>w&&(b=k,w=t)}w>(l*O)**2?(JZ(bH,this,nie).call(this,e,t,b+2,i),JZ(bH,this,nie).call(this,e,b,n,i)):i.push(r,s)}function iie(e){const t=[],n=e.length;return JZ(bH,this,nie).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}function rie(e,t,n,i,r,s){const o=new Float32Array(s**2),a=-2*i**2,l=s>>1;for(let f=0;f<s;f++){const e=(f-l)**2;for(let t=0;t<s;t++)o[f*s+t]=Math.exp((e+(t-l)**2)/a)}const c=new Float32Array(256),u=-2*r**2;for(let f=0;f<256;f++)c[f]=Math.exp(f**2/u);const h=e.length,d=new Uint8Array(h),p=new Uint32Array(256);for(let f=0;f<n;f++)for(let i=0;i<t;i++){const r=f*t+i,a=e[r];let u=0,h=0;for(let d=0;d<s;d++){const r=f+d-l;if(!(r<0||r>=n))for(let n=0;n<s;n++){const p=i+n-l;if(p<0||p>=t)continue;const f=e[r*t+p],m=o[d*s+n]*c[Math.abs(f-a)];u+=f*m,h+=m}}p[d[r]=Math.round(u/h)]++}return[d,p]}function sie(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}function oie(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let i=-1/0,r=1/0;for(let o=0,a=n.length;o<a;o++){const t=n[o]=e[o<<2];i=Math.max(i,t),r=Math.min(r,t)}const s=255/(i-r);for(let o=0,a=n.length;o<a;o++)n[o]=(n[o]-r)*s;return n}function aie(e){let t,n=-1/0,i=-1/0;const r=e.findIndex(e=>0!==e);let s=r,o=r;for(t=r;t<256;t++){const r=e[t];r>n&&(t-s>i&&(i=t-s,o=t-1),n=r,s=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t}function lie(e){const t=e,{width:n,height:i}=e,{maxDim:r}=JZ(bH,this,cie)._;let s=n,o=i;if(n>r||i>r){let a=n,l=i,c=Math.log2(Math.max(n,i)/r);const u=Math.floor(c);c=c===u?u-1:u;for(let n=0;n<c;n++){s=Math.ceil(a/2),o=Math.ceil(l/2);const n=new OffscreenCanvas(s,o);n.getContext("2d").drawImage(e,0,0,a,l,0,0,s,o),a=s,l=o,e!==t&&e.close(),e=n.transferToImageBitmap()}const h=Math.min(r/s,r/o);s=Math.round(s*h),o=Math.round(o*h)}const a=new OffscreenCanvas(s,o).getContext("2d",{willReadFrequently:!0});a.fillStyle="white",a.fillRect(0,0,s,o),a.filter="grayscale(1)",a.drawImage(e,0,0,e.width,e.height,0,0,s,o);const l=a.getImageData(0,0,s,o).data;return[JZ(bH,this,oie).call(this,l),s,o]}bH=Gne;var cie={_:{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}},uie={_:new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1])};class hie extends tne{constructor(){super(),super.updateProperties({fill:H0._defaultLineColor,"stroke-width":0})}clone(){const e=new hie;return e.updateAll(this),e}}class die extends Xne{constructor(e){super(e),super.updateProperties({stroke:H0._defaultLineColor,"stroke-width":1})}clone(){const e=new die(this._viewParameters);return e.updateAll(this),e}}var pie=new WeakMap,fie=new WeakMap,mie=new WeakMap,gie=new WeakMap;class vie extends sne{constructor(e){super(p(p({},e),{},{mustBeCommitted:!0,name:"signatureEditor"})),KZ(this,pie,!1),KZ(this,fie,null),KZ(this,mie,null),KZ(this,gie,null),this._willKeepAspectRatio=!0,nH(mie,this,e.signatureData||null),nH(fie,this,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){H0.initialize(e,t),this._defaultDrawingOptions=new hie,this._defaultDrawnSignatureOptions=new die(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return mY(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!tH(fie,this)}}static computeTelemetryFinalData(e){var t,n;const i=e.get("hasDescription");return{hasAltText:null!==(t=i.get(!0))&&void 0!==t?t:0,hasNoAltText:null!==(n=i.get(!1))&&void 0!==n?n:0}}get isResizable(){return!0}onScaleChanging(){null!==this._drawId&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),null===this._drawId)if(tH(mie,this)){const{lines:e,mustSmooth:t,areContours:n,description:i,uuid:r,heightInPage:s}=tH(mie,this),{rawDims:{pageWidth:o,pageHeight:a},rotation:l}=this.parent.viewport,c=Gne.processDrawnLines({lines:e,pageWidth:o,pageHeight:a,rotation:l,innerMargin:vie._INNER_MARGIN,mustSmooth:t,areContours:n});this.addSignature(c,s,i,r)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:tH(fie,this)||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){nH(gie,this,e),this.addEditToolbar()}getUuid(){return tH(gie,this)}get description(){return tH(fie,this)}set description(e){nH(fie,this,e),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{null===t||void 0===t||t.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:i,height:r}=tH(mie,this),s=Math.max(i,r);return{areContours:t,outline:Gne.processDrawnLines({lines:{curves:e.map(e=>({points:e})),thickness:n,width:i,height:r},pageWidth:s,pageHeight:s,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t}).outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,i){const{x:r,y:s}=this,{outline:o}=nH(mie,this,e);let a;nH(pie,this,o instanceof Yne),this.description=n,tH(pie,this)?a=vie.getDefaultDrawingOptions():(a=vie._defaultDrawnSignatureOptions.clone(),a.updateProperties({"stroke-width":o.thickness})),this._addOutlines({drawOutlines:o,drawingOptions:a});const[,l]=this.pageDimensions;let c=t/l;c=c>=1?.5:c,this.width*=c/this.height,this.width>=1&&(c*=.9/this.width,this.width=.9),this.height=c,this.setDims(),this.x=r,this.y=s,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return Gne.process(e,t,n,i,vie._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:r}=this.parent.viewport;return Gne.extractContoursFromText(e,t,n,i,r,vie._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return Gne.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:vie._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions(e){let{areContours:t,thickness:n}=e;t?this._drawingOptions=vie.getDefaultDrawingOptions():(this._drawingOptions=vie._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":i}}=this,r=Object.assign(super.serialize(e),{isSignature:!0,areContours:tH(pie,this),color:[0,0,0],thickness:tH(pie,this)?0:i});return this.addComment(r),e?(r.paths={lines:t,points:n},r.uuid=tH(gie,this),r.isCopy=!0):r.lines=t,tH(fie,this)&&(r.accessibilityData={type:"Figure",alt:tH(fie,this)}),r}static deserializeDraw(e,t,n,i,r,s){return s.areContours?Yne.deserialize(e,t,n,i,r,s):$ne.deserialize(e,t,n,i,r,s)}static async deserialize(e,t,n){var i;const r=await super.deserialize(e,t,n);return nH(pie,r,e.areContours),r.description=(null===(i=e.accessibilityData)||void 0===i?void 0:i.alt)||"",nH(gie,r,e.uuid),r}}h(vie,"_type","signature"),h(vie,"_editorType",IH.SIGNATURE),h(vie,"_defaultDrawingOptions",null);var yie=new WeakMap,Oie=new WeakMap,wie=new WeakMap,bie=new WeakMap,kie=new WeakMap,xie=new WeakMap,Die=new WeakMap,Sie=new WeakMap,Cie=new WeakMap,Aie=new WeakMap,Eie=new WeakMap,_ie=new WeakSet;class Tie extends H0{constructor(e){super(p(p({},e),{},{name:"stampEditor"})),iH(this,_ie),KZ(this,yie,null),KZ(this,Oie,null),KZ(this,wie,null),KZ(this,bie,null),KZ(this,kie,null),KZ(this,xie,""),KZ(this,Die,null),KZ(this,Sie,!1),KZ(this,Cie,null),KZ(this,Aie,!1),KZ(this,Eie,!1),nH(bie,this,e.bitmapUrl),nH(kie,this,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){H0.initialize(e,t)}static isHandlingMimeForPasting(e){return eG.includes(e)}static paste(e,t){t.pasteEditor({mode:IH.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!(null===(e=this.altTextData)||void 0===e||!e.altText)}}static computeTelemetryFinalData(e){var t,n;const i=e.get("hasAltText");return{hasAltText:null!==(t=i.get(!0))&&void 0!==t?t:0,hasNoAltText:null!==(n=i.get(!1))&&void 0!==n?n:0}}async mlGuessAltText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:r,height:s}=e||this.copyCanvas(null,null,!0).imageData,o=await n.guess({name:"altText",request:{data:i,width:r,height:s,channels:i.length/(r*s)}});if(!o)throw new Error("No response from the AI service.");if(o.error)throw new Error("Error from the AI service.");if(o.cancel)return null;if(!o.output)throw new Error("No valid response from the AI service.");const a=o.output;return await this.setGuessedAltText(a),t&&!this.hasAltTextData()&&(this.altTextData={alt:a,decorative:!1}),a}remove(){var e;tH(Oie,this)&&(nH(yie,this,null),this._uiManager.imageManager.deleteId(tH(Oie,this)),null===(e=tH(Die,this))||void 0===e||e.remove(),nH(Die,this,null),tH(Cie,this)&&(clearTimeout(tH(Cie,this)),nH(Cie,this,null)));super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(tH(Oie,this)&&null===tH(Die,this)&&JZ(_ie,this,Fie).call(this),this.isAttachedToDOM||this.parent.add(this))):tH(Oie,this)&&JZ(_ie,this,Fie).call(this)}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(tH(wie,this)||tH(yie,this)||tH(bie,this)||tH(kie,this)||tH(Oie,this)||tH(Sie,this))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),tH(Sie,this)||(tH(yie,this)?JZ(_ie,this,Rie).call(this):JZ(_ie,this,Fie).call(this)),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(nH(Oie,this,n),i&&nH(yie,this,i),nH(Sie,this,!1),JZ(_ie,this,Rie).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;null!==tH(Cie,this)&&clearTimeout(tH(Cie,this));nH(Cie,this,setTimeout(()=>{nH(Cie,this,null),JZ(_ie,this,Iie).call(this)},200))}copyCanvas(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e||(e=224);const{width:i,height:r}=tH(yie,this),s=new JY;let o=tH(yie,this),a=i,l=r,c=null;if(t){if(i>t||r>t){const e=Math.min(t/i,t/r);a=Math.floor(i*e),l=Math.floor(r*e)}c=document.createElement("canvas");const e=c.width=Math.ceil(a*s.sx),n=c.height=Math.ceil(l*s.sy);tH(Aie,this)||(o=JZ(_ie,this,Nie).call(this,e,n));const u=c.getContext("2d");u.filter=this._uiManager.hcmFilter;let h="white",d="#cfcfd8";"none"!==this._uiManager.hcmFilter?d="black":tG.isDarkMode&&(h="#8f8f9d",d="#42414d");const p=15,f=p*s.sx,m=p*s.sy,g=new OffscreenCanvas(2*f,2*m),v=g.getContext("2d");v.fillStyle=h,v.fillRect(0,0,2*f,2*m),v.fillStyle=d,v.fillRect(0,0,f,m),v.fillRect(f,m,f,m),u.fillStyle=u.createPattern(g,"repeat"),u.fillRect(0,0,e,n),u.drawImage(o,0,0,o.width,o.height,0,0,e,n)}let u=null;if(n){let t,n;if(s.symmetric&&o.width<e&&o.height<e)t=o.width,n=o.height;else if(o=tH(yie,this),i>e||r>e){const s=Math.min(e/i,e/r);t=Math.floor(i*s),n=Math.floor(r*s),tH(Aie,this)||(o=JZ(_ie,this,Nie).call(this,t,n))}const a=new OffscreenCanvas(t,n).getContext("2d",{willReadFrequently:!0});a.drawImage(o,0,0,o.width,o.height,0,0,t,n),u={width:t,height:n,data:a.getImageData(0,0,t,n).data}}return{canvas:c,width:a,height:l,imageData:u}}static async deserialize(e,t,n){let i=null,r=!1;if(e instanceof $7){var s;const{data:{rect:o,rotation:a,id:l,structParent:c,popupRef:u,richText:h,contentsObj:d,creationDate:p,modificationDate:f},container:m,parent:{page:{pageNumber:g}},canvas:v}=e;let y,O;v?(delete e.canvas,({id:y,bitmap:O}=n.imageManager.getFromCanvas(m.id,v)),v.remove()):(r=!0,e._hasNoCanvas=!0);const w=(null===(s=await t._structTree.getAriaAttributes("".concat(MY).concat(l)))||void 0===s?void 0:s.get("aria-label"))||"";i=e={annotationType:IH.STAMP,bitmapId:y,bitmap:O,pageIndex:g-1,rect:o.slice(0),rotation:a,annotationElementId:l,id:l,deleted:!1,accessibilityData:{decorative:!1,altText:w},isSvg:!1,structParent:c,popupRef:u,richText:h,comment:(null===d||void 0===d?void 0:d.str)||null,creationDate:p,modificationDate:f}}const o=await super.deserialize(e,t,n),{rect:a,bitmap:l,bitmapUrl:c,bitmapId:u,isSvg:h,accessibilityData:d}=e;r?(n.addMissingCanvas(e.id,o),nH(Sie,o,!0)):u&&n.imageManager.isValidId(u)?(nH(Oie,o,u),l&&nH(yie,o,l)):nH(bie,o,c),nH(Aie,o,h);const[p,f]=o.pageDimensions;return o.width=(a[2]-a[0])/p,o.height=(a[3]-a[1])/f,d&&(o.altTextData=d),o._initialData=i,e.comment&&o.setCommentData(e),nH(Eie,o,!!i),o}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:tH(Oie,this),isSvg:tH(Aie,this)});if(this.addComment(n),e)return n.bitmapUrl=JZ(_ie,this,Bie).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:r}=this.serializeAltText(!1);if(!i&&r&&(n.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const e=JZ(_ie,this,Qie).call(this,n);if(e.isSame)return null;var s;if(e.isSameAltText)delete n.accessibilityData;else n.accessibilityData.structParent=null!==(s=this._initialData.structParent)&&void 0!==s?s:-1;return n.id=this.annotationElementId,delete n.bitmapId,n}if(null===t)return n;t.stamps||(t.stamps=new Map);const o=tH(Aie,this)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(t.stamps.has(tH(Oie,this))){if(tH(Aie,this)){const e=t.stamps.get(tH(Oie,this));o>e.area&&(e.area=o,e.serialized.bitmap.close(),e.serialized.bitmap=JZ(_ie,this,Bie).call(this,!1))}}else t.stamps.set(tH(Oie,this),{area:o,serialized:n}),n.bitmap=JZ(_ie,this,Bie).call(this,!1);return n}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}function Pie(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e?(nH(yie,this,e.bitmap),t||(nH(Oie,this,e.id),nH(Aie,this,e.isSvg)),e.file&&nH(xie,this,e.file.name),JZ(_ie,this,Rie).call(this)):this.remove()}function Mie(){if(nH(wie,this,null),this._uiManager.enableWaiting(!1),tH(Die,this))if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&tH(yie,this))this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});else{if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&tH(yie,this)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch(e){}}this.div.focus()}}function Fie(){if(tH(Oie,this))return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(tH(Oie,this)).then(e=>JZ(_ie,this,Pie).call(this,e,!0)).finally(()=>JZ(_ie,this,Mie).call(this));if(tH(bie,this)){const e=tH(bie,this);return nH(bie,this,null),this._uiManager.enableWaiting(!0),void nH(wie,this,this._uiManager.imageManager.getFromUrl(e).then(e=>JZ(_ie,this,Pie).call(this,e)).finally(()=>JZ(_ie,this,Mie).call(this)))}if(tH(kie,this)){const e=tH(kie,this);return nH(kie,this,null),this._uiManager.enableWaiting(!0),void nH(wie,this,this._uiManager.imageManager.getFromFile(e).then(e=>JZ(_ie,this,Pie).call(this,e)).finally(()=>JZ(_ie,this,Mie).call(this)))}const e=document.createElement("input");e.type="file",e.accept=eG.join(",");const t=this._uiManager._signal;nH(wie,this,new Promise(n=>{e.addEventListener("change",async()=>{if(e.files&&0!==e.files.length){this._uiManager.enableWaiting(!0);const t=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),JZ(_ie,this,Pie).call(this,t)}else this.remove();n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>JZ(_ie,this,Mie).call(this))),e.click()}function Rie(){var e;const{div:t}=this;let{width:n,height:i}=tH(yie,this);const[r,s]=this.pageDimensions,o=.75;if(this.width)n=this.width*r,i=this.height*s;else if(n>o*r||i>o*s){const e=Math.min(o*r/n,o*s/i);n*=e,i*=e}this._uiManager.enableWaiting(!1);const a=nH(Die,this,document.createElement("canvas"));a.setAttribute("role","img"),this.addContainer(a),this.width=n/r,this.height=i/s,this.setDims(),null!==(e=this._initialOptions)&&void 0!==e&&e.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(t.hidden=!1),JZ(_ie,this,Iie).call(this),tH(Eie,this)||(this.parent.addUndoableEditor(this),nH(Eie,this,!0)),this._reportTelemetry({action:"inserted_image"}),tH(xie,this)&&this.div.setAttribute("aria-description",tH(xie,this)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}function Nie(e,t){const{width:n,height:i}=tH(yie,this);let r=n,s=i,o=tH(yie,this);for(;r>2*e||s>2*t;){const n=r,i=s;r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2));const a=new OffscreenCanvas(r,s);a.getContext("2d").drawImage(o,0,0,n,i,0,0,r,s),o=a.transferToImageBitmap()}return o}function Iie(){const[e,t]=this.parentDimensions,{width:n,height:i}=this,r=new JY,s=Math.ceil(n*e*r.sx),o=Math.ceil(i*t*r.sy),a=tH(Die,this);if(!a||a.width===s&&a.height===o)return;a.width=s,a.height=o;const l=tH(Aie,this)?tH(yie,this):JZ(_ie,this,Nie).call(this,s,o),c=a.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,s,o)}function Bie(e){if(e){if(tH(Aie,this)){const e=this._uiManager.imageManager.getSvgUrl(tH(Oie,this));if(e)return e}const e=document.createElement("canvas");({width:e.width,height:e.height}=tH(yie,this));return e.getContext("2d").drawImage(tH(yie,this),0,0),e.toDataURL()}if(tH(Aie,this)){const[e,t]=this.pageDimensions,n=Math.round(this.width*e*BY.PDF_TO_CSS_UNITS),i=Math.round(this.height*t*BY.PDF_TO_CSS_UNITS),r=new OffscreenCanvas(n,i);return r.getContext("2d").drawImage(tH(yie,this),0,0,tH(yie,this).width,tH(yie,this).height,0,0,n,i),r.transferToImageBitmap()}return structuredClone(tH(yie,this))}function Qie(e){var t;const{pageIndex:n,accessibilityData:{altText:i}}=this._initialData,r=e.pageIndex===n,s=((null===(t=e.accessibilityData)||void 0===t?void 0:t.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&s,isSameAltText:s}}h(Tie,"_type","stamp"),h(Tie,"_editorType",IH.STAMP);var Lie=new WeakMap,jie=new WeakMap,$ie=new WeakMap,zie=new WeakMap,Wie=new WeakMap,Vie=new WeakMap,Uie=new WeakMap,Xie=new WeakMap,qie=new WeakMap,Zie=new WeakMap,Hie=new WeakMap,Yie=new WeakMap,Gie=new WeakMap,Kie=new WeakMap,Jie=new WeakMap,ere=new WeakMap,tre=new WeakSet;class nre{constructor(e){let{uiManager:t,pageIndex:n,div:i,structTreeLayer:r,accessibilityManager:s,annotationLayer:o,drawLayer:a,textLayer:l,viewport:c,l10n:u}=e;iH(this,tre),KZ(this,Lie,void 0),KZ(this,jie,!1),KZ(this,$ie,null),KZ(this,zie,null),KZ(this,Wie,null),KZ(this,Vie,new Map),KZ(this,Uie,!1),KZ(this,Xie,!1),KZ(this,qie,!1),KZ(this,Zie,null),KZ(this,Hie,null),KZ(this,Yie,null),KZ(this,Gie,null),KZ(this,Kie,null),KZ(this,Jie,-1),KZ(this,ere,void 0);const h=[...cre._.values()];if(!nre._initialized){nre._initialized=!0;for(const e of h)e.initialize(u,t)}t.registerEditorTypes(h),nH(ere,this,t),this.pageIndex=n,this.div=i,nH(Lie,this,s),nH($ie,this,o),this.viewport=c,nH(Yie,this,l),this.drawLayer=a,this._structTree=r,tH(ere,this).addLayer(this)}updatePageIndex(e){this.pageIndex=e}get isEmpty(){return 0===tH(Vie,this).size}get isInvisible(){return this.isEmpty&&tH(ere,this).getMode()===IH.NONE}updateToolbar(e){tH(ere,this).updateToolbar(e)}updateMode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tH(ere,this).getMode();switch(JZ(tre,this,lre).call(this),e){case IH.NONE:return this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case IH.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case IH.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===IH.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of cre._.values())t.toggle("".concat(n._type,"Editing"),e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===(null===(t=tH(Yie,this))||void 0===t?void 0:t.div)}setEditingState(e){tH(ere,this).setEditingState(e)}addCommands(e){tH(ere,this).addCommands(e)}cleanUndoStack(e){tH(ere,this).cleanUndoStack(e)}toggleDrawing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("drawing",!e)}togglePointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=tH($ie,this))||void 0===e||e.togglePointerEvents(t)}async enable(){var e;nH(qie,this,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),null===(e=tH(Kie,this))||void 0===e||e.abort(),nH(Kie,this,null);const t=new Set;for(const i of eH(tre,this,ire))i.enableEditing(),i.show(!0),i.annotationElementId&&(tH(ere,this).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const n=tH($ie,this);if(n)for(const i of n.getEditableAnnotations()){if(i.hide(),tH(ere,this).isDeletedAnnotationElement(i.data.id))continue;if(t.has(i.data.id))continue;const e=await this.deserialize(i);e&&(this.addOrRebuild(e),e.enableEditing())}nH(qie,this,!1),tH(ere,this)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(nH(Xie,this,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),tH(Yie,this)&&!tH(Kie,this)){nH(Kie,this,new AbortController);const e=tH(ere,this).combinedSignal(tH(Kie,this));tH(Yie,this).div.addEventListener("pointerdown",e=>{const{clientX:t,clientY:n,timeStamp:i}=e;if(i-tH(Jie,this)>500)return void nH(Jie,this,i);nH(Jie,this,-1);const{classList:r}=this.div;r.toggle("getElements",!0);const s=document.elementsFromPoint(t,n);if(r.toggle("getElements",!1),!this.div.contains(s[0]))return;let o;const a=new RegExp("^".concat(NH,"[0-9]+$"));for(const c of s)if(a.test(c.id)){o=c.id;break}if(!o)return;const l=tH(Vie,this).get(o);null===(null===l||void 0===l?void 0:l.annotationElementId)&&(e.stopPropagation(),e.preventDefault(),l.dblclick(e))},{signal:e,capture:!0})}const e=tH($ie,this),t=[];if(e){const i=new Map,r=new Map;for(const e of eH(tre,this,ire)){var n;e.disableEditing(),e.annotationElementId?null===e.serialize()?(r.set(e.annotationElementId,e),null===(n=this.getEditableAnnotation(e.annotationElementId))||void 0===n||n.show(),e.remove()):i.set(e.annotationElementId,e):t.push(e)}const s=e.getEditableAnnotations();for(const e of s){const{id:t}=e.data;if(tH(ere,this).isDeletedAnnotationElement(t)){e.updateEdited({deleted:!0});continue}let n=r.get(t);n?(n.resetAnnotationElement(e),n.show(!1),e.show()):(n=i.get(t),n&&(tH(ere,this).addChangedExistingAnnotation(n),n.renderAnnotationElement(e)&&n.show(!1)),e.show())}}JZ(tre,this,lre).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of cre._.values())i.remove("".concat(r._type,"Editing"));this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),null===e||void 0===e||e.updateFakeAnnotations(t),nH(Xie,this,!1)}getEditableAnnotation(e){var t;return(null===(t=tH($ie,this))||void 0===t?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){tH(ere,this).getActive()!==e&&tH(ere,this).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,null!==(e=tH(Yie,this))&&void 0!==e&&e.div&&!tH(Gie,this)){nH(Gie,this,new AbortController);const e=tH(ere,this).combinedSignal(tH(Gie,this));tH(Yie,this).div.addEventListener("pointerdown",JZ(tre,this,rre).bind(this),{signal:e}),tH(Yie,this).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,null!==(e=tH(Yie,this))&&void 0!==e&&e.div&&tH(Gie,this)&&(tH(Gie,this).abort(),nH(Gie,this,null),tH(Yie,this).div.classList.remove("highlighting"))}enableClick(){if(tH(zie,this))return;nH(zie,this,new AbortController);const e=tH(ere,this).combinedSignal(tH(zie,this));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;null===(e=tH(zie,this))||void 0===e||e.abort(),nH(zie,this,null)}attach(e){tH(Vie,this).set(e.id,e);const{annotationElementId:t}=e;t&&tH(ere,this).isDeletedAnnotationElement(t)&&tH(ere,this).removeDeletedAnnotationElement(e)}detach(e){var t;tH(Vie,this).delete(e.id),null===(t=tH(Lie,this))||void 0===t||t.removePointerInTextLayer(e.contentDiv),!tH(Xie,this)&&e.annotationElementId&&tH(ere,this).addDeletedAnnotationElement(e)}remove(e){this.detach(e),tH(ere,this).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(tH(ere,this).addDeletedAnnotationElement(e),H0.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),null===(t=e.parent)||void 0===t||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(e.parent!==this||!e.isAttachedToDOM){if(this.changeParent(e),tH(ere,this).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!tH(qie,this)),tH(ere,this).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var t;if(!e.isAttachedToDOM)return;const{activeElement:n}=document;e.div.contains(n)&&!tH(Wie,this)&&(e._focusEventsAllowed=!1,nH(Wie,this,setTimeout(()=>{nH(Wie,this,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:tH(ere,this)._signal}),n.focus())},0))),e._structTreeParentId=null===(t=tH(Lie,this))||void 0===t?void 0:t.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getEditorByUID(e){for(const t of tH(Vie,this).values())if(t.uid===e)return t;return null}getNextId(){return tH(ere,this).getId()}combinedSignal(e){return tH(ere,this).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return null===(e=eH(tre,this,sre))||void 0===e?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await tH(ere,this).updateMode(e.mode);const{offsetX:n,offsetY:i}=JZ(tre,this,are).call(this),r=this.getNextId(),s=JZ(tre,this,ore).call(this,p({parent:this,id:r,x:n,y:i,uiManager:tH(ere,this),isCentered:!0},t));s&&this.add(s)}async deserialize(e){var t,n;return await(null===(t=cre._.get(null!==(n=e.annotationType)&&void 0!==n?n:e.annotationEditorType))||void 0===t?void 0:t.deserialize(e,this,tH(ere,this)))||null}createAndAddNewEditor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.getNextId(),r=JZ(tre,this,ore).call(this,p({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:tH(ere,this),isCentered:t},n));return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.createAndAddNewEditor(JZ(tre,this,are).call(this),!0,e)}setSelected(e){tH(ere,this).setSelected(e)}toggleSelected(e){tH(ere,this).toggleSelected(e)}unselect(e){tH(ere,this).unselect(e)}pointerup(e){var t;const{isMac:n}=DY.platform;if(0!==e.button||e.ctrlKey&&n)return;if(e.target!==this.div)return;if(!tH(Uie,this))return;if(nH(Uie,this,!1),null!==(t=eH(tre,this,sre))&&void 0!==t&&t.isDrawer&&eH(tre,this,sre).supportMultipleDrawings)return;if(!tH(jie,this))return void nH(jie,this,!0);const i=tH(ere,this).getMode();i!==IH.STAMP&&i!==IH.SIGNATURE?this.createAndAddNewEditor(e,!1):tH(ere,this).unselectAll()}pointerdown(e){var t;if(tH(ere,this).getMode()===IH.HIGHLIGHT&&this.enableTextSelection(),tH(Uie,this))return void nH(Uie,this,!1);const{isMac:n}=DY.platform;if(0!==e.button||e.ctrlKey&&n)return;if(e.target!==this.div)return;if(nH(Uie,this,!0),null!==(t=eH(tre,this,sre))&&void 0!==t&&t.isDrawer)return void this.startDrawingSession(e);const i=tH(ere,this).getActive();nH(jie,this,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),tH(Zie,this))return void eH(tre,this,sre).startDrawing(this,tH(ere,this),!1,e);tH(ere,this).setCurrentDrawingSession(this),nH(Zie,this,new AbortController);const t=tH(ere,this).combinedSignal(tH(Zie,this));this.div.addEventListener("blur",e=>{let{relatedTarget:t}=e;t&&!this.div.contains(t)&&(nH(Hie,this,null),this.commitOrRemove())},{signal:t}),eH(tre,this,sre).startDrawing(this,tH(ere,this),!1,e)}pause(e){if(e){const{activeElement:e}=document;return void(this.div.contains(e)&&nH(Hie,this,e))}tH(Hie,this)&&setTimeout(()=>{var e;null===(e=tH(Hie,this))||void 0===e||e.focus(),nH(Hie,this,null)},0)}endDrawingSession(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return tH(Zie,this)?(tH(ere,this).setCurrentDrawingSession(null),tH(Zie,this).abort(),nH(Zie,this,null),nH(Hie,this,null),eH(tre,this,sre).endDrawing(e)):null}findNewParent(e,t,n){const i=tH(ere,this).findParent(t,n);return null!==i&&i!==this&&(i.changeParent(e),!0)}commitOrRemove(){return!!tH(Zie,this)&&(this.endDrawingSession(),!0)}onScaleChanging(){tH(Zie,this)&&eH(tre,this,sre).onScaleChangingWhenDrawing(this)}destroy(){var e;this.commitOrRemove(),(null===(e=tH(ere,this).getActive())||void 0===e?void 0:e.parent)===this&&(tH(ere,this).commitOrRemove(),tH(ere,this).setActiveEditor(null)),tH(Wie,this)&&(clearTimeout(tH(Wie,this)),nH(Wie,this,null));for(const n of tH(Vie,this).values()){var t;null===(t=tH(Lie,this))||void 0===t||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove()}this.div=null,tH(Vie,this).clear(),tH(ere,this).removeLayer(this)}render(e){let{viewport:t}=e;this.viewport=t,KY(this.div,t);for(const n of tH(ere,this).getEditors(this.pageIndex))this.add(n),n.rebuild();this.updateMode()}update(e){let{viewport:t}=e;tH(ere,this).commitOrRemove(),JZ(tre,this,lre).call(this);const n=this.viewport.rotation,i=t.rotation;if(this.viewport=t,KY(this.div,{rotation:i}),n!==i)for(const r of tH(Vie,this).values())r.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return tH(ere,this).viewParameters.realScale}}function ire(e){return 0!==tH(Vie,e).size?tH(Vie,e).values():tH(ere,e).getEditors(e.pageIndex)}function rre(e){tH(ere,this).unselectAll();const{target:t}=e;if(t===tH(Yie,this).div||("img"===t.getAttribute("role")||t.classList.contains("endOfContent"))&&tH(Yie,this).div.contains(t)){const{isMac:t}=DY.platform;if(0!==e.button||e.ctrlKey&&t)return;tH(ere,this).showAllEditors("highlight",!0,!0),tH(Yie,this).div.classList.add("free"),this.toggleDrawing(),Bte.startHighlighting(this,"ltr"===tH(ere,this).direction,{target:tH(Yie,this).div,x:e.x,y:e.y}),tH(Yie,this).div.addEventListener("pointerup",()=>{tH(Yie,this).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:tH(ere,this)._signal}),e.preventDefault()}}function sre(e){return cre._.get(tH(ere,e).getMode())}function ore(e){const t=eH(tre,this,sre);return t?new t.prototype.constructor(e):null}function are(){const{x:e,y:t,width:n,height:i}=this.boundingClientRect,r=Math.max(0,e),s=Math.max(0,t),o=(r+Math.min(window.innerWidth,e+n))/2-e,a=(s+Math.min(window.innerHeight,t+i))/2-t,[l,c]=this.viewport.rotation%180===0?[o,a]:[a,o];return{offsetX:l,offsetY:c}}function lre(){for(const e of tH(Vie,this).values())e.isEmpty()&&e.remove()}h(nre,"_initialized",!1);var cre={_:new Map([uee,Zne,Tie,Bte,vie].map(e=>[e._editorType,e]))},ure=new WeakMap,hre=new WeakMap,dre=new WeakMap,pre=new WeakSet;class fre{constructor(){iH(this,pre),KZ(this,ure,null),KZ(this,hre,new Map),KZ(this,dre,new Map)}setParent(e){if(tH(ure,this)){if(tH(ure,this)!==e){if(tH(hre,this).size>0)for(const t of tH(hre,this).values())t.remove(),e.append(t);nH(ure,this,e)}}else nH(ure,this,e)}static get _svgFactory(){return mY(this,"_svgFactory",new a9)}draw(e){var t,n;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=(Ore._=(t=Ore._,n=t++,t),n),o=JZ(pre,this,gre).call(this),a=fre._svgFactory.createElement("defs");o.append(a);const l=fre._svgFactory.createElement("path");a.append(l);const c="path_".concat(s);l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),i&&tH(dre,this).set(s,l);const u=r?JZ(pre,this,vre).call(this,a,c):null,h=fre._svgFactory.createElement("use");return o.append(h),h.setAttribute("href","#".concat(c)),this.updateProperties(o,e),tH(hre,this).set(s,o),{id:s,clipPathId:"url(#".concat(u,")")}}drawOutline(e,t){var n,i;const r=(Ore._=(n=Ore._,i=n++,n),i),s=JZ(pre,this,gre).call(this),o=fre._svgFactory.createElement("defs");s.append(o);const a=fre._svgFactory.createElement("path");o.append(a);const l="path_".concat(r);let c;if(a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t){const e=fre._svgFactory.createElement("mask");o.append(e),c="mask_".concat(r),e.setAttribute("id",c),e.setAttribute("maskUnits","objectBoundingBox");const t=fre._svgFactory.createElement("rect");e.append(t),t.setAttribute("width","1"),t.setAttribute("height","1"),t.setAttribute("fill","white");const n=fre._svgFactory.createElement("use");e.append(n),n.setAttribute("href","#".concat(l)),n.setAttribute("stroke","none"),n.setAttribute("fill","black"),n.setAttribute("fill-rule","nonzero"),n.classList.add("mask")}const u=fre._svgFactory.createElement("use");s.append(u),u.setAttribute("href","#".concat(l)),c&&u.setAttribute("mask","url(#".concat(c,")"));const h=u.cloneNode();return s.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(s,e),tH(hre,this).set(r,s),r}finalizeDraw(e,t){tH(dre,this).delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:i,rootClass:r,path:s}=t,o="number"===typeof e?tH(hre,this).get(e):e;if(o){if(n&&JZ(pre,this,yre).call(this,o,n),i&&mre.call(fre,o,i),r){const{classList:e}=o;for(const[t,n]of Object.entries(r))e.toggle(t,n)}if(s){const e=o.firstElementChild.firstElementChild;JZ(pre,this,yre).call(this,e,s)}}}updateParent(e,t){if(t===this)return;const n=tH(hre,this).get(e);n&&(tH(ure,t).append(n),tH(hre,this).delete(e),tH(hre,t).set(e,n))}remove(e){tH(dre,this).delete(e),null!==tH(ure,this)&&(tH(hre,this).get(e).remove(),tH(hre,this).delete(e))}destroy(){nH(ure,this,null);for(const e of tH(hre,this).values())e.remove();tH(hre,this).clear(),tH(dre,this).clear()}}function mre(e,t){let[n,i,r,s]=t;const{style:o}=e;o.top="".concat(100*i,"%"),o.left="".concat(100*n,"%"),o.width="".concat(100*r,"%"),o.height="".concat(100*s,"%")}function gre(){const e=kH._svgFactory.create(1,1,!0);return tH(ure,this).append(e),e.setAttribute("aria-hidden",!0),e}function vre(e,t){const n=kH._svgFactory.createElement("clipPath");e.append(n);const i="clip_".concat(t);n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const r=kH._svgFactory.createElement("use");return n.append(r),r.setAttribute("href","#".concat(t)),r.classList.add("clip"),i}function yre(e,t){for(const[n,i]of Object.entries(t))null===i?e.removeAttribute(n):e.setAttribute(n,i)}kH=fre;var Ore={_:0};globalThis._pdfjsTestingUtils={HighlightOutliner:ate},globalThis.pdfjsLib={AbortException:kY,AnnotationEditorLayer:nre,AnnotationEditorParamsType:BH,AnnotationEditorType:IH,AnnotationEditorUIManager:aJ,AnnotationLayer:tee,AnnotationMode:RH,AnnotationType:qH,applyOpacity:function(e,t,n,i){const r=255*(1-(i=Math.min(Math.max(null!==i&&void 0!==i?i:1,0),1)));return[e=Math.round(e*i+r),t=Math.round(t*i+r),n=Math.round(n*i+r)]},build:"384c6208b",ColorPicker:V6,createValidAbsoluteUrl:pY,CSSConstants:class{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),mY(this,"commentForegroundColor",HY(n))}},DOMSVGFactory:a9,DrawLayer:fre,FeatureTest:DY,fetchData:QY,findContrastColor:function(e,t){const n=e[0]+256*e[1]+65536*e[2]+16777216*t[0]+4294967296*t[1]+1099511627776*t[2];let i=oG.get(n);if(i)return i;const r=new Float32Array(9),s=r.subarray(0,3),o=r.subarray(3,6);nG(e,o);const a=r.subarray(6,9);nG(t,a);const l=a[2]<.5,c=l?12:4.5;if(o[2]=l?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),sG(o,a,s)<c){let e,t;l?(e=o[2],t=1):(e=0,t=o[2]);const n=.005;for(;t-e>n;){const n=o[2]=(e+t)/2;l===sG(o,a,s)<c?e=n:t=n}o[2]=l?t:e}return iG(o,s),i=CY.makeHexColor(Math.round(255*s[0]),Math.round(255*s[1]),Math.round(255*s[2])),oG.set(n,i),i},getDocument:j8,getFilenameFromUrl:function(e){return[e]=e.split(/[#?]/,1),e.substring(e.lastIndexOf("/")+1)},getPdfFilenameFromUrl:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"document.pdf";if("string"!==typeof e)return t;if($Y(e))return uY('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(e=>{try{return new URL(e)}catch(t){try{return new URL(decodeURIComponent(e))}catch(n){try{return new URL(e,"https://foo.bar")}catch(i){try{return new URL(decodeURIComponent(e),"https://foo.bar")}catch(r){return null}}}}})(e);if(!n)return t;const i=e=>{try{let t=decodeURIComponent(e);return t.includes("/")?(t=t.split("/").at(-1),t.test(/^\.pdf$/i)?t:e):t}catch(t){return e}},r=/\.pdf$/i,s=n.pathname.split("/").at(-1);if(r.test(s))return i(s);if(n.searchParams.size>0){const e=Array.from(n.searchParams.values()).reverse();for(const n of e)if(r.test(n))return i(n);const t=Array.from(n.searchParams.keys()).reverse();for(const n of t)if(r.test(n))return i(n)}if(n.hash){const e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(e)return i(e[0])}return t},getRGB:HY,getUuid:PY,getXfaPageViewport:function(e,t){let{scale:n=1,rotation:i=0}=t;const{width:r,height:s}=e.attributes.style,o=[0,0,parseInt(r),parseInt(s)];return new LY({viewBox:o,userUnit:1,scale:n,rotation:i})},GlobalWorkerOptions:q5,ImageKind:XH,InvalidPDFException:OY,isDataScheme:$Y,isPdfFile:zY,isValidExplicitDest:y2,MathClamp:FY,noContextMenu:UY,normalizeUnicode:function(e){return _Y||(_Y=/([\xA0\xB5\u037E\u0EB3\u2000-\u200A\u202F\u2126\uFB00-\uFB04\uFB06\uFB20-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBA1\uFBA4-\uFBA9\uFBAE-\uFBB1\uFBD3-\uFBDC\uFBDE-\uFBE7\uFBEA-\uFBF8\uFBFC\uFBFD\uFC00-\uFC5D\uFC64-\uFCF1\uFCF5-\uFD3D\uFD88\uFDF4\uFDFA\uFDFB\uFE71\uFE77\uFE79\uFE7B\uFE7D]+)|(\uFB05+)/g,TY=new Map([["\ufb05","\u017ft"]])),e.replaceAll(_Y,(e,t,n)=>t?t.normalize("NFKC"):TY.get(n))},OPS:eY,OutputScale:JY,PagesMapper:uG,PasswordResponses:{NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PDFDataRangeTransport:Z8,PDFDateString:qY,PDFWorker:o6,PermissionFlag:{PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},PixelsPerInch:BY,RenderingCancelledException:jY,renderRichText:aG,ResponseException:wY,setLayerDimensions:KY,shadow:mY,SignatureExtractor:Gne,stopEvent:XY,SupportedImageMimeTypes:eG,TextLayer:A8,TouchManager:y0,updateUrlHash:fY,Util:CY,VerbosityLevel:JH,version:M6,XfaLayer:NY},q5.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@".concat(M6,"/build/pdf.worker.min.mjs");const wre={free:[{id:"gpt-4o-mini",name:"GPT-4o Mini",provider:"openai",description:"Free tier (500/day)"},{id:"claude-haiku-4-5-20251001",name:"Claude 4.5 Haiku",provider:"anthropic",description:"Free tier (500/day)"}],openai:[{id:"gpt-4o-mini",name:"GPT-4o Mini",provider:"openai",description:"Fast & affordable"},{id:"gpt-4-turbo",name:"GPT-4 Turbo",provider:"openai",description:"More capable"},{id:"gpt-4o",name:"GPT-4o",provider:"openai",description:"Latest & best"}],anthropic:[{id:"claude-haiku-4-5-20251001",name:"Claude 4.5 Haiku",provider:"anthropic",description:"Fast & smart"},{id:"claude-sonnet-4-5-20250929",name:"Claude 4.5 Sonnet",provider:"anthropic",description:"Most capable"}]},bre=[{label:"Summarize my notes",icon:NZ},{label:"Generate flashcards from this page",icon:IZ},{label:"Explain a concept",icon:BZ},{label:"Quiz me on this topic",icon:QZ}],kre=["image/png","image/jpeg","image/gif","image/webp","application/pdf","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"],xre=1024;function Dre(e){return new Promise((t,n)=>{const i=new Image;i.onload=()=>{const{width:r,height:s}=i;if(URL.revokeObjectURL(i.src),r<=xre&&s<=xre)return void function(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{const e=i.result;t(e.split(",")[1])},i.onerror=n,i.readAsDataURL(e)})}(e).then(n=>{t({base64:n,mimeType:e.type||"image/png"})}).catch(n);const o=xre/Math.max(r,s),a=Math.round(r*o),l=Math.round(s*o),c=document.createElement("canvas");c.width=a,c.height=l;const u=c.getContext("2d"),h=new Image;h.onload=()=>{u.drawImage(h,0,0,a,l),URL.revokeObjectURL(h.src);const e=c.toDataURL("image/jpeg",.85);t({base64:e.split(",")[1],mimeType:"image/jpeg"})},h.onerror=n,h.src=URL.createObjectURL(e)},i.onerror=n,i.src=URL.createObjectURL(e)})}async function Sre(e){const t=await e.arrayBuffer(),n=await j8({data:t}).promise,i=[],r=Math.min(n.numPages,50);for(let s=1;s<=r;s++){const e=await n.getPage(s),t=(await e.getTextContent()).items.map(e=>e.str).join(" ");t.trim()&&i.push(t)}return n.numPages>50&&i.push("\n[...truncated, showing 50 of ".concat(n.numPages," pages]")),i.join("\n\n")}function Cre(e){let{content:t}=e;const[n,i]=(0,s.useState)(null),r=[],o=/```(\w*)\n?([\s\S]*?)```/g;let a,l=0;for(;null!==(a=o.exec(t));)a.index>l&&r.push({type:"text",content:t.slice(l,a.index)}),r.push({type:"code",content:a[2].trim(),lang:a[1]||void 0}),l=a.index+a[0].length;if(l<t.length&&r.push({type:"text",content:t.slice(l)}),0===r.length||1===r.length&&"text"===r[0].type)return(0,Qt.jsx)(Qt.Fragment,{children:t});let c=0;return(0,Qt.jsx)(Qt.Fragment,{children:r.map((e,t)=>{if("text"===e.type)return(0,Qt.jsx)("span",{children:e.content},t);const r=c++;return(0,Qt.jsxs)("div",{className:"chat-code-block",children:[(0,Qt.jsxs)("div",{className:"chat-code-header",children:[(0,Qt.jsx)("span",{className:"chat-code-lang",children:e.lang||"code"}),(0,Qt.jsx)("button",{className:"chat-code-copy",onClick:()=>(async(e,t)=>{try{await navigator.clipboard.writeText(e),i(t),setTimeout(()=>i(null),2e3)}catch(n){const r=document.createElement("textarea");r.value=e,document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r),i(t),setTimeout(()=>i(null),2e3)}})(e.content,r),title:"Copy to clipboard",children:n===r?(0,Qt.jsxs)(Qt.Fragment,{children:[(0,Qt.jsx)(hZ,{size:12})," Copied"]}):(0,Qt.jsxs)(Qt.Fragment,{children:[(0,Qt.jsx)(LZ,{size:12})," Copy"]})})]}),(0,Qt.jsx)("pre",{className:"chat-code-content",children:(0,Qt.jsx)("code",{children:e.content})})]},t)})})}function Are(e){let{roomId:t,onClose:n}=e;const[i,r]=(0,s.useState)([]),[o,a]=(0,s.useState)(""),[l,c]=(0,s.useState)(!1),[,u]=(0,s.useState)(!1),[h,d]=(0,s.useState)(null),[f,m]=(0,s.useState)(!1),[,g]=(0,s.useState)(null),[v,y]=(0,s.useState)([]),[O,w]=(0,s.useState)([]),[b,k]=(0,s.useState)(!1),[x,D]=(0,s.useState)([{id:"default",name:"Chat",createdAt:Date.now()}]),[S,C]=(0,s.useState)("default"),[,A]=(0,s.useState)(!1),[E,_]=(0,s.useState)({}),[T,P]=(0,s.useState)({}),[M,F]=(0,s.useState)(()=>localStorage.getItem("flashy_api_key")||""),[R,N]=(0,s.useState)(()=>localStorage.getItem("flashy_api_provider")||"openai"),[I,B]=(0,s.useState)(()=>{const e=localStorage.getItem("flashy_model"),t=[...wre.free,...wre.openai,...wre.anthropic].map(e=>e.id);return e&&t.includes(e)?e:"gpt-4o-mini"}),Q=(0,s.useRef)(null),L=(0,s.useRef)(null),j=(0,s.useRef)(null),$=(0,s.useRef)(null),z=(0,s.useRef)(null),W=(0,s.useRef)(null),V=(0,s.useRef)(null),U=(0,s.useRef)(null),X=(0,s.useRef)(0),q=(0,s.useRef)(null),Z=(0,s.useRef)(!1),H=(0,s.useRef)(new Set),Y=(0,s.useRef)(new Map),G=(0,s.useRef)(new Map),K=(0,s.useRef)(0),J=(0,s.useRef)(null),ee=(0,s.useRef)(M),te=(0,s.useRef)(R),ne=(0,s.useRef)(I);(0,s.useEffect)(()=>{ee.current=M},[M]),(0,s.useEffect)(()=>{te.current=R},[R]),(0,s.useEffect)(()=>{ne.current=I},[I]),(0,s.useEffect)(()=>{localStorage.setItem("flashy_api_key",M),localStorage.setItem("flashy_api_provider",R),localStorage.setItem("flashy_model",I)},[M,R,I]),(0,s.useEffect)(()=>()=>{v.forEach(e=>{e.previewUrl&&URL.revokeObjectURL(e.previewUrl)})},[]);const ie=()=>M?"anthropic"===R?wre.anthropic:wre.openai:wre.free;(0,s.useEffect)(()=>{Z.current=l},[l]);const re=(0,s.useCallback)(()=>{var e;null===(e=Q.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[]);(0,s.useEffect)(()=>{re()},[i,re]);const se=(0,s.useCallback)(async(e,n)=>{if(!H.current.has(e.id)){H.current.add(e.id),c(!0),d(null);try{const{ydoc:i}=await W_.connect(),r=zP(i.getXmlFragment("prosemirror")),s=n.toArray().slice(-10).map(e=>({role:e.role,content:e.content})),o=Y.current.get(e.id);KS.log("[Chat] Leader response for msg:",e.id,"has pending files:",!!o,o?"images: ".concat(o.images.length,", text: ").concat(o.extractedText.length," chars"):""),o&&Y.current.delete(e.id);let a=r;null!==o&&void 0!==o&&o.extractedText&&(a+="\n\n## Attached File Content"+o.extractedText);const l=ee.current,c=te.current,u=ne.current;KS.log("[Chat] Using model:",u,"provider:",c,"hasKey:",!!l);const h={messages:s,documentContent:a,userApiKey:l||void 0,provider:c,model:u,roomId:t,ragEnabled:!0};if(null!==o&&void 0!==o&&o.images&&o.images.length>0){h.imageAttachments=o.images;const e=o.images.reduce((e,t)=>e+t.base64.length,0);KS.log("[Chat] Sending",o.images.length,"images to API, total base64 size:",e);const t=JSON.stringify(h).length;if(KS.log("[Chat] Total request body size:",t),t>18e5){KS.warn("[Chat] Body too large, sending without images"),delete h.imageAttachments;const e=h.messages[h.messages.length-1];e&&(e.content+="\n\n(File attachments were too large to send directly. The extracted text content is still available in the study material context.)")}}const{data:d,error:p}=await Q_.functions.invoke("chat",{body:h});if(p)throw p;void 0!==d.remaining&&g(d.remaining);const f={id:"msg-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),role:"assistant",content:d.content||"Sorry, I could not generate a response.",timestamp:Date.now()};n.push([f])}catch(a){var i,r,s;KS.error("Chat API error:",a);let e=null,t="";try{var o;const n=null===(o=a.context)||void 0===o?void 0:o.body;if(n&&"string"===typeof n)e=JSON.parse(n);else if(n&&"function"===typeof n.getReader){const i=n.getReader(),r=[];let s=!1;for(;!s;){const e=await i.read();e.value&&r.push(e.value),s=e.done}const o=(new TextDecoder).decode(1===r.length?r[0]:await new Blob(r).arrayBuffer());try{e=JSON.parse(o)}catch(l){t=o}}}catch(u){}const c=(null===(i=e)||void 0===i?void 0:i.error)||t||a.message||"Failed to get AI response";KS.error("Chat API detailed error:",c),null!==(r=e)&&void 0!==r&&r.rateLimited?(g(0),d("Usage limit reached. Add your API key for unlimited access.")):d(c);const h={id:"msg-".concat(Date.now(),"-error"),role:"assistant",content:null!==(s=e)&&void 0!==s&&s.rateLimited?"Free usage limit reached. Click the settings button to add your own API key for unlimited access!":"Error: ".concat(c),timestamp:Date.now()};n.push([h])}finally{c(!1)}}},[t]);(0,s.useEffect)(()=>{let e=null;return(async()=>{try{const{provider:t}=await W_.connect();U.current=t,X.current=t.awareness.clientID,t.awareness.setLocalStateField("activeThread","default");const n=W_.getChatPrompt(),i=W_.getChatMessages(),s=W_.getChatAttachmentsMeta(),o=W_.getSendRequest();if(!n||!i||!s||!o)return void KS.error("Chat structures not available");$.current=n,z.current=i,W.current=s,V.current=o;const l=W_.getChatThreads();if(J.current=l,l){const e=[{id:"default",name:"Chat",createdAt:0}];l.forEach((t,n)=>{"default"!==n&&e.push({id:n,name:t.name||n,createdAt:t.createdAt||0})}),D(e);const t=()=>{const e=[{id:"default",name:"Chat",createdAt:0}];l.forEach((t,n)=>{"default"!==n&&e.push({id:n,name:t.name||n,createdAt:t.createdAt||0})}),D(e)};l.observe(t)}a(n.toString()),r(i.toArray());const c=()=>{a(n.toString())};n.observe(c);const h=()=>{const e=i.toArray();if(r(e),e.length>0){const n=e[e.length-1],r=n.content.includes("[Attached:");if("user"===n.role&&!r&&!Z.current&&!H.current.has(n.id)){const e=t.awareness.getStates(),r=Array.from(e.keys()),s=t.awareness.clientID;r.includes(s)||r.push(s);s===Math.min(...r)&&setTimeout(()=>se(n,i),100)}}};i.observe(h),w(s.toArray());const d=()=>{const e=s.toArray();w(e),A(e.some(e=>"ready"===e.embeddingStatus))};s.observe(d);const p=()=>{const e=o.get("id"),t=o.get("prompt"),r=o.get("requestedBy"),a=o.get("handledBy");if(e&&!a&&r!==X.current&&G.current.size>0){var l;KS.log("[Chat] Handling send request from peer, we have local files"),o.set("handledBy",X.current);const e=W_.getUserInfo();if(!e)return;let r=t||"";const a=Array.from(G.current.values()).map(e=>e.file.name);if(a.length>0){r+="\n"+a.map(e=>"[Attached: ".concat(e,"]")).join("\n")}const c={id:"msg-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),role:"user",content:r,author:{name:e.name,color:e.color},timestamp:Date.now()},u=[];let h="";G.current.forEach(e=>{e.processed&&u.push(e.processed),e.extractedText&&(h+=e.extractedText)}),Y.current.set(c.id,{images:u,extractedText:h}),G.current.clear(),y([]),s.delete(0,s.length),null===(l=n.doc)||void 0===l||l.transact(()=>{n.delete(0,n.toString().length)}),i.push([c]),se(c,i),o.delete("id"),o.delete("prompt"),o.delete("requestedBy"),o.delete("handledBy")}};o.observe(p);const f=()=>{const e=t.awareness.getStates(),n=t.awareness.clientID,i={},r={};e.forEach((e,t)=>{var s;if(null===(s=e.user)||void 0===s||!s.name)return;const o=e.activeThread||"default",a=e.user.name,l=e.user.color||"#999";if(t!==n&&(i[o]||(i[o]=[]),i[o].push({name:a,color:l})),e.chatTyping){const i=e.chatTyping;t!==n&&(r[i]||(r[i]=[]),r[i].push(a))}}),_(i),P(r)};f(),t.awareness.on("change",f);const m=()=>{const e=t.awareness.getStates(),n=Array.from(e.keys()),i=t.awareness.clientID;n.includes(i)||n.push(i);const r=Math.min(...n);u(i===r)},g=e=>{let{removed:t}=e;if(0===t.length)return;const n=new Set(t),i=s.toArray();for(let r=i.length-1;r>=0;r--)n.has(i[r].ownerId)&&(KS.log("[Chat] Removing attachment from disconnected peer:",i[r].name,i[r].ownerName),s.delete(r,1));if(o.get("id")&&!o.get("handledBy")){0===s.toArray().length&&(KS.log("[Chat] No file owners left online, clearing stale send request"),o.delete("id"),o.delete("prompt"),o.delete("requestedBy"),o.delete("handledBy"))}};setTimeout(m,500),t.awareness.on("change",m),t.awareness.on("change",g),e=()=>{n.unobserve(c),i.unobserve(h),s.unobserve(d),o.unobserve(p),t.awareness.off("change",f),t.awareness.off("change",m),t.awareness.off("change",g),W_.disconnect()}}catch(h){KS.error("Failed to connect ChatSidebar:",h)}})(),()=>{e&&e(),q.current&&clearTimeout(q.current)}},[]),(0,s.useEffect)(()=>{if(!z.current&&"default"===S)return;(async()=>{try{const{provider:e}=await W_.connect();e.awareness.setLocalStateField("activeThread",S)}catch(e){}})();let e=null,t=null;return(async()=>{try{const{provider:n}=await W_.connect(),i="default"===S?W_.getChatPrompt():W_.getChatThreadPrompt(S),s="default"===S?W_.getChatMessages():W_.getChatThreadMessages(S),o="default"===S?W_.getSendRequest():W_.getThreadSendRequest(S);if(!i||!s||!o)return;$.current=i,z.current=s,V.current=o,a(i.toString()),r(s.toArray()),e=()=>a(i.toString()),i.observe(e),t=()=>{const e=s.toArray();if(r(e),e.length>0){const t=e[e.length-1],i=t.content.includes("[Attached:");if("user"===t.role&&!i&&!Z.current&&!H.current.has(t.id)){const e=n.awareness.getStates(),i=Array.from(e.keys()),r=n.awareness.clientID;i.includes(r)||i.push(r);r===Math.min(...i)&&setTimeout(()=>se(t,s),100)}}},s.observe(t)}catch(n){KS.error("Failed to switch thread:",n)}})(),()=>{if(e&&$.current)try{$.current.unobserve(e)}catch(n){}if(t&&z.current)try{z.current.unobserve(t)}catch(i){}}},[S]);const oe=(0,s.useCallback)(async e=>{const n=[],i=[],r=W_.getUserInfo(),s=W.current;for(const a of Array.from(e)){if(!kre.includes(a.type)){i.push("".concat(a.name,": unsupported format"));continue}if(a.size>5242880){i.push("".concat(a.name,": too large (max 5MB)"));continue}const e="file-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),l=a.type.startsWith("image/");n.push({file:a,previewUrl:l?URL.createObjectURL(a):null});let c=null,u="";try{if("application/pdf"===a.type){u=await Sre(a),u.trim()&&(u="\n\n--- Content from ".concat(a.name," ---\n").concat(u));const e=await a.arrayBuffer(),t=new Uint8Array(e);let n="";for(let i=0;i<t.length;i++)n+=String.fromCharCode(t[i]);c={base64:btoa(n),mimeType:"application/pdf",name:a.name}}else if(l){const{base64:e,mimeType:t}=await Dre(a);c={base64:e,mimeType:t,name:a.name}}}catch(o){KS.warn("Failed to process ".concat(a.name,":"),o),u="\n\n--- Could not read ".concat(a.name," ---")}if(G.current.set(e,{file:a,processed:c,extractedText:u}),s&&r){const n={id:e,name:a.name,mimeType:a.type,ownerId:X.current,ownerName:r.name};if(s.push([n]),u.trim()){const i=s.toArray().findIndex(t=>t.id===e);-1!==i&&(s.delete(i,1),s.insert(i,[p(p({},n),{},{embeddingStatus:"processing"})])),Q_.functions.invoke("embed",{body:{room_id:t,file_name:a.name,text_content:u,file_id:e}}).then(t=>{let{error:n}=t;const i=s.toArray(),r=i.findIndex(t=>t.id===e);if(-1!==r){const e=n?"error":"ready";s.delete(r,1),s.insert(r,[p(p({},i[r]),{},{embeddingStatus:e})]),n||A(!0)}}).catch(()=>{})}}}i.length>0&&(d(i.join(", ")),setTimeout(()=>d(null),4e3)),n.length>0&&y(e=>[...e,...n])},[t]),ae=(0,s.useCallback)(e=>{const t=W.current;y(n=>{const i=n[e];if(null!==i&&void 0!==i&&i.previewUrl&&URL.revokeObjectURL(i.previewUrl),i&&t){const e=t.toArray(),n=e.findIndex(e=>e.name===i.file.name&&e.ownerId===X.current);if(-1!==n){const i=e[n];G.current.delete(i.id),t.delete(n,1)}}return n.filter((t,n)=>n!==e)})},[]),le=async()=>{var e;if(!o.trim()||l)return;const t=$.current,n=z.current,i=V.current,r=W.current,s=W_.getUserInfo();if(!t||!n||!i||!r||!s)return;const a=r.toArray(),c=a.filter(e=>e.ownerId!==X.current),u=a.filter(e=>e.ownerId===X.current);if(c.length>0)return KS.log("[Chat] Other peer has files, sending request for them to handle"),i.set("id","req-".concat(Date.now())),i.set("prompt",o.trim()),i.set("requestedBy",X.current),void i.delete("handledBy");let h=o.trim();if(u.length>0){h+="\n"+u.map(e=>{const t=e.mimeType.startsWith("image/")?"image":"application/pdf"===e.mimeType?"pdf":"file";return"[Attached: ".concat(e.name," (").concat(t,")]")}).join("\n")}const d={id:"msg-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),role:"user",content:h,author:{name:s.name,color:s.color},timestamp:Date.now()};if(G.current.size>0){const e=[];let t="";G.current.forEach(n=>{n.processed&&e.push(n.processed),n.extractedText&&(t+=n.extractedText)}),Y.current.set(d.id,{images:e,extractedText:t})}const p=G.current.size>0;null===(e=t.doc)||void 0===e||e.transact(()=>{t.delete(0,t.toString().length)}),G.current.clear(),y([]),r.delete(0,r.length),n.push([d]),p&&se(d,n)};return(0,Qt.jsxs)("div",{className:"chat-sidebar",onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),K.current++,e.dataTransfer.types.includes("Files")&&k(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),K.current--,0===K.current&&k(!1)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation(),K.current=0,k(!1),e.dataTransfer.files.length>0&&oe(e.dataTransfer.files)},children:[b&&(0,Qt.jsx)("div",{className:"chat-drop-overlay",children:(0,Qt.jsxs)("div",{className:"chat-drop-overlay-content",children:[(0,Qt.jsx)(jZ,{size:24}),(0,Qt.jsx)("span",{children:"Drop files here"})]})}),(0,Qt.jsxs)("div",{className:"chat-header",children:[(0,Qt.jsxs)("div",{className:"chat-title-row",children:[(0,Qt.jsx)("h3",{children:"AI Chat"}),(0,Qt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Qt.jsx)("span",{className:"chat-status",children:l?"Thinking...":M?"".concat(i.length," messages"):"Limited usage"}),n&&(0,Qt.jsx)("button",{className:"chat-close-button",onClick:n,title:"Close chat",children:(0,Qt.jsx)(Xq,{size:16})})]})]}),(0,Qt.jsxs)("div",{className:"chat-toolbar",children:[(0,Qt.jsx)("button",{className:"chat-settings-button ".concat(M?"has-key":""),onClick:()=>m(!f),title:M?"Using ".concat(R," API key"):"Add API key for more models",children:M?(0,Qt.jsx)($Z,{size:16}):(0,Qt.jsx)(zZ,{size:16})}),(0,Qt.jsx)("button",{className:"chat-clear-button",onClick:()=>{const e=z.current;e&&e.length>0&&e.delete(0,e.length)},disabled:0===i.length,title:"Clear chat",children:(0,Qt.jsx)(WZ,{size:16})})]})]}),(0,Qt.jsxs)("div",{className:"chat-thread-tabs",children:[x.map(e=>(0,Qt.jsxs)("div",{className:"chat-thread-tab ".concat(e.id===S?"active":""),onClick:()=>C(e.id),children:[(0,Qt.jsx)(VZ,{size:12}),(0,Qt.jsx)("span",{children:e.name}),E[e.id]&&E[e.id].length>0&&(0,Qt.jsxs)("span",{className:"chat-thread-presence",children:[E[e.id].slice(0,3).map((e,t)=>(0,Qt.jsx)("span",{className:"chat-thread-presence-dot",style:{backgroundColor:e.color},title:e.name},t)),E[e.id].length>3&&(0,Qt.jsxs)("span",{className:"chat-thread-presence-more",children:["+",E[e.id].length-3]})]}),T[e.id]&&T[e.id].length>0&&(0,Qt.jsxs)("span",{className:"chat-thread-typing",title:"".concat(T[e.id].join(", ")," typing..."),children:[(0,Qt.jsx)("span",{className:"typing-dot"}),(0,Qt.jsx)("span",{className:"typing-dot"}),(0,Qt.jsx)("span",{className:"typing-dot"})]}),"default"!==e.id&&(0,Qt.jsx)("button",{className:"chat-thread-close",onClick:t=>{t.stopPropagation(),D(t=>t.filter(t=>t.id!==e.id)),S===e.id&&C("default"),J.current&&J.current.delete(e.id)},children:(0,Qt.jsx)(Xq,{size:10})})]},e.id)),(0,Qt.jsx)("button",{className:"chat-thread-add",onClick:()=>{const e="thread-".concat(Date.now()),t={id:e,name:"Chat ".concat(x.length+1),createdAt:Date.now()};D(e=>[...e,t]),C(e),J.current&&J.current.set(e,{name:t.name,createdAt:t.createdAt})},title:"New chat thread",children:(0,Qt.jsx)(UZ,{size:14})})]}),f&&(0,Qt.jsxs)("div",{className:"chat-settings-panel",children:[(0,Qt.jsxs)("div",{className:"chat-settings-header",children:[(0,Qt.jsx)("h4",{children:"AI Settings"}),(0,Qt.jsx)("button",{className:"chat-settings-close",onClick:()=>m(!1),children:(0,Qt.jsx)(Xq,{size:16})})]}),(0,Qt.jsxs)("div",{className:"chat-settings-section",children:[(0,Qt.jsx)("label",{children:"API Provider"}),(0,Qt.jsxs)("div",{className:"chat-provider-buttons",children:[(0,Qt.jsx)("button",{className:"chat-provider-btn ".concat("openai"===R?"active":""),onClick:()=>{N("openai"),B("gpt-4o-mini")},children:"OpenAI"}),(0,Qt.jsx)("button",{className:"chat-provider-btn ".concat("anthropic"===R?"active":""),onClick:()=>{N("anthropic"),B("claude-haiku-4-5-20251001")},children:"Anthropic"})]})]}),(0,Qt.jsxs)("div",{className:"chat-settings-section",children:[(0,Qt.jsx)("label",{children:"Your API Key (optional)"}),(0,Qt.jsx)("input",{type:"password",className:"chat-api-input",placeholder:"openai"===R?"sk-...":"sk-ant-...",value:M,onChange:e=>F(e.target.value)}),(0,Qt.jsx)("span",{className:"chat-settings-hint",children:M?"Using your key - unlimited access":"Add your key for unlimited access & more models"})]}),M&&(0,Qt.jsx)("button",{className:"chat-clear-key-btn",onClick:()=>{F(""),B("gpt-4o-mini"),N("openai")},children:"Clear API Key"})]}),(0,Qt.jsxs)("div",{className:"chat-messages",children:[0===i.length?(0,Qt.jsxs)("div",{className:"chat-empty",children:[(0,Qt.jsx)("div",{className:"chat-welcome-logo",children:(0,Qt.jsx)(zt,{size:36,strokeColor:"white"})}),(0,Qt.jsx)("h2",{children:"How can I help you today?"}),(0,Qt.jsx)("div",{className:"chat-suggestions",children:bre.map(e=>(0,Qt.jsxs)("button",{className:"chat-suggestion-btn",onClick:()=>(e=>{var t;if($.current){var n;const t=$.current,i=t.toString();null===(n=t.doc)||void 0===n||n.transact(()=>{t.delete(0,i.length),t.insert(0,e)})}null===(t=L.current)||void 0===t||t.focus()})(e.label),children:[(0,Qt.jsx)(e.icon,{size:16}),e.label]},e.label))}),(0,Qt.jsx)("p",{className:"chat-empty-hint",children:"Everyone in this session can see and contribute to the chat"})]}):i.map(e=>{var t,n;return(0,Qt.jsxs)("div",{className:"chat-message ".concat("user"===e.role?"user":"assistant"),children:[(0,Qt.jsx)("div",{className:"chat-message-header",children:"user"===e.role?(0,Qt.jsxs)(Qt.Fragment,{children:[(0,Qt.jsx)("div",{className:"chat-message-avatar",style:{backgroundColor:(null===(t=e.author)||void 0===t?void 0:t.color)||"#B399D4"},children:(0,Qt.jsx)(XZ,{size:14})}),(0,Qt.jsx)("span",{className:"chat-message-author",children:(null===(n=e.author)||void 0===n?void 0:n.name)||"User"})]}):(0,Qt.jsxs)(Qt.Fragment,{children:[(0,Qt.jsx)("div",{className:"chat-message-avatar assistant",children:(0,Qt.jsx)(qZ,{size:14})}),(0,Qt.jsx)("span",{className:"chat-message-author",children:"AI Assistant"})]})}),(0,Qt.jsx)("div",{className:"chat-message-content",children:(0,Qt.jsx)(Cre,{content:e.content})})]},e.id)}),l&&(0,Qt.jsxs)("div",{className:"chat-message assistant",children:[(0,Qt.jsxs)("div",{className:"chat-message-header",children:[(0,Qt.jsx)("div",{className:"chat-message-avatar assistant",children:(0,Qt.jsx)(qZ,{size:14})}),(0,Qt.jsx)("span",{className:"chat-message-author",children:"AI Assistant"})]}),(0,Qt.jsxs)("div",{className:"chat-message-content typing",children:[(0,Qt.jsx)(eZ,{size:16,className:"spinning"}),(0,Qt.jsx)("span",{children:"Thinking..."})]})]}),T[S]&&T[S].length>0&&(0,Qt.jsxs)("div",{className:"chat-typing-indicator",children:[(0,Qt.jsxs)("span",{className:"chat-typing-dots",children:[(0,Qt.jsx)("span",{className:"typing-dot"}),(0,Qt.jsx)("span",{className:"typing-dot"}),(0,Qt.jsx)("span",{className:"typing-dot"})]}),(0,Qt.jsxs)("span",{className:"chat-typing-text",children:[T[S].join(", ")," ",1===T[S].length?"is":"are"," typing..."]})]}),(0,Qt.jsx)("div",{ref:Q})]}),h&&(0,Qt.jsx)("div",{className:"chat-error",children:h}),(0,Qt.jsxs)("div",{className:"chat-input-area",children:[(0,Qt.jsxs)("div",{className:"chat-input-card",children:[O.length>0&&(0,Qt.jsx)("div",{className:"chat-attachments",children:O.map(e=>{const t=e.ownerId===X.current,n=v.find(t=>t.file.name===e.name),i=e.mimeType.startsWith("image/")?"image":"application/pdf"===e.mimeType?"pdf":"file";return(0,Qt.jsxs)("div",{className:"chat-attachment-chip ".concat(t?"":"from-peer"),children:["image"===i&&null!==n&&void 0!==n&&n.previewUrl?(0,Qt.jsx)("img",{src:n.previewUrl,alt:e.name}):(0,Qt.jsx)("span",{className:"chat-attachment-chip-icon ".concat(i),children:(0,Qt.jsx)(NZ,{size:14})}),(0,Qt.jsxs)("span",{className:"chat-attachment-chip-name",children:[e.name,!t&&(0,Qt.jsxs)("span",{className:"chat-attachment-owner",children:[" (",e.ownerName,")"]})]}),e.embeddingStatus&&(0,Qt.jsxs)("span",{className:"chat-embedding-status ".concat(e.embeddingStatus),children:["processing"===e.embeddingStatus&&(0,Qt.jsx)(eZ,{size:10,className:"spinning"}),"ready"===e.embeddingStatus&&(0,Qt.jsx)(IZ,{size:10}),"error"===e.embeddingStatus&&(0,Qt.jsx)(Xq,{size:10})]}),t&&(0,Qt.jsx)("button",{className:"chat-attachment-chip-remove",onClick:()=>{const t=v.findIndex(t=>t.file.name===e.name);-1!==t&&ae(t)},children:(0,Qt.jsx)(Xq,{size:10})})]},e.id)})}),(0,Qt.jsx)("textarea",{ref:L,className:"chat-input",placeholder:"Ask anything...",value:o,onChange:e=>{const t=e.target.value;if($.current){var n;const e=$.current,i=e.toString();null===(n=e.doc)||void 0===n||n.transact(()=>{e.delete(0,i.length),e.insert(0,t)}),U.current&&(U.current.awareness.setLocalStateField("chatTyping",S),q.current&&clearTimeout(q.current),q.current=setTimeout(()=>{U.current&&U.current.awareness.setLocalStateField("chatTyping",null)},2e3))}},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),le())},disabled:l,rows:2}),(0,Qt.jsxs)("div",{className:"chat-input-actions",children:[(0,Qt.jsxs)("div",{className:"chat-input-left",children:[(0,Qt.jsxs)("button",{className:"chat-attach-button",onClick:()=>{var e;return null===(e=j.current)||void 0===e?void 0:e.click()},title:"Attach files",children:[(0,Qt.jsx)(ZZ,{size:16}),O.length>0&&(0,Qt.jsx)("span",{className:"chat-attach-badge",children:O.length})]}),(0,Qt.jsxs)("div",{className:"chat-model-picker",children:[(0,Qt.jsx)("select",{className:"chat-model-picker-select",value:I,onChange:e=>{const t=e.target.value;B(t);const n=ie().find(e=>e.id===t);n&&N(n.provider)},children:ie().map(e=>(0,Qt.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,Qt.jsx)(TZ,{size:12,className:"chat-model-picker-chevron"})]})]}),(0,Qt.jsx)("button",{className:"chat-send-button",onClick:le,disabled:!o.trim()||l,title:"Send message",children:l?(0,Qt.jsx)(eZ,{size:16,className:"spinning"}):(0,Qt.jsx)(HZ,{size:16})})]})]}),(0,Qt.jsx)("input",{ref:j,type:"file",multiple:!0,accept:"image/png,image/jpeg,image/gif,image/webp,application/pdf,.ppt,.pptx",style:{display:"none"},onChange:e=>{e.target.files&&e.target.files.length>0&&oe(e.target.files),e.target.value=""}})]})]})}const Ere=qz("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),_re=qz("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);function Tre(e){let{roomId:t}=e;const[n,i]=(0,s.useState)(""),[r,o]=(0,s.useState)([]),[a,l]=(0,s.useState)([]),[c,u]=(0,s.useState)(!1),[h,d]=(0,s.useState)(!1),[p,f]=(0,s.useState)(-1),[m,g]=(0,s.useState)(null),[v,y]=(0,s.useState)(null),O=(0,s.useRef)(null),w=(0,s.useRef)(null),b=(0,s.useRef)(null),k=a.length+r.length,x=(0,s.useCallback)(e=>{if(!e.trim()||e.trim().length<2)l([]);else try{const t=W_.getYDoc();if(!t)return void l([]);const n=zP(t.getXmlFragment("prosemirror"));if(!n)return void l([]);const i=e.trim().toLowerCase(),r=[];let s=0,o=0;for(;s<n.length&&r.length<10;){const e=n.toLowerCase().indexOf(i,s);if(-1===e)break;const t=Math.max(0,e-40),a=Math.min(n.length,e+i.length+60);let l=n.substring(t,a).replace(/\n/g," ");t>0&&(l="..."+l),a<n.length&&(l+="..."),r.push({snippet:l,matchIndex:o}),o++,s=e+i.length}l(r)}catch(t){l([])}},[]);(0,s.useEffect)(()=>()=>{b.current&&clearTimeout(b.current)},[]),(0,s.useEffect)(()=>{const e=e=>{w.current&&!w.current.contains(e.target)&&O.current&&!O.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,s.useEffect)(()=>{const e=e=>{var t;(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),null===(t=O.current)||void 0===t||t.focus())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);const D=(0,s.useCallback)(async e=>{if(e.trim()){u(!0);try{const{data:n,error:i}=await Q_.functions.invoke("search",{body:{room_id:t,query:e.trim()}});if(i)throw i;const r=(null===n||void 0===n?void 0:n.results)||[];o(r),y(r.length>0||!0===v)}catch(n){console.error("Search failed:",n),o([])}finally{u(!1)}}else o([])},[t,v]),S=e=>{window.dispatchEvent(new CustomEvent("searchScrollTo",{detail:{query:n.trim(),matchIndex:e.matchIndex}})),d(!1)},C=async(e,t)=>{try{await navigator.clipboard.writeText(e.text_content),g(t),setTimeout(()=>g(null),1500)}catch(n){const i=document.createElement("textarea");i.value=e.text_content,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),g(t),setTimeout(()=>g(null),1500)}},A=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120;return e.length<=t?e:e.substring(0,t)+"..."},E=e=>{const t=n.trim();if(!t)return e;const i=new RegExp("(".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),")"),"gi");return e.split(i).map((e,t)=>i.test(e)?(0,Qt.jsx)("mark",{className:"search-bar-highlight",children:e},t):e)},_=a.length>0||r.length>0;return(0,Qt.jsxs)("div",{className:"search-bar-container",children:[(0,Qt.jsxs)("div",{className:"search-bar-input-wrapper",children:[(0,Qt.jsx)(Ere,{size:16,className:"search-bar-icon"}),(0,Qt.jsx)("input",{ref:O,type:"text",className:"search-bar-input",placeholder:"Search doc & files... (\u2318K)",value:n,onChange:e=>{const t=e.target.value;i(t),x(t),t.trim()?(d(!0),f(-1)):d(!1),b.current&&clearTimeout(b.current),b.current=setTimeout(()=>D(t),300)},onKeyDown:e=>{if(h&&0!==k)if("ArrowDown"===e.key)e.preventDefault(),f(e=>Math.min(e+1,k-1));else if("ArrowUp"===e.key)e.preventDefault(),f(e=>Math.max(e-1,-1));else if("Enter"===e.key&&p>=0)if(e.preventDefault(),p<a.length)S(a[p]);else{const e=p-a.length;C(r[e],e)}else if("Escape"===e.key){var t;d(!1),null===(t=O.current)||void 0===t||t.blur()}},onFocus:()=>{_&&d(!0)}}),n&&(0,Qt.jsx)("button",{className:"search-bar-clear",onClick:()=>{var e;i(""),o([]),l([]),d(!1),null===(e=O.current)||void 0===e||e.focus()},children:(0,Qt.jsx)(Xq,{size:14})}),c&&(0,Qt.jsx)("div",{className:"search-bar-spinner"})]}),h&&(0,Qt.jsx)("div",{ref:w,className:"search-bar-dropdown",children:_||c?(0,Qt.jsxs)(Qt.Fragment,{children:[a.length>0&&(0,Qt.jsxs)(Qt.Fragment,{children:[(0,Qt.jsxs)("div",{className:"search-bar-section-header",children:[(0,Qt.jsx)(_re,{size:12}),"In Document",(0,Qt.jsx)("span",{className:"search-bar-section-count",children:a.length})]}),a.map((e,t)=>(0,Qt.jsx)("div",{className:"search-bar-result ".concat(t===p?"selected":""),onClick:()=>S(e),onMouseEnter:()=>f(t),children:(0,Qt.jsx)("div",{className:"search-bar-result-text",children:E(e.snippet)})},"doc-".concat(e.matchIndex)))]}),r.length>0&&(0,Qt.jsxs)(Qt.Fragment,{children:[(0,Qt.jsxs)("div",{className:"search-bar-section-header",children:[(0,Qt.jsx)(NZ,{size:12}),"From Files",(0,Qt.jsx)("span",{className:"search-bar-section-count",children:r.length})]}),r.map((e,t)=>{const n=a.length+t;return(0,Qt.jsxs)("div",{className:"search-bar-result ".concat(n===p?"selected":""),onClick:()=>C(e,t),onMouseEnter:()=>f(n),children:[(0,Qt.jsxs)("div",{className:"search-bar-result-header",children:[(0,Qt.jsx)(NZ,{size:14,className:"search-bar-result-icon"}),(0,Qt.jsx)("span",{className:"search-bar-result-file",children:e.file_name}),(0,Qt.jsxs)("span",{className:"search-bar-result-score",children:[(100*e.rrf_score).toFixed(0),"%"]}),(0,Qt.jsx)("button",{className:"search-bar-result-copy",onClick:n=>{n.stopPropagation(),C(e,t)},children:m===t?(0,Qt.jsx)(hZ,{size:12}):(0,Qt.jsx)(LZ,{size:12})})]}),(0,Qt.jsx)("div",{className:"search-bar-result-text",children:A(e.text_content)})]},"".concat(e.file_name,"-").concat(e.chunk_index))})]}),c&&0===r.length&&(0,Qt.jsx)("div",{className:"search-bar-empty",children:"Searching files..."})]}):(0,Qt.jsx)("div",{className:"search-bar-empty",children:n.trim().length<2?"Type at least 2 characters":"No results found"})})]})}const Pre=qz("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Mre=qz("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Fre=qz("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),Rre=qz("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Nre=qz("chevrons-up",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]),Ire=qz("chevrons-down",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]),Bre="1.3.5";function Qre(e){let{roomId:t}=e;const n=400,{logout:i}=$t(),[r,o]=(0,s.useState)([]),[a,l]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!1),[h,d]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),[m,g]=(0,s.useState)(null),[v,y]=(0,s.useState)(()=>localStorage.getItem("tutor_instructions_".concat(t))||""),[O,w]=(0,s.useState)(n),[b,k]=(0,s.useState)(!1),[x,D]=(0,s.useState)(!1),[S,C]=(0,s.useState)(!1),[A,E]=(0,s.useState)(null),[_,T]=(0,s.useState)(!1),[P,M]=(0,s.useState)(()=>{try{const e=localStorage.getItem("flashy-chat-fab-position");if(e)return JSON.parse(e)}catch(e){}return{bottom:24,right:24}}),F=(0,s.useRef)(null),[R,N]=(0,s.useState)(!1),I=(0,s.useRef)(null),[B,Q]=(0,s.useState)(!1),[L,j]=(0,s.useState)(!1),$=(0,s.useRef)(null),[z,W]=(0,s.useState)(()=>{const e=localStorage.getItem("starredCards");return e?new Set(JSON.parse(e)):new Set}),[V,U]=(0,s.useState)(!1),[X,q]=(0,s.useState)(()=>localStorage.getItem("flashy_editor_mode")||"markdown"),[Z,H]=(0,s.useState)(null),Y=Ce(),[G,K]=(0,s.useState)(!1),J=()=>{i(),Y("/")},ee=(0,s.useCallback)(e=>{e.currentTarget.setPointerCapture(e.pointerId),F.current={isDragging:!0,hasMoved:!1,startX:e.clientX,startY:e.clientY,startRight:P.right,startBottom:P.bottom},N(!0)},[P]),te=(0,s.useCallback)(e=>{const t=F.current;if(!t||!t.isDragging)return;const n=e.clientX-t.startX,i=e.clientY-t.startY;if(!t.hasMoved&&Math.sqrt(n*n+i*i)<5)return;t.hasMoved=!0;const r=t.startRight-n,s=t.startBottom-i,o=Math.max(8,Math.min(window.innerWidth-56-8,r)),a=Math.max(8,Math.min(window.innerHeight-56-8,s));M({right:o,bottom:a})},[]),ne=(0,s.useCallback)(e=>{const t=F.current;if(!t)return;const n=t.hasMoved;F.current=null,N(!1),n?M(e=>(localStorage.setItem("flashy-chat-fab-position",JSON.stringify(e)),e)):T(!0)},[]),ie=(0,s.useCallback)(e=>{const t=e.target;if(t.closest("button")||t.closest("input")||t.closest("textarea")||t.closest("select"))return;const n=e.currentTarget.getBoundingClientRect();e.clientY-n.top>48||(e.currentTarget.setPointerCapture(e.pointerId),I.current={isDragging:!0,startX:e.clientX,startY:e.clientY,startRight:P.right,startBottom:P.bottom},Q(!0))},[P]),re=(0,s.useCallback)(e=>{const t=I.current;if(!t||!t.isDragging)return;const n=e.clientX-t.startX,i=e.clientY-t.startY,r=t.startRight-n,s=t.startBottom-i,o=Math.max(8,Math.min(window.innerWidth-200,r)),a=Math.max(8,Math.min(window.innerHeight-100,s));M({right:o,bottom:a})},[]),se=(0,s.useCallback)(()=>{I.current&&(I.current=null,Q(!1),M(e=>(localStorage.setItem("flashy-chat-fab-position",JSON.stringify(e)),e)))},[]),oe=async e=>{q(e),localStorage.setItem("flashy_editor_mode",e);try{const{provider:n}=await W_.connect(t);n.awareness.setLocalStateField("editorMode",e)}catch(n){KS.error("Failed to broadcast mode change:",n)}},ae=e=>{const t=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n"),n=[];let i="";for(let r=0;r<t.length;r++){const e=t[r],s=e.match(/^#\s+(.+)$/);if(s){i=s[1].trim();continue}const o=e.match(/^##\s+(.+)$/);if(o){const e=o[1].trim();let s="",a=r+1;for(;a<t.length&&!t[a].match(/^#{1,2}\s+/);)s+=t[a]+"\n",a++;n.push({id:"card-".concat(r),term:e,definition:s.trim(),lineNumber:r,section:i||void 0})}}return n},le=(e,t)=>{t.stopPropagation();const n=new Set(z);n.has(e)?n.delete(e):n.add(e),W(n),localStorage.setItem("starredCards",JSON.stringify(Array.from(n)))};(0,s.useEffect)(()=>{localStorage.setItem("tutor_instructions_".concat(t),v)},[v,t]);(0,s.useEffect)(()=>{const e=e=>{if(null===A)return;if(!(Math.abs(e.clientX-A)<3)&&x){const t=e.clientX-24,i=window.innerWidth-464;t>=n&&t<=i&&w(t)}},t=()=>{D(!1),E(null)};return x&&(document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),document.body.style.cursor="ew-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.body.style.cursor="",document.body.style.userSelect=""}},[x,A,O]),(0,s.useEffect)(()=>{const e=e=>{if((e.ctrlKey||e.metaKey)&&e.shiftKey&&"M"===e.key){e.preventDefault();const t=["markdown","wysiwyg","canvas"],n=t.indexOf(X),i=t[(n+1)%t.length];oe(i)}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[X]),(0,s.useEffect)(()=>{const e=()=>{const e=window.scrollY>20;l(e)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,s.useEffect)(()=>{const e=e=>{$.current&&!$.current.contains(e.target)&&j(!1)};return L&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[L]),(0,s.useEffect)(()=>{let e;return(async()=>{try{const{ydoc:e,provider:n}=await W_.connect(t);n.awareness.setLocalStateField("editorMode",X);const i=e.getXmlFragment("prosemirror"),r=(()=>zP(i))(),s=ae(r);r.length>0&&0===s.length&&KS.warn("\u26a0\ufe0f Flashcard parsing: document has content but 0 cards detected.","Content length:",r.length,"First 200 chars:",JSON.stringify(r.substring(0,200))),o(s);let a=null;const l=()=>{a&&clearTimeout(a),a=setTimeout(()=>{try{const e=zP(i),t=ae(e);o(t)}catch(Kre){KS.warn("Failed to parse flashcards:",Kre)}},100)};return i.observeDeep(l),()=>{i.unobserveDeep(l)}}catch(e){"ROOM_FULL"===e.message?(KS.log("\ud83d\udeab Room is full, cannot join"),U(!0)):KS.error("Failed to connect:",e)}})().then(t=>{e=t}),()=>{e&&e(),W_.disconnect()}},[X,t]);const ce=(0,s.useCallback)(()=>"markdown"===X?document.querySelector(".editor-panel.active .cm-scroller"):document.querySelector(".editor-panel.active .tiptap-editor"),[X]),ue=(0,s.useCallback)(e=>{const t=ce();t&&t.scrollTo({top:"top"===e?0:t.scrollHeight,behavior:"smooth"})},[ce]);if(V)return(0,Qt.jsx)("div",{className:"editor-page",style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",background:"linear-gradient(135deg, #F5E1FD 0%, #E8D5F2 100%)"},children:(0,Qt.jsxs)("div",{style:{textAlign:"center",padding:"48px",background:"rgba(255, 255, 255, 0.9)",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",maxWidth:"500px"},children:[(0,Qt.jsx)(zt,{size:80}),(0,Qt.jsx)("h1",{style:{fontSize:"32px",color:"#1f2937",marginTop:"24px",marginBottom:"16px"},children:"Party's Full! \ud83c\udf89"}),(0,Qt.jsx)("p",{style:{fontSize:"18px",color:"#6b7280",lineHeight:"1.6"},children:"This study session has reached its maximum capacity of 4 users. Please try again later when someone leaves."}),(0,Qt.jsx)("button",{onClick:J,style:{marginTop:"32px",padding:"12px 32px",fontSize:"16px",fontWeight:600,color:"white",background:"#B399D4",border:"none",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseOver:e=>e.currentTarget.style.background="#9b7ec4",onMouseOut:e=>e.currentTarget.style.background="#B399D4",children:"Back to Login"})]})});const he=S;return(0,Qt.jsxs)("div",{className:"editor-page",style:{"--left-sidebar-width":b?"0px":"".concat(O,"px"),"--min-panel-width":"".concat(n,"px"),"--margin-left":"".concat(24,"px"),"--margin-gap":"".concat(16,"px")},children:[(0,Qt.jsx)(Vq,{}),(0,Qt.jsxs)("div",{className:"editor-header ".concat(a?"scrolled":""),children:[(0,Qt.jsxs)("div",{className:"editor-title-container",children:[(0,Qt.jsx)(zt,{size:40}),(0,Qt.jsx)("h1",{className:"editor-title",children:"Flashy"})]}),(0,Qt.jsx)(Tre,{roomId:t}),(0,Qt.jsxs)("div",{className:"header-actions",children:[(0,Qt.jsx)(Wq,{onUserClick:e=>{const t=e.mode||"markdown",n=e.cursorPosition;void 0!==n?t!==X?(oe(t),setTimeout(()=>{H({position:n,timestamp:Date.now()})},100)):H({position:n,timestamp:Date.now()}):t!==X&&oe(t)}}),(0,Qt.jsx)(zq,{roomId:t}),(0,Qt.jsxs)("button",{onClick:async()=>{const e=window.location.href;try{await navigator.clipboard.writeText(e),K(!0),setTimeout(()=>K(!1),2e3)}catch(t){const n=document.createElement("input");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),K(!0),setTimeout(()=>K(!1),2e3)}},className:"share-button",title:"Copy room link",children:[G?(0,Qt.jsx)(hZ,{size:20}):(0,Qt.jsx)(Pre,{size:20}),(0,Qt.jsx)("span",{children:G?"Copied!":"Share"})]}),(0,Qt.jsx)($q,{onRestore:async e=>{const t=W_.persistence;if(!t)throw new Error("Persistence not initialized");await t.restoreVersion(e)},roomId:t}),(0,Qt.jsxs)("div",{ref:$,style:{position:"relative"},children:[(0,Qt.jsx)("button",{className:"lock-button",title:"Info",onClick:()=>j(!L),children:(0,Qt.jsx)(Mre,{size:20})}),L&&(0,Qt.jsxs)("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",background:"white",border:"1px solid #e5e7eb",borderRadius:"10px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.12)",padding:"14px 18px",zIndex:1e3,whiteSpace:"nowrap",fontSize:"14px",color:"#333",fontWeight:500},children:[(0,Qt.jsx)("span",{children:"made with dreams :)"}),(0,Qt.jsx)("br",{}),(0,Qt.jsxs)("span",{style:{color:"#9ca3af"},children:["v",Bre]})]})]}),(0,Qt.jsx)("button",{onClick:J,className:"lock-button",title:"Leave room",children:(0,Qt.jsx)(Fre,{size:22})})]})]}),!b&&(0,Qt.jsx)(RZ,{flashcards:r,starredCards:z,onToggleStar:le,onStartStudy:e=>{g(e||null),u(!0)},onStartTutor:e=>{g(e||null),d(!0)},onStartGames:e=>{g(e||null),f(!0)},isAnimating:S,tutorInstructions:v,onTutorInstructionsChange:y}),(0,Qt.jsxs)("div",{className:"resize-handle-left ".concat(S?"animating":""," ").concat(b?"collapsed":""),style:{left:b?"0px":"calc(var(--left-sidebar-width) + var(--margin-left) + var(--margin-gap) / 2 - 8px)"},onMouseDown:b?void 0:e=>{E(e.clientX),D(!0)},children:[!b&&(0,Qt.jsx)("div",{className:"resize-stick ".concat(S?"animating":"")}),(0,Qt.jsx)("button",{className:"resize-toggle-button ".concat(S?"animating":""),onMouseDown:e=>e.stopPropagation(),onClick:e=>{e.stopPropagation(),C(!0),k(!b),setTimeout(()=>C(!1),500)},title:b?"Show flashcards":"Hide flashcards",children:(0,Qt.jsxs)("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,Qt.jsx)("svg",{width:32,height:32,viewBox:"0 0 55 55",xmlns:"http://www.w3.org/2000/svg",children:(0,Qt.jsx)("g",{transform:"translate(-30, -13) scale(4) rotate(-15)",children:(0,Qt.jsx)("path",{d:"M10 16.7 L13 18.5 C13.8321 19.1154 14.9154 18.8615 15.2857 18.0313L18.2815 11.4698C18.6518 10.6396 18.1606 9.67891 17.2518 9.53429L8.3871 8.16507 C7 8.02045 6.71766 8.79742 6.34815 9.68484 L5.6 11.5 C4.5 13.9 5 13.7 8 15.5 z",fill:"#B399D4",stroke:"#B399D4",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,Qt.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"white"},children:b?(0,Qt.jsx)(Rre,{size:14}):(0,Qt.jsx)(MZ,{size:14})})]})})]}),(0,Qt.jsxs)("div",{className:"editor-content ".concat(he?"animating":""),children:[(0,Qt.jsx)("div",{className:"mode-selector-overlay",children:(0,Qt.jsx)(SZ,{currentMode:X,onModeChange:oe})}),(0,Qt.jsx)("button",{className:"editor-scroll-btn editor-scroll-top",onClick:()=>ue("top"),title:"Scroll to top",children:(0,Qt.jsx)(Nre,{size:18})}),(0,Qt.jsx)("button",{className:"editor-scroll-btn editor-scroll-bottom",onClick:()=>ue("bottom"),title:"Scroll to bottom",children:(0,Qt.jsx)(Ire,{size:18})}),(0,Qt.jsx)("div",{className:"editor-panel ".concat("wysiwyg"===X?"active":"hidden"),children:(0,Qt.jsx)(iW,{scrollTarget:Z,isActive:"wysiwyg"===X})}),(0,Qt.jsx)("div",{className:"editor-panel ".concat("markdown"===X?"active":"hidden"),children:(0,Qt.jsx)(HP,{scrollTarget:Z,isActive:"markdown"===X,roomId:t})}),(0,Qt.jsx)("div",{className:"editor-panel ".concat("canvas"===X?"active":"hidden"),children:(0,Qt.jsx)(Lq,{isActive:"canvas"===X,flashcards:r,roomId:t})})]}),_?(0,Qt.jsx)("div",{className:"chat-widget".concat(B?" dragging":""),style:{bottom:P.bottom,right:P.right},onPointerDown:ie,onPointerMove:re,onPointerUp:se,children:(0,Qt.jsx)(Are,{roomId:t,onClose:()=>T(!1)})}):(0,Qt.jsx)("button",{className:"chat-fab".concat(R?" dragging":""),style:{bottom:P.bottom,right:P.right},onPointerDown:ee,onPointerMove:te,onPointerUp:ne,title:"Open AI chat",children:(0,Qt.jsx)(VZ,{size:24})}),c&&r.length>0&&(0,Qt.jsx)(qq,{flashcards:m?r.filter(e=>m.includes(e.id)):r,starredCards:z,onToggleStar:le,onClose:()=>{u(!1),g(null)}}),h&&(0,Qt.jsx)(aZ,{flashcards:m?r.filter(e=>m.includes(e.id)):r,onClose:()=>{d(!1),g(null)},roomId:t,tutorInstructions:v}),p&&r.length>=3&&(0,Qt.jsx)(bZ,{flashcards:m?r.filter(e=>m.includes(e.id)):r,onClose:()=>{f(!1),g(null)}})]})}const Lre=qz("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);function jre(){const e=Ce(),[t,n]=(0,s.useState)(""),[i,r]=(0,s.useState)("");return(0,Qt.jsx)("div",{className:"landing-page",children:(0,Qt.jsxs)("div",{className:"landing-content",children:[(0,Qt.jsxs)("div",{className:"landing-header",children:[(0,Qt.jsx)(zt,{size:80}),(0,Qt.jsx)("h1",{children:"Flashy"}),(0,Qt.jsx)("p",{className:"landing-tagline",children:"Collaborative flashcards with AI assistance"})]}),(0,Qt.jsxs)("div",{className:"landing-actions",children:[(0,Qt.jsxs)("button",{className:"landing-create-btn",onClick:()=>{const t=function(){const e="abcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let n=0;n<8;n++)t+=e.charAt(Math.floor(36*Math.random()));return t}();sessionStorage.setItem("flashy_new_room",t),e("/room/".concat(t))},children:[(0,Qt.jsx)(UZ,{size:24}),(0,Qt.jsx)("span",{children:"Create a Room"})]}),(0,Qt.jsx)("div",{className:"landing-divider",children:(0,Qt.jsx)("span",{children:"or join existing"})}),(0,Qt.jsxs)("form",{className:"landing-join-form",onSubmit:n=>{n.preventDefault();const i=t.trim().toLowerCase();if(!i)return void r("Please enter a room code");let s=i;if(i.includes("/room/")){const e=i.match(/\/room\/([a-z0-9]+)/);e&&(s=e[1])}!/^[a-z0-9]+$/.test(s)||s.length>64?r("Invalid room code"):e("/room/".concat(s))},children:[(0,Qt.jsxs)("div",{className:"landing-join-input-wrapper",children:[(0,Qt.jsx)(Lre,{size:20,className:"landing-join-icon"}),(0,Qt.jsx)("input",{type:"text",className:"landing-join-input",placeholder:"Enter room code or paste link",value:t,onChange:e=>{n(e.target.value),r("")}}),(0,Qt.jsx)("button",{type:"submit",className:"landing-join-btn",disabled:!t.trim(),children:(0,Qt.jsx)(tZ,{size:20})})]}),i&&(0,Qt.jsx)("p",{className:"landing-error",children:i})]})]}),(0,Qt.jsxs)("div",{className:"landing-features",children:[(0,Qt.jsx)("div",{className:"landing-feature",children:(0,Qt.jsx)("span",{children:"Real-time collaboration"})}),(0,Qt.jsx)("div",{className:"landing-feature",children:(0,Qt.jsx)("span",{children:"AI study assistant"})}),(0,Qt.jsx)("div",{className:"landing-feature",children:(0,Qt.jsx)("span",{children:"Study mode with flashcards"})})]}),(0,Qt.jsx)("p",{className:"landing-footer",children:"Share your room link with up to 3 friends to study together"})]})})}const $re=Date.now().toString();function zre(){const[e,t]=(0,s.useState)(!1);(0,s.useEffect)(()=>{localStorage.getItem("app_version")||localStorage.setItem("app_version",$re);const e=async()=>{try{var e,i;const r="/flashy",s=await fetch(r+"/?t="+Date.now(),{cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}}),o=(await s.text()).match(/main\.([a-f0-9]+)\.js/),a=null===(e=document.querySelector('script[src*="main."]'))||void 0===e||null===(i=e.getAttribute("src"))||void 0===i?void 0:i.match(/main\.([a-f0-9]+)\.js/);o&&a&&o[1]!==a[1]&&(KS.log("New version detected! Current:",a[1],"New:",o[1]),KS.log("\u23f3 Auto-reloading in 3 seconds..."),t(!0),setTimeout(()=>{n()},3e3))}catch(r){}};e();const i=setInterval(e,15e3);return()=>clearInterval(i)},[]);const n=async()=>{if(KS.log("\ud83d\udd04 Forcing hard refresh and clearing all caches..."),localStorage.clear(),sessionStorage.clear(),"serviceWorker"in navigator){const e=await navigator.serviceWorker.getRegistrations();for(const t of e)await t.unregister()}if("caches"in window){const e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}window.location.reload()};return e?(0,Qt.jsx)("div",{className:"update-notification",children:(0,Qt.jsx)("div",{className:"update-content",children:(0,Qt.jsx)("span",{children:"New version detected! Auto-reloading in 3s..."})})}):null}function Wre(){const{roomId:e}=Ae(),{isAuthenticated:t}=$t();return e?t?(0,Qt.jsx)(Qre,{roomId:e}):(0,Qt.jsx)(Wt,{redirectTo:"/room/".concat(e)}):(0,Qt.jsx)(Xe,{to:"/",replace:!0})}function Vre(){return(0,Qt.jsxs)(Qt.Fragment,{children:[(0,Qt.jsx)(zre,{}),(0,Qt.jsxs)(He,{children:[(0,Qt.jsx)(qe,{path:"/",element:(0,Qt.jsx)(jre,{})}),(0,Qt.jsx)(qe,{path:"/room/:roomId",element:(0,Qt.jsx)(Wre,{})}),(0,Qt.jsx)(qe,{path:"*",element:(0,Qt.jsx)(Xe,{to:"/",replace:!0})})]})]})}const Ure=function(){return(0,Qt.jsx)(Et,{basename:"/flashy",children:(0,Qt.jsx)(jt,{children:(0,Qt.jsx)(Vre,{})})})},Xre=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:s,getTTFB:o}=t;n(e),i(e),r(e),s(e),o(e)})},qre=new Set;let Zre=0;let Hre=null;async function Yre(e){if(Zre>=10)return;const t=(n=e.message,i=e.stack,"".concat(n,":").concat((null===i||void 0===i?void 0:i.slice(0,200))||""));var n,i;if(!qre.has(t)){if(qre.add(t),Zre++,qre.size>100){const e=qre.values().next().value;e&&qre.delete(e)}try{var r;await Q_.from("error_logs").insert({message:e.message.slice(0,1e3),stack:null===(r=e.stack)||void 0===r?void 0:r.slice(0,5e3),error_type:e.error_type,room_id:e.room_id,user_agent:e.user_agent,url:e.url,session_id:e.session_id,user_name:e.user_name})}catch(s){}}}function Gre(){const e=window.location.pathname.match(/\/room\/([^/]+)/);return{room_id:(null===e||void 0===e?void 0:e[1])||sessionStorage.getItem("flashy_room_id")||void 0,user_agent:navigator.userAgent,url:window.location.href,session_id:sessionStorage.getItem("flashy_session_id")||void 0,user_name:sessionStorage.getItem("flashy_username")||void 0}}!function(){if(Hre||(Hre=setInterval(()=>{Zre=0},6e4)),!sessionStorage.getItem("flashy_session_id")){const e=new Uint8Array(8);crypto.getRandomValues(e);const t=Array.from(e,e=>e.toString(16).padStart(2,"0")).join("");sessionStorage.setItem("flashy_session_id","session-".concat(t))}window.addEventListener("error",e=>{var t;Yre(p({message:e.message||"Unknown error",stack:null===(t=e.error)||void 0===t?void 0:t.stack,error_type:"uncaught"},Gre()))}),window.addEventListener("unhandledrejection",e=>{const t=e.reason;Yre(p({message:(null===t||void 0===t?void 0:t.message)||String(t)||"Unhandled promise rejection",stack:null===t||void 0===t?void 0:t.stack,error_type:"unhandledrejection"},Gre()))})}(),(async()=>{try{if("indexedDB"in window&&"function"===typeof indexedDB.databases){const e=await indexedDB.databases();for(const t of e)t.name&&t.name.startsWith("flashy-doc-")&&(indexedDB.deleteDatabase(t.name),console.log("[Flashy] Cleaned up stale IndexedDB:",t.name))}}catch(e){}})();a.createRoot(document.getElementById("root")).render((0,Qt.jsx)(Ure,{})),Xre()})();
//# sourceMappingURL=main.09bca386.js.map